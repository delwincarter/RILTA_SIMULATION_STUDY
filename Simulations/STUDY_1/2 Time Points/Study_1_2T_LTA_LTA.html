<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Delwin Carter">
<meta name="dcterms.date" content="2025-03-13">

<title>Understanding the Performance of Random Intercepts Latent Transition Analysis (RI-LTA): A Monte Carlo Simulation Study using MplusAutomation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Study_1_2T_LTA_LTA_files/libs/clipboard/clipboard.min.js"></script>
<script src="Study_1_2T_LTA_LTA_files/libs/quarto-html/quarto.js"></script>
<script src="Study_1_2T_LTA_LTA_files/libs/quarto-html/popper.min.js"></script>
<script src="Study_1_2T_LTA_LTA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Study_1_2T_LTA_LTA_files/libs/quarto-html/anchor.min.js"></script>
<link href="Study_1_2T_LTA_LTA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Study_1_2T_LTA_LTA_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Study_1_2T_LTA_LTA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Study_1_2T_LTA_LTA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Study_1_2T_LTA_LTA_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="Study_1_2T_LTA_LTA_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="Study_1_2T_LTA_LTA_files/libs/tabwid-1.1.3/tabwid.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Overview</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#study-1.1-lta-generated-lta-analyzed" id="toc-study-1.1-lta-generated-lta-analyzed" class="nav-link" data-scroll-target="#study-1.1-lta-generated-lta-analyzed">Study 1.1: LTA Generated, LTA Analyzed</a></li>
  </ul></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a>
  <ul class="collapse">
  <li><a href="#part-1-conduct-simulation" id="toc-part-1-conduct-simulation" class="nav-link" data-scroll-target="#part-1-conduct-simulation">Part 1: Conduct Simulation</a>
  <ul class="collapse">
  <li><a href="#setting-up-the-simulation-conditions" id="toc-setting-up-the-simulation-conditions" class="nav-link" data-scroll-target="#setting-up-the-simulation-conditions">Setting up the Simulation Conditions&nbsp;</a></li>
  <li><a href="#run-initial-simulation" id="toc-run-initial-simulation" class="nav-link" data-scroll-target="#run-initial-simulation">Run Initial Simulation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-processing-and-verification" id="toc-data-processing-and-verification" class="nav-link" data-scroll-target="#data-processing-and-verification">Data Processing and Verification</a>
  <ul class="collapse">
  <li><a href="#check-for-label-switching-and-errors" id="toc-check-for-label-switching-and-errors" class="nav-link" data-scroll-target="#check-for-label-switching-and-errors">Check for Label Switching and Errors</a>
  <ul class="collapse">
  <li><a href="#scrape-mplus-csv-files" id="toc-scrape-mplus-csv-files" class="nav-link" data-scroll-target="#scrape-mplus-csv-files">Scrape Mplus CSV Files</a></li>
  <li><a href="#slice-data-extract-parameters" id="toc-slice-data-extract-parameters" class="nav-link" data-scroll-target="#slice-data-extract-parameters">Slice Data / Extract Parameters</a></li>
  <li><a href="#wrangle-data" id="toc-wrangle-data" class="nav-link" data-scroll-target="#wrangle-data">Wrangle Data</a></li>
  <li><a href="#generate-plots-of-label-switching" id="toc-generate-plots-of-label-switching" class="nav-link" data-scroll-target="#generate-plots-of-label-switching">Generate Plots of Label Switching</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#error-handling" id="toc-error-handling" class="nav-link" data-scroll-target="#error-handling">Error Handling</a>
  <ul class="collapse">
  <li><a href="#scrape-for-errors" id="toc-scrape-for-errors" class="nav-link" data-scroll-target="#scrape-for-errors">Scrape for Errors</a></li>
  <li><a href="#merge-errors-with-main-data-file" id="toc-merge-errors-with-main-data-file" class="nav-link" data-scroll-target="#merge-errors-with-main-data-file">Merge Errors with Main Data File</a></li>
  <li><a href="#scrape-file-name-components" id="toc-scrape-file-name-components" class="nav-link" data-scroll-target="#scrape-file-name-components">Scrape File Name Components</a></li>
  <li><a href="#calculate-violations" id="toc-calculate-violations" class="nav-link" data-scroll-target="#calculate-violations">Calculate Violations</a></li>
  <li><a href="#create-apa-flextable-of-label-switching-errors-and-replications-needed-for-part-2" id="toc-create-apa-flextable-of-label-switching-errors-and-replications-needed-for-part-2" class="nav-link" data-scroll-target="#create-apa-flextable-of-label-switching-errors-and-replications-needed-for-part-2">Create APA Flextable of Label Switching, Errors, and Replications Needed for PART 2</a></li>
  </ul></li>
  <li><a href="#part-2-re-run-simulations" id="toc-part-2-re-run-simulations" class="nav-link" data-scroll-target="#part-2-re-run-simulations">PART 2 Re-Run Simulations</a>
  <ul class="collapse">
  <li><a href="#re-run-simulation-with-dynamic-replication-conditions" id="toc-re-run-simulation-with-dynamic-replication-conditions" class="nav-link" data-scroll-target="#re-run-simulation-with-dynamic-replication-conditions">Re-Run Simulation with Dynamic Replication Conditions</a></li>
  <li><a href="#check-for-label-switching-and-errors---part-2" id="toc-check-for-label-switching-and-errors---part-2" class="nav-link" data-scroll-target="#check-for-label-switching-and-errors---part-2">Check for Label Switching and Errors - Part 2</a></li>
  <li><a href="#merge-errors-with-main-data-file-1" id="toc-merge-errors-with-main-data-file-1" class="nav-link" data-scroll-target="#merge-errors-with-main-data-file-1">Merge Errors with Main Data File</a></li>
  </ul></li>
  <li><a href="#final-data-preparation" id="toc-final-data-preparation" class="nav-link" data-scroll-target="#final-data-preparation">Final Data Preparation</a>
  <ul class="collapse">
  <li><a href="#filter-cases-with-violations-and-errors" id="toc-filter-cases-with-violations-and-errors" class="nav-link" data-scroll-target="#filter-cases-with-violations-and-errors">Filter Cases with Violations and Errors</a></li>
  <li><a href="#calculate-monte-carlo-values-via-bootstrapping" id="toc-calculate-monte-carlo-values-via-bootstrapping" class="nav-link" data-scroll-target="#calculate-monte-carlo-values-via-bootstrapping">Calculate Monte Carlo Values via Bootstrapping</a></li>
  <li><a href="#prepare-data-for-visualization" id="toc-prepare-data-for-visualization" class="nav-link" data-scroll-target="#prepare-data-for-visualization">Prepare Data for Visualization</a>
  <ul class="collapse">
  <li><a href="#subset-data-for-bias-plots" id="toc-subset-data-for-bias-plots" class="nav-link" data-scroll-target="#subset-data-for-bias-plots">Subset Data for Bias Plots</a></li>
  <li><a href="#prepare-function-for-bias-plots" id="toc-prepare-function-for-bias-plots" class="nav-link" data-scroll-target="#prepare-function-for-bias-plots">Prepare Function for Bias Plots</a></li>
  <li><a href="#render-bias-figures" id="toc-render-bias-figures" class="nav-link" data-scroll-target="#render-bias-figures">Render Bias Figures</a></li>
  </ul></li>
  <li><a href="#prepare-data-for-heat-maps" id="toc-prepare-data-for-heat-maps" class="nav-link" data-scroll-target="#prepare-data-for-heat-maps"><strong>Prepare Data for Heat Maps</strong></a>
  <ul class="collapse">
  <li><a href="#prepare-function-for-heat-map-creation" id="toc-prepare-function-for-heat-map-creation" class="nav-link" data-scroll-target="#prepare-function-for-heat-map-creation">Prepare Function for Heat Map Creation</a></li>
  <li><a href="#render-heat-map" id="toc-render-heat-map" class="nav-link" data-scroll-target="#render-heat-map">Render Heat map</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Understanding the Performance of Random Intercepts Latent Transition Analysis (RI-LTA): A Monte Carlo Simulation Study using MplusAutomation</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Study 1.1: LTA Generated, LTA Analyzed with Two Timepoints</p>
</div>



<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Delwin Carter </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 13, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<hr>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/LVG%20FINAL.png" class="img-fluid" width="300"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/UCSB_Gauchos_logo_PNG2.png" class="img-fluid" width="300"></p>
</div>
</div>
</div>
<hr>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="study-1.1-lta-generated-lta-analyzed" class="level2">
<h2 class="anchored" data-anchor-id="study-1.1-lta-generated-lta-analyzed">Study 1.1: LTA Generated, LTA Analyzed</h2>
<hr>
<p><img src="images/LTA_LTA-01.png" class="img-fluid" width="324"></p>
<hr>
<p>Load Packages</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MplusAutomation)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tools)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(webshot2)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(officer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="simulation" class="level1">
<h1>Simulation</h1>
<hr>
<section id="part-1-conduct-simulation" class="level2">
<h2 class="anchored" data-anchor-id="part-1-conduct-simulation">Part 1: Conduct Simulation</h2>
<blockquote class="blockquote">
<p>In this section, I am conducting a simulation where I am generating data as Latent Transition Analysis and analyzing it as Latent Transition Analysis to fully explore the modelâ€™s performance. The simulation consists of 24 conditions, combining four sample sizes (N = 500, 1000, 2000, 4000) with six transition probabilities linked to logits (<em>betas;</em> 1.385, .85, .41, -.41, -.85, -1.385), corresponding to probabilities of .8, .7, .6, .4, .3, and .2. These conditions are iterated over programmatically using MplusAutomation to set up and execute the models. To speed up the process, I employ parallel processing, which distributes computations across multiple CPU cores, enabling efficient completion of the simulations across all scenarios.</p>
</blockquote>
<p>Conditions:</p>
<p>Sample Size: N = 500, 1000, 2000, 4000</p>
<p>Transition logit (Probability): TPs = 1.385 (.8), .85 (.7), .41 (.6), -.41 (.4), -.85 (.3), -1.385 (.2)</p>
<p><img src="images/clipboard-3344253592.png" class="img-fluid" width="450"></p>
<section id="setting-up-the-simulation-conditions" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-the-simulation-conditions">Setting up the Simulation Conditions&nbsp;</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">N =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">TPs =</span> <span class="fu">c</span>(<span class="fl">1.385</span>, .<span class="dv">85</span>, .<span class="dv">41</span>, <span class="sc">-</span>.<span class="dv">41</span>, <span class="sc">-</span>.<span class="dv">85</span>, <span class="sc">-</span><span class="fl">1.385</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">TH =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the matrix using gt</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Simulation Conditions Matrix"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Combinations of Sample Sizes, Transition Probabilities, and Mixtures"</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>() <span class="co"># Centers all columns</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="xgmlqhlcjy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xgmlqhlcjy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xgmlqhlcjy thead, #xgmlqhlcjy tbody, #xgmlqhlcjy tfoot, #xgmlqhlcjy tr, #xgmlqhlcjy td, #xgmlqhlcjy th {
  border-style: none;
}

#xgmlqhlcjy p {
  margin: 0;
  padding: 0;
}

#xgmlqhlcjy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xgmlqhlcjy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xgmlqhlcjy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xgmlqhlcjy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xgmlqhlcjy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xgmlqhlcjy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgmlqhlcjy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xgmlqhlcjy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xgmlqhlcjy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xgmlqhlcjy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xgmlqhlcjy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xgmlqhlcjy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xgmlqhlcjy .gt_spanner_row {
  border-bottom-style: hidden;
}

#xgmlqhlcjy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xgmlqhlcjy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xgmlqhlcjy .gt_from_md > :first-child {
  margin-top: 0;
}

#xgmlqhlcjy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xgmlqhlcjy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xgmlqhlcjy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xgmlqhlcjy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xgmlqhlcjy .gt_row_group_first td {
  border-top-width: 2px;
}

#xgmlqhlcjy .gt_row_group_first th {
  border-top-width: 2px;
}

#xgmlqhlcjy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgmlqhlcjy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xgmlqhlcjy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xgmlqhlcjy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgmlqhlcjy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgmlqhlcjy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xgmlqhlcjy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xgmlqhlcjy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xgmlqhlcjy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgmlqhlcjy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xgmlqhlcjy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgmlqhlcjy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xgmlqhlcjy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgmlqhlcjy .gt_left {
  text-align: left;
}

#xgmlqhlcjy .gt_center {
  text-align: center;
}

#xgmlqhlcjy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xgmlqhlcjy .gt_font_normal {
  font-weight: normal;
}

#xgmlqhlcjy .gt_font_bold {
  font-weight: bold;
}

#xgmlqhlcjy .gt_font_italic {
  font-style: italic;
}

#xgmlqhlcjy .gt_super {
  font-size: 65%;
}

#xgmlqhlcjy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xgmlqhlcjy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xgmlqhlcjy .gt_indent_1 {
  text-indent: 5px;
}

#xgmlqhlcjy .gt_indent_2 {
  text-indent: 10px;
}

#xgmlqhlcjy .gt_indent_3 {
  text-indent: 15px;
}

#xgmlqhlcjy .gt_indent_4 {
  text-indent: 20px;
}

#xgmlqhlcjy .gt_indent_5 {
  text-indent: 25px;
}

#xgmlqhlcjy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xgmlqhlcjy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal">Simulation Conditions Matrix</th>
</tr>
<tr class="odd gt_heading">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Combinations of Sample Sizes, Transition Probabilities, and Mixtures</th>
</tr>
<tr class="header gt_col_headings">
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">N</th>
<th id="TPs" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">TPs</th>
<th id="TH" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">TH</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="run-initial-simulation" class="level3">
<h3 class="anchored" data-anchor-id="run-initial-simulation">Run Initial Simulation</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create the cluster for parallel processing</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Detect the number of available cores (minus 1)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> <span class="st">"PSOCK"</span>)  <span class="co"># Create the PSOCK cluster</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Define the function for the simulation</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>lta_lta_func <span class="ot">&lt;-</span> <span class="cf">function</span>(N, TPs, TH) {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  LTA_LTA <span class="ot">&lt;-</span> <span class="fu">mplusObject</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE =</span> <span class="fu">glue</span>(<span class="st">"Generate LTA_LTA_N_{N}_TP_{TPs}_{TH}"</span>),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">MONTECARLO =</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"NAMES = u11-u15 u21-u25;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">      GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">      CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">      GENCLASSES = c1(2) c2(2);</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">      CLASSES = c1(2) c2(2);</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="st">      NOBSERVATIONS = {N};</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="st">      SEED = 07252005;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="st">      NREPS = 500;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">      !!SAVE = repM1*.dat;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="st">      RESULTS = LTA_LTA_N_{N}_TP_{TPs}_TH_{TH}.csv;"</span>),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANALYSIS =</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">"TYPE = MIXTURE;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="st">      processors = 24;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="st">      starts= 50 10;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="st">      logcriterion=0.00001;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="st">      mconv=0.00001;"</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">OUTPUT =</span> <span class="st">"TECH9"</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELPOPULATION =</span> <span class="fu">glue</span>(<span class="st">"    </span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="st">        %OVERALL%</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="st">       [c1#1-c2#1*0];</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="st">        c2#1 on c1#1*{TPs};</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#1%</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*{TH} u12$1*{TH} u13$1*{TH} u14$1*{TH} u15$1*{TH}] (p111-p115);</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#2%</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*-{TH} u12$1*-{TH} u13$1*-{TH} u14$1*-{TH} u15$1*-{TH}] (p121-p125);</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#1%</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*{TH} u22$1*{TH} u23$1*{TH} u24$1*{TH} u25$1*{TH}] (p111-p115);</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#2%</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*-{TH} u22$1*-{TH} u23$1*-{TH} u24$1*-{TH} u25$1*-{TH}] (p121-p125);</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="st">       "</span>),</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODEL =</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"    </span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="st">        %OVERALL%</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="st">          [c1#1-c2#1*0](par1-par2);</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="st">            c2#1 on c1#1*{TPs} (par11);</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="st">     MODEL c1:</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#1%</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*{TH} u12$1*{TH} u13$1*{TH} u14$1*{TH} u15$1*{TH}] (p111-p115);</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#2%</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*-{TH} u12$1*-{TH} u13$1*-{TH} u14$1*-{TH} u15$1*-{TH}] (p121-p125);</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="st">    MODEL c2:   </span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#1%</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*{TH} u22$1*{TH} u23$1*{TH} u24$1*{TH} u25$1*{TH}] (p111-p115);</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#2%</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*-{TH} u22$1*-{TH} u23$1*-{TH} u24$1*-{TH} u25$1*-{TH}] (p121-p125);</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="st">          "</span>),</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELCONSTRAINT =</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="fl">1.385</span>) {</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.80 trans12*.20 trans21*.5 trans22*.5</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.65 prob22*.35);</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>             <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">85</span>) {</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.70 trans12*.30 trans21*.5 trans22*.5</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.60 prob22*.4);</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>  <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">41</span>) {</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.60 trans12*.40 trans21*.5 trans22*.5</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.55 prob22*.45);</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>             <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span>.<span class="dv">41</span>) {</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.40 trans12*.60 trans21*.5 trans22*.5</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.45 prob22*.55);</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>             <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span>.<span class="dv">85</span>) {</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.30 trans12*.70 trans21*.5 trans22*.5</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.40 prob22*.60);</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span><span class="fl">1.385</span>) {</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a><span class="st">         New(</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.20 trans12*.80 trans21*.5 trans22*.5</span></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.35 prob22*.65);</span></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;"</span>)</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run Mplus model</span></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>  LTA_LTA_Model <span class="ot">&lt;-</span> <span class="fu">mplusModeler</span>(LTA_LTA, </span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">dataout =</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>,<span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"1_2T_LTA_GEN_LTA_ANALYZED"</span>, <span class="fu">glue</span>(<span class="st">"LTA_LTA_N_{N}_TP_{TPs}_TH_{TH}.dat"</span>)),</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">modelout =</span> <span class="fu">glue</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"1_2T_LTA_GEN_LTA_ANALYZED"</span>, <span class="st">"LTA_LTA_N_{N}_TP_{TPs}_TH_{TH}.inp"</span>)),</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">check =</span> <span class="cn">TRUE</span>, <span class="at">run =</span> <span class="cn">TRUE</span>, <span class="at">hashfilename =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LTA_LTA_Model)</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Export necessary objects to the cluster</span></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"lta_lta_func"</span>, <span class="st">"p1"</span>, <span class="st">"here"</span>, <span class="st">"glue"</span>, <span class="st">"mplusModeler"</span>, <span class="st">"mplusObject"</span>))</span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure necessary libraries are loaded on each cluster node</span></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MplusAutomation)</span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Run the simulation in parallel using the cluster</span></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>result_list <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p1), <span class="cf">function</span>(i) {</span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lta_lta_func</span>(p1<span class="sc">$</span>N[i], p1<span class="sc">$</span>TPs[i], p1<span class="sc">$</span>TH[i])</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Stop the cluster after the simulation</span></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
</section>
</section>
<section id="data-processing-and-verification" class="level1">
<h1>Data Processing and Verification</h1>
<hr>
<section id="check-for-label-switching-and-errors" class="level2">
<h2 class="anchored" data-anchor-id="check-for-label-switching-and-errors">Check for Label Switching and Errors</h2>
<blockquote class="blockquote">
<p>In this section: .csv files are first merged into a single data frame, from which specific parameters are extracted. Logit values are then converted to probabilities, and known class values are incorporated into the data frame. A subset of cases involving label switching is selected randomly and plotted for visual review. Output files are scanned for errors, which are subsequently merged back into the original data file. Additional columns derived from the file name are added, and the percentage of violations is calculated. Both errors and label switching violations are visually represented, and the total number of corrected replications is reported.</p>
</blockquote>
<section id="scrape-mplus-csv-files" class="level3">
<h3 class="anchored" data-anchor-id="scrape-mplus-csv-files">Scrape Mplus CSV Files</h3>
<p><em>First, Load all CSV files and combine them into a single data frame.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct CSV directory</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>csv_directory <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'1_2T_LTA_GEN_LTA_ANALYZED'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'data_scraping.R'</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate combined_data dataframe in the global environment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="slice-data-extract-parameters" class="level3">
<h3 class="anchored" data-anchor-id="slice-data-extract-parameters">Slice Data / Extract Parameters</h3>
<p><em>Extract data from the appropriate rows from each 9-row chunk and prepare the data for further processing.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the data using the child script</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step2_2t_LTA.R'</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>final_combined_data <span class="ot">&lt;-</span> final_combined_data <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">TRANS11 =</span> <span class="fu">as.numeric</span>(TRANS11),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_11 =</span> <span class="fu">as.numeric</span>(SE_11),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Ec"</span>), as.numeric),  <span class="co"># Convert all Ec columns</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_csv =</span> <span class="fu">as.numeric</span>(ll_csv)  <span class="co"># Convert Log-Likelihood values</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wrangle-data" class="level3">
<h3 class="anchored" data-anchor-id="wrangle-data">Wrangle Data</h3>
<p><em>Convert the logits to probabilities and add the known actual values to each row.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3 and 4: Process the data and return results</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step_3.R'</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The objects `final_data_with_actuals` and `violators` should now be in the global environment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="generate-plots-of-label-switching" class="level3">
<h3 class="anchored" data-anchor-id="generate-plots-of-label-switching">Generate Plots of Label Switching</h3>
<p><em>Generate plots of randomly sampled violators for visual inspection using parallel processing.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot width and height</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plot_width <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plot_height <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a random sample of up to 250 violators (ensure not to exceed the total number of violators)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">nrow</span>(violators), <span class="dv">250</span>)  <span class="co"># Handle cases where fewer than 250 violators exist</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>sampled_violators <span class="ot">&lt;-</span> violators[<span class="fu">sample</span>(<span class="fu">nrow</span>(violators), sample_size), ]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to create plots sequentially</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plot_violator <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  row_data <span class="ot">&lt;-</span> sampled_violators[i, ]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the file name from the current row</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  file_name <span class="ot">&lt;-</span> row_data<span class="sc">$</span>FileName</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract probability values for EC1 and EC2 (estimated probabilities) and AC1 and AC2 (actuals)</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  estimated_probabilities <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ec1u1"</span>, <span class="st">"Ec1u2"</span>, <span class="st">"Ec1u3"</span>, <span class="st">"Ec1u4"</span>, <span class="st">"Ec1u5"</span>)]),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ec2u1"</span>, <span class="st">"Ec2u2"</span>, <span class="st">"Ec2u3"</span>, <span class="st">"Ec2u4"</span>, <span class="st">"Ec2u5"</span>)])</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  actual_values <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ac1u1"</span>, <span class="st">"Ac1u2"</span>, <span class="st">"Ac1u3"</span>, <span class="st">"Ac1u4"</span>, <span class="st">"Ac1u5"</span>)]),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ac2u1"</span>, <span class="st">"Ac2u2"</span>, <span class="st">"Ac2u3"</span>, <span class="st">"Ac2u4"</span>, <span class="st">"Ac2u5"</span>)])</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create labels for the legend with actual values directly from the dataset</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"EC1: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"EC2: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"AC1: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"AC2: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u5, <span class="dv">3</span>), <span class="st">")"</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 6: Create a data frame for plotting</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Items =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">4</span>),</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">Probabilities =</span> <span class="fu">c</span>(estimated_probabilities, actual_values),</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Class =</span> <span class="fu">rep</span>(labels, <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 7: Create the plot with the file name in the title</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Items, <span class="at">y =</span> Probabilities, <span class="at">color =</span> Class, <span class="at">group =</span> Class)) <span class="sc">+</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> file_name, <span class="at">x =</span> <span class="st">"Items"</span>, <span class="at">y =</span> <span class="st">"Probabilities"</span>) <span class="sc">+</span>  <span class="co"># Only the file name in the title</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span>  <span class="co"># Adjust title size and center</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>      <span class="st">"darkblue"</span>, <span class="st">"darkgreen"</span>,  <span class="co"># EC1 and EC2 (Estimated Probabilities)</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>      <span class="st">"lightblue"</span>, <span class="st">"lightgreen"</span>  <span class="co"># AC1 and AC2 (Actual Values)</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zViolator_Plots"</span>, <span class="st">"z2t_lta_lta_violator_plots"</span>, <span class="fu">paste0</span>(<span class="st">"violator_plot_"</span>, i, <span class="st">"_"</span>, file_name, <span class="st">".png"</span>))),</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot =</span> p, <span class="at">width =</span> plot_width, <span class="at">height =</span> plot_height)</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to generate plots sequentially (without parallelization)</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>sample_size, plot_violator))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>PLot Non-Violators and inspect for False NEGATIVES</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a random sample of up to 250 non-violators</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>non_violators <span class="ot">&lt;-</span> <span class="fu">filter</span>(final_data_with_actuals, Any_Violation <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>sample_size_non_violators <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">nrow</span>(non_violators), <span class="dv">250</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>sampled_non_violators <span class="ot">&lt;-</span> non_violators[<span class="fu">sample</span>(<span class="fu">nrow</span>(non_violators), sample_size_non_violators), ]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function for non-violator plots</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>plot_non_violator <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  row_data <span class="ot">&lt;-</span> sampled_non_violators[i, ]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  file_name <span class="ot">&lt;-</span> row_data<span class="sc">$</span>FileName</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  estimated_probabilities <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ec1u1"</span>, <span class="st">"Ec1u2"</span>, <span class="st">"Ec1u3"</span>, <span class="st">"Ec1u4"</span>, <span class="st">"Ec1u5"</span>)]),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ec2u1"</span>, <span class="st">"Ec2u2"</span>, <span class="st">"Ec2u3"</span>, <span class="st">"Ec2u4"</span>, <span class="st">"Ec2u5"</span>)])</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  actual_values <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ac1u1"</span>, <span class="st">"Ac1u2"</span>, <span class="st">"Ac1u3"</span>, <span class="st">"Ac1u4"</span>, <span class="st">"Ac1u5"</span>)]),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ac2u1"</span>, <span class="st">"Ac2u2"</span>, <span class="st">"Ac2u3"</span>, <span class="st">"Ac2u4"</span>, <span class="st">"Ac2u5"</span>)])</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"EC1: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"EC2: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"AC1: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"AC2: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u5, <span class="dv">3</span>), <span class="st">")"</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Items =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">4</span>),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Probabilities =</span> <span class="fu">c</span>(estimated_probabilities, actual_values),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Class =</span> <span class="fu">rep</span>(labels, <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Items, <span class="at">y =</span> Probabilities, <span class="at">color =</span> Class, <span class="at">group =</span> Class)) <span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(file_name, <span class="st">" (Non-Violator)"</span>), <span class="at">x =</span> <span class="st">"Items"</span>, <span class="at">y =</span> <span class="st">"Probabilities"</span>) <span class="sc">+</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">"darkblue"</span>, <span class="st">"darkgreen"</span>,  <span class="co"># EC1 and EC2 (Estimated Probabilities)</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">"lightblue"</span>, <span class="st">"lightgreen"</span>  <span class="co"># AC1 and AC2 (Actual Values)</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zViolator_Plots"</span>, <span class="st">"z2t_lta_lta_non_violator_plots"</span>, <span class="fu">paste0</span>(<span class="st">"non_violator_plot_"</span>, i, <span class="st">"_"</span>, file_name, <span class="st">".png"</span>))),</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot =</span> p, <span class="at">width =</span> plot_width, <span class="at">height =</span> plot_height)</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply function to generate non-violator plots</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>sample_size_non_violators, plot_non_violator))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
</section>
<section id="error-handling" class="level1">
<h1>Error Handling</h1>
<hr>
<section id="scrape-for-errors" class="level3">
<h3 class="anchored" data-anchor-id="scrape-for-errors">Scrape for Errors</h3>
<p><em>Scrape output files for errors</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct output directory for .out files</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>output_folder <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'1_2T_LTA_GEN_LTA_ANALYZED'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document that processes .out files</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'out_scraping.R'</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  âœ… SECTION 1 Generate Replication Summary Table</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>replication_summary_table <span class="ot">&lt;-</span> replication_summary <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Replication Summary"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Folder: "</span>, output_folder)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Total"</span>, <span class="st">"Replicated_Yes"</span>, <span class="st">"Replicated_No"</span>, <span class="st">"Error_Count"</span>),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">FileName =</span> <span class="st">"File Name"</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="st">"Total Replications"</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replicated_Yes =</span> <span class="st">"LL Replicated"</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replicated_No =</span> <span class="st">"LL Not Replicated"</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Error_Count =</span> <span class="st">"Errors"</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">80</span>)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>replication_summary_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="zxhaemwtcl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zxhaemwtcl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zxhaemwtcl thead, #zxhaemwtcl tbody, #zxhaemwtcl tfoot, #zxhaemwtcl tr, #zxhaemwtcl td, #zxhaemwtcl th {
  border-style: none;
}

#zxhaemwtcl p {
  margin: 0;
  padding: 0;
}

#zxhaemwtcl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 80%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zxhaemwtcl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zxhaemwtcl .gt_title {
  color: #333333;
  font-size: medium;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zxhaemwtcl .gt_subtitle {
  color: #333333;
  font-size: small;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zxhaemwtcl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zxhaemwtcl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zxhaemwtcl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zxhaemwtcl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zxhaemwtcl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zxhaemwtcl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zxhaemwtcl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zxhaemwtcl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zxhaemwtcl .gt_spanner_row {
  border-bottom-style: hidden;
}

#zxhaemwtcl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zxhaemwtcl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zxhaemwtcl .gt_from_md > :first-child {
  margin-top: 0;
}

#zxhaemwtcl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zxhaemwtcl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zxhaemwtcl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zxhaemwtcl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zxhaemwtcl .gt_row_group_first td {
  border-top-width: 2px;
}

#zxhaemwtcl .gt_row_group_first th {
  border-top-width: 2px;
}

#zxhaemwtcl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zxhaemwtcl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zxhaemwtcl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zxhaemwtcl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zxhaemwtcl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zxhaemwtcl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zxhaemwtcl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zxhaemwtcl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zxhaemwtcl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zxhaemwtcl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zxhaemwtcl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zxhaemwtcl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zxhaemwtcl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zxhaemwtcl .gt_left {
  text-align: left;
}

#zxhaemwtcl .gt_center {
  text-align: center;
}

#zxhaemwtcl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zxhaemwtcl .gt_font_normal {
  font-weight: normal;
}

#zxhaemwtcl .gt_font_bold {
  font-weight: bold;
}

#zxhaemwtcl .gt_font_italic {
  font-style: italic;
}

#zxhaemwtcl .gt_super {
  font-size: 65%;
}

#zxhaemwtcl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zxhaemwtcl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zxhaemwtcl .gt_indent_1 {
  text-indent: 5px;
}

#zxhaemwtcl .gt_indent_2 {
  text-indent: 10px;
}

#zxhaemwtcl .gt_indent_3 {
  text-indent: 15px;
}

#zxhaemwtcl .gt_indent_4 {
  text-indent: 20px;
}

#zxhaemwtcl .gt_indent_5 {
  text-indent: 25px;
}

#zxhaemwtcl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zxhaemwtcl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="5" class="gt_heading gt_title gt_font_normal">Replication Summary</th>
</tr>
<tr class="odd gt_heading">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Folder: /Users/brucecarter/Library/CloudStorage/Box-Box/RILTAS/RILTA_SIMULATION_STUDY/Simulations/STUDY_1/2 Time Points/1_2T_LTA_GEN_LTA_ANALYZED</th>
</tr>
<tr class="header gt_col_headings">
<th id="FileName" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">File Name</th>
<th id="Total" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Total Replications</th>
<th id="Replicated_Yes" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">LL Replicated</th>
<th id="Replicated_No" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">LL Not Replicated</th>
<th id="Error_Count" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Errors</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_-0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_-0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_-1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_-0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_-0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_-1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_-0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_-0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_-1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_-0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_-0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_-1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">500</td>
<td class="gt_row gt_center" headers="Replicated_Yes">500</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  âœ… SECTION 2 Row Count Validation</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_data_with_actuals:"</span>, <span class="fu">nrow</span>(final_data_with_actuals), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows in final_data_with_actuals: 12000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_results:"</span>, <span class="fu">nrow</span>(final_results), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows in final_results: 12000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in replication_summary:"</span>, <span class="fu">nrow</span>(replication_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows in replication_summary: 24 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="cf">if</span> (<span class="fu">any</span>(replication_summary<span class="sc">$</span>LL_Not_Replicated <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"âš ï¸ WARNING: Some LL values were NOT replicated! Check the Replication Summary table."</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"âœ… All LL values were successfully replicated."</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "âœ… All LL values were successfully replicated."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(final_data_with_actuals<span class="sc">$</span>ll_csv, final_results<span class="sc">$</span>ll_out, <span class="at">tolerance =</span> <span class="fl">1e-4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="merge-errors-with-main-data-file" class="level3">
<h3 class="anchored" data-anchor-id="merge-errors-with-main-data-file">Merge Errors with Main Data File</h3>
<p><em>Combine error information with main data file</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    final_results <span class="sc">%&gt;%</span> <span class="fu">select</span>(FileName, Replication, ll_out, LL_Replicated, ErrorFlag), </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"FileName"</span>, <span class="st">"Replication"</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Any_Violation =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Any_Violation), <span class="dv">0</span>, Any_Violation),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorFlag =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(ErrorFlag), <span class="dv">0</span>, ErrorFlag),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">LL_Replicated =</span> <span class="fu">ifelse</span>(LL_Replicated <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),  <span class="co"># âœ… Convert Yes/No to 1/0</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ðŸ”¹ Create a new True Violation column</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">True_Violation =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>      Any_Violation <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> ErrorFlag <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> LL_Replicated <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># âœ… At least one violation</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualize differences between ll_out and ll_csv</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ll_check <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">round</span>(ll_out <span class="sc">-</span> ll_csv, <span class="dv">3</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Round before counting</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(diff)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>ll_check_table <span class="ot">&lt;-</span> ll_check <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"LL Difference Summary"</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Comparison of LL values between CSV and OUT files"</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff =</span> <span class="st">"LL Difference"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="st">"Count"</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> diff,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">50</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>ll_check_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="stiqghzuza" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#stiqghzuza table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#stiqghzuza thead, #stiqghzuza tbody, #stiqghzuza tfoot, #stiqghzuza tr, #stiqghzuza td, #stiqghzuza th {
  border-style: none;
}

#stiqghzuza p {
  margin: 0;
  padding: 0;
}

#stiqghzuza .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 50%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#stiqghzuza .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#stiqghzuza .gt_title {
  color: #333333;
  font-size: medium;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#stiqghzuza .gt_subtitle {
  color: #333333;
  font-size: small;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#stiqghzuza .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#stiqghzuza .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stiqghzuza .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#stiqghzuza .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#stiqghzuza .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#stiqghzuza .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#stiqghzuza .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#stiqghzuza .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#stiqghzuza .gt_spanner_row {
  border-bottom-style: hidden;
}

#stiqghzuza .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#stiqghzuza .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#stiqghzuza .gt_from_md > :first-child {
  margin-top: 0;
}

#stiqghzuza .gt_from_md > :last-child {
  margin-bottom: 0;
}

#stiqghzuza .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#stiqghzuza .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#stiqghzuza .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#stiqghzuza .gt_row_group_first td {
  border-top-width: 2px;
}

#stiqghzuza .gt_row_group_first th {
  border-top-width: 2px;
}

#stiqghzuza .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#stiqghzuza .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#stiqghzuza .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#stiqghzuza .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stiqghzuza .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#stiqghzuza .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#stiqghzuza .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#stiqghzuza .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#stiqghzuza .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stiqghzuza .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#stiqghzuza .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#stiqghzuza .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#stiqghzuza .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#stiqghzuza .gt_left {
  text-align: left;
}

#stiqghzuza .gt_center {
  text-align: center;
}

#stiqghzuza .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#stiqghzuza .gt_font_normal {
  font-weight: normal;
}

#stiqghzuza .gt_font_bold {
  font-weight: bold;
}

#stiqghzuza .gt_font_italic {
  font-style: italic;
}

#stiqghzuza .gt_super {
  font-size: 65%;
}

#stiqghzuza .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#stiqghzuza .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#stiqghzuza .gt_indent_1 {
  text-indent: 5px;
}

#stiqghzuza .gt_indent_2 {
  text-indent: 10px;
}

#stiqghzuza .gt_indent_3 {
  text-indent: 15px;
}

#stiqghzuza .gt_indent_4 {
  text-indent: 20px;
}

#stiqghzuza .gt_indent_5 {
  text-indent: 25px;
}

#stiqghzuza .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#stiqghzuza div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="2" class="gt_heading gt_title gt_font_normal">LL Difference Summary</th>
</tr>
<tr class="odd gt_heading">
<th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Comparison of LL values between CSV and OUT files</th>
</tr>
<tr class="header gt_col_headings">
<th id="diff" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">LL Difference</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Count</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="diff">âˆ’0.001</td>
<td class="gt_row gt_center" headers="n">140</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="diff">0.000</td>
<td class="gt_row gt_center" headers="n">11710</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="diff">0.001</td>
<td class="gt_row gt_center" headers="n">150</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Create DF of LL differences from .out and .csv files for inspection at the replication level</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe with only rows where ll_out and ll_csv differ</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ll_mismatch <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">round</span>(ll_out <span class="sc">-</span> ll_csv, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(diff <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FileName, Replication, ll_out, ll_csv, diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scrape-file-name-components" class="level3">
<h3 class="anchored" data-anchor-id="scrape-file-name-components">Scrape File Name Components</h3>
<p><em>Create Column Names from the file name</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns based on the information in the FileName and set factors</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the sample size (N) from the FileName with the correct values</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_4000"</span>, FileName) <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_500"</span>, FileName) <span class="sc">~</span> <span class="dv">1</span>,   </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_1000"</span>, FileName) <span class="sc">~</span> <span class="dv">2</span>,  </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_2000"</span>, FileName) <span class="sc">~</span> <span class="dv">3</span>,  </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map the TPs from the FileName to the appropriate Population labels</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".800"</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".700"</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".600"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".400"</span>, </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".300"</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".200"</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the Transitions variable based on Population values</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>) <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># Assign 1</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>) <span class="sc">~</span> <span class="dv">2</span>,  <span class="co"># Assign 2 </span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert columns to factors, ordering N_4000 first in the factor levels</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"N = 4000"</span>, <span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>)),</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".800"</span>, <span class="st">".700"</span>, <span class="st">".600"</span>, <span class="st">".400"</span>, <span class="st">".300"</span>, <span class="st">".200"</span>)),</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">factor</span>(Transitions, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mover"</span>, <span class="st">"Stayer"</span>))</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculate-violations" class="level3">
<h3 class="anchored" data-anchor-id="calculate-violations">Calculate Violations</h3>
<p><em>Calculate Violation Percentages per Condition</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, <span class="fu">as.character</span>(N))),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(N_numeric), <span class="dv">0</span>, N_numeric)  </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName, Population, N, N_numeric) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> <span class="fu">n</span>(),                                </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Violations =</span> <span class="fu">sum</span>(Any_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),   </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Errors =</span> <span class="fu">sum</span>(ErrorFlag, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),           </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_LL_Failures =</span> <span class="fu">sum</span>(LL_Replicated <span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_True_Violations =</span> <span class="fu">sum</span>(True_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage_Violations =</span> <span class="fu">round</span>((Total_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">True_Violation_Perc =</span> <span class="fu">round</span>((Total_True_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> <span class="fu">round</span>((Total_Errors <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">LL_Failure_Perc =</span> <span class="fu">round</span>((Total_LL_Failures <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Additional_Runs =</span> (<span class="dv">500</span> <span class="sc">+</span> Total_Violations) <span class="sc">*</span> (Percentage_Violations <span class="sc">/</span> <span class="dv">100</span>), </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replications_Needed =</span> <span class="fu">ceiling</span>(<span class="dv">500</span> <span class="sc">+</span> Total_Violations <span class="sc">+</span> Additional_Runs <span class="sc">+</span> <span class="dv">20</span>),</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replications_Needed =</span> <span class="fu">if_else</span>(Replications_Needed <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="dv">500</span>, Replications_Needed),</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adjusted_Replications_Needed =</span> <span class="fu">ceiling</span>(Replications_Needed <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> ErrorRate <span class="sc">/</span> <span class="dv">100</span>)), <span class="co">#+ 100,</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adjusted_Replications_Needed =</span> <span class="fu">if_else</span>(Adjusted_Replications_Needed <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="dv">500</span>, Adjusted_Replications_Needed),</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">TPs =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">~</span> <span class="fl">1.385</span>,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".700"</span> <span class="sc">~</span> <span class="fl">0.85</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".600"</span> <span class="sc">~</span> <span class="fl">0.41</span>,</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".400"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.41</span>,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".300"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.85</span>,</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">1.385</span>,</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">factor</span>(N_numeric, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>)), <span class="fu">as.numeric</span>(Population)) <span class="sc">%&gt;%</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>, <span class="st">"N = 4000"</span>)),  </span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>, <span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>))  </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>    N, N_numeric, Population, TPs,   </span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>    Total_Rows,  </span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>    Total_Violations, Percentage_Violations,  </span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>    Total_Errors, ErrorRate,  </span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>    Total_LL_Failures, LL_Failure_Perc,  </span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>    Total_True_Violations, True_Violation_Perc,  </span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>    Replications_Needed, Adjusted_Replications_Needed  </span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(N_numeric, Population) <span class="sc">%&gt;%</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_numeric =</span> <span class="fu">trimws</span>(<span class="fu">as.numeric</span>(N_numeric)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-apa-flextable-of-label-switching-errors-and-replications-needed-for-part-2" class="level3">
<h3 class="anchored" data-anchor-id="create-apa-flextable-of-label-switching-errors-and-replications-needed-for-part-2">Create APA Flextable of Label Switching, Errors, and Replications Needed for PART 2</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>create_flextable <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure only the required columns are used</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>      N_numeric,  </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>      Population,  </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>      Total_Violations,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>      Percentage_Violations,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>      Total_Errors,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>      ErrorRate,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>      Total_LL_Failures,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>      LL_Failure_Perc,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>      Total_True_Violations,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>      True_Violation_Perc,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>      Replications_Needed,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>      Adjusted_Replications_Needed</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()  <span class="co"># Ensures proper structure before passing to flextable</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the flextable</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_header_labels</span>(</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_numeric =</span> <span class="st">"N"</span>,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Population =</span> <span class="st">"Tâ‚â‚"</span>,  <span class="co"># Column remains "Population"</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Violations =</span> <span class="st">"V"</span>,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">Percentage_Violations =</span> <span class="st">"V %"</span>,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Errors =</span> <span class="st">"\u03B5"</span>,  <span class="co"># Epsilon</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">ErrorRate =</span> <span class="st">"\u03B5 %"</span>,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_LL_Failures =</span> <span class="st">"\u2112\u2097"</span>,  <span class="co"># â„’â‚—</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">LL_Failure_Perc =</span> <span class="st">"\u2112\u2097 %"</span>,  <span class="co"># â„’â‚—%</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_True_Violations =</span> <span class="st">"\u03C4\u1D65"</span>,  <span class="co"># Tau subscript v (ðœáµ¥)</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">True_Violation_Perc =</span> <span class="st">"\u03C4\u1D65 %"</span>,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">Replications_Needed =</span> <span class="st">"Reps Reqâ€™d"</span>,</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">Adjusted_Replications_Needed =</span> <span class="st">"\u2206 Reps Reqâ€™d"</span>  <span class="co"># Delta Symbol</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply special formatting to headers</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"N"</span>)))</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"T"</span>), <span class="fu">as_sub</span>(<span class="st">"11"</span>)))</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ðŸ”¹ Label Switching Violations</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>)))</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Percentage_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>), <span class="st">"%"</span>))</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ðŸ”¹ Mplus Errors</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_Errors"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>)))  </span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"ErrorRate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>), <span class="st">"%"</span>))</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ðŸ”¹ NEW: LL Replication Failures (â„’â‚—)</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_LL_Failures"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u2112"</span>), <span class="fu">as_sub</span>(<span class="st">"â‚—"</span>)))</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"LL_Failure_Perc"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u2112"</span>), <span class="fu">as_sub</span>(<span class="st">"â‚—"</span>), <span class="st">"%"</span>))</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ”¹ True Violations (ðœáµ¥)</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_True_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="fu">as_i</span>(<span class="st">"v"</span>))))  </span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"True_Violation_Perc"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="fu">as_i</span>(<span class="st">"v"</span>)), <span class="st">"%"</span>))  </span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ðŸ”¹ Replication Counts</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Replications_Needed"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"Reps"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Req'd"</span>))</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Adjusted_Replications_Needed"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u2206"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as_i</span>(<span class="st">"Reps"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Req'd"</span>))</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply width settings</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">width =</span> <span class="fl">1.0</span>)</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)  </span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Percentage_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_Errors"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"ErrorRate"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_LL_Failures"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"LL_Failure_Perc"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_True_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"True_Violation_Perc"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Replications_Needed"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Adjusted_Replications_Needed"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">colformat_num</span>(</span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>  ft,</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">j =</span> <span class="fu">c</span>(<span class="st">"Percentage_Violations"</span>, <span class="st">"ErrorRate"</span>, <span class="st">"LL_Failure_Perc"</span>, <span class="st">"True_Violation_Perc"</span> ),  </span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="st">"%"</span>  <span class="co"># âœ… Adds percentage symbol</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add padding below the subheaders</span></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a><span class="co">#ft &lt;- ft %&gt;%</span></span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a> <span class="co"># padding(part = "header", padding = c(0, 0, 6, 0))  # Adjust as needed for top, right, bottom, and left padding</span></span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enable autofit</span></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">set_table_properties</span>(ft, <span class="at">layout =</span> <span class="st">"fixed"</span>)</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Center all cells</span></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">align</span>(ft, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Align header text at the bottom of the cells</span></span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ft &lt;- valign(ft, part = "header", valign = "bottom")</span></span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Merge vertically identical rows in the "N_numeric" column</span></span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">merge_v</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>)</span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply font to the entire table</span></span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">font</span>(ft, <span class="at">fontname =</span> <span class="st">"Avenir Next LT Pro"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(</span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">part =</span> <span class="st">"body"</span>,</span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">j =</span> <span class="st">"N_numeric"</span>,</span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="sc">~</span> <span class="sc">!</span><span class="fu">duplicated</span>(N_numeric),</span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as_paragraph</span>(</span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_i</span>(<span class="st">"N"</span>),  </span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>      <span class="st">" =\u2009"</span>,  <span class="co"># THIN SPACE (Unicode U+2009)</span></span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.character</span>(<span class="fu">format</span>(N_numeric, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>))  <span class="co"># Keeps proper formatting</span></span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add subheader row</span></span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">add_header_row</span>(</span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"N Reps = 500"</span>, <span class="st">"Violations"</span>, <span class="st">"Errors"</span>, <span class="st">"LL Replication"</span>, <span class="st">"True Violations"</span>, <span class="st">"Adjustments"</span>),  </span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)  </span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define a transparent border</span></span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a>  no_border <span class="ot">&lt;-</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">width =</span> <span class="dv">0</span>)</span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Remove ONLY the bottom border under the first three columns (the blank subheader)**</span></span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">hline</span>(ft, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">border =</span> no_border, <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding color with a correct method</span></span>
<span id="cb25-127"><a href="#cb25-127" aria-hidden="true" tabindex="-1"></a>  total_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)  <span class="co"># Get the total number of rows in your data</span></span>
<span id="cb25-128"><a href="#cb25-128" aria-hidden="true" tabindex="-1"></a>  color_rows <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>, total_rows)  <span class="co"># Initialize a logical vector for coloring rows</span></span>
<span id="cb25-129"><a href="#cb25-129" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, total_rows, <span class="at">by =</span> <span class="dv">12</span>)) {</span>
<span id="cb25-130"><a href="#cb25-130" aria-hidden="true" tabindex="-1"></a>    color_rows[i<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Apply color to every 6 rows</span></span>
<span id="cb25-131"><a href="#cb25-131" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-132"><a href="#cb25-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-133"><a href="#cb25-133" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply background color with a lighter shade of gray</span></span>
<span id="cb25-134"><a href="#cb25-134" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">bg</span>(ft, <span class="at">i =</span> color_rows, <span class="at">bg =</span> <span class="st">"#f0f0f0"</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb25-135"><a href="#cb25-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-136"><a href="#cb25-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ft)</span>
<span id="cb25-137"><a href="#cb25-137" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-138"><a href="#cb25-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-139"><a href="#cb25-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-140"><a href="#cb25-140" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate formatted flextables for each subset</span></span>
<span id="cb25-141"><a href="#cb25-141" aria-hidden="true" tabindex="-1"></a>violation_summary_table <span class="ot">&lt;-</span> <span class="fu">create_flextable</span>(violation_summary)</span>
<span id="cb25-142"><a href="#cb25-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-143"><a href="#cb25-143" aria-hidden="true" tabindex="-1"></a>violation_summary_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-00d71c18{}.cl-00cc6688{font-family:'Avenir Next LT Pro';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-00cc66a6{font-family:'Avenir Next LT Pro';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-00cc66a7{font-family:'Avenir Next LT Pro';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;top:3.3pt;}.cl-00cc66b0{font-family:'Avenir Next LT Pro';font-size:6.6pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;top:3.3pt;}.cl-00cfe7a4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-00d0087e{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d00892{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d0089c{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d0089d{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d008a6{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d008b0{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d008ba{width:1in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d008c4{width:0.6in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d008c5{width:0.5in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d008ce{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d008d8{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d008e2{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d008e3{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d008ec{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-00d00900{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-00d71c18"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-00d0087e"><p class="cl-00cfe7a4"><span class="cl-00cc6688">N Reps = 500</span></p></th><th colspan="2" class="cl-00d0089c"><p class="cl-00cfe7a4"><span class="cl-00cc6688">Violations</span></p></th><th colspan="2" class="cl-00d0089d"><p class="cl-00cfe7a4"><span class="cl-00cc6688">Errors</span></p></th><th colspan="2" class="cl-00d0089d"><p class="cl-00cfe7a4"><span class="cl-00cc6688">LL Replication</span></p></th><th colspan="2" class="cl-00d0089c"><p class="cl-00cfe7a4"><span class="cl-00cc6688">True Violations</span></p></th><th colspan="2" class="cl-00d0089c"><p class="cl-00cfe7a4"><span class="cl-00cc6688">Adjustments</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-00d008a6"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">N</span></p></th><th class="cl-00d008b0"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">T</span><span class="cl-00cc66a7">11</span></p></th><th class="cl-00d0089c"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">V</span></p></th><th class="cl-00d0089c"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">V</span><span class="cl-00cc6688">%</span></p></th><th class="cl-00d0089d"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">Îµ</span></p></th><th class="cl-00d0089d"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">Îµ</span><span class="cl-00cc6688">%</span></p></th><th class="cl-00d0089d"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">â„’</span><span class="cl-00cc66a7">â‚—</span></p></th><th class="cl-00d0089d"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">â„’</span><span class="cl-00cc66a7">â‚—</span><span class="cl-00cc6688">%</span></p></th><th class="cl-00d0089c"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">Ï„</span><span class="cl-00cc66b0">v</span></p></th><th class="cl-00d0089c"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">Ï„</span><span class="cl-00cc66b0">v</span><span class="cl-00cc6688">%</span></p></th><th class="cl-00d0089c"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">Reps</span><br><span class="cl-00cc6688">Req'd</span></p></th><th class="cl-00d0089c"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">âˆ†</span><br><span class="cl-00cc66a6">Reps</span><br><span class="cl-00cc6688">Req'd</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-00d008ba"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">N</span><span class="cl-00cc6688"> =â€‰</span><span class="cl-00cc6688">500 </span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.200</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">133</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">26.6%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">133</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">26.6%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">822</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">822</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.300</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">119</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">23.8%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">119</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">23.8%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">787</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">787</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.400</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">110</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">22.0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">110</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">22.0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">765</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">765</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.600</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">128</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">25.6%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">128</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">25.6%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">809</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">809</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.700</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">109</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">21.8%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">109</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">21.8%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">762</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">762</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.800</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">84</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">16.8%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">84</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">16.8%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">703</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">703</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-00d008ce"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">N</span><span class="cl-00cc6688"> =â€‰</span><span class="cl-00cc6688">1000</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.200</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">125</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">25.0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">125</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">25.0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">802</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">802</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.300</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">112</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">22.4%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">112</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">22.4%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">770</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">770</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.400</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">112</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">22.4%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">112</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">22.4%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">770</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">770</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.600</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">128</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">25.6%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">128</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">25.6%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">809</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">809</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.700</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">98</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">19.6%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">98</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">19.6%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">736</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">736</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.800</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">84</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">16.8%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">84</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">16.8%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">703</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">703</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-00d008ba"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">N</span><span class="cl-00cc6688"> =â€‰</span><span class="cl-00cc6688">2000</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.200</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">146</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">29.2%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">146</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">29.2%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">855</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">855</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.300</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">96</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">19.2%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">96</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">19.2%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">731</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">731</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.400</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">92</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">18.4%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">92</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">18.4%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">721</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">721</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.600</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">108</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">21.6%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">108</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">21.6%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">760</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">760</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.700</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">110</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">22.0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">110</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">22.0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">765</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">765</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.800</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">74</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">14.8%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008c5"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">74</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">14.8%</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">679</span></p></td><td class="cl-00d008c4"><p class="cl-00cfe7a4"><span class="cl-00cc6688">679</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-00d008e3"><p class="cl-00cfe7a4"><span class="cl-00cc66a6">N</span><span class="cl-00cc6688"> =â€‰</span><span class="cl-00cc6688">4000</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.200</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">97</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">19.4%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">97</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">19.4%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">733</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">733</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.300</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">90</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">18.0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">90</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">18.0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">717</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">717</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.400</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">91</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">18.2%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">91</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">18.2%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">719</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">719</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.600</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">129</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">25.8%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">129</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">25.8%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">812</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">812</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.700</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">120</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">24.0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d008e2"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">120</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">24.0%</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">789</span></p></td><td class="cl-00d008d8"><p class="cl-00cfe7a4"><span class="cl-00cc6688">789</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-00d008ec"><p class="cl-00cfe7a4"><span class="cl-00cc6688">.800</span></p></td><td class="cl-00d008ec"><p class="cl-00cfe7a4"><span class="cl-00cc6688">76</span></p></td><td class="cl-00d008ec"><p class="cl-00cfe7a4"><span class="cl-00cc6688">15.2%</span></p></td><td class="cl-00d00900"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d00900"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d00900"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0</span></p></td><td class="cl-00d00900"><p class="cl-00cfe7a4"><span class="cl-00cc6688">0%</span></p></td><td class="cl-00d008ec"><p class="cl-00cfe7a4"><span class="cl-00cc6688">76</span></p></td><td class="cl-00d008ec"><p class="cl-00cfe7a4"><span class="cl-00cc6688">15.2%</span></p></td><td class="cl-00d008ec"><p class="cl-00cfe7a4"><span class="cl-00cc6688">684</span></p></td><td class="cl-00d008ec"><p class="cl-00cfe7a4"><span class="cl-00cc6688">684</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Save Tables</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">save_as_image</span>(violation_summary_table, <span class="at">path =</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zErrors"</span>, <span class="st">"l_l_e&amp;v_1.svg"</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="part-2-re-run-simulations" class="level1">
<h1>PART 2 Re-Run Simulations</h1>
<hr>
<section id="re-run-simulation-with-dynamic-replication-conditions" class="level3">
<h3 class="anchored" data-anchor-id="re-run-simulation-with-dynamic-replication-conditions">Re-Run Simulation with Dynamic Replication Conditions</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the Mplus object with the dynamic replications</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>lta_lta_func <span class="ot">&lt;-</span> <span class="cf">function</span>(N_numeric, TPs, Replications_Needed) {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Manually construct the MONTECARLO section with dynamic NREPS</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  montecarlo_section <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="st">    NAMES = u11-u15 u21-u25;</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="st">    GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="st">    CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="st">    GENCLASSES = c1(2) c2(2);</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="st">    CLASSES = c1(2) c2(2);</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="st">    NOBSERVATIONS = {N_numeric};</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="st">    SEED = 07252005;</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="st">    NREPS = {Replications_Needed};  ! Dynamic number of replications</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="st">    !!SAVE = repM1*.dat;</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="st">    RESULTS = LTA_LTA_N_{N_numeric}_TP_{TPs}_TH_1.csv;</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the Mplus model using MplusAutomation, using glue for the content</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  LTA_LTA <span class="ot">&lt;-</span> <span class="fu">mplusObject</span>(</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE =</span> <span class="fu">glue</span>(<span class="st">"Generate LTA_LTA_N_{N_numeric}_TP_{TPs}_TH_1;"</span>),</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">MONTECARLO =</span> montecarlo_section,  <span class="co"># Use the dynamically constructed MONTECARLO section</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANALYSIS =</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"TYPE = MIXTURE;</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="st">      processors = 24;</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="st">      starts= 50 10;</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="st">      logcriterion=0.00001;</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="st">      mconv=0.00001;"</span>,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">OUTPUT =</span> <span class="st">"TECH9"</span>,</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELPOPULATION =</span> <span class="fu">glue</span>(<span class="st">"    </span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="st">        %OVERALL%</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="st">       [c1#1-c2#1*0];</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a><span class="st">        c2#1 on c1#1*{TPs};</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#1%</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#2%</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#1%</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#2%</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a><span class="st">       "</span>),</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODEL =</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"    </span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a><span class="st">        %OVERALL%</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a><span class="st">          [c1#1-c2#1*0](par1-par2);</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a><span class="st">            c2#1 on c1#1*{TPs} (par11);</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a><span class="st">     MODEL c1:</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#1%</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#2%</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a><span class="st">    MODEL c2:   </span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#1%</span></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#2%</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a><span class="st">          "</span>),</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELCONSTRAINT =</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="fl">1.385</span>) {</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a><span class="st">      New(trans11*.80 trans12*.20 trans21*.5 trans22*.5 </span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11*.5 prob12*.5 prob21*.65 prob22*.35);</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = 1-trans11;</span></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = 1-trans21;</span></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a><span class="st">      prob12 = 1 - prob11;</span></span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a><span class="st">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a><span class="st">      prob22 = 1- prob21;</span></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">85</span>) {</span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a><span class="st">      New(trans11*.70 trans12*.30 trans21*.5 trans22*.5 </span></span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11*.5 prob12*.5 prob21*.60 prob22*.40);</span></span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = 1-trans11;</span></span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = 1-trans21;</span></span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a><span class="st">      prob12 = 1 - prob11;</span></span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a><span class="st">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a><span class="st">      prob22 = 1- prob21;</span></span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">41</span>) {</span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a><span class="st">      New(trans11*.60 trans12*.40 trans21*.5 trans22*.5 </span></span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11*.5 prob12*.5 prob21*.55 prob22*.45);</span></span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = 1-trans11;</span></span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = 1-trans21;</span></span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a><span class="st">      prob12 = 1 - prob11;</span></span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a><span class="st">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a><span class="st">      prob22 = 1- prob21;</span></span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span>.<span class="dv">41</span>) {</span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a><span class="st">      New(trans11*.40 trans12*.60 trans21*.5 trans22*.5 </span></span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11*.5 prob12*.5 prob21*.45 prob22*.55);</span></span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = 1-trans11;</span></span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = 1-trans21;</span></span>
<span id="cb27-122"><a href="#cb27-122" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb27-123"><a href="#cb27-123" aria-hidden="true" tabindex="-1"></a><span class="st">      prob12 = 1 - prob11;</span></span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a><span class="st">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb27-125"><a href="#cb27-125" aria-hidden="true" tabindex="-1"></a><span class="st">      prob22 = 1- prob21;</span></span>
<span id="cb27-126"><a href="#cb27-126" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span>
<span id="cb27-127"><a href="#cb27-127" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span>.<span class="dv">85</span>) {</span>
<span id="cb27-128"><a href="#cb27-128" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb27-129"><a href="#cb27-129" aria-hidden="true" tabindex="-1"></a><span class="st">      New(trans11*.30 trans12*.70 trans21*.5 trans22*.5 </span></span>
<span id="cb27-130"><a href="#cb27-130" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11*.5 prob12*.5 prob21*.40 prob22*.60);</span></span>
<span id="cb27-131"><a href="#cb27-131" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb27-132"><a href="#cb27-132" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = 1-trans11;</span></span>
<span id="cb27-133"><a href="#cb27-133" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb27-134"><a href="#cb27-134" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = 1-trans21;</span></span>
<span id="cb27-135"><a href="#cb27-135" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb27-136"><a href="#cb27-136" aria-hidden="true" tabindex="-1"></a><span class="st">      prob12 = 1 - prob11;</span></span>
<span id="cb27-137"><a href="#cb27-137" aria-hidden="true" tabindex="-1"></a><span class="st">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb27-138"><a href="#cb27-138" aria-hidden="true" tabindex="-1"></a><span class="st">      prob22 = 1- prob21;</span></span>
<span id="cb27-139"><a href="#cb27-139" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span>
<span id="cb27-140"><a href="#cb27-140" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span><span class="fl">1.385</span>) {</span>
<span id="cb27-141"><a href="#cb27-141" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb27-142"><a href="#cb27-142" aria-hidden="true" tabindex="-1"></a><span class="st">      New(trans11*.20 trans12*.80 trans21*.5 trans22*.5 </span></span>
<span id="cb27-143"><a href="#cb27-143" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11*.5 prob12*.5 prob21*.35 prob22*.65);</span></span>
<span id="cb27-144"><a href="#cb27-144" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb27-145"><a href="#cb27-145" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = 1-trans11;</span></span>
<span id="cb27-146"><a href="#cb27-146" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb27-147"><a href="#cb27-147" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = 1-trans21;</span></span>
<span id="cb27-148"><a href="#cb27-148" aria-hidden="true" tabindex="-1"></a><span class="st">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb27-149"><a href="#cb27-149" aria-hidden="true" tabindex="-1"></a><span class="st">      prob12 = 1 - prob11;</span></span>
<span id="cb27-150"><a href="#cb27-150" aria-hidden="true" tabindex="-1"></a><span class="st">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb27-151"><a href="#cb27-151" aria-hidden="true" tabindex="-1"></a><span class="st">      prob22 = 1- prob21;</span></span>
<span id="cb27-152"><a href="#cb27-152" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span>
<span id="cb27-153"><a href="#cb27-153" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-154"><a href="#cb27-154" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-155"><a href="#cb27-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-156"><a href="#cb27-156" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run the Mplus model using MplusAutomation</span></span>
<span id="cb27-157"><a href="#cb27-157" aria-hidden="true" tabindex="-1"></a>  LTA_LTA_Model <span class="ot">&lt;-</span> <span class="fu">mplusModeler</span>(LTA_LTA,</span>
<span id="cb27-158"><a href="#cb27-158" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dataout =</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"1_2T_LTA_GEN_LTA_ANALYZED_REP"</span>, <span class="fu">glue</span>(<span class="st">"LTA_LTA_N_{N_numeric}_TP_{TPs}_TH_1.dat"</span>)),</span>
<span id="cb27-159"><a href="#cb27-159" aria-hidden="true" tabindex="-1"></a>                                <span class="at">modelout =</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"1_2T_LTA_GEN_LTA_ANALYZED_REP"</span>, <span class="fu">glue</span>(<span class="st">"LTA_LTA_N_{N_numeric}_TP_{TPs}_TH_1.inp"</span>)),</span>
<span id="cb27-160"><a href="#cb27-160" aria-hidden="true" tabindex="-1"></a>                                <span class="at">run =</span> <span class="dv">1</span>, <span class="at">check =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-161"><a href="#cb27-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LTA_LTA_Model)</span>
<span id="cb27-162"><a href="#cb27-162" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-163"><a href="#cb27-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-164"><a href="#cb27-164" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb27-165"><a href="#cb27-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-166"><a href="#cb27-166" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the cluster</span></span>
<span id="cb27-167"><a href="#cb27-167" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb27-168"><a href="#cb27-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-169"><a href="#cb27-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Select the cluster type based on the system (PSOCK for Windows, FORK for macOS/Linux)</span></span>
<span id="cb27-170"><a href="#cb27-170" aria-hidden="true" tabindex="-1"></a>cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>)</span>
<span id="cb27-171"><a href="#cb27-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-172"><a href="#cb27-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-173"><a href="#cb27-173" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)</span>
<span id="cb27-174"><a href="#cb27-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-175"><a href="#cb27-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Export necessary objects to the cluster</span></span>
<span id="cb27-176"><a href="#cb27-176" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"lta_lta_func"</span>, <span class="st">"violation_summary"</span>, <span class="st">"here"</span>, <span class="st">"glue"</span>, <span class="st">"mplusModeler"</span>, <span class="st">"mplusObject"</span>))</span>
<span id="cb27-177"><a href="#cb27-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-178"><a href="#cb27-178" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure required libraries are loaded on each node</span></span>
<span id="cb27-179"><a href="#cb27-179" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb27-180"><a href="#cb27-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MplusAutomation)</span>
<span id="cb27-181"><a href="#cb27-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb27-182"><a href="#cb27-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb27-183"><a href="#cb27-183" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb27-184"><a href="#cb27-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-185"><a href="#cb27-185" aria-hidden="true" tabindex="-1"></a>result_list <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(violation_summary), <span class="cf">function</span>(i) {</span>
<span id="cb27-186"><a href="#cb27-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lta_lta_func</span>(</span>
<span id="cb27-187"><a href="#cb27-187" aria-hidden="true" tabindex="-1"></a>    violation_summary<span class="sc">$</span>N_numeric[i], </span>
<span id="cb27-188"><a href="#cb27-188" aria-hidden="true" tabindex="-1"></a>    violation_summary<span class="sc">$</span>TPs[i],  </span>
<span id="cb27-189"><a href="#cb27-189" aria-hidden="true" tabindex="-1"></a>    violation_summary<span class="sc">$</span>Replications_Needed[i]</span>
<span id="cb27-190"><a href="#cb27-190" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-191"><a href="#cb27-191" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb27-192"><a href="#cb27-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-193"><a href="#cb27-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-194"><a href="#cb27-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-195"><a href="#cb27-195" aria-hidden="true" tabindex="-1"></a><span class="co"># Stop the cluster after the simulation</span></span>
<span id="cb27-196"><a href="#cb27-196" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="check-for-label-switching-and-errors---part-2" class="level3">
<h3 class="anchored" data-anchor-id="check-for-label-switching-and-errors---part-2">Check for Label Switching and Errors - Part 2</h3>
<blockquote class="blockquote">
<p>In this section: we re conduct the steps for aggregating the label switching and errors to guarantee that we will have at minimum 500 replications per condition.</p>
</blockquote>
<hr>
<p><em>Load all CSV files and combine them into a single data frame.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct CSV directory</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>csv_directory <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'1_2T_LTA_GEN_LTA_ANALYZED_REP'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'data_scraping.R'</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate combine_data data frame in the global environment </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Extract data from the appropriate rows from each 9-row chunk and prepare the data for further processing.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Process the data using the child script</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step2_2t_LTA.R'</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate final_combined data in global environment</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>final_combined_data <span class="ot">&lt;-</span> final_combined_data <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">TRANS11 =</span> <span class="fu">as.numeric</span>(TRANS11),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_11 =</span> <span class="fu">as.numeric</span>(SE_11),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Ec"</span>), as.numeric),  <span class="co"># Convert all Ec columns</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_csv =</span> <span class="fu">as.numeric</span>(ll_csv)  <span class="co"># Convert Log-Likelihood values</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Convert the logits to probabilities and add the known actual values to each row.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Process the data and return results</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step_3.R'</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The objects `final_data_with_actuals` and `violators` should now be in the global environment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Scrape Output Files for Errors</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct output directory for .out files</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>output_folder <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'1_2T_LTA_GEN_LTA_ANALYZED_REP'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document that processes .out files</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'out_scraping.R'</span>))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  âœ… SECTION 1 Generate Replication Summary Table</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>replication_summary_table <span class="ot">&lt;-</span> replication_summary <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Replication Summary"</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Folder: "</span>, output_folder)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Total"</span>, <span class="st">"Replicated_Yes"</span>, <span class="st">"Replicated_No"</span>, <span class="st">"Error_Count"</span>),</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">FileName =</span> <span class="st">"File Name"</span>,</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="st">"Total Replications"</span>,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replicated_Yes =</span> <span class="st">"LL Replicated"</span>,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replicated_No =</span> <span class="st">"LL Not Replicated"</span>,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Error_Count =</span> <span class="st">"Errors"</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">80</span>)</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>replication_summary_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="zuttquavym" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zuttquavym table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zuttquavym thead, #zuttquavym tbody, #zuttquavym tfoot, #zuttquavym tr, #zuttquavym td, #zuttquavym th {
  border-style: none;
}

#zuttquavym p {
  margin: 0;
  padding: 0;
}

#zuttquavym .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 80%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zuttquavym .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zuttquavym .gt_title {
  color: #333333;
  font-size: medium;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zuttquavym .gt_subtitle {
  color: #333333;
  font-size: small;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zuttquavym .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zuttquavym .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zuttquavym .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zuttquavym .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zuttquavym .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zuttquavym .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zuttquavym .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zuttquavym .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zuttquavym .gt_spanner_row {
  border-bottom-style: hidden;
}

#zuttquavym .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zuttquavym .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zuttquavym .gt_from_md > :first-child {
  margin-top: 0;
}

#zuttquavym .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zuttquavym .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zuttquavym .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zuttquavym .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zuttquavym .gt_row_group_first td {
  border-top-width: 2px;
}

#zuttquavym .gt_row_group_first th {
  border-top-width: 2px;
}

#zuttquavym .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zuttquavym .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zuttquavym .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zuttquavym .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zuttquavym .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zuttquavym .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zuttquavym .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zuttquavym .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zuttquavym .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zuttquavym .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zuttquavym .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zuttquavym .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zuttquavym .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zuttquavym .gt_left {
  text-align: left;
}

#zuttquavym .gt_center {
  text-align: center;
}

#zuttquavym .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zuttquavym .gt_font_normal {
  font-weight: normal;
}

#zuttquavym .gt_font_bold {
  font-weight: bold;
}

#zuttquavym .gt_font_italic {
  font-style: italic;
}

#zuttquavym .gt_super {
  font-size: 65%;
}

#zuttquavym .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zuttquavym .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zuttquavym .gt_indent_1 {
  text-indent: 5px;
}

#zuttquavym .gt_indent_2 {
  text-indent: 10px;
}

#zuttquavym .gt_indent_3 {
  text-indent: 15px;
}

#zuttquavym .gt_indent_4 {
  text-indent: 20px;
}

#zuttquavym .gt_indent_5 {
  text-indent: 25px;
}

#zuttquavym .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zuttquavym div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="5" class="gt_heading gt_title gt_font_normal">Replication Summary</th>
</tr>
<tr class="odd gt_heading">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Folder: /Users/brucecarter/Library/CloudStorage/Box-Box/RILTAS/RILTA_SIMULATION_STUDY/Simulations/STUDY_1/2 Time Points/1_2T_LTA_GEN_LTA_ANALYZED_REP</th>
</tr>
<tr class="header gt_col_headings">
<th id="FileName" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">File Name</th>
<th id="Total" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Total Replications</th>
<th id="Replicated_Yes" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">LL Replicated</th>
<th id="Replicated_No" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">LL Not Replicated</th>
<th id="Error_Count" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Errors</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_-0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">770</td>
<td class="gt_row gt_center" headers="Replicated_Yes">770</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_-0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">770</td>
<td class="gt_row gt_center" headers="Replicated_Yes">770</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_-1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">802</td>
<td class="gt_row gt_center" headers="Replicated_Yes">802</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">809</td>
<td class="gt_row gt_center" headers="Replicated_Yes">809</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">736</td>
<td class="gt_row gt_center" headers="Replicated_Yes">736</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_1000_tp_1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">703</td>
<td class="gt_row gt_center" headers="Replicated_Yes">703</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_-0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">721</td>
<td class="gt_row gt_center" headers="Replicated_Yes">721</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_-0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">731</td>
<td class="gt_row gt_center" headers="Replicated_Yes">731</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_-1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">855</td>
<td class="gt_row gt_center" headers="Replicated_Yes">855</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">760</td>
<td class="gt_row gt_center" headers="Replicated_Yes">760</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">765</td>
<td class="gt_row gt_center" headers="Replicated_Yes">765</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_2000_tp_1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">679</td>
<td class="gt_row gt_center" headers="Replicated_Yes">679</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_-0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">719</td>
<td class="gt_row gt_center" headers="Replicated_Yes">719</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_-0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">717</td>
<td class="gt_row gt_center" headers="Replicated_Yes">717</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_-1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">733</td>
<td class="gt_row gt_center" headers="Replicated_Yes">733</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">812</td>
<td class="gt_row gt_center" headers="Replicated_Yes">812</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">789</td>
<td class="gt_row gt_center" headers="Replicated_Yes">789</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_4000_tp_1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">684</td>
<td class="gt_row gt_center" headers="Replicated_Yes">684</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_-0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">765</td>
<td class="gt_row gt_center" headers="Replicated_Yes">765</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_-0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">787</td>
<td class="gt_row gt_center" headers="Replicated_Yes">787</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_-1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">822</td>
<td class="gt_row gt_center" headers="Replicated_Yes">822</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_0.41_th_1.out</td>
<td class="gt_row gt_center" headers="Total">809</td>
<td class="gt_row gt_center" headers="Replicated_Yes">809</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_0.85_th_1.out</td>
<td class="gt_row gt_center" headers="Total">762</td>
<td class="gt_row gt_center" headers="Replicated_Yes">762</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_lta_n_500_tp_1.385_th_1.out</td>
<td class="gt_row gt_center" headers="Total">703</td>
<td class="gt_row gt_center" headers="Replicated_Yes">703</td>
<td class="gt_row gt_center" headers="Replicated_No">0</td>
<td class="gt_row gt_center" headers="Error_Count">0</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  âœ… SECTION 2 Row Count Validation</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_data_with_actuals:"</span>, <span class="fu">nrow</span>(final_data_with_actuals), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows in final_data_with_actuals: 18203 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_results:"</span>, <span class="fu">nrow</span>(final_results), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows in final_results: 18203 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in replication_summary:"</span>, <span class="fu">nrow</span>(replication_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows in replication_summary: 24 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="cf">if</span> (<span class="fu">any</span>(replication_summary<span class="sc">$</span>LL_Not_Replicated <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"âš ï¸ WARNING: Some LL values were NOT replicated! Check the Replication Summary table."</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"âœ… All LL values were successfully replicated."</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "âœ… All LL values were successfully replicated."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(final_data_with_actuals<span class="sc">$</span>ll_csv, final_results<span class="sc">$</span>ll_out, <span class="at">tolerance =</span> <span class="fl">1e-4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="merge-errors-with-main-data-file-1" class="level3">
<h3 class="anchored" data-anchor-id="merge-errors-with-main-data-file-1">Merge Errors with Main Data File</h3>
<p><em>Combine error information with main data file</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    final_results <span class="sc">%&gt;%</span> <span class="fu">select</span>(FileName, Replication, ll_out, LL_Replicated, ErrorFlag), </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"FileName"</span>, <span class="st">"Replication"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Any_Violation =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Any_Violation), <span class="dv">0</span>, Any_Violation),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorFlag =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(ErrorFlag), <span class="dv">0</span>, ErrorFlag),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">LL_Replicated =</span> <span class="fu">ifelse</span>(LL_Replicated <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),  <span class="co"># âœ… Convert Yes/No to 1/0</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ðŸ”¹ Create a new True Violation column</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">True_Violation =</span> <span class="fu">case_when</span>(</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>      Any_Violation <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> ErrorFlag <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> LL_Replicated <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># âœ… At least one violation</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualize differences between ll_out and ll_csv</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe with only rows where ll_out and ll_csv differ</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>ll_mismatch <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">round</span>(ll_out <span class="sc">-</span> ll_csv, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(diff <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FileName, Replication, ll_out, ll_csv, diff)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>ll_check <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">round</span>(ll_out <span class="sc">-</span> ll_csv, <span class="dv">3</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Round before counting</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(diff)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>ll_check_table <span class="ot">&lt;-</span> ll_check <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"LL Difference Summary"</span>,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Comparison of LL values between CSV and OUT files"</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff =</span> <span class="st">"LL Difference"</span>,</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="st">"Count"</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> diff,</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">50</span>)</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>ll_check_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="lvscqyuoag" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lvscqyuoag table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lvscqyuoag thead, #lvscqyuoag tbody, #lvscqyuoag tfoot, #lvscqyuoag tr, #lvscqyuoag td, #lvscqyuoag th {
  border-style: none;
}

#lvscqyuoag p {
  margin: 0;
  padding: 0;
}

#lvscqyuoag .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 50%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lvscqyuoag .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lvscqyuoag .gt_title {
  color: #333333;
  font-size: medium;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lvscqyuoag .gt_subtitle {
  color: #333333;
  font-size: small;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lvscqyuoag .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lvscqyuoag .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lvscqyuoag .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lvscqyuoag .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lvscqyuoag .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lvscqyuoag .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lvscqyuoag .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lvscqyuoag .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lvscqyuoag .gt_spanner_row {
  border-bottom-style: hidden;
}

#lvscqyuoag .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lvscqyuoag .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lvscqyuoag .gt_from_md > :first-child {
  margin-top: 0;
}

#lvscqyuoag .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lvscqyuoag .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lvscqyuoag .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lvscqyuoag .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lvscqyuoag .gt_row_group_first td {
  border-top-width: 2px;
}

#lvscqyuoag .gt_row_group_first th {
  border-top-width: 2px;
}

#lvscqyuoag .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lvscqyuoag .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lvscqyuoag .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lvscqyuoag .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lvscqyuoag .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lvscqyuoag .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lvscqyuoag .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lvscqyuoag .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lvscqyuoag .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lvscqyuoag .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lvscqyuoag .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lvscqyuoag .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lvscqyuoag .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lvscqyuoag .gt_left {
  text-align: left;
}

#lvscqyuoag .gt_center {
  text-align: center;
}

#lvscqyuoag .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lvscqyuoag .gt_font_normal {
  font-weight: normal;
}

#lvscqyuoag .gt_font_bold {
  font-weight: bold;
}

#lvscqyuoag .gt_font_italic {
  font-style: italic;
}

#lvscqyuoag .gt_super {
  font-size: 65%;
}

#lvscqyuoag .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lvscqyuoag .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lvscqyuoag .gt_indent_1 {
  text-indent: 5px;
}

#lvscqyuoag .gt_indent_2 {
  text-indent: 10px;
}

#lvscqyuoag .gt_indent_3 {
  text-indent: 15px;
}

#lvscqyuoag .gt_indent_4 {
  text-indent: 20px;
}

#lvscqyuoag .gt_indent_5 {
  text-indent: 25px;
}

#lvscqyuoag .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lvscqyuoag div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="2" class="gt_heading gt_title gt_font_normal">LL Difference Summary</th>
</tr>
<tr class="odd gt_heading">
<th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Comparison of LL values between CSV and OUT files</th>
</tr>
<tr class="header gt_col_headings">
<th id="diff" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">LL Difference</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Count</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="diff">âˆ’0.001</td>
<td class="gt_row gt_center" headers="n">219</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="diff">0.000</td>
<td class="gt_row gt_center" headers="n">17764</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="diff">0.001</td>
<td class="gt_row gt_center" headers="n">220</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><em>Create Column Names from the File Name</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns based on the information in the FileName and set factors</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the sample size (N) from the FileName with the correct values</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">case_when</span>(</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_4000"</span>, FileName) <span class="sc">~</span> <span class="dv">4</span>,  <span class="co"># Correct value for N_4000</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_500"</span>, FileName) <span class="sc">~</span> <span class="dv">1</span>,   </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_1000"</span>, FileName) <span class="sc">~</span> <span class="dv">2</span>,  </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_2000"</span>, FileName) <span class="sc">~</span> <span class="dv">3</span>,  </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map the TPs from the FileName to the appropriate Population labels</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">case_when</span>(</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".800"</span>,  </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".700"</span>,  </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".600"</span>,   </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".400"</span>,  </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".300"</span>, </span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".200"</span>,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the Transitions variable based on Population values</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">case_when</span>(</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>) <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># Assign 1 for Population .200, .300, .400</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>) <span class="sc">~</span> <span class="dv">2</span>,  <span class="co"># Assign 2 for Population .600, .700, .800</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert columns to factors, ordering N_4000 first in the factor levels</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"N = 4000"</span>, <span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>)),</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".800"</span>, <span class="st">".700"</span>, <span class="st">".600"</span>, <span class="st">".400"</span>, <span class="st">".300"</span>, <span class="st">".200"</span>)),</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">factor</span>(Transitions, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mover"</span>, <span class="st">"Stayer"</span>))</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Calculate Violation Percentages per Condition</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>violation_summary2 <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure numeric conversion for N</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, <span class="fu">as.character</span>(N))),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(N_numeric), <span class="dv">0</span>, N_numeric)  <span class="co"># Ensure no missing values</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName, Population, N, N_numeric) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> <span class="fu">n</span>(),</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Label Switching Violations</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Violations =</span> <span class="fu">sum</span>(Any_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),   </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Mplus Errors</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Errors =</span> <span class="fu">sum</span>(ErrorFlag, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),           </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… LL Replication Failures</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_LL_Failures =</span> <span class="fu">sum</span>(LL_Replicated <span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Compute True Violation Count</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_True_Violations =</span> <span class="fu">sum</span>(True_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Compute Violation Percentages</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage_Violations =</span> <span class="fu">round</span>((Total_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">True_Violation_Perc =</span> <span class="fu">round</span>((Total_True_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> <span class="fu">round</span>((Total_Errors <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">LL_Failure_Perc =</span> <span class="fu">round</span>((Total_LL_Failures <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Compute Good Replications</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> Total_Rows <span class="sc">-</span> Total_True_Violations,</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> <span class="fu">ifelse</span>(GoodReplications <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, GoodReplications),</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Reanalysis Needed Flag</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reanalysis_Needed =</span> <span class="fu">if_else</span>(GoodReplications <span class="sc">&gt;=</span> <span class="dv">500</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>),</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Assign Transition Probabilities (TPs) based on Population</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">TPs =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">~</span> <span class="fl">1.385</span>,</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".700"</span> <span class="sc">~</span> <span class="fl">0.85</span>,</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".600"</span> <span class="sc">~</span> <span class="fl">0.41</span>,</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".400"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.41</span>,</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".300"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.85</span>,</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">1.385</span>,</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">factor</span>(N_numeric, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>)), <span class="fu">as.numeric</span>(Population)) <span class="sc">%&gt;%</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>, <span class="st">"N = 4000"</span>)),</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>, <span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>))</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># âœ… FINAL SELECTION </span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>    FileName, Population, N, N_numeric, TPs,  </span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>    Total_Rows,  </span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>    Total_Violations, Percentage_Violations,  </span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>    Total_Errors, ErrorRate,  </span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>    Total_LL_Failures, LL_Failure_Perc,  </span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>    Total_True_Violations, True_Violation_Perc,  </span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>    GoodReplications,  </span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>    Reanalysis_Needed  <span class="co"># </span></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(N_numeric, Population) <span class="sc">%&gt;%</span></span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_numeric =</span> <span class="fu">trimws</span>(<span class="fu">as.numeric</span>(N_numeric)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Summarize &amp; Visualize Label Switching Percentage Results</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>create_flextable <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure only the required columns are used</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>      N_numeric,  </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>      Population,  </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>      Total_Violations,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>      Percentage_Violations,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>      Total_Errors,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>      ErrorRate,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>      Total_LL_Failures,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>      LL_Failure_Perc,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>      Total_True_Violations,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>      True_Violation_Perc,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>      GoodReplications,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>      Reanalysis_Needed</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()  <span class="co"># Ensure proper structure before passing to flextable</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the flextable</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_header_labels</span>(</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_numeric =</span> <span class="st">"N"</span>,</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Population =</span> <span class="st">"T11"</span>,  </span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Violations =</span> <span class="st">"V"</span>,</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">Percentage_Violations =</span> <span class="st">"V %"</span>,</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Errors =</span> <span class="st">"\u03B5"</span>,  </span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">ErrorRate =</span> <span class="st">"\u03B5 %"</span>,</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_LL_Failures =</span> <span class="st">"â„’â‚—"</span>,  </span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">LL_Failure_Perc =</span> <span class="st">"â„’â‚— %"</span>,</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_True_Violations =</span> <span class="st">"\u03C4áµ¥"</span>,  </span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">True_Violation_Perc =</span> <span class="st">"\u03C4áµ¥ %"</span>,</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">GoodReplications =</span> <span class="st">"Good Reps"</span>,</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">Reanalysis_Needed =</span> <span class="st">"Reanalysis Needed"</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply special formatting to headers</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"N"</span>)))</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"T"</span>), <span class="fu">as_sub</span>(<span class="st">"11"</span>)))</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Label Switching Violations</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>)))</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Percentage_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>), <span class="st">"%"</span>))</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mplus Errors</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_Errors"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>)))  </span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"ErrorRate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>), <span class="st">"%"</span>))</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># LL Replication Failures</span></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_LL_Failures"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"â„’"</span>), <span class="fu">as_sub</span>(<span class="st">"â‚—"</span>)))  </span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"LL_Failure_Perc"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"â„’"</span>), <span class="fu">as_sub</span>(<span class="st">"â‚—"</span>), <span class="st">"%"</span>))</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># True Violations</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_True_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="st">"áµ¥"</span>)))  </span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"True_Violation_Perc"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="st">"áµ¥"</span>), <span class="st">"%"</span>))  </span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Good Replications and Reanalysis Needed</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"GoodReplications"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Good"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Reps"</span>))</span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Reanalysis_Needed"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Reanalysis"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Needed?"</span>))</span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply width settings</span></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">width =</span> <span class="fl">1.0</span>)</span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)  </span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Percentage_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_Errors"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"ErrorRate"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_LL_Failures"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"LL_Failure_Perc"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_True_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"True_Violation_Perc"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"GoodReplications"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Reanalysis_Needed"</span>, <span class="at">width =</span> <span class="fl">0.7</span>)</span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">colformat_num</span>(</span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>  ft,</span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">j =</span> <span class="fu">c</span>(<span class="st">"Percentage_Violations"</span>, <span class="st">"ErrorRate"</span>, <span class="st">"LL_Failure_Perc"</span>, <span class="st">"True_Violation_Perc"</span> ),  </span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="st">"%"</span>  <span class="co"># âœ… Adds percentage symbol</span></span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add padding below the subheaders</span></span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a><span class="co">#ft &lt;- ft %&gt;%</span></span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a> <span class="co"># padding(part = "header", padding = c(0, 0, 6, 0))  # Adjust as needed for top, right, bottom, and left padding</span></span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enable autofit</span></span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">set_table_properties</span>(ft, <span class="at">layout =</span> <span class="st">"fixed"</span>)</span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Center all cells</span></span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">align</span>(ft, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Align header text at the bottom of the cells</span></span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ft &lt;- valign(ft, part = "header", valign = "bottom")</span></span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Merge vertically identical rows in the "N_numeric" column</span></span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">merge_v</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>)</span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply font to the entire table</span></span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">font</span>(ft, <span class="at">fontname =</span> <span class="st">"Avenir Next LT Pro"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">part =</span> <span class="st">"body"</span>,</span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">j =</span> <span class="st">"N_numeric"</span>,</span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="sc">~</span> <span class="sc">!</span><span class="fu">duplicated</span>(N_numeric),</span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as_paragraph</span>(</span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_i</span>(<span class="st">"N"</span>),  </span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a>      <span class="st">" =\u2009"</span>,  <span class="co"># THIN SPACE (Unicode U+2009)</span></span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.character</span>(<span class="fu">format</span>(N_numeric, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>))  <span class="co"># Keeps proper formatting</span></span>
<span id="cb46-109"><a href="#cb46-109" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-110"><a href="#cb46-110" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-111"><a href="#cb46-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add subheader row</span></span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">add_header_row</span>(</span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"N Reps = Varies"</span>, <span class="st">"Violations"</span>, <span class="st">"Errors"</span>, <span class="st">"LL Replication"</span>, <span class="st">"True Violations"</span>, <span class="st">"Success?"</span>),  </span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)  </span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define a transparent border</span></span>
<span id="cb46-120"><a href="#cb46-120" aria-hidden="true" tabindex="-1"></a>  no_border <span class="ot">&lt;-</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">width =</span> <span class="dv">0</span>)</span>
<span id="cb46-121"><a href="#cb46-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Remove ONLY the bottom border under the first three columns (the blank subheader)**</span></span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">hline</span>(ft, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">border =</span> no_border, <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding color with a correct method</span></span>
<span id="cb46-126"><a href="#cb46-126" aria-hidden="true" tabindex="-1"></a>  total_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)  <span class="co"># Get the total number of rows in your data</span></span>
<span id="cb46-127"><a href="#cb46-127" aria-hidden="true" tabindex="-1"></a>  color_rows <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>, total_rows)  <span class="co"># Initialize a logical vector for coloring rows</span></span>
<span id="cb46-128"><a href="#cb46-128" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, total_rows, <span class="at">by =</span> <span class="dv">12</span>)) {</span>
<span id="cb46-129"><a href="#cb46-129" aria-hidden="true" tabindex="-1"></a>    color_rows[i<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Apply color to every 6 rows</span></span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-131"><a href="#cb46-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-132"><a href="#cb46-132" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply background color with a lighter shade of gray</span></span>
<span id="cb46-133"><a href="#cb46-133" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">bg</span>(ft, <span class="at">i =</span> color_rows, <span class="at">bg =</span> <span class="st">"#f0f0f0"</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb46-134"><a href="#cb46-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-135"><a href="#cb46-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ft)</span>
<span id="cb46-136"><a href="#cb46-136" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-137"><a href="#cb46-137" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-138"><a href="#cb46-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate formatted flextables for each subset</span></span>
<span id="cb46-139"><a href="#cb46-139" aria-hidden="true" tabindex="-1"></a>violation_summary_table2 <span class="ot">&lt;-</span> <span class="fu">create_flextable</span>(violation_summary2)</span>
<span id="cb46-140"><a href="#cb46-140" aria-hidden="true" tabindex="-1"></a>violation_summary_table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-176223ec{}.cl-17578e5a{font-family:'Avenir Next LT Pro';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-17578e64{font-family:'Avenir Next LT Pro';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-17578e6e{font-family:'Avenir Next LT Pro';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;top:3.3pt;}.cl-175b98f6{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-175bb8fe{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb908{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb912{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb913{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb91c{width:0.7in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb91d{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb926{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb927{width:1in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb928{width:0.6in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb930{width:0.5in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb931{width:0.7in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb93a{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb93b{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb944{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb94e{width:0.7in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb94f{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb958{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb959{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-175bb962{width:0.7in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-176223ec"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-175bb8fe"><p class="cl-175b98f6"><span class="cl-17578e5a">N Reps = Varies</span></p></th><th colspan="2" class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e5a">Violations</span></p></th><th colspan="2" class="cl-175bb913"><p class="cl-175b98f6"><span class="cl-17578e5a">Errors</span></p></th><th colspan="2" class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e5a">LL Replication</span></p></th><th colspan="2" class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e5a">True Violations</span></p></th><th colspan="2" class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e5a">Success?</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-175bb91d"><p class="cl-175b98f6"><span class="cl-17578e64">N</span></p></th><th class="cl-175bb926"><p class="cl-175b98f6"><span class="cl-17578e64">T</span><span class="cl-17578e6e">11</span></p></th><th class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e64">V</span></p></th><th class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e64">V</span><span class="cl-17578e5a">%</span></p></th><th class="cl-175bb913"><p class="cl-175b98f6"><span class="cl-17578e64">Îµ</span></p></th><th class="cl-175bb913"><p class="cl-175b98f6"><span class="cl-17578e64">Îµ</span><span class="cl-17578e5a">%</span></p></th><th class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e64">â„’</span><span class="cl-17578e6e">â‚—</span></p></th><th class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e64">â„’</span><span class="cl-17578e6e">â‚—</span><span class="cl-17578e5a">%</span></p></th><th class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e64">Ï„</span><span class="cl-17578e6e">áµ¥</span></p></th><th class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e64">Ï„</span><span class="cl-17578e6e">áµ¥</span><span class="cl-17578e5a">%</span></p></th><th class="cl-175bb912"><p class="cl-175b98f6"><span class="cl-17578e5a">Good</span><br><span class="cl-17578e5a">Reps</span></p></th><th class="cl-175bb91c"><p class="cl-175b98f6"><span class="cl-17578e5a">Reanalysis</span><br><span class="cl-17578e5a">Needed?</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-175bb927"><p class="cl-175b98f6"><span class="cl-17578e64">N</span><span class="cl-17578e5a"> =â€‰</span><span class="cl-17578e5a">500 </span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.200</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">214</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">26.0%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">214</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">26.0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">608</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.300</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">191</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">24.3%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">191</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">24.3%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">596</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.400</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">170</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">22.2%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">170</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">22.2%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">595</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.600</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">207</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">25.6%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">207</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">25.6%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">602</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.700</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">166</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">21.8%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">166</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">21.8%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">596</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.800</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">118</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">16.8%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">118</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">16.8%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">585</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-175bb93a"><p class="cl-175b98f6"><span class="cl-17578e64">N</span><span class="cl-17578e5a"> =â€‰</span><span class="cl-17578e5a">1000</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.200</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">216</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">26.9%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">216</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">26.9%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">586</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.300</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">163</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">21.2%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">163</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">21.2%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">607</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.400</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">168</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">21.8%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">168</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">21.8%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">602</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.600</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">188</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">23.2%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">188</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">23.2%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">621</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.700</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">148</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">20.1%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">148</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">20.1%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">588</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.800</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">115</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">16.4%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">115</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">16.4%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">588</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-175bb927"><p class="cl-175b98f6"><span class="cl-17578e64">N</span><span class="cl-17578e5a"> =â€‰</span><span class="cl-17578e5a">2000</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.200</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">231</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">27.0%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">231</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">27.0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">624</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.300</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">146</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">20.0%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">146</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">20.0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">585</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.400</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">134</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">18.6%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">134</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">18.6%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">587</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.600</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">165</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">21.7%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">165</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">21.7%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">595</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.700</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">154</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">20.1%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">154</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">20.1%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">611</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">.800</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">98</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">14.4%</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb930"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">98</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">14.4%</span></p></td><td class="cl-175bb928"><p class="cl-175b98f6"><span class="cl-17578e5a">581</span></p></td><td class="cl-175bb931"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-175bb94f"><p class="cl-175b98f6"><span class="cl-17578e64">N</span><span class="cl-17578e5a"> =â€‰</span><span class="cl-17578e5a">4000</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.200</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">139</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">19.0%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">139</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">19.0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">594</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.300</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">122</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">17.0%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">122</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">17.0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">595</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.400</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">126</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">17.5%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">126</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">17.5%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">593</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.600</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">207</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">25.5%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">207</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">25.5%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">605</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">.700</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">175</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">22.2%</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb944"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">175</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">22.2%</span></p></td><td class="cl-175bb93b"><p class="cl-175b98f6"><span class="cl-17578e5a">614</span></p></td><td class="cl-175bb94e"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-175bb958"><p class="cl-175b98f6"><span class="cl-17578e5a">.800</span></p></td><td class="cl-175bb958"><p class="cl-175b98f6"><span class="cl-17578e5a">106</span></p></td><td class="cl-175bb958"><p class="cl-175b98f6"><span class="cl-17578e5a">15.5%</span></p></td><td class="cl-175bb959"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb959"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb958"><p class="cl-175b98f6"><span class="cl-17578e5a">0</span></p></td><td class="cl-175bb958"><p class="cl-175b98f6"><span class="cl-17578e5a">0%</span></p></td><td class="cl-175bb958"><p class="cl-175b98f6"><span class="cl-17578e5a">106</span></p></td><td class="cl-175bb958"><p class="cl-175b98f6"><span class="cl-17578e5a">15.5%</span></p></td><td class="cl-175bb958"><p class="cl-175b98f6"><span class="cl-17578e5a">578</span></p></td><td class="cl-175bb962"><p class="cl-175b98f6"><span class="cl-17578e5a">No</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Save the Table</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">save_as_image</span>(violation_summary_table2, <span class="at">path =</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zErrors"</span>, <span class="st">"zl_l_e&amp;v_2.svg"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>   ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Prepare data for Submission Table</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Rename columns in violation_summary2 (except join keys)</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>violation_summary2 <span class="ot">&lt;-</span> violation_summary2 <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_2"</span>), </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>              <span class="sc">-</span><span class="fu">c</span>(Population, N, N_numeric))  <span class="co"># âœ… Remove FileName from keys</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Merge both datasets on common keys</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>violation_summary_final <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(violation_summary2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Population"</span>, <span class="st">"N"</span>, <span class="st">"N_numeric"</span>)) <span class="sc">%&gt;%</span>  <span class="co"># âœ… Remove FileName from join</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> Total_Rows,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initial and Final Violation Rates</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Violation_Rate =</span> Percentage_Violations,  </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Final_Violation_Rate =</span> Percentage_Violations_2,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initial and Final LL Failure Rates</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">LL_Failure_Rate =</span> LL_Failure_Perc,</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Final_LL_Failure_Rate =</span> LL_Failure_Perc_2,</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initial and Final Error Rates</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Error_Rate =</span> ErrorRate,</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Final_Error_Rate =</span> ErrorRate_2,</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… NEW: Initial and Final True Violation Rates</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">True_Violation_Rate =</span> True_Violation_Perc,</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Final_True_Violation_Rate =</span> True_Violation_Perc_2,</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replications &amp; Success</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reps_Needed_for_Success =</span> Replications_Needed,</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">Successful_Replications =</span> GoodReplications_2,</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Status: Check if we achieved 500+ successful replications</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Status =</span> <span class="fu">if_else</span>(Successful_Replications <span class="sc">&gt;=</span> <span class="dv">500</span>, <span class="st">"âœ… Fixed"</span>, <span class="st">"âš ï¸ Additional Runs Required"</span>)</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>    N_numeric, Population, Total_Rows, </span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>    Violation_Rate, LL_Failure_Rate, Error_Rate, True_Violation_Rate,  <span class="co"># âœ… Initial Rates</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>    Final_Violation_Rate, Final_LL_Failure_Rate, Final_Error_Rate, Final_True_Violation_Rate,  <span class="co"># âœ… Final Rates</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>    Reps_Needed_for_Success, Successful_Replications, Status  <span class="co"># âœ… Success Metrics</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">factor</span>(N_numeric, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>)), Population) <span class="sc">%&gt;%</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_numeric =</span> <span class="fu">trimws</span>(<span class="fu">as.numeric</span>(N_numeric)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create flextable Function for Final Table</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>create_flextable <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep only the required columns</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>      N_numeric,  </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>      Population,  </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>      Total_Rows,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>      Violation_Rate,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>      LL_Failure_Rate,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>      Error_Rate,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>      True_Violation_Rate,   <span class="co"># âœ… NEW</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>      Reps_Needed_for_Success,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>      Final_Violation_Rate,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>      Final_LL_Failure_Rate,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>      Final_Error_Rate,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>      Final_True_Violation_Rate,   <span class="co"># âœ… NEW</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>      Successful_Replications</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()  </span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the flextable</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_header_labels</span>(</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_numeric =</span> <span class="st">"N"</span>,</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">Population =</span> <span class="st">"T11"</span>,  </span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Rows =</span> <span class="st">"N Reps"</span>,</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">Violation_Rate =</span> <span class="st">"V %"</span>,</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">LL_Failure_Rate =</span> <span class="st">"â„’â‚— %"</span>,</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">Error_Rate =</span> <span class="st">"\u03B5 %"</span>,</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">True_Violation_Rate =</span> <span class="st">"\u03C4áµ¥ %"</span>,   <span class="co"># âœ… NEW</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">Reps_Needed_for_Success =</span> <span class="st">"Reps Needed"</span>,</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">Final_Violation_Rate =</span> <span class="st">"V %"</span>,</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">Final_LL_Failure_Rate =</span> <span class="st">"â„’â‚— %"</span>,</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">Final_Error_Rate =</span> <span class="st">"\u03B5 %"</span>,</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">Final_True_Violation_Rate =</span> <span class="st">"\u03C4áµ¥ %"</span>,  <span class="co"># âœ… NEW</span></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">Successful_Replications =</span> <span class="st">"Successful Reps"</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply special formatting to headers</span></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"N"</span>)))</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"T"</span>), <span class="fu">as_sub</span>(<span class="st">"11"</span>)))</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_Rows"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"N"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Reps"</span>))</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Violation_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>), <span class="st">"%"</span>))</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"LL_Failure_Rate"</span>, </span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>              <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"â„’"</span>), <span class="fu">as_chunk</span>(<span class="st">"l"</span>, <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">10</span>, <span class="at">vertical.align =</span> <span class="st">"subscript"</span>)), <span class="st">"%"</span>))</span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Error_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>), <span class="st">"%"</span>))</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"True_Violation_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="st">"áµ¥"</span>), <span class="st">"%"</span>))  <span class="co"># âœ… NEW</span></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Final_Violation_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>), <span class="st">"%"</span>))</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Final_LL_Failure_Rate"</span>, </span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>              <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"â„’"</span>), <span class="fu">as_chunk</span>(<span class="st">"l"</span>, <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">10</span>, <span class="at">vertical.align =</span> <span class="st">"subscript"</span>)), <span class="st">"%"</span>))</span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Final_Error_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>), <span class="st">"%"</span>))</span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Final_True_Violation_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="st">"áµ¥"</span>), <span class="st">"%"</span>))  <span class="co"># âœ… NEW</span></span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Reps_Needed_for_Success"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"N"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Reps 2"</span>))</span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Successful_Replications"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Successful"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Reps"</span>))</span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set column widths</span></span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)  </span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_Rows"</span>, <span class="at">width =</span> <span class="fl">0.6</span>) </span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Violation_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"LL_Failure_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Error_Rate"</span>, <span class="at">width =</span> <span class="fl">0.4</span>)</span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"True_Violation_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)  <span class="co"># âœ… NEW</span></span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Reps_Needed_for_Success"</span>, <span class="at">width =</span> .<span class="dv">7</span>)</span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Final_Violation_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Final_LL_Failure_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Final_Error_Rate"</span>, <span class="at">width =</span> <span class="fl">0.4</span>)</span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Final_True_Violation_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)  <span class="co"># âœ… NEW</span></span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Successful_Replications"</span>, <span class="at">width =</span> .<span class="dv">6</span>)</span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Correct vertical centering: Merge "N = _" across 6-row blocks**</span></span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">merge_v</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>)  </span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Ensure "N = ..." appears only ONCE in the center of the 6-row block**</span></span>
<span id="cb49-78"><a href="#cb49-78" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(</span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a>  ft,</span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">part =</span> <span class="st">"body"</span>,</span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">j =</span> <span class="st">"N_numeric"</span>,</span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(data), <span class="at">by =</span> <span class="dv">6</span>),  <span class="co"># Every 6th row</span></span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">as_paragraph</span>(</span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_i</span>(<span class="st">"N"</span>),  </span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">" =\u2009"</span>,  <span class="co"># THIN SPACE (Unicode U+2009)</span></span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(N_numeric, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)  <span class="co"># Updated</span></span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Fully remove duplicate N values in merged rows**</span></span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(</span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">part =</span> <span class="st">"body"</span>,</span>
<span id="cb49-94"><a href="#cb49-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">j =</span> <span class="st">"N_numeric"</span>,</span>
<span id="cb49-95"><a href="#cb49-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(data), <span class="at">by =</span> <span class="dv">6</span>)),  </span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">""</span>)</span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-98"><a href="#cb49-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-99"><a href="#cb49-99" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Align vertically centered**</span></span>
<span id="cb49-100"><a href="#cb49-100" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">valign</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">valign =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb49-101"><a href="#cb49-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-102"><a href="#cb49-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Center all text</span></span>
<span id="cb49-103"><a href="#cb49-103" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">align</span>(ft, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb49-104"><a href="#cb49-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-105"><a href="#cb49-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-106"><a href="#cb49-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply percentage formatting</span></span>
<span id="cb49-107"><a href="#cb49-107" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">colformat_num</span>(</span>
<span id="cb49-108"><a href="#cb49-108" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb49-109"><a href="#cb49-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">j =</span> <span class="fu">c</span>(<span class="st">"Violation_Rate"</span>, <span class="st">"LL_Failure_Rate"</span>, <span class="st">"Error_Rate"</span>, <span class="st">"True_Violation_Rate"</span>,</span>
<span id="cb49-110"><a href="#cb49-110" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Final_Violation_Rate"</span>, <span class="st">"Final_LL_Failure_Rate"</span>, <span class="st">"Final_Error_Rate"</span>, <span class="st">"Final_True_Violation_Rate"</span>),  </span>
<span id="cb49-111"><a href="#cb49-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="st">"%"</span>  </span>
<span id="cb49-112"><a href="#cb49-112" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-113"><a href="#cb49-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-114"><a href="#cb49-114" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">add_header_row</span>(</span>
<span id="cb49-115"><a href="#cb49-115" aria-hidden="true" tabindex="-1"></a>  ft,</span>
<span id="cb49-116"><a href="#cb49-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">values =</span> <span class="fu">c</span>(<span class="st">" "</span>, <span class="st">"Initial Reps"</span>, <span class="st">"Final Reps"</span>, <span class="st">" "</span>),</span>
<span id="cb49-117"><a href="#cb49-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb49-118"><a href="#cb49-118" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-119"><a href="#cb49-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-120"><a href="#cb49-120" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define a transparent border</span></span>
<span id="cb49-121"><a href="#cb49-121" aria-hidden="true" tabindex="-1"></a>  no_border <span class="ot">&lt;-</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">width =</span> <span class="dv">0</span>)</span>
<span id="cb49-122"><a href="#cb49-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-123"><a href="#cb49-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Remove ONLY the bottom border under the first three columns (the blank subheader)**</span></span>
<span id="cb49-124"><a href="#cb49-124" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">hline</span>(ft, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">border =</span> no_border, <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb49-125"><a href="#cb49-125" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">hline</span>(ft, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">j =</span> <span class="dv">13</span>, <span class="at">border =</span> no_border, <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb49-126"><a href="#cb49-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-127"><a href="#cb49-127" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Autofit table layout</span></span>
<span id="cb49-128"><a href="#cb49-128" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">set_table_properties</span>(ft, <span class="at">layout =</span> <span class="st">"fixed"</span>)</span>
<span id="cb49-129"><a href="#cb49-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-130"><a href="#cb49-130" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply font settings</span></span>
<span id="cb49-131"><a href="#cb49-131" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">font</span>(ft, <span class="at">fontname =</span> <span class="st">"Avenir Next"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb49-132"><a href="#cb49-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-133"><a href="#cb49-133" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get total number of rows</span></span>
<span id="cb49-134"><a href="#cb49-134" aria-hidden="true" tabindex="-1"></a>total_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb49-135"><a href="#cb49-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-136"><a href="#cb49-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a logical vector marking every 6 rows for coloring</span></span>
<span id="cb49-137"><a href="#cb49-137" aria-hidden="true" tabindex="-1"></a>color_rows <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>, total_rows)  </span>
<span id="cb49-138"><a href="#cb49-138" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, total_rows, <span class="at">by =</span> <span class="dv">12</span>)) {  </span>
<span id="cb49-139"><a href="#cb49-139" aria-hidden="true" tabindex="-1"></a>  color_rows[i<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># âœ… Color every 6-row block</span></span>
<span id="cb49-140"><a href="#cb49-140" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-141"><a href="#cb49-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-142"><a href="#cb49-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply background color</span></span>
<span id="cb49-143"><a href="#cb49-143" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">bg</span>(ft, <span class="at">i =</span> color_rows, <span class="at">bg =</span> <span class="st">"#f0f0f0"</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb49-144"><a href="#cb49-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-145"><a href="#cb49-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ft)</span>
<span id="cb49-146"><a href="#cb49-146" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-147"><a href="#cb49-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-148"><a href="#cb49-148" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate formatted flextable</span></span>
<span id="cb49-149"><a href="#cb49-149" aria-hidden="true" tabindex="-1"></a>violation_summary_final_table <span class="ot">&lt;-</span> <span class="fu">create_flextable</span>(violation_summary_final)</span>
<span id="cb49-150"><a href="#cb49-150" aria-hidden="true" tabindex="-1"></a>violation_summary_final_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-1a230f38{}.cl-1a163b50{font-family:'Avenir Next';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1a163b64{font-family:'Avenir Next';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1a163b6e{font-family:'Avenir Next';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;top:3.3pt;}.cl-1a163b6f{font-family:'Arial';font-size:6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;top:3pt;}.cl-1a19ead4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1a1a0ef6{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f00{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f0a{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f0b{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f14{width:0.7in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f1e{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f28{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f32{width:1in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f3c{width:0.6in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f3d{width:0.4in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f3e{width:0.7in;background-color:rgba(240, 240, 240, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f46{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f50{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f51{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f5a{width:0.7in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f5b{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f64{width:0.6in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f65{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a1a0f6e{width:0.7in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-1a230f38"><thead><tr style="overflow-wrap:break-word;"><th colspan="2" class="cl-1a1a0ef6"><p class="cl-1a19ead4"><span class="cl-1a163b50"> </span></p></th><th colspan="5" class="cl-1a1a0f0a"><p class="cl-1a19ead4"><span class="cl-1a163b50">Initial Reps</span></p></th><th colspan="5" class="cl-1a1a0f14"><p class="cl-1a19ead4"><span class="cl-1a163b50">Final Reps</span></p></th><th class="cl-1a1a0f00"><p class="cl-1a19ead4"><span class="cl-1a163b50"> </span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-1a1a0f1e"><p class="cl-1a19ead4"><span class="cl-1a163b64">N</span></p></th><th class="cl-1a1a0f28"><p class="cl-1a19ead4"><span class="cl-1a163b64">T</span><span class="cl-1a163b6e">11</span></p></th><th class="cl-1a1a0f0a"><p class="cl-1a19ead4"><span class="cl-1a163b64">N</span><br><span class="cl-1a163b50">Reps</span></p></th><th class="cl-1a1a0f0a"><p class="cl-1a19ead4"><span class="cl-1a163b64">V</span><span class="cl-1a163b50">%</span></p></th><th class="cl-1a1a0f0a"><p class="cl-1a19ead4"><span class="cl-1a163b64">â„’</span><span class="cl-1a163b6f">l</span><span class="cl-1a163b50">%</span></p></th><th class="cl-1a1a0f0b"><p class="cl-1a19ead4"><span class="cl-1a163b64">Îµ</span><span class="cl-1a163b50">%</span></p></th><th class="cl-1a1a0f0a"><p class="cl-1a19ead4"><span class="cl-1a163b64">Ï„</span><span class="cl-1a163b6e">áµ¥</span><span class="cl-1a163b50">%</span></p></th><th class="cl-1a1a0f14"><p class="cl-1a19ead4"><span class="cl-1a163b64">N</span><br><span class="cl-1a163b50">Reps 2</span></p></th><th class="cl-1a1a0f0a"><p class="cl-1a19ead4"><span class="cl-1a163b64">V</span><span class="cl-1a163b50">%</span></p></th><th class="cl-1a1a0f0a"><p class="cl-1a19ead4"><span class="cl-1a163b64">â„’</span><span class="cl-1a163b6f">l</span><span class="cl-1a163b50">%</span></p></th><th class="cl-1a1a0f0b"><p class="cl-1a19ead4"><span class="cl-1a163b64">Îµ</span><span class="cl-1a163b50">%</span></p></th><th class="cl-1a1a0f0a"><p class="cl-1a19ead4"><span class="cl-1a163b64">Ï„</span><span class="cl-1a163b6e">áµ¥</span><span class="cl-1a163b50">%</span></p></th><th class="cl-1a1a0f28"><p class="cl-1a19ead4"><span class="cl-1a163b50">Successful</span><br><span class="cl-1a163b50">Reps</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-1a1a0f32"><p class="cl-1a19ead4"><span class="cl-1a163b64">N</span><span class="cl-1a163b50"> =â€‰</span><span class="cl-1a163b50">500 </span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.200</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">26.6%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">26.6%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">822</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">26.0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">26.0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">608</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.300</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">23.8%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">23.8%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">787</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">24.3%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">24.3%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">596</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.400</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.0%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">765</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.2%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.2%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">595</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.600</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.6%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.6%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">809</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.6%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.6%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">602</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.700</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.8%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.8%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">762</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.8%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.8%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">596</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.800</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">16.8%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">16.8%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">703</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">16.8%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">16.8%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">585</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-1a1a0f46"><p class="cl-1a19ead4"><span class="cl-1a163b64">N</span><span class="cl-1a163b50"> =â€‰</span><span class="cl-1a163b50">1000</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.200</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.0%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">802</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">26.9%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">26.9%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">586</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.300</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.4%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.4%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">770</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.2%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.2%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">607</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.400</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.4%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.4%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">770</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.8%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.8%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">602</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.600</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.6%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.6%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">809</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">23.2%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">23.2%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">621</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.700</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">19.6%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">19.6%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">736</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">20.1%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">20.1%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">588</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.800</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">16.8%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">16.8%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">703</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">16.4%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">16.4%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">588</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-1a1a0f32"><p class="cl-1a19ead4"><span class="cl-1a163b64">N</span><span class="cl-1a163b50"> =â€‰</span><span class="cl-1a163b50">2000</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.200</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">29.2%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">29.2%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">855</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">27.0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">27.0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">624</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.300</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">19.2%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">19.2%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">731</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">20.0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">20.0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">585</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.400</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">18.4%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">18.4%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">721</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">18.6%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">18.6%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">587</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.600</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.6%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.6%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">760</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.7%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">21.7%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">595</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.700</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.0%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">765</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">20.1%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">20.1%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">611</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">.800</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">14.8%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">14.8%</span></p></td><td class="cl-1a1a0f3e"><p class="cl-1a19ead4"><span class="cl-1a163b50">679</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">14.4%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3d"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">14.4%</span></p></td><td class="cl-1a1a0f3c"><p class="cl-1a19ead4"><span class="cl-1a163b50">581</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-1a1a0f5b"><p class="cl-1a19ead4"><span class="cl-1a163b64">N</span><span class="cl-1a163b50"> =â€‰</span><span class="cl-1a163b50">4000</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.200</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">19.4%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">19.4%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">733</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">19.0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">19.0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">594</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.300</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">18.0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">18.0%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">717</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">17.0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">17.0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">595</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.400</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">18.2%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">18.2%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">719</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">17.5%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">17.5%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">593</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.600</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.8%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.8%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">812</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.5%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">25.5%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">605</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">.700</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">24.0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">24.0%</span></p></td><td class="cl-1a1a0f5a"><p class="cl-1a19ead4"><span class="cl-1a163b50">789</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.2%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f51"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">22.2%</span></p></td><td class="cl-1a1a0f50"><p class="cl-1a19ead4"><span class="cl-1a163b50">614</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1a1a0f64"><p class="cl-1a19ead4"><span class="cl-1a163b50">.800</span></p></td><td class="cl-1a1a0f64"><p class="cl-1a19ead4"><span class="cl-1a163b50">500</span></p></td><td class="cl-1a1a0f64"><p class="cl-1a19ead4"><span class="cl-1a163b50">15.2%</span></p></td><td class="cl-1a1a0f64"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f65"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f64"><p class="cl-1a19ead4"><span class="cl-1a163b50">15.2%</span></p></td><td class="cl-1a1a0f6e"><p class="cl-1a19ead4"><span class="cl-1a163b50">684</span></p></td><td class="cl-1a1a0f64"><p class="cl-1a19ead4"><span class="cl-1a163b50">15.5%</span></p></td><td class="cl-1a1a0f64"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f65"><p class="cl-1a19ead4"><span class="cl-1a163b50">0%</span></p></td><td class="cl-1a1a0f64"><p class="cl-1a19ead4"><span class="cl-1a163b50">15.5%</span></p></td><td class="cl-1a1a0f64"><p class="cl-1a19ead4"><span class="cl-1a163b50">578</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Save FINAL table</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the flextable as an SVG</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">save_as_image</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  violation_summary_final_table,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="fu">here</span>(<span class="st">"Simulations"</span>, <span class="st">"STUDY_1"</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zErrors"</span>, <span class="st">"zl_l_e&amp;v_FINAL.svg"</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the flextable as a Word document</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co">#invisible(flextable::save_as_xlsx(</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a> <span class="co"># violation_summary_final_table,</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#path = here("Simulations", "STUDY_1", "2 Time Points", "zErrors", "zl_l_e&amp;v_FINAL.docx")</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co">#))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="final-data-preparation" class="level1">
<h1>Final Data Preparation</h1>
<hr>
<section id="filter-cases-with-violations-and-errors" class="level2">
<h2 class="anchored" data-anchor-id="filter-cases-with-violations-and-errors">Filter Cases with Violations and Errors</h2>
<p><em>Filter out cases with any violations, leaving only the clean data.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out cases with no violations and no errors</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>filtered_data_with_no_violations <span class="ot">&lt;-</span> final_data_with_actuals[</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  final_data_with_actuals<span class="sc">$</span>True_Violation <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the number of remaining rows after filtering</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Remaining rows after filtering:"</span>, <span class="fu">nrow</span>(filtered_data_with_no_violations), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Remaining rows after filtering: 14336 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify if there are any remaining violations or errors</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Any remaining violations:"</span>, <span class="fu">sum</span>(filtered_data_with_no_violations<span class="sc">$</span>True_Violation), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Any remaining violations: 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Any remaining errors:"</span>, <span class="fu">sum</span>(filtered_data_with_no_violations<span class="sc">$</span>ErrorFlag), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Any remaining errors: 0 </code></pre>
</div>
</div>
<hr>
</section>
<section id="calculate-monte-carlo-values-via-bootstrapping" class="level2">
<h2 class="anchored" data-anchor-id="calculate-monte-carlo-values-via-bootstrapping">Calculate Monte Carlo Values via Bootstrapping</h2>
<p><em>Calculate Monte Carlo values for&nbsp;<code>TRANS11</code>, including population values, averages, standard errors, Mean Squared Error (MSE), coverage, power, and dichotomous variables for Power and Coverage,</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create a function that calculates mc_values from raw replication-level data</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>calc_mc_values <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step A: Clean and convert columns as needed</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  cleaned_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">Population =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Population)),</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">TRANS11 =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(TRANS11)),</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE_11 =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(SE_11))</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step B: Compute group-level summaries (without grouping by Transitions)</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  mc_values <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Population, N) <span class="sc">%&gt;%</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">group_size   =</span> <span class="fu">n</span>(),</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">average      =</span> <span class="fu">round</span>(<span class="fu">mean</span>(TRANS11, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">average_SE   =</span> <span class="fu">round</span>(<span class="fu">mean</span>(SE_11, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">population_sd=</span> <span class="fu">round</span>(<span class="fu">sd</span>(TRANS11, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">MSE          =</span> <span class="fu">round</span>(<span class="fu">mean</span>((TRANS11 <span class="sc">-</span> Population)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">Coverage     =</span> <span class="fu">round</span>(<span class="fu">mean</span>((Population <span class="sc">&gt;=</span> (TRANS11 <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> SE_11)) <span class="sc">&amp;</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>                                  (Population <span class="sc">&lt;=</span> (TRANS11 <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> SE_11)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Power        =</span> <span class="fu">round</span>(<span class="fu">mean</span>(TRANS11 <span class="sc">/</span> SE_11 <span class="sc">&gt;</span> <span class="fl">1.96</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">Reps_Used    =</span> <span class="fu">n</span>(),</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step C: Merge in Transitions from the raw data (or from an auxiliary table if needed)</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>  mc_values <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FileName, Population, N, Transitions) <span class="sc">%&gt;%</span></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">right_join</span>(mc_values, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Population"</span>, <span class="st">"N"</span>))</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step D: Calculate bias measures</span></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>  mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter_Bias_boot =</span> <span class="fu">round</span>((average <span class="sc">-</span> Population) <span class="sc">/</span> Population <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE_Bias_boot        =</span> <span class="fu">round</span>((average_SE <span class="sc">-</span> population_sd) <span class="sc">/</span> (population_sd <span class="sc">+</span> <span class="fl">1e-6</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (Optional: add any further transformations or dichotomizations)</span></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mc_values)</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create a parallelized bootstrap function that uses the above calculation on bootstrap samples</span></span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>bootstrap_mc_values <span class="ot">&lt;-</span> <span class="cf">function</span>(data, n_bootstrap, sample_size) {</span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step A: Detect available cores and create a parallel cluster</span></span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a>  num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Use one less than total cores to avoid overloading the system</span></span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a>  cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>)  <span class="co"># Use FORK for Mac/Linux, PSOCK for Windows</span></span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a>  cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)  <span class="co"># Create the cluster</span></span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step B: Export necessary functions and objects to the cluster workers</span></span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"calc_mc_values"</span>, <span class="st">"sample_n"</span>, <span class="st">"%&gt;%"</span>, <span class="st">"filtered_data_with_no_violations"</span>))</span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clusterEvalQ</span>(cl, { <span class="fu">library</span>(dplyr) })  <span class="co"># Ensure each worker loads the required package</span></span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step C: Group data by condition variables (Population, N, Transitions)</span></span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a>  grouped_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb57-62"><a href="#cb57-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Population, N, Transitions) <span class="sc">%&gt;%</span></span>
<span id="cb57-63"><a href="#cb57-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_split</span>()  <span class="co"># Split data so each group runs separately in parallel</span></span>
<span id="cb57-64"><a href="#cb57-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-65"><a href="#cb57-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step D: Perform bootstrapping in parallel across worker nodes</span></span>
<span id="cb57-66"><a href="#cb57-66" aria-hidden="true" tabindex="-1"></a>  boot_results <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, grouped_data, <span class="cf">function</span>(group_data) {</span>
<span id="cb57-67"><a href="#cb57-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>n_bootstrap, <span class="cf">function</span>(i) {</span>
<span id="cb57-68"><a href="#cb57-68" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Step D1: Draw a bootstrap sample (with replacement) from the replications in this condition</span></span>
<span id="cb57-69"><a href="#cb57-69" aria-hidden="true" tabindex="-1"></a>      boot_sample <span class="ot">&lt;-</span> group_data <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(sample_size, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-70"><a href="#cb57-70" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb57-71"><a href="#cb57-71" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Step D2: Calculate MC values for the bootstrap sample</span></span>
<span id="cb57-72"><a href="#cb57-72" aria-hidden="true" tabindex="-1"></a>      boot_mc <span class="ot">&lt;-</span> <span class="fu">calc_mc_values</span>(boot_sample)</span>
<span id="cb57-73"><a href="#cb57-73" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb57-74"><a href="#cb57-74" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Step D3: Add Bootstrap Iteration number</span></span>
<span id="cb57-75"><a href="#cb57-75" aria-hidden="true" tabindex="-1"></a>      boot_mc <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Bootstrap_Iteration =</span> i)</span>
<span id="cb57-76"><a href="#cb57-76" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb57-77"><a href="#cb57-77" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span></span>
<span id="cb57-78"><a href="#cb57-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()  <span class="co"># Step E: Combine results from all parallel workers into a single dataframe</span></span>
<span id="cb57-79"><a href="#cb57-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-80"><a href="#cb57-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step F: Stop the parallel cluster to free system resources</span></span>
<span id="cb57-81"><a href="#cb57-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopCluster</span>(cl)</span>
<span id="cb57-82"><a href="#cb57-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-83"><a href="#cb57-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step G: Return the final bootstrapped MC values</span></span>
<span id="cb57-84"><a href="#cb57-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(boot_results)</span>
<span id="cb57-85"><a href="#cb57-85" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-86"><a href="#cb57-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-87"><a href="#cb57-87" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Run the bootstrap procedure on your raw replication-level data</span></span>
<span id="cb57-88"><a href="#cb57-88" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">07252005</span>)</span>
<span id="cb57-89"><a href="#cb57-89" aria-hidden="true" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">bootstrap_mc_values</span>(filtered_data_with_no_violations, <span class="at">n_bootstrap =</span> <span class="dv">1000</span>, <span class="at">sample_size =</span> <span class="dv">500</span>)</span>
<span id="cb57-90"><a href="#cb57-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-91"><a href="#cb57-91" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Aggregate the bootstrap results to get mean bootstrap estimates per condition:</span></span>
<span id="cb57-92"><a href="#cb57-92" aria-hidden="true" tabindex="-1"></a>bootstrap_aggregates <span class="ot">&lt;-</span> boot_results <span class="sc">%&gt;%</span></span>
<span id="cb57-93"><a href="#cb57-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Population, N, Transitions) <span class="sc">%&gt;%</span></span>
<span id="cb57-94"><a href="#cb57-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb57-95"><a href="#cb57-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">Parameter_Bias =</span> <span class="fu">mean</span>(Parameter_Bias_boot, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb57-96"><a href="#cb57-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_Bias       =</span> <span class="fu">mean</span>(SE_Bias_boot, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb57-97"><a href="#cb57-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb57-98"><a href="#cb57-98" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-99"><a href="#cb57-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-100"><a href="#cb57-100" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Calculate your original mc_values (using the full replication set) for comparison:</span></span>
<span id="cb57-101"><a href="#cb57-101" aria-hidden="true" tabindex="-1"></a>original_mc_values <span class="ot">&lt;-</span> <span class="fu">calc_mc_values</span>(filtered_data_with_no_violations)</span>
<span id="cb57-102"><a href="#cb57-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-103"><a href="#cb57-103" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Merge the bootstrap aggregates back to the original values (if desired)</span></span>
<span id="cb57-104"><a href="#cb57-104" aria-hidden="true" tabindex="-1"></a>final_mc_values <span class="ot">&lt;-</span> original_mc_values <span class="sc">%&gt;%</span></span>
<span id="cb57-105"><a href="#cb57-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bootstrap_aggregates, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Population"</span>, <span class="st">"N"</span>, <span class="st">"Transitions"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb57-106"><a href="#cb57-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-107"><a href="#cb57-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">Power_Dic    =</span> <span class="fu">ifelse</span>(Power <span class="sc">&gt;=</span> <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb57-108"><a href="#cb57-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coverage_Dic =</span> <span class="fu">ifelse</span>(Coverage <span class="sc">&gt;</span> <span class="fl">0.98</span> <span class="sc">|</span> Coverage <span class="sc">&lt;</span> <span class="fl">0.91</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb57-109"><a href="#cb57-109" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-110"><a href="#cb57-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-111"><a href="#cb57-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Save or inspect the results</span></span>
<span id="cb57-112"><a href="#cb57-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Save results</span></span>
<span id="cb57-113"><a href="#cb57-113" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(final_mc_values, <span class="fu">here</span>(<span class="st">"Simulations"</span>, <span class="st">"STUDY_1"</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zbootstrapping"</span>, <span class="st">"l_l_2t_mc_final_mc_values.csv"</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-114"><a href="#cb57-114" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(boot_results, <span class="fu">here</span>(<span class="st">"Simulations"</span>, <span class="st">"STUDY_1"</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zbootstrapping"</span>, <span class="st">"l_l_2t_boot_results.csv"</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="prepare-data-for-visualization" class="level2">
<h2 class="anchored" data-anchor-id="prepare-data-for-visualization">Prepare Data for Visualization</h2>
<section id="subset-data-for-bias-plots" class="level3">
<h3 class="anchored" data-anchor-id="subset-data-for-bias-plots">Subset Data for Bias Plots</h3>
<p><em>Subset the Monte Carlo data into mover transition probabilities (.2, .3, .4) and stayer transition probabilities (.6, .7, .8) based on population values</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming Population is numeric in all_data</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> final_mc_values</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that the Population_Label uses numeric levels without leading zeros but assigns expression-based labels</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>Population_Label <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_data<span class="sc">$</span>Population, </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>),  <span class="co"># Numeric levels without leading zeros</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .200"</span>),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .300"</span>),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .400"</span>),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .600"</span>),</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .700"</span>),</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .800"</span>)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that N is consistently factored and ordered</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>N <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_data<span class="sc">$</span>N, </span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>, <span class="st">"N = 4000"</span>)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Population, N)</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset for Transitions movers (already correctly defined as "Mover")</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>subset_mover <span class="ot">&lt;-</span> <span class="fu">subset</span>(all_data, Transitions <span class="sc">==</span> <span class="st">"Mover"</span>)</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset for Transitions stayers (already correctly defined as "Stayer")</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>subset_stayer <span class="ot">&lt;-</span> <span class="fu">subset</span>(all_data, Transitions <span class="sc">==</span> <span class="st">"Stayer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prepare-function-for-bias-plots" class="level3">
<h3 class="anchored" data-anchor-id="prepare-function-for-bias-plots">Prepare Function for Bias Plots</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>create_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title_suffix) {</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Common theme for the plots</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  common_theme <span class="ot">&lt;-</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">10</span>),</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Detect which legend items to show</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span>, <span class="st">"Standard Error Bias"</span>)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(data<span class="sc">$</span>Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>)) present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(present_categories, <span class="st">"Coverage Failure"</span>)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(data<span class="sc">$</span>Power_Dic <span class="sc">==</span> <span class="dv">0</span>)) present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(present_categories, <span class="st">"Power Failure"</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define colors and shapes for different categories</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>  colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span> <span class="ot">=</span> <span class="st">"#7030A0"</span>, <span class="st">"Standard Error Bias"</span> <span class="ot">=</span> <span class="st">"#C830CC"</span>, </span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Coverage Failure"</span> <span class="ot">=</span> <span class="st">"#7030A0"</span>, <span class="st">"Power Failure"</span> <span class="ot">=</span> <span class="st">"black"</span>)</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"Standard Error Bias"</span> <span class="ot">=</span> <span class="dv">18</span>, </span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Coverage Failure"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Power Failure"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter colors and shapes based on detected categories</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  filtered_colors <span class="ot">&lt;-</span> colors[present_categories]</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>  filtered_shapes <span class="ot">&lt;-</span> shapes[present_categories]</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(N))) <span class="sc">+</span>  </span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Parameter Bias"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span>  </span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> SE_Bias, <span class="at">color =</span> <span class="st">"Standard Error Bias"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span>  </span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Parameter Bias"</span>), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">fill =</span> <span class="st">"#7030A0"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> SE_Bias, <span class="at">color =</span> <span class="st">"Standard Error Bias"</span>), <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">fill =</span> <span class="st">"#C830CC"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Coverage Failure"</span>), <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"#7030A0"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Power_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Power Failure"</span>), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Coverage Failure"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Power_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Power Failure"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> filtered_colors, </span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> present_categories, </span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> present_categories,</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> filtered_shapes)</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span>  </span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Bias (%)"</span>,</span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"LTA Generated, LTA Analyzed with"</span>, title_suffix, <span class="st">"Transition Probabilities"</span>)</span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>)) <span class="sc">+</span>  </span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">as.character</span>(Population_Label), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span>  </span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 500"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 1000"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 2000"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 4000"</span>))) <span class="sc">+</span>  </span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span>  </span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a>    common_theme <span class="sc">+</span></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#7030A0"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  </span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#C830CC"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"outside"</span>, </span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="render-bias-figures" class="level3">
<h3 class="anchored" data-anchor-id="render-bias-figures">Render Bias Figures</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and print plot for Mover</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>plot_mover <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(subset_mover, <span class="st">"Mover"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-format: svg</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_mover)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Study_1_2T_LTA_LTA_files/figure-html/plot-movers-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove title for the saved version</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>plot_mover_no_title <span class="ot">&lt;-</span> plot_mover <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Mover plot without title as .svg</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zFigures"</span>, <span class="st">"x2t_lta_lta_plots"</span>, <span class="st">"plot_mover.svg"</span>), <span class="at">plot =</span> plot_mover_no_title, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> <span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and print plot for Stayer</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>plot_stayer <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(subset_stayer, <span class="st">"Stayer"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-format: svg</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_stayer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Study_1_2T_LTA_LTA_files/figure-html/plot-stayers-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove title for the saved version</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>plot_stayer_no_title <span class="ot">&lt;-</span> plot_stayer <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Stayer plot without title as .svg</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zFigures"</span>, <span class="st">"x2t_lta_lta_plots"</span>, <span class="st">"plot_stayer.svg"</span>), <span class="at">plot =</span> plot_stayer_no_title, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> <span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="prepare-data-for-heat-maps" class="level2">
<h2 class="anchored" data-anchor-id="prepare-data-for-heat-maps"><strong>Prepare Data for Heat Maps</strong></h2>
<p><em>Prepare data for heat map creation by ensuring correct formatting for population values, and subsetting the data based on class proportions and sample sizes.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Separate the movers and stayers and ensure sorting by N and Population for each transition</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>movers <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Transitions <span class="sc">==</span> <span class="st">"Mover"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, N)), Population)  <span class="co"># Sort movers by numeric N and Population</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>stayers <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Transitions <span class="sc">==</span> <span class="st">"Stayer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, N)), Population)  <span class="co"># Sort stayers by numeric N and Population</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Assign N_Label only once for each N within Movers and Stayers</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>movers <span class="ot">&lt;-</span> movers <span class="sc">%&gt;%</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(N) <span class="sc">%&gt;%</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_Label =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">2</span>, <span class="fu">as.character</span>(N), <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>stayers <span class="ot">&lt;-</span> stayers <span class="sc">%&gt;%</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(N) <span class="sc">%&gt;%</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_Label =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">2</span>, <span class="fu">as.character</span>(N), <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Combine movers and stayers back into one dataset, keeping them separate by transitions</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>all_data_sorted <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(movers, stayers)</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Select necessary columns for the final display</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>test_map <span class="ot">&lt;-</span> <span class="fu">select</span>(all_data_sorted, N_Label, Population, average, Coverage, Power, Parameter_Bias, SE_Bias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="prepare-function-for-heat-map-creation" class="level3">
<h3 class="anchored" data-anchor-id="prepare-function-for-heat-map-creation">Prepare Function for Heat Map Creation</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create gt table based on subset data</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>create_gt_table <span class="ot">&lt;-</span> <span class="cf">function</span>(subset, transition_probability) {</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the gt object and set initial formatting</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  gt_table <span class="ot">&lt;-</span> subset <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opt_table_font</span>(<span class="at">stack =</span> <span class="st">"geometric-humanist"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"LTA Generated &amp; LTA Analyzed with Transition Probability of"</span>, transition_probability)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_Label =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">Population =</span> <span class="st">"Transition"</span>,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">average =</span> <span class="st">"Estimated&lt;br&gt;Probability"</span>,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">Coverage =</span> <span class="st">"Coverage"</span>,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">Power =</span> <span class="st">"Power"</span>,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter_Bias =</span> <span class="st">"Parameter &lt;br&gt;Bias"</span>,</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE_Bias =</span> <span class="st">"Standard Error&lt;br&gt;Bias"</span>,</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fn =</span> md</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Bias"</span>,</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Parameter_Bias"</span>, <span class="st">"SE_Bias"</span>)</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Stayer Probabilities"</span>,  <span class="co"># Label for the first subgroup</span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>)  <span class="co"># Rows corresponding to the first subgroup</span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Mover Probabilities"</span>,  <span class="co"># Label for the second subgroup</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)  <span class="co"># Rows corresponding to the second subgroup</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">font =</span> <span class="st">"bold italic"</span>  <span class="co"># Apply bold and italic styling</span></span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_row_groups</span>()  <span class="co"># Apply style to row subheaders</span></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Parameter_Bias"</span>, <span class="st">"SE_Bias"</span>), <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">4</span>, <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_options</span>(</span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.striping.include_table_body =</span> <span class="cn">FALSE</span>,  <span class="co"># Disables row striping</span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">table_body.hlines.color =</span> <span class="st">"white"</span>,  </span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">table.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">table.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">table_body.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">heading.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">column_labels.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">column_labels.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">row_group.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">row_group.border.top.color =</span> <span class="st">"black"</span></span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"center"</span>),</span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply color highlighting for violations in Parameter Bias</span></span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span>(subset<span class="sc">$</span>Parameter_Bias <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">9.99</span> <span class="sc">&amp;</span> subset<span class="sc">$</span>Parameter_Bias <span class="sc">&lt;=</span> <span class="fl">9.99</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Parameter_Bias"</span>,</span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> .data<span class="sc">$</span>Parameter_Bias <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">9.99</span> <span class="sc">|</span> .data<span class="sc">$</span>Parameter_Bias <span class="sc">&gt;</span> <span class="fl">9.99</span>,  <span class="co"># Apply color only if outside the threshold</span></span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#113386"</span>, <span class="st">"#DAE3FA"</span>, <span class="st">"#113386"</span>),  <span class="co"># Darker blue for larger deviations</span></span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>)  <span class="co"># Adjust the domain to reflect the range of values</span></span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Darker blue indicates larger deviations from zero *Parameter Bias* beyond the Â±9.99 threshold."</span>),</span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Parameter_Bias"</span>)</span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply color highlighting for violations in SE Bias</span></span>
<span id="cb65-74"><a href="#cb65-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span>(subset<span class="sc">$</span>SE_Bias <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">4.99</span> <span class="sc">&amp;</span> subset<span class="sc">$</span>SE_Bias <span class="sc">&lt;=</span> <span class="fl">4.99</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb65-75"><a href="#cb65-75" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb65-76"><a href="#cb65-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb65-77"><a href="#cb65-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"SE_Bias"</span>,</span>
<span id="cb65-78"><a href="#cb65-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> .data<span class="sc">$</span>SE_Bias <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">4.99</span> <span class="sc">|</span> .data<span class="sc">$</span>SE_Bias <span class="sc">&gt;</span> <span class="fl">4.99</span>,  <span class="co"># Apply color only if outside the threshold</span></span>
<span id="cb65-79"><a href="#cb65-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb65-80"><a href="#cb65-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#781049"</span>, <span class="st">"#FDEAF4"</span>, <span class="st">"#781049"</span>),  <span class="co"># Darker red for larger deviations</span></span>
<span id="cb65-81"><a href="#cb65-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>, <span class="dv">80</span>)  <span class="co"># Adjust the domain for the SE_Bias range</span></span>
<span id="cb65-82"><a href="#cb65-82" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb65-83"><a href="#cb65-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb65-84"><a href="#cb65-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Darker red indicates larger deviations from zero *Standard Error Bias* beyond the Â±4.99 threshold."</span>),</span>
<span id="cb65-85"><a href="#cb65-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"SE_Bias"</span>)</span>
<span id="cb65-86"><a href="#cb65-86" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb65-87"><a href="#cb65-87" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-88"><a href="#cb65-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-89"><a href="#cb65-89" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(subset<span class="sc">$</span>Coverage <span class="sc">&lt;</span> <span class="fl">0.93</span> <span class="sc">|</span> subset<span class="sc">$</span>Coverage <span class="sc">&gt;</span> <span class="fl">0.979</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb65-90"><a href="#cb65-90" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb65-91"><a href="#cb65-91" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb65-92"><a href="#cb65-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Coverage"</span>,</span>
<span id="cb65-93"><a href="#cb65-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> subset<span class="sc">$</span>Coverage <span class="sc">&lt;</span> <span class="fl">0.93</span> <span class="sc">|</span> subset<span class="sc">$</span>Coverage <span class="sc">&gt;</span> <span class="fl">0.979</span>,</span>
<span id="cb65-94"><a href="#cb65-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb65-95"><a href="#cb65-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#024F2D"</span>, <span class="st">"white"</span>),  <span class="co"># Green for coverage issues</span></span>
<span id="cb65-96"><a href="#cb65-96" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb65-97"><a href="#cb65-97" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb65-98"><a href="#cb65-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb65-99"><a href="#cb65-99" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Green indicates failure to achieve adequate *Coverage*."</span>),</span>
<span id="cb65-100"><a href="#cb65-100" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Coverage"</span>)</span>
<span id="cb65-101"><a href="#cb65-101" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb65-102"><a href="#cb65-102" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-103"><a href="#cb65-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-104"><a href="#cb65-104" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(subset<span class="sc">$</span>Power <span class="sc">&lt;</span> <span class="fl">0.8</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb65-105"><a href="#cb65-105" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb65-106"><a href="#cb65-106" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb65-107"><a href="#cb65-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Power"</span>,</span>
<span id="cb65-108"><a href="#cb65-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> subset<span class="sc">$</span>Power <span class="sc">&lt;</span> <span class="fl">0.8</span>,</span>
<span id="cb65-109"><a href="#cb65-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb65-110"><a href="#cb65-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#502CD1"</span>, <span class="st">"white"</span>),  <span class="co"># Purple for power issues</span></span>
<span id="cb65-111"><a href="#cb65-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb65-112"><a href="#cb65-112" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb65-113"><a href="#cb65-113" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb65-114"><a href="#cb65-114" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Purple indicates failure to achieve adequate *Power*."</span>),</span>
<span id="cb65-115"><a href="#cb65-115" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Power"</span>)</span>
<span id="cb65-116"><a href="#cb65-116" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb65-117"><a href="#cb65-117" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-118"><a href="#cb65-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-119"><a href="#cb65-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(gt_table)</span>
<span id="cb65-120"><a href="#cb65-120" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="render-heat-map" class="level3">
<h3 class="anchored" data-anchor-id="render-heat-map">Render Heat map</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>gt_table <span class="ot">&lt;-</span> <span class="fu">create_gt_table</span>(test_map, <span class="st">"Mover &amp; Stayers"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>gt_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="swvtpsvopk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#swvtpsvopk table {
  font-family: Avenir, Montserrat, Corbel, 'URW Gothic', source-sans-pro, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#swvtpsvopk thead, #swvtpsvopk tbody, #swvtpsvopk tfoot, #swvtpsvopk tr, #swvtpsvopk td, #swvtpsvopk th {
  border-style: none;
}

#swvtpsvopk p {
  margin: 0;
  padding: 0;
}

#swvtpsvopk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#swvtpsvopk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#swvtpsvopk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#swvtpsvopk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#swvtpsvopk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#swvtpsvopk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#swvtpsvopk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#swvtpsvopk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#swvtpsvopk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#swvtpsvopk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#swvtpsvopk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#swvtpsvopk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#swvtpsvopk .gt_spanner_row {
  border-bottom-style: hidden;
}

#swvtpsvopk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#swvtpsvopk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: middle;
}

#swvtpsvopk .gt_from_md > :first-child {
  margin-top: 0;
}

#swvtpsvopk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#swvtpsvopk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#swvtpsvopk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#swvtpsvopk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#swvtpsvopk .gt_row_group_first td {
  border-top-width: 2px;
}

#swvtpsvopk .gt_row_group_first th {
  border-top-width: 2px;
}

#swvtpsvopk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#swvtpsvopk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#swvtpsvopk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#swvtpsvopk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#swvtpsvopk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#swvtpsvopk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#swvtpsvopk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#swvtpsvopk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#swvtpsvopk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#swvtpsvopk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#swvtpsvopk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#swvtpsvopk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#swvtpsvopk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#swvtpsvopk .gt_left {
  text-align: left;
}

#swvtpsvopk .gt_center {
  text-align: center;
}

#swvtpsvopk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#swvtpsvopk .gt_font_normal {
  font-weight: normal;
}

#swvtpsvopk .gt_font_bold {
  font-weight: bold;
}

#swvtpsvopk .gt_font_italic {
  font-style: italic;
}

#swvtpsvopk .gt_super {
  font-size: 65%;
}

#swvtpsvopk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#swvtpsvopk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#swvtpsvopk .gt_indent_1 {
  text-indent: 5px;
}

#swvtpsvopk .gt_indent_2 {
  text-indent: 10px;
}

#swvtpsvopk .gt_indent_3 {
  text-indent: 15px;
}

#swvtpsvopk .gt_indent_4 {
  text-indent: 20px;
}

#swvtpsvopk .gt_indent_5 {
  text-indent: 25px;
}

#swvtpsvopk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#swvtpsvopk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border">LTA Generated &amp; LTA Analyzed with Transition Probability of Mover &amp; Stayers</th>
</tr>
<tr class="odd gt_col_headings gt_spanner_row">
<th rowspan="2" id="N_Label" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Sample Size</th>
<th rowspan="2" id="Population" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Transition</th>
<th rowspan="2" id="average" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimated<br>Probability</th>
<th rowspan="2" id="Coverage" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Coverage<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th rowspan="2" id="Power" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Power</th>
<th colspan="2" id="Bias" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Bias
</div></th>
</tr>
<tr class="header gt_col_headings">
<th id="Parameter_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Parameter <br>Bias</th>
<th id="SE_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Standard Error<br>Bias</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="7" id="Mover Probabilities" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Mover Probabilities</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.2</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.199</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage" style="background-color: #ECF1ED; color: #000000">0.924</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">0.975</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’0.37</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">âˆ’1.32</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label">N = 500</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.3</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.306</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.930</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">1.83</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">âˆ’2.23</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.4</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.401</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.941</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">0.20</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">0.28</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.2</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.198</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.935</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’0.74</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">0.08</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label">N = 1000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.3</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.300</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.957</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’0.08</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">âˆ’1.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.4</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.401</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.950</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">0.22</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">1.15</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.2</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.201</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.947</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">0.39</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">2.76</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label">N = 2000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.3</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.300</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.952</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">0.10</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">1.37</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.4</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.400</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.963</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">0.01</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">4.65</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.2</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.201</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.961</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">0.56</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">2.61</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label">N = 4000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.3</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.300</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.950</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’0.09</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">âˆ’0.64</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.4</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.400</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.961</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’0.04</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">âˆ’1.37</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="7" id="Stayer Probabilities" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Stayer Probabilities</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.6</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.602</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.944</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.24</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">âˆ’1.91</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label">N = 500</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.7</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.704</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.941</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.52</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">âˆ’0.07</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.8</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.802</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.952</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.28</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">4.04</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.6</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.602</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.945</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.37</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">âˆ’0.45</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label">N = 1000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.7</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.702</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.954</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.30</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">2.92</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.8</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.802</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.942</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.30</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">2.52</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.6</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.602</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.955</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.27</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">âˆ’0.05</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label">N = 2000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.7</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.702</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.946</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.24</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">âˆ’2.95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.8</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.801</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.959</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.14</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">0.62</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.6</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.602</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.947</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.32</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">âˆ’2.88</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label">N = 4000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.7</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.702</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.951</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.30</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">âˆ’0.83</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.8</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.801</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.945</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">0.09</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">âˆ’1.47</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="7" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Green indicates failure to achieve adequate <em>Coverage</em>.</td>
</tr>
</tfoot>

</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Further operations on gt_table</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>gt_table <span class="sc">|&gt;</span> <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">75</span>)) <span class="sc">|&gt;</span> <span class="fu">gtsave</span>(<span class="fu">here</span>(<span class="st">"Simulations"</span>, <span class="st">"STUDY_1"</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zHEATMAPS"</span>, <span class="st">"z2t_heatmaps"</span>, <span class="st">"2T_L_L.png"</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb68" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Understanding the Performance of Random Intercepts Latent Transition Analysis (RI-LTA): A Monte Carlo Simulation Study using MplusAutomation"</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Study 1.1: LTA Generated, LTA Analyzed with Two Timepoints"</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Delwin Carter"</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.time(), '%B %d, %Y')`"</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Overview"</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-float:</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co">      collapsed: false</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co">      smooth-scroll: true</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: flatly</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-format: svg</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="co">    font:</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co">      main: "Avenir Next LT Pro, Arial, sans-serif"</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="an">knitr:</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="co">  opts_chunk:</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="co">    echo: true</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="co">    out.width: "100%"</span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a><span class="co">    fig.align: "center"</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>::: {layout-ncol="2"}</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/LVG%20FINAL.png)</span>{width="300"}</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/UCSB_Gauchos_logo_PNG2.png)</span>{width="300"}</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Study 1.1: LTA Generated, LTA Analyzed</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/LTA_LTA-01.png)</span>{width="324"}</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>Load Packages</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "load-libraries"</span></span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MplusAutomation)</span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tools)</span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(webshot2)</span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(officer)</span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simulation</span></span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1: Conduct Simulation</span></span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In this section, I am conducting a simulation where I am generating data as Latent Transition Analysis and analyzing it as Latent Transition Analysis to fully explore the model's performance. The simulation consists of 24 conditions, combining four sample sizes (N = 500, 1000, 2000, 4000) with six transition probabilities linked to logits (*betas;* 1.385, .85, .41, -.41, -.85, -1.385), corresponding to probabilities of .8, .7, .6, .4, .3, and .2. These conditions are iterated over programmatically using MplusAutomation to set up and execute the models. To speed up the process, I employ parallel processing, which distributes computations across multiple CPU cores, enabling efficient completion of the simulations across all scenarios.</span></span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a>Conditions:</span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a>Sample Size: N = 500, 1000, 2000, 4000</span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a>Transition logit (Probability): TPs = 1.385 (.8), .85 (.7), .41 (.6), -.41 (.4), -.85 (.3), -1.385 (.2)</span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/clipboard-3344253592.png)</span>{width="450"}</span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a><span class="fu">### Setting up the Simulation Conditions&nbsp;</span></span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-99"><a href="#cb68-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-100"><a href="#cb68-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "simulation-conditions"</span></span>
<span id="cb68-101"><a href="#cb68-101" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-102"><a href="#cb68-102" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-103"><a href="#cb68-103" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-104"><a href="#cb68-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-105"><a href="#cb68-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-106"><a href="#cb68-106" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">N =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>),</span>
<span id="cb68-107"><a href="#cb68-107" aria-hidden="true" tabindex="-1"></a><span class="at">TPs =</span> <span class="fu">c</span>(<span class="fl">1.385</span>, .<span class="dv">85</span>, .<span class="dv">41</span>, <span class="sc">-</span>.<span class="dv">41</span>, <span class="sc">-</span>.<span class="dv">85</span>, <span class="sc">-</span><span class="fl">1.385</span>),</span>
<span id="cb68-108"><a href="#cb68-108" aria-hidden="true" tabindex="-1"></a><span class="at">TH =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb68-109"><a href="#cb68-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-110"><a href="#cb68-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the matrix using gt</span></span>
<span id="cb68-111"><a href="#cb68-111" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">%&gt;%</span></span>
<span id="cb68-112"><a href="#cb68-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-113"><a href="#cb68-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-114"><a href="#cb68-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Simulation Conditions Matrix"</span>,</span>
<span id="cb68-115"><a href="#cb68-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Combinations of Sample Sizes, Transition Probabilities, and Mixtures"</span></span>
<span id="cb68-116"><a href="#cb68-116" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-117"><a href="#cb68-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb68-118"><a href="#cb68-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb68-119"><a href="#cb68-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>() <span class="co"># Centers all columns</span></span>
<span id="cb68-120"><a href="#cb68-120" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-121"><a href="#cb68-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-122"><a href="#cb68-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-123"><a href="#cb68-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-124"><a href="#cb68-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-125"><a href="#cb68-125" aria-hidden="true" tabindex="-1"></a><span class="fu">### Run Initial Simulation</span></span>
<span id="cb68-126"><a href="#cb68-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-127"><a href="#cb68-127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,eval = FALSE}</span></span>
<span id="cb68-128"><a href="#cb68-128" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: "lta-lta-simulation"</span></span>
<span id="cb68-129"><a href="#cb68-129" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb68-130"><a href="#cb68-130" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb68-131"><a href="#cb68-131" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb68-132"><a href="#cb68-132" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb68-133"><a href="#cb68-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-134"><a href="#cb68-134" aria-hidden="true" tabindex="-1"></a><span class="in">library(parallel)</span></span>
<span id="cb68-135"><a href="#cb68-135" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 1: Create the cluster for parallel processing</span></span>
<span id="cb68-136"><a href="#cb68-136" aria-hidden="true" tabindex="-1"></a><span class="in">num_cores &lt;- detectCores() - 1  # Detect the number of available cores (minus 1)</span></span>
<span id="cb68-137"><a href="#cb68-137" aria-hidden="true" tabindex="-1"></a><span class="in">cl &lt;- makeCluster(num_cores, type = "PSOCK")  # Create the PSOCK cluster</span></span>
<span id="cb68-138"><a href="#cb68-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-139"><a href="#cb68-139" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 2: Define the function for the simulation</span></span>
<span id="cb68-140"><a href="#cb68-140" aria-hidden="true" tabindex="-1"></a><span class="in">lta_lta_func &lt;- function(N, TPs, TH) {</span></span>
<span id="cb68-141"><a href="#cb68-141" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-142"><a href="#cb68-142" aria-hidden="true" tabindex="-1"></a><span class="in">  LTA_LTA &lt;- mplusObject(</span></span>
<span id="cb68-143"><a href="#cb68-143" aria-hidden="true" tabindex="-1"></a><span class="in">    TITLE = glue("Generate LTA_LTA_N_{N}_TP_{TPs}_{TH}"),</span></span>
<span id="cb68-144"><a href="#cb68-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-145"><a href="#cb68-145" aria-hidden="true" tabindex="-1"></a><span class="in">    MONTECARLO =</span></span>
<span id="cb68-146"><a href="#cb68-146" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("NAMES = u11-u15 u21-u25;</span></span>
<span id="cb68-147"><a href="#cb68-147" aria-hidden="true" tabindex="-1"></a><span class="in">      GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb68-148"><a href="#cb68-148" aria-hidden="true" tabindex="-1"></a><span class="in">      CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb68-149"><a href="#cb68-149" aria-hidden="true" tabindex="-1"></a><span class="in">      GENCLASSES = c1(2) c2(2);</span></span>
<span id="cb68-150"><a href="#cb68-150" aria-hidden="true" tabindex="-1"></a><span class="in">      CLASSES = c1(2) c2(2);</span></span>
<span id="cb68-151"><a href="#cb68-151" aria-hidden="true" tabindex="-1"></a><span class="in">      NOBSERVATIONS = {N};</span></span>
<span id="cb68-152"><a href="#cb68-152" aria-hidden="true" tabindex="-1"></a><span class="in">      SEED = 07252005;</span></span>
<span id="cb68-153"><a href="#cb68-153" aria-hidden="true" tabindex="-1"></a><span class="in">      NREPS = 500;</span></span>
<span id="cb68-154"><a href="#cb68-154" aria-hidden="true" tabindex="-1"></a><span class="in">      !!SAVE = repM1*.dat;</span></span>
<span id="cb68-155"><a href="#cb68-155" aria-hidden="true" tabindex="-1"></a><span class="in">      RESULTS = LTA_LTA_N_{N}_TP_{TPs}_TH_{TH}.csv;"),</span></span>
<span id="cb68-156"><a href="#cb68-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-157"><a href="#cb68-157" aria-hidden="true" tabindex="-1"></a><span class="in">    ANALYSIS =</span></span>
<span id="cb68-158"><a href="#cb68-158" aria-hidden="true" tabindex="-1"></a><span class="in">      "TYPE = MIXTURE;</span></span>
<span id="cb68-159"><a href="#cb68-159" aria-hidden="true" tabindex="-1"></a><span class="in">      processors = 24;</span></span>
<span id="cb68-160"><a href="#cb68-160" aria-hidden="true" tabindex="-1"></a><span class="in">      starts= 50 10;</span></span>
<span id="cb68-161"><a href="#cb68-161" aria-hidden="true" tabindex="-1"></a><span class="in">      logcriterion=0.00001;</span></span>
<span id="cb68-162"><a href="#cb68-162" aria-hidden="true" tabindex="-1"></a><span class="in">      mconv=0.00001;",</span></span>
<span id="cb68-163"><a href="#cb68-163" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb68-164"><a href="#cb68-164" aria-hidden="true" tabindex="-1"></a><span class="in">    OUTPUT = "TECH9",</span></span>
<span id="cb68-165"><a href="#cb68-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-166"><a href="#cb68-166" aria-hidden="true" tabindex="-1"></a><span class="in">    MODELPOPULATION = glue("    </span></span>
<span id="cb68-167"><a href="#cb68-167" aria-hidden="true" tabindex="-1"></a><span class="in">        %OVERALL%</span></span>
<span id="cb68-168"><a href="#cb68-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-169"><a href="#cb68-169" aria-hidden="true" tabindex="-1"></a><span class="in">       [c1#1-c2#1*0];</span></span>
<span id="cb68-170"><a href="#cb68-170" aria-hidden="true" tabindex="-1"></a><span class="in">        c2#1 on c1#1*{TPs};</span></span>
<span id="cb68-171"><a href="#cb68-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-172"><a href="#cb68-172" aria-hidden="true" tabindex="-1"></a><span class="in">      MODEL POPULATION-c1:</span></span>
<span id="cb68-173"><a href="#cb68-173" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#1%</span></span>
<span id="cb68-174"><a href="#cb68-174" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*{TH} u12$1*{TH} u13$1*{TH} u14$1*{TH} u15$1*{TH}] (p111-p115);</span></span>
<span id="cb68-175"><a href="#cb68-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-176"><a href="#cb68-176" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#2%</span></span>
<span id="cb68-177"><a href="#cb68-177" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*-{TH} u12$1*-{TH} u13$1*-{TH} u14$1*-{TH} u15$1*-{TH}] (p121-p125);</span></span>
<span id="cb68-178"><a href="#cb68-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-179"><a href="#cb68-179" aria-hidden="true" tabindex="-1"></a><span class="in">      MODEL POPULATION-c2:  </span></span>
<span id="cb68-180"><a href="#cb68-180" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#1%</span></span>
<span id="cb68-181"><a href="#cb68-181" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*{TH} u22$1*{TH} u23$1*{TH} u24$1*{TH} u25$1*{TH}] (p111-p115);</span></span>
<span id="cb68-182"><a href="#cb68-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-183"><a href="#cb68-183" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#2%</span></span>
<span id="cb68-184"><a href="#cb68-184" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*-{TH} u22$1*-{TH} u23$1*-{TH} u24$1*-{TH} u25$1*-{TH}] (p121-p125);</span></span>
<span id="cb68-185"><a href="#cb68-185" aria-hidden="true" tabindex="-1"></a><span class="in">       "),</span></span>
<span id="cb68-186"><a href="#cb68-186" aria-hidden="true" tabindex="-1"></a><span class="in">     </span></span>
<span id="cb68-187"><a href="#cb68-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-188"><a href="#cb68-188" aria-hidden="true" tabindex="-1"></a><span class="in">    MODEL =</span></span>
<span id="cb68-189"><a href="#cb68-189" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("    </span></span>
<span id="cb68-190"><a href="#cb68-190" aria-hidden="true" tabindex="-1"></a><span class="in">        %OVERALL%</span></span>
<span id="cb68-191"><a href="#cb68-191" aria-hidden="true" tabindex="-1"></a><span class="in">          [c1#1-c2#1*0](par1-par2);</span></span>
<span id="cb68-192"><a href="#cb68-192" aria-hidden="true" tabindex="-1"></a><span class="in">            c2#1 on c1#1*{TPs} (par11);</span></span>
<span id="cb68-193"><a href="#cb68-193" aria-hidden="true" tabindex="-1"></a><span class="in">            </span></span>
<span id="cb68-194"><a href="#cb68-194" aria-hidden="true" tabindex="-1"></a><span class="in">     MODEL c1:</span></span>
<span id="cb68-195"><a href="#cb68-195" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#1%</span></span>
<span id="cb68-196"><a href="#cb68-196" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*{TH} u12$1*{TH} u13$1*{TH} u14$1*{TH} u15$1*{TH}] (p111-p115);</span></span>
<span id="cb68-197"><a href="#cb68-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-198"><a href="#cb68-198" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#2%</span></span>
<span id="cb68-199"><a href="#cb68-199" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*-{TH} u12$1*-{TH} u13$1*-{TH} u14$1*-{TH} u15$1*-{TH}] (p121-p125);</span></span>
<span id="cb68-200"><a href="#cb68-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-201"><a href="#cb68-201" aria-hidden="true" tabindex="-1"></a><span class="in">    MODEL c2:   </span></span>
<span id="cb68-202"><a href="#cb68-202" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#1%</span></span>
<span id="cb68-203"><a href="#cb68-203" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*{TH} u22$1*{TH} u23$1*{TH} u24$1*{TH} u25$1*{TH}] (p111-p115);</span></span>
<span id="cb68-204"><a href="#cb68-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-205"><a href="#cb68-205" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#2%</span></span>
<span id="cb68-206"><a href="#cb68-206" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*-{TH} u22$1*-{TH} u23$1*-{TH} u24$1*-{TH} u25$1*-{TH}] (p121-p125);</span></span>
<span id="cb68-207"><a href="#cb68-207" aria-hidden="true" tabindex="-1"></a><span class="in">          "),</span></span>
<span id="cb68-208"><a href="#cb68-208" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb68-209"><a href="#cb68-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-210"><a href="#cb68-210" aria-hidden="true" tabindex="-1"></a><span class="in">    MODELCONSTRAINT =</span></span>
<span id="cb68-211"><a href="#cb68-211" aria-hidden="true" tabindex="-1"></a><span class="in">      if (TPs == 1.385) {</span></span>
<span id="cb68-212"><a href="#cb68-212" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb68-213"><a href="#cb68-213" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb68-214"><a href="#cb68-214" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.80 trans12*.20 trans21*.5 trans22*.5</span></span>
<span id="cb68-215"><a href="#cb68-215" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.65 prob22*.35);</span></span>
<span id="cb68-216"><a href="#cb68-216" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-217"><a href="#cb68-217" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb68-218"><a href="#cb68-218" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-219"><a href="#cb68-219" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb68-220"><a href="#cb68-220" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb68-221"><a href="#cb68-221" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-222"><a href="#cb68-222" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb68-223"><a href="#cb68-223" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb68-224"><a href="#cb68-224" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb68-225"><a href="#cb68-225" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb68-226"><a href="#cb68-226" aria-hidden="true" tabindex="-1"></a><span class="in">      } </span></span>
<span id="cb68-227"><a href="#cb68-227" aria-hidden="true" tabindex="-1"></a><span class="in">             else if (TPs == .85) {</span></span>
<span id="cb68-228"><a href="#cb68-228" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb68-229"><a href="#cb68-229" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb68-230"><a href="#cb68-230" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.70 trans12*.30 trans21*.5 trans22*.5</span></span>
<span id="cb68-231"><a href="#cb68-231" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.60 prob22*.4);</span></span>
<span id="cb68-232"><a href="#cb68-232" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-233"><a href="#cb68-233" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb68-234"><a href="#cb68-234" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-235"><a href="#cb68-235" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb68-236"><a href="#cb68-236" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb68-237"><a href="#cb68-237" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-238"><a href="#cb68-238" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb68-239"><a href="#cb68-239" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb68-240"><a href="#cb68-240" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb68-241"><a href="#cb68-241" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb68-242"><a href="#cb68-242" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb68-243"><a href="#cb68-243" aria-hidden="true" tabindex="-1"></a><span class="in">            else  if (TPs == .41) {</span></span>
<span id="cb68-244"><a href="#cb68-244" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb68-245"><a href="#cb68-245" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb68-246"><a href="#cb68-246" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.60 trans12*.40 trans21*.5 trans22*.5</span></span>
<span id="cb68-247"><a href="#cb68-247" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.55 prob22*.45);</span></span>
<span id="cb68-248"><a href="#cb68-248" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-249"><a href="#cb68-249" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb68-250"><a href="#cb68-250" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-251"><a href="#cb68-251" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb68-252"><a href="#cb68-252" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb68-253"><a href="#cb68-253" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-254"><a href="#cb68-254" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb68-255"><a href="#cb68-255" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb68-256"><a href="#cb68-256" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb68-257"><a href="#cb68-257" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb68-258"><a href="#cb68-258" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb68-259"><a href="#cb68-259" aria-hidden="true" tabindex="-1"></a><span class="in">             else if (TPs == -.41) {</span></span>
<span id="cb68-260"><a href="#cb68-260" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb68-261"><a href="#cb68-261" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb68-262"><a href="#cb68-262" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.40 trans12*.60 trans21*.5 trans22*.5</span></span>
<span id="cb68-263"><a href="#cb68-263" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.45 prob22*.55);</span></span>
<span id="cb68-264"><a href="#cb68-264" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-265"><a href="#cb68-265" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb68-266"><a href="#cb68-266" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-267"><a href="#cb68-267" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb68-268"><a href="#cb68-268" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb68-269"><a href="#cb68-269" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-270"><a href="#cb68-270" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb68-271"><a href="#cb68-271" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb68-272"><a href="#cb68-272" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb68-273"><a href="#cb68-273" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb68-274"><a href="#cb68-274" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb68-275"><a href="#cb68-275" aria-hidden="true" tabindex="-1"></a><span class="in">             else if (TPs == -.85) {</span></span>
<span id="cb68-276"><a href="#cb68-276" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb68-277"><a href="#cb68-277" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb68-278"><a href="#cb68-278" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.30 trans12*.70 trans21*.5 trans22*.5</span></span>
<span id="cb68-279"><a href="#cb68-279" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.40 prob22*.60);</span></span>
<span id="cb68-280"><a href="#cb68-280" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-281"><a href="#cb68-281" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb68-282"><a href="#cb68-282" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-283"><a href="#cb68-283" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb68-284"><a href="#cb68-284" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb68-285"><a href="#cb68-285" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-286"><a href="#cb68-286" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb68-287"><a href="#cb68-287" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb68-288"><a href="#cb68-288" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb68-289"><a href="#cb68-289" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb68-290"><a href="#cb68-290" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb68-291"><a href="#cb68-291" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb68-292"><a href="#cb68-292" aria-hidden="true" tabindex="-1"></a><span class="in">        else if (TPs == -1.385) {</span></span>
<span id="cb68-293"><a href="#cb68-293" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb68-294"><a href="#cb68-294" aria-hidden="true" tabindex="-1"></a><span class="in">         New(</span></span>
<span id="cb68-295"><a href="#cb68-295" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.20 trans12*.80 trans21*.5 trans22*.5</span></span>
<span id="cb68-296"><a href="#cb68-296" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.35 prob22*.65);</span></span>
<span id="cb68-297"><a href="#cb68-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-298"><a href="#cb68-298" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-299"><a href="#cb68-299" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb68-300"><a href="#cb68-300" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-301"><a href="#cb68-301" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb68-302"><a href="#cb68-302" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb68-303"><a href="#cb68-303" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-304"><a href="#cb68-304" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb68-305"><a href="#cb68-305" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb68-306"><a href="#cb68-306" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;")</span></span>
<span id="cb68-307"><a href="#cb68-307" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb68-308"><a href="#cb68-308" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb68-309"><a href="#cb68-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-310"><a href="#cb68-310" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-311"><a href="#cb68-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-312"><a href="#cb68-312" aria-hidden="true" tabindex="-1"></a><span class="in">  # Run Mplus model</span></span>
<span id="cb68-313"><a href="#cb68-313" aria-hidden="true" tabindex="-1"></a><span class="in">  LTA_LTA_Model &lt;- mplusModeler(LTA_LTA, </span></span>
<span id="cb68-314"><a href="#cb68-314" aria-hidden="true" tabindex="-1"></a><span class="in">                                   dataout = here('Simulations','STUDY_1', "2 Time Points", "1_2T_LTA_GEN_LTA_ANALYZED", glue("LTA_LTA_N_{N}_TP_{TPs}_TH_{TH}.dat")),</span></span>
<span id="cb68-315"><a href="#cb68-315" aria-hidden="true" tabindex="-1"></a><span class="in">                                   modelout = glue(here('Simulations', 'STUDY_1', "2 Time Points", "1_2T_LTA_GEN_LTA_ANALYZED", "LTA_LTA_N_{N}_TP_{TPs}_TH_{TH}.inp")),</span></span>
<span id="cb68-316"><a href="#cb68-316" aria-hidden="true" tabindex="-1"></a><span class="in">                                   check = TRUE, run = TRUE, hashfilename = FALSE)</span></span>
<span id="cb68-317"><a href="#cb68-317" aria-hidden="true" tabindex="-1"></a><span class="in">  return(LTA_LTA_Model)</span></span>
<span id="cb68-318"><a href="#cb68-318" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb68-319"><a href="#cb68-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-320"><a href="#cb68-320" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 3: Export necessary objects to the cluster</span></span>
<span id="cb68-321"><a href="#cb68-321" aria-hidden="true" tabindex="-1"></a><span class="in">clusterExport(cl, c("lta_lta_func", "p1", "here", "glue", "mplusModeler", "mplusObject"))</span></span>
<span id="cb68-322"><a href="#cb68-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-323"><a href="#cb68-323" aria-hidden="true" tabindex="-1"></a><span class="in"># Ensure necessary libraries are loaded on each cluster node</span></span>
<span id="cb68-324"><a href="#cb68-324" aria-hidden="true" tabindex="-1"></a><span class="in">clusterEvalQ(cl, {</span></span>
<span id="cb68-325"><a href="#cb68-325" aria-hidden="true" tabindex="-1"></a><span class="in">  library(MplusAutomation)</span></span>
<span id="cb68-326"><a href="#cb68-326" aria-hidden="true" tabindex="-1"></a><span class="in">  library(glue)</span></span>
<span id="cb68-327"><a href="#cb68-327" aria-hidden="true" tabindex="-1"></a><span class="in">  library(here)</span></span>
<span id="cb68-328"><a href="#cb68-328" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb68-329"><a href="#cb68-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-330"><a href="#cb68-330" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 4: Run the simulation in parallel using the cluster</span></span>
<span id="cb68-331"><a href="#cb68-331" aria-hidden="true" tabindex="-1"></a><span class="in">result_list &lt;- parLapply(cl, 1:nrow(p1), function(i) {</span></span>
<span id="cb68-332"><a href="#cb68-332" aria-hidden="true" tabindex="-1"></a><span class="in">  lta_lta_func(p1$N[i], p1$TPs[i], p1$TH[i])</span></span>
<span id="cb68-333"><a href="#cb68-333" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb68-334"><a href="#cb68-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-335"><a href="#cb68-335" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 5: Stop the cluster after the simulation</span></span>
<span id="cb68-336"><a href="#cb68-336" aria-hidden="true" tabindex="-1"></a><span class="in">stopCluster(cl)</span></span>
<span id="cb68-337"><a href="#cb68-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-338"><a href="#cb68-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-339"><a href="#cb68-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-340"><a href="#cb68-340" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-341"><a href="#cb68-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-342"><a href="#cb68-342" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Processing and Verification</span></span>
<span id="cb68-343"><a href="#cb68-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-344"><a href="#cb68-344" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-345"><a href="#cb68-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-346"><a href="#cb68-346" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check for Label Switching and Errors</span></span>
<span id="cb68-347"><a href="#cb68-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-348"><a href="#cb68-348" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In this section: .csv files are first merged into a single data frame, from which specific parameters are extracted. Logit values are then converted to probabilities, and known class values are incorporated into the data frame. A subset of cases involving label switching is selected randomly and plotted for visual review. Output files are scanned for errors, which are subsequently merged back into the original data file. Additional columns derived from the file name are added, and the percentage of violations is calculated. Both errors and label switching violations are visually represented, and the total number of corrected replications is reported.</span></span>
<span id="cb68-349"><a href="#cb68-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-350"><a href="#cb68-350" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scrape Mplus CSV Files</span></span>
<span id="cb68-351"><a href="#cb68-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-352"><a href="#cb68-352" aria-hidden="true" tabindex="-1"></a>*First, Load all CSV files and combine them into a single data frame.*</span>
<span id="cb68-353"><a href="#cb68-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-356"><a href="#cb68-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-357"><a href="#cb68-357" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "combine-csv-files-parallel"</span></span>
<span id="cb68-358"><a href="#cb68-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-359"><a href="#cb68-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-360"><a href="#cb68-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-361"><a href="#cb68-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-362"><a href="#cb68-362" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct CSV directory</span></span>
<span id="cb68-363"><a href="#cb68-363" aria-hidden="true" tabindex="-1"></a>csv_directory <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'1_2T_LTA_GEN_LTA_ANALYZED'</span>)</span>
<span id="cb68-364"><a href="#cb68-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-365"><a href="#cb68-365" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document</span></span>
<span id="cb68-366"><a href="#cb68-366" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'data_scraping.R'</span>))</span>
<span id="cb68-367"><a href="#cb68-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-368"><a href="#cb68-368" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate combined_data dataframe in the global environment</span></span>
<span id="cb68-369"><a href="#cb68-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-370"><a href="#cb68-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-371"><a href="#cb68-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-372"><a href="#cb68-372" aria-hidden="true" tabindex="-1"></a><span class="fu">### Slice Data / Extract Parameters</span></span>
<span id="cb68-373"><a href="#cb68-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-374"><a href="#cb68-374" aria-hidden="true" tabindex="-1"></a>*Extract data from the appropriate rows from each 9-row chunk and prepare the data for further processing.*</span>
<span id="cb68-375"><a href="#cb68-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-378"><a href="#cb68-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-379"><a href="#cb68-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "scrape-rows-process-data-parallel"</span></span>
<span id="cb68-380"><a href="#cb68-380" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-381"><a href="#cb68-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-382"><a href="#cb68-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-383"><a href="#cb68-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-384"><a href="#cb68-384" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the data using the child script</span></span>
<span id="cb68-385"><a href="#cb68-385" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step2_2t_LTA.R'</span>))</span>
<span id="cb68-386"><a href="#cb68-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-387"><a href="#cb68-387" aria-hidden="true" tabindex="-1"></a>final_combined_data <span class="ot">&lt;-</span> final_combined_data <span class="sc">%&gt;%</span></span>
<span id="cb68-388"><a href="#cb68-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-389"><a href="#cb68-389" aria-hidden="true" tabindex="-1"></a>    <span class="at">TRANS11 =</span> <span class="fu">as.numeric</span>(TRANS11),</span>
<span id="cb68-390"><a href="#cb68-390" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_11 =</span> <span class="fu">as.numeric</span>(SE_11),</span>
<span id="cb68-391"><a href="#cb68-391" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Ec"</span>), as.numeric),  <span class="co"># Convert all Ec columns</span></span>
<span id="cb68-392"><a href="#cb68-392" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_csv =</span> <span class="fu">as.numeric</span>(ll_csv)  <span class="co"># Convert Log-Likelihood values</span></span>
<span id="cb68-393"><a href="#cb68-393" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-394"><a href="#cb68-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-395"><a href="#cb68-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-396"><a href="#cb68-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-397"><a href="#cb68-397" aria-hidden="true" tabindex="-1"></a><span class="fu">### Wrangle Data</span></span>
<span id="cb68-398"><a href="#cb68-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-399"><a href="#cb68-399" aria-hidden="true" tabindex="-1"></a>*Convert the logits to probabilities and add the known actual values to each row.*</span>
<span id="cb68-400"><a href="#cb68-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-403"><a href="#cb68-403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-404"><a href="#cb68-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "convert-logits-to-probabilities"</span></span>
<span id="cb68-405"><a href="#cb68-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-406"><a href="#cb68-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-407"><a href="#cb68-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-408"><a href="#cb68-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-409"><a href="#cb68-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-410"><a href="#cb68-410" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3 and 4: Process the data and return results</span></span>
<span id="cb68-411"><a href="#cb68-411" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step_3.R'</span>))</span>
<span id="cb68-412"><a href="#cb68-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-413"><a href="#cb68-413" aria-hidden="true" tabindex="-1"></a><span class="co"># The objects `final_data_with_actuals` and `violators` should now be in the global environment</span></span>
<span id="cb68-414"><a href="#cb68-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-415"><a href="#cb68-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-416"><a href="#cb68-416" aria-hidden="true" tabindex="-1"></a><span class="fu">### Generate Plots of Label Switching</span></span>
<span id="cb68-417"><a href="#cb68-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-418"><a href="#cb68-418" aria-hidden="true" tabindex="-1"></a>*Generate plots of randomly sampled violators for visual inspection using parallel processing.*</span>
<span id="cb68-419"><a href="#cb68-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-420"><a href="#cb68-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb68-421"><a href="#cb68-421" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: "plot-violators"</span></span>
<span id="cb68-422"><a href="#cb68-422" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb68-423"><a href="#cb68-423" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb68-424"><a href="#cb68-424" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb68-425"><a href="#cb68-425" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: false</span></span>
<span id="cb68-426"><a href="#cb68-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-427"><a href="#cb68-427" aria-hidden="true" tabindex="-1"></a><span class="in"># Set plot width and height</span></span>
<span id="cb68-428"><a href="#cb68-428" aria-hidden="true" tabindex="-1"></a><span class="in">plot_width &lt;- 8</span></span>
<span id="cb68-429"><a href="#cb68-429" aria-hidden="true" tabindex="-1"></a><span class="in">plot_height &lt;- 6</span></span>
<span id="cb68-430"><a href="#cb68-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-431"><a href="#cb68-431" aria-hidden="true" tabindex="-1"></a><span class="in"># Take a random sample of up to 250 violators (ensure not to exceed the total number of violators)</span></span>
<span id="cb68-432"><a href="#cb68-432" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(123)  # For reproducibility</span></span>
<span id="cb68-433"><a href="#cb68-433" aria-hidden="true" tabindex="-1"></a><span class="in">sample_size &lt;- min(nrow(violators), 250)  # Handle cases where fewer than 250 violators exist</span></span>
<span id="cb68-434"><a href="#cb68-434" aria-hidden="true" tabindex="-1"></a><span class="in">sampled_violators &lt;- violators[sample(nrow(violators), sample_size), ]</span></span>
<span id="cb68-435"><a href="#cb68-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-436"><a href="#cb68-436" aria-hidden="true" tabindex="-1"></a><span class="in"># Define the function to create plots sequentially</span></span>
<span id="cb68-437"><a href="#cb68-437" aria-hidden="true" tabindex="-1"></a><span class="in">plot_violator &lt;- function(i) {</span></span>
<span id="cb68-438"><a href="#cb68-438" aria-hidden="true" tabindex="-1"></a><span class="in">  row_data &lt;- sampled_violators[i, ]</span></span>
<span id="cb68-439"><a href="#cb68-439" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-440"><a href="#cb68-440" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extract the file name from the current row</span></span>
<span id="cb68-441"><a href="#cb68-441" aria-hidden="true" tabindex="-1"></a><span class="in">  file_name &lt;- row_data$FileName</span></span>
<span id="cb68-442"><a href="#cb68-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-443"><a href="#cb68-443" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extract probability values for EC1 and EC2 (estimated probabilities) and AC1 and AC2 (actuals)</span></span>
<span id="cb68-444"><a href="#cb68-444" aria-hidden="true" tabindex="-1"></a><span class="in">  estimated_probabilities &lt;- c(</span></span>
<span id="cb68-445"><a href="#cb68-445" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ec1u1", "Ec1u2", "Ec1u3", "Ec1u4", "Ec1u5")]),</span></span>
<span id="cb68-446"><a href="#cb68-446" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ec2u1", "Ec2u2", "Ec2u3", "Ec2u4", "Ec2u5")])</span></span>
<span id="cb68-447"><a href="#cb68-447" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-448"><a href="#cb68-448" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-449"><a href="#cb68-449" aria-hidden="true" tabindex="-1"></a><span class="in">  actual_values &lt;- c(</span></span>
<span id="cb68-450"><a href="#cb68-450" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ac1u1", "Ac1u2", "Ac1u3", "Ac1u4", "Ac1u5")]),</span></span>
<span id="cb68-451"><a href="#cb68-451" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ac2u1", "Ac2u2", "Ac2u3", "Ac2u4", "Ac2u5")])</span></span>
<span id="cb68-452"><a href="#cb68-452" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-453"><a href="#cb68-453" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-454"><a href="#cb68-454" aria-hidden="true" tabindex="-1"></a><span class="in">  # Create labels for the legend with actual values directly from the dataset</span></span>
<span id="cb68-455"><a href="#cb68-455" aria-hidden="true" tabindex="-1"></a><span class="in">  labels &lt;- c(</span></span>
<span id="cb68-456"><a href="#cb68-456" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("EC1: (", round(row_data$Ec1u1, 3), ", ", round(row_data$Ec1u2, 3), ", ", round(row_data$Ec1u3, 3), ", ", round(row_data$Ec1u4, 3), ", ", round(row_data$Ec1u5, 3), ")"),</span></span>
<span id="cb68-457"><a href="#cb68-457" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("EC2: (", round(row_data$Ec2u1, 3), ", ", round(row_data$Ec2u2, 3), ", ", round(row_data$Ec2u3, 3), ", ", round(row_data$Ec2u4, 3), ", ", round(row_data$Ec2u5, 3), ")"),</span></span>
<span id="cb68-458"><a href="#cb68-458" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("AC1: (", round(row_data$Ac1u1, 3), ", ", round(row_data$Ac1u2, 3), ", ", round(row_data$Ac1u3, 3), ", ", round(row_data$Ac1u4, 3), ", ", round(row_data$Ac1u5, 3), ")"),</span></span>
<span id="cb68-459"><a href="#cb68-459" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("AC2: (", round(row_data$Ac2u1, 3), ", ", round(row_data$Ac2u2, 3), ", ", round(row_data$Ac2u3, 3), ", ", round(row_data$Ac2u4, 3), ", ", round(row_data$Ac2u5, 3), ")")</span></span>
<span id="cb68-460"><a href="#cb68-460" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-461"><a href="#cb68-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-462"><a href="#cb68-462" aria-hidden="true" tabindex="-1"></a><span class="in">  # Step 6: Create a data frame for plotting</span></span>
<span id="cb68-463"><a href="#cb68-463" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_data &lt;- data.frame(</span></span>
<span id="cb68-464"><a href="#cb68-464" aria-hidden="true" tabindex="-1"></a><span class="in">    Items = rep(1:5, 4),</span></span>
<span id="cb68-465"><a href="#cb68-465" aria-hidden="true" tabindex="-1"></a><span class="in">    Probabilities = c(estimated_probabilities, actual_values),</span></span>
<span id="cb68-466"><a href="#cb68-466" aria-hidden="true" tabindex="-1"></a><span class="in">    Class = rep(labels, each = 5)</span></span>
<span id="cb68-467"><a href="#cb68-467" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-468"><a href="#cb68-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-469"><a href="#cb68-469" aria-hidden="true" tabindex="-1"></a><span class="in">  # Step 7: Create the plot with the file name in the title</span></span>
<span id="cb68-470"><a href="#cb68-470" aria-hidden="true" tabindex="-1"></a><span class="in">  p &lt;- ggplot(plot_data, aes(x = Items, y = Probabilities, color = Class, group = Class)) +</span></span>
<span id="cb68-471"><a href="#cb68-471" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_line(size = 1.2) +</span></span>
<span id="cb68-472"><a href="#cb68-472" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(size = 3) +</span></span>
<span id="cb68-473"><a href="#cb68-473" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(title = file_name, x = "Items", y = "Probabilities") +  # Only the file name in the title</span></span>
<span id="cb68-474"><a href="#cb68-474" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_minimal(base_size = 16) +</span></span>
<span id="cb68-475"><a href="#cb68-475" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(panel.background = element_rect(fill = "white"),</span></span>
<span id="cb68-476"><a href="#cb68-476" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.background = element_rect(fill = "white"),</span></span>
<span id="cb68-477"><a href="#cb68-477" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.title = element_text(size = 14, hjust = 0.5)) +  # Adjust title size and center</span></span>
<span id="cb68-478"><a href="#cb68-478" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = c(</span></span>
<span id="cb68-479"><a href="#cb68-479" aria-hidden="true" tabindex="-1"></a><span class="in">      "darkblue", "darkgreen",  # EC1 and EC2 (Estimated Probabilities)</span></span>
<span id="cb68-480"><a href="#cb68-480" aria-hidden="true" tabindex="-1"></a><span class="in">      "lightblue", "lightgreen"  # AC1 and AC2 (Actual Values)</span></span>
<span id="cb68-481"><a href="#cb68-481" aria-hidden="true" tabindex="-1"></a><span class="in">    ))</span></span>
<span id="cb68-482"><a href="#cb68-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-483"><a href="#cb68-483" aria-hidden="true" tabindex="-1"></a><span class="in">  ggsave(filename = file.path(here('Simulations', 'STUDY_1', "2 Time Points", "zViolator_Plots", "z2t_lta_lta_violator_plots", paste0("violator_plot_", i, "_", file_name, ".png"))),</span></span>
<span id="cb68-484"><a href="#cb68-484" aria-hidden="true" tabindex="-1"></a><span class="in">         plot = p, width = plot_width, height = plot_height)</span></span>
<span id="cb68-485"><a href="#cb68-485" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb68-486"><a href="#cb68-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-487"><a href="#cb68-487" aria-hidden="true" tabindex="-1"></a><span class="in"># Apply the function to generate plots sequentially (without parallelization)</span></span>
<span id="cb68-488"><a href="#cb68-488" aria-hidden="true" tabindex="-1"></a><span class="in">invisible(lapply(1:sample_size, plot_violator))</span></span>
<span id="cb68-489"><a href="#cb68-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-490"><a href="#cb68-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-491"><a href="#cb68-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-492"><a href="#cb68-492" aria-hidden="true" tabindex="-1"></a>PLot Non-Violators and inspect for False NEGATIVES</span>
<span id="cb68-493"><a href="#cb68-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-494"><a href="#cb68-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb68-495"><a href="#cb68-495" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: "plot-non-violators"</span></span>
<span id="cb68-496"><a href="#cb68-496" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb68-497"><a href="#cb68-497" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb68-498"><a href="#cb68-498" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb68-499"><a href="#cb68-499" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: false</span></span>
<span id="cb68-500"><a href="#cb68-500" aria-hidden="true" tabindex="-1"></a><span class="in"># Take a random sample of up to 250 non-violators</span></span>
<span id="cb68-501"><a href="#cb68-501" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(123)  # For reproducibility</span></span>
<span id="cb68-502"><a href="#cb68-502" aria-hidden="true" tabindex="-1"></a><span class="in">non_violators &lt;- filter(final_data_with_actuals, Any_Violation == 0)</span></span>
<span id="cb68-503"><a href="#cb68-503" aria-hidden="true" tabindex="-1"></a><span class="in">sample_size_non_violators &lt;- min(nrow(non_violators), 250)</span></span>
<span id="cb68-504"><a href="#cb68-504" aria-hidden="true" tabindex="-1"></a><span class="in">sampled_non_violators &lt;- non_violators[sample(nrow(non_violators), sample_size_non_violators), ]</span></span>
<span id="cb68-505"><a href="#cb68-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-506"><a href="#cb68-506" aria-hidden="true" tabindex="-1"></a><span class="in"># Define a function for non-violator plots</span></span>
<span id="cb68-507"><a href="#cb68-507" aria-hidden="true" tabindex="-1"></a><span class="in">plot_non_violator &lt;- function(i) {</span></span>
<span id="cb68-508"><a href="#cb68-508" aria-hidden="true" tabindex="-1"></a><span class="in">  row_data &lt;- sampled_non_violators[i, ]</span></span>
<span id="cb68-509"><a href="#cb68-509" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-510"><a href="#cb68-510" aria-hidden="true" tabindex="-1"></a><span class="in">  file_name &lt;- row_data$FileName</span></span>
<span id="cb68-511"><a href="#cb68-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-512"><a href="#cb68-512" aria-hidden="true" tabindex="-1"></a><span class="in">  estimated_probabilities &lt;- c(</span></span>
<span id="cb68-513"><a href="#cb68-513" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ec1u1", "Ec1u2", "Ec1u3", "Ec1u4", "Ec1u5")]),</span></span>
<span id="cb68-514"><a href="#cb68-514" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ec2u1", "Ec2u2", "Ec2u3", "Ec2u4", "Ec2u5")])</span></span>
<span id="cb68-515"><a href="#cb68-515" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-516"><a href="#cb68-516" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-517"><a href="#cb68-517" aria-hidden="true" tabindex="-1"></a><span class="in">  actual_values &lt;- c(</span></span>
<span id="cb68-518"><a href="#cb68-518" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ac1u1", "Ac1u2", "Ac1u3", "Ac1u4", "Ac1u5")]),</span></span>
<span id="cb68-519"><a href="#cb68-519" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ac2u1", "Ac2u2", "Ac2u3", "Ac2u4", "Ac2u5")])</span></span>
<span id="cb68-520"><a href="#cb68-520" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-521"><a href="#cb68-521" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-522"><a href="#cb68-522" aria-hidden="true" tabindex="-1"></a><span class="in">  labels &lt;- c(</span></span>
<span id="cb68-523"><a href="#cb68-523" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("EC1: (", round(row_data$Ec1u1, 3), ", ", round(row_data$Ec1u2, 3), ", ", round(row_data$Ec1u3, 3), ", ", round(row_data$Ec1u4, 3), ", ", round(row_data$Ec1u5, 3), ")"),</span></span>
<span id="cb68-524"><a href="#cb68-524" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("EC2: (", round(row_data$Ec2u1, 3), ", ", round(row_data$Ec2u2, 3), ", ", round(row_data$Ec2u3, 3), ", ", round(row_data$Ec2u4, 3), ", ", round(row_data$Ec2u5, 3), ")"),</span></span>
<span id="cb68-525"><a href="#cb68-525" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("AC1: (", round(row_data$Ac1u1, 3), ", ", round(row_data$Ac1u2, 3), ", ", round(row_data$Ac1u3, 3), ", ", round(row_data$Ac1u4, 3), ", ", round(row_data$Ac1u5, 3), ")"),</span></span>
<span id="cb68-526"><a href="#cb68-526" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("AC2: (", round(row_data$Ac2u1, 3), ", ", round(row_data$Ac2u2, 3), ", ", round(row_data$Ac2u3, 3), ", ", round(row_data$Ac2u4, 3), ", ", round(row_data$Ac2u5, 3), ")")</span></span>
<span id="cb68-527"><a href="#cb68-527" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-528"><a href="#cb68-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-529"><a href="#cb68-529" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_data &lt;- data.frame(</span></span>
<span id="cb68-530"><a href="#cb68-530" aria-hidden="true" tabindex="-1"></a><span class="in">    Items = rep(1:5, 4),</span></span>
<span id="cb68-531"><a href="#cb68-531" aria-hidden="true" tabindex="-1"></a><span class="in">    Probabilities = c(estimated_probabilities, actual_values),</span></span>
<span id="cb68-532"><a href="#cb68-532" aria-hidden="true" tabindex="-1"></a><span class="in">    Class = rep(labels, each = 5)</span></span>
<span id="cb68-533"><a href="#cb68-533" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-534"><a href="#cb68-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-535"><a href="#cb68-535" aria-hidden="true" tabindex="-1"></a><span class="in">  p &lt;- ggplot(plot_data, aes(x = Items, y = Probabilities, color = Class, group = Class)) +</span></span>
<span id="cb68-536"><a href="#cb68-536" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_line(size = 1.2) +</span></span>
<span id="cb68-537"><a href="#cb68-537" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(size = 3) +</span></span>
<span id="cb68-538"><a href="#cb68-538" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(title = paste0(file_name, " (Non-Violator)"), x = "Items", y = "Probabilities") +</span></span>
<span id="cb68-539"><a href="#cb68-539" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_minimal(base_size = 16) +</span></span>
<span id="cb68-540"><a href="#cb68-540" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(panel.background = element_rect(fill = "white"),</span></span>
<span id="cb68-541"><a href="#cb68-541" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.background = element_rect(fill = "white"),</span></span>
<span id="cb68-542"><a href="#cb68-542" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.title = element_text(size = 14, hjust = 0.5)) +</span></span>
<span id="cb68-543"><a href="#cb68-543" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = c(</span></span>
<span id="cb68-544"><a href="#cb68-544" aria-hidden="true" tabindex="-1"></a><span class="in">      "darkblue", "darkgreen",  # EC1 and EC2 (Estimated Probabilities)</span></span>
<span id="cb68-545"><a href="#cb68-545" aria-hidden="true" tabindex="-1"></a><span class="in">      "lightblue", "lightgreen"  # AC1 and AC2 (Actual Values)</span></span>
<span id="cb68-546"><a href="#cb68-546" aria-hidden="true" tabindex="-1"></a><span class="in">    ))</span></span>
<span id="cb68-547"><a href="#cb68-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-548"><a href="#cb68-548" aria-hidden="true" tabindex="-1"></a><span class="in">  ggsave(filename = file.path(here('Simulations', 'STUDY_1', "2 Time Points", "zViolator_Plots", "z2t_lta_lta_non_violator_plots", paste0("non_violator_plot_", i, "_", file_name, ".png"))),</span></span>
<span id="cb68-549"><a href="#cb68-549" aria-hidden="true" tabindex="-1"></a><span class="in">         plot = p, width = plot_width, height = plot_height)</span></span>
<span id="cb68-550"><a href="#cb68-550" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb68-551"><a href="#cb68-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-552"><a href="#cb68-552" aria-hidden="true" tabindex="-1"></a><span class="in"># Apply function to generate non-violator plots</span></span>
<span id="cb68-553"><a href="#cb68-553" aria-hidden="true" tabindex="-1"></a><span class="in">invisible(lapply(1:sample_size_non_violators, plot_non_violator))</span></span>
<span id="cb68-554"><a href="#cb68-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-555"><a href="#cb68-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-556"><a href="#cb68-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-557"><a href="#cb68-557" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-558"><a href="#cb68-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-559"><a href="#cb68-559" aria-hidden="true" tabindex="-1"></a><span class="fu"># Error Handling</span></span>
<span id="cb68-560"><a href="#cb68-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-561"><a href="#cb68-561" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-562"><a href="#cb68-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-563"><a href="#cb68-563" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scrape for Errors</span></span>
<span id="cb68-564"><a href="#cb68-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-565"><a href="#cb68-565" aria-hidden="true" tabindex="-1"></a>*Scrape output files for errors*</span>
<span id="cb68-566"><a href="#cb68-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-569"><a href="#cb68-569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-570"><a href="#cb68-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "process-out-files-parallel"</span></span>
<span id="cb68-571"><a href="#cb68-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-572"><a href="#cb68-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-573"><a href="#cb68-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-574"><a href="#cb68-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-575"><a href="#cb68-575" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct output directory for .out files</span></span>
<span id="cb68-576"><a href="#cb68-576" aria-hidden="true" tabindex="-1"></a>output_folder <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'1_2T_LTA_GEN_LTA_ANALYZED'</span>)</span>
<span id="cb68-577"><a href="#cb68-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-578"><a href="#cb68-578" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document that processes .out files</span></span>
<span id="cb68-579"><a href="#cb68-579" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'out_scraping.R'</span>))</span>
<span id="cb68-580"><a href="#cb68-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-581"><a href="#cb68-581" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb68-582"><a href="#cb68-582" aria-hidden="true" tabindex="-1"></a><span class="co">#  âœ… SECTION 1 Generate Replication Summary Table</span></span>
<span id="cb68-583"><a href="#cb68-583" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb68-584"><a href="#cb68-584" aria-hidden="true" tabindex="-1"></a>replication_summary_table <span class="ot">&lt;-</span> replication_summary <span class="sc">%&gt;%</span></span>
<span id="cb68-585"><a href="#cb68-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-586"><a href="#cb68-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-587"><a href="#cb68-587" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Replication Summary"</span>,</span>
<span id="cb68-588"><a href="#cb68-588" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Folder: "</span>, output_folder)</span>
<span id="cb68-589"><a href="#cb68-589" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-590"><a href="#cb68-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb68-591"><a href="#cb68-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Total"</span>, <span class="st">"Replicated_Yes"</span>, <span class="st">"Replicated_No"</span>, <span class="st">"Error_Count"</span>),</span>
<span id="cb68-592"><a href="#cb68-592" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb68-593"><a href="#cb68-593" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-594"><a href="#cb68-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb68-595"><a href="#cb68-595" aria-hidden="true" tabindex="-1"></a>    <span class="at">FileName =</span> <span class="st">"File Name"</span>,</span>
<span id="cb68-596"><a href="#cb68-596" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="st">"Total Replications"</span>,</span>
<span id="cb68-597"><a href="#cb68-597" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replicated_Yes =</span> <span class="st">"LL Replicated"</span>,</span>
<span id="cb68-598"><a href="#cb68-598" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replicated_No =</span> <span class="st">"LL Not Replicated"</span>,</span>
<span id="cb68-599"><a href="#cb68-599" aria-hidden="true" tabindex="-1"></a>    <span class="at">Error_Count =</span> <span class="st">"Errors"</span></span>
<span id="cb68-600"><a href="#cb68-600" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-601"><a href="#cb68-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb68-602"><a href="#cb68-602" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb68-603"><a href="#cb68-603" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb68-604"><a href="#cb68-604" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-605"><a href="#cb68-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb68-606"><a href="#cb68-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb68-607"><a href="#cb68-607" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb68-608"><a href="#cb68-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb68-609"><a href="#cb68-609" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">80</span>)</span>
<span id="cb68-610"><a href="#cb68-610" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-611"><a href="#cb68-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-612"><a href="#cb68-612" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb68-613"><a href="#cb68-613" aria-hidden="true" tabindex="-1"></a>replication_summary_table</span>
<span id="cb68-614"><a href="#cb68-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-615"><a href="#cb68-615" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb68-616"><a href="#cb68-616" aria-hidden="true" tabindex="-1"></a><span class="co">#  âœ… SECTION 2 Row Count Validation</span></span>
<span id="cb68-617"><a href="#cb68-617" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb68-618"><a href="#cb68-618" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_data_with_actuals:"</span>, <span class="fu">nrow</span>(final_data_with_actuals), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-619"><a href="#cb68-619" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_results:"</span>, <span class="fu">nrow</span>(final_results), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-620"><a href="#cb68-620" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in replication_summary:"</span>, <span class="fu">nrow</span>(replication_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-621"><a href="#cb68-621" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="cf">if</span> (<span class="fu">any</span>(replication_summary<span class="sc">$</span>LL_Not_Replicated <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb68-622"><a href="#cb68-622" aria-hidden="true" tabindex="-1"></a>  <span class="st">"âš ï¸ WARNING: Some LL values were NOT replicated! Check the Replication Summary table."</span></span>
<span id="cb68-623"><a href="#cb68-623" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb68-624"><a href="#cb68-624" aria-hidden="true" tabindex="-1"></a>  <span class="st">"âœ… All LL values were successfully replicated."</span></span>
<span id="cb68-625"><a href="#cb68-625" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb68-626"><a href="#cb68-626" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(final_data_with_actuals<span class="sc">$</span>ll_csv, final_results<span class="sc">$</span>ll_out, <span class="at">tolerance =</span> <span class="fl">1e-4</span>)</span>
<span id="cb68-627"><a href="#cb68-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-628"><a href="#cb68-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-629"><a href="#cb68-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-630"><a href="#cb68-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-631"><a href="#cb68-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-632"><a href="#cb68-632" aria-hidden="true" tabindex="-1"></a><span class="fu">### Merge Errors with Main Data File</span></span>
<span id="cb68-633"><a href="#cb68-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-634"><a href="#cb68-634" aria-hidden="true" tabindex="-1"></a>*Combine error information with main data file*</span>
<span id="cb68-635"><a href="#cb68-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-638"><a href="#cb68-638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-639"><a href="#cb68-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "merge-errors"</span></span>
<span id="cb68-640"><a href="#cb68-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-641"><a href="#cb68-641" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-642"><a href="#cb68-642" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-643"><a href="#cb68-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-644"><a href="#cb68-644" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb68-645"><a href="#cb68-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb68-646"><a href="#cb68-646" aria-hidden="true" tabindex="-1"></a>    final_results <span class="sc">%&gt;%</span> <span class="fu">select</span>(FileName, Replication, ll_out, LL_Replicated, ErrorFlag), </span>
<span id="cb68-647"><a href="#cb68-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"FileName"</span>, <span class="st">"Replication"</span>)</span>
<span id="cb68-648"><a href="#cb68-648" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-649"><a href="#cb68-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-650"><a href="#cb68-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">Any_Violation =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Any_Violation), <span class="dv">0</span>, Any_Violation),</span>
<span id="cb68-651"><a href="#cb68-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorFlag =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(ErrorFlag), <span class="dv">0</span>, ErrorFlag),</span>
<span id="cb68-652"><a href="#cb68-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">LL_Replicated =</span> <span class="fu">ifelse</span>(LL_Replicated <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),  <span class="co"># âœ… Convert Yes/No to 1/0</span></span>
<span id="cb68-653"><a href="#cb68-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-654"><a href="#cb68-654" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ðŸ”¹ Create a new True Violation column</span></span>
<span id="cb68-655"><a href="#cb68-655" aria-hidden="true" tabindex="-1"></a>    <span class="at">True_Violation =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-656"><a href="#cb68-656" aria-hidden="true" tabindex="-1"></a>      Any_Violation <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> ErrorFlag <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> LL_Replicated <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># âœ… At least one violation</span></span>
<span id="cb68-657"><a href="#cb68-657" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb68-658"><a href="#cb68-658" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-659"><a href="#cb68-659" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-660"><a href="#cb68-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-661"><a href="#cb68-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-662"><a href="#cb68-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-663"><a href="#cb68-663" aria-hidden="true" tabindex="-1"></a>Visualize differences between ll_out and ll_csv</span>
<span id="cb68-664"><a href="#cb68-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-667"><a href="#cb68-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-668"><a href="#cb68-668" aria-hidden="true" tabindex="-1"></a>ll_check <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb68-669"><a href="#cb68-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">round</span>(ll_out <span class="sc">-</span> ll_csv, <span class="dv">3</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Round before counting</span></span>
<span id="cb68-670"><a href="#cb68-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(diff)</span>
<span id="cb68-671"><a href="#cb68-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-672"><a href="#cb68-672" aria-hidden="true" tabindex="-1"></a>ll_check_table <span class="ot">&lt;-</span> ll_check <span class="sc">%&gt;%</span></span>
<span id="cb68-673"><a href="#cb68-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-674"><a href="#cb68-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-675"><a href="#cb68-675" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"LL Difference Summary"</span>,</span>
<span id="cb68-676"><a href="#cb68-676" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Comparison of LL values between CSV and OUT files"</span></span>
<span id="cb68-677"><a href="#cb68-677" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-678"><a href="#cb68-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb68-679"><a href="#cb68-679" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff =</span> <span class="st">"LL Difference"</span>,</span>
<span id="cb68-680"><a href="#cb68-680" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="st">"Count"</span></span>
<span id="cb68-681"><a href="#cb68-681" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-682"><a href="#cb68-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb68-683"><a href="#cb68-683" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> diff,</span>
<span id="cb68-684"><a href="#cb68-684" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb68-685"><a href="#cb68-685" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-686"><a href="#cb68-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb68-687"><a href="#cb68-687" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb68-688"><a href="#cb68-688" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb68-689"><a href="#cb68-689" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-690"><a href="#cb68-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb68-691"><a href="#cb68-691" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb68-692"><a href="#cb68-692" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb68-693"><a href="#cb68-693" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb68-694"><a href="#cb68-694" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">50</span>)</span>
<span id="cb68-695"><a href="#cb68-695" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-696"><a href="#cb68-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-697"><a href="#cb68-697" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb68-698"><a href="#cb68-698" aria-hidden="true" tabindex="-1"></a>ll_check_table</span>
<span id="cb68-699"><a href="#cb68-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-700"><a href="#cb68-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-701"><a href="#cb68-701" aria-hidden="true" tabindex="-1"></a>Create DF of LL differences from .out and .csv files for inspection at the replication level</span>
<span id="cb68-702"><a href="#cb68-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-705"><a href="#cb68-705" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-706"><a href="#cb68-706" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe with only rows where ll_out and ll_csv differ</span></span>
<span id="cb68-707"><a href="#cb68-707" aria-hidden="true" tabindex="-1"></a>ll_mismatch <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb68-708"><a href="#cb68-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">round</span>(ll_out <span class="sc">-</span> ll_csv, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-709"><a href="#cb68-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(diff <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-710"><a href="#cb68-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FileName, Replication, ll_out, ll_csv, diff)</span>
<span id="cb68-711"><a href="#cb68-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-712"><a href="#cb68-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-713"><a href="#cb68-713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-714"><a href="#cb68-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-715"><a href="#cb68-715" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scrape File Name Components</span></span>
<span id="cb68-716"><a href="#cb68-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-717"><a href="#cb68-717" aria-hidden="true" tabindex="-1"></a>*Create Column Names from the file name*</span>
<span id="cb68-718"><a href="#cb68-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-721"><a href="#cb68-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-722"><a href="#cb68-722" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "create-column-names-from-filename"</span></span>
<span id="cb68-723"><a href="#cb68-723" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-724"><a href="#cb68-724" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-725"><a href="#cb68-725" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-726"><a href="#cb68-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-727"><a href="#cb68-727" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns based on the information in the FileName and set factors</span></span>
<span id="cb68-728"><a href="#cb68-728" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb68-729"><a href="#cb68-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-730"><a href="#cb68-730" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the sample size (N) from the FileName with the correct values</span></span>
<span id="cb68-731"><a href="#cb68-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-732"><a href="#cb68-732" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_4000"</span>, FileName) <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb68-733"><a href="#cb68-733" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_500"</span>, FileName) <span class="sc">~</span> <span class="dv">1</span>,   </span>
<span id="cb68-734"><a href="#cb68-734" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_1000"</span>, FileName) <span class="sc">~</span> <span class="dv">2</span>,  </span>
<span id="cb68-735"><a href="#cb68-735" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_2000"</span>, FileName) <span class="sc">~</span> <span class="dv">3</span>,  </span>
<span id="cb68-736"><a href="#cb68-736" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb68-737"><a href="#cb68-737" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb68-738"><a href="#cb68-738" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map the TPs from the FileName to the appropriate Population labels</span></span>
<span id="cb68-739"><a href="#cb68-739" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-740"><a href="#cb68-740" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".800"</span>,</span>
<span id="cb68-741"><a href="#cb68-741" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".700"</span>,</span>
<span id="cb68-742"><a href="#cb68-742" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".600"</span>,</span>
<span id="cb68-743"><a href="#cb68-743" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".400"</span>, </span>
<span id="cb68-744"><a href="#cb68-744" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".300"</span>,</span>
<span id="cb68-745"><a href="#cb68-745" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".200"</span>,</span>
<span id="cb68-746"><a href="#cb68-746" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb68-747"><a href="#cb68-747" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb68-748"><a href="#cb68-748" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the Transitions variable based on Population values</span></span>
<span id="cb68-749"><a href="#cb68-749" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-750"><a href="#cb68-750" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>) <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># Assign 1</span></span>
<span id="cb68-751"><a href="#cb68-751" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>) <span class="sc">~</span> <span class="dv">2</span>,  <span class="co"># Assign 2 </span></span>
<span id="cb68-752"><a href="#cb68-752" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb68-753"><a href="#cb68-753" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-754"><a href="#cb68-754" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-755"><a href="#cb68-755" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert columns to factors, ordering N_4000 first in the factor levels</span></span>
<span id="cb68-756"><a href="#cb68-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-757"><a href="#cb68-757" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"N = 4000"</span>, <span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>)),</span>
<span id="cb68-758"><a href="#cb68-758" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".800"</span>, <span class="st">".700"</span>, <span class="st">".600"</span>, <span class="st">".400"</span>, <span class="st">".300"</span>, <span class="st">".200"</span>)),</span>
<span id="cb68-759"><a href="#cb68-759" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">factor</span>(Transitions, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mover"</span>, <span class="st">"Stayer"</span>))</span>
<span id="cb68-760"><a href="#cb68-760" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-761"><a href="#cb68-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-762"><a href="#cb68-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-763"><a href="#cb68-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-764"><a href="#cb68-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-765"><a href="#cb68-765" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculate Violations</span></span>
<span id="cb68-766"><a href="#cb68-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-767"><a href="#cb68-767" aria-hidden="true" tabindex="-1"></a>*Calculate Violation Percentages per Condition*</span>
<span id="cb68-768"><a href="#cb68-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-771"><a href="#cb68-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-772"><a href="#cb68-772" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "calculate-violations"</span></span>
<span id="cb68-773"><a href="#cb68-773" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-774"><a href="#cb68-774" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-775"><a href="#cb68-775" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-776"><a href="#cb68-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-777"><a href="#cb68-777" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb68-778"><a href="#cb68-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-779"><a href="#cb68-779" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, <span class="fu">as.character</span>(N))),</span>
<span id="cb68-780"><a href="#cb68-780" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(N_numeric), <span class="dv">0</span>, N_numeric)  </span>
<span id="cb68-781"><a href="#cb68-781" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-782"><a href="#cb68-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName, Population, N, N_numeric) <span class="sc">%&gt;%</span></span>
<span id="cb68-783"><a href="#cb68-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb68-784"><a href="#cb68-784" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> <span class="fu">n</span>(),                                </span>
<span id="cb68-785"><a href="#cb68-785" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Violations =</span> <span class="fu">sum</span>(Any_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),   </span>
<span id="cb68-786"><a href="#cb68-786" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Errors =</span> <span class="fu">sum</span>(ErrorFlag, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),           </span>
<span id="cb68-787"><a href="#cb68-787" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_LL_Failures =</span> <span class="fu">sum</span>(LL_Replicated <span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb68-788"><a href="#cb68-788" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_True_Violations =</span> <span class="fu">sum</span>(True_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb68-789"><a href="#cb68-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-790"><a href="#cb68-790" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage_Violations =</span> <span class="fu">round</span>((Total_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb68-791"><a href="#cb68-791" aria-hidden="true" tabindex="-1"></a>    <span class="at">True_Violation_Perc =</span> <span class="fu">round</span>((Total_True_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb68-792"><a href="#cb68-792" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> <span class="fu">round</span>((Total_Errors <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb68-793"><a href="#cb68-793" aria-hidden="true" tabindex="-1"></a>    <span class="at">LL_Failure_Perc =</span> <span class="fu">round</span>((Total_LL_Failures <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb68-794"><a href="#cb68-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-795"><a href="#cb68-795" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb68-796"><a href="#cb68-796" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-797"><a href="#cb68-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-798"><a href="#cb68-798" aria-hidden="true" tabindex="-1"></a>    <span class="at">Additional_Runs =</span> (<span class="dv">500</span> <span class="sc">+</span> Total_Violations) <span class="sc">*</span> (Percentage_Violations <span class="sc">/</span> <span class="dv">100</span>), </span>
<span id="cb68-799"><a href="#cb68-799" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replications_Needed =</span> <span class="fu">ceiling</span>(<span class="dv">500</span> <span class="sc">+</span> Total_Violations <span class="sc">+</span> Additional_Runs <span class="sc">+</span> <span class="dv">20</span>),</span>
<span id="cb68-800"><a href="#cb68-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-801"><a href="#cb68-801" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replications_Needed =</span> <span class="fu">if_else</span>(Replications_Needed <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="dv">500</span>, Replications_Needed),</span>
<span id="cb68-802"><a href="#cb68-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-803"><a href="#cb68-803" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adjusted_Replications_Needed =</span> <span class="fu">ceiling</span>(Replications_Needed <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> ErrorRate <span class="sc">/</span> <span class="dv">100</span>)), <span class="co">#+ 100,</span></span>
<span id="cb68-804"><a href="#cb68-804" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adjusted_Replications_Needed =</span> <span class="fu">if_else</span>(Adjusted_Replications_Needed <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="dv">500</span>, Adjusted_Replications_Needed),</span>
<span id="cb68-805"><a href="#cb68-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-806"><a href="#cb68-806" aria-hidden="true" tabindex="-1"></a>    <span class="at">TPs =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-807"><a href="#cb68-807" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">~</span> <span class="fl">1.385</span>,</span>
<span id="cb68-808"><a href="#cb68-808" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".700"</span> <span class="sc">~</span> <span class="fl">0.85</span>,</span>
<span id="cb68-809"><a href="#cb68-809" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".600"</span> <span class="sc">~</span> <span class="fl">0.41</span>,</span>
<span id="cb68-810"><a href="#cb68-810" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".400"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.41</span>,</span>
<span id="cb68-811"><a href="#cb68-811" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".300"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.85</span>,</span>
<span id="cb68-812"><a href="#cb68-812" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">1.385</span>,</span>
<span id="cb68-813"><a href="#cb68-813" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb68-814"><a href="#cb68-814" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-815"><a href="#cb68-815" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-816"><a href="#cb68-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">factor</span>(N_numeric, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>)), <span class="fu">as.numeric</span>(Population)) <span class="sc">%&gt;%</span></span>
<span id="cb68-817"><a href="#cb68-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-818"><a href="#cb68-818" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>, <span class="st">"N = 4000"</span>)),  </span>
<span id="cb68-819"><a href="#cb68-819" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>, <span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>))  </span>
<span id="cb68-820"><a href="#cb68-820" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-821"><a href="#cb68-821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb68-822"><a href="#cb68-822" aria-hidden="true" tabindex="-1"></a>    N, N_numeric, Population, TPs,   </span>
<span id="cb68-823"><a href="#cb68-823" aria-hidden="true" tabindex="-1"></a>    Total_Rows,  </span>
<span id="cb68-824"><a href="#cb68-824" aria-hidden="true" tabindex="-1"></a>    Total_Violations, Percentage_Violations,  </span>
<span id="cb68-825"><a href="#cb68-825" aria-hidden="true" tabindex="-1"></a>    Total_Errors, ErrorRate,  </span>
<span id="cb68-826"><a href="#cb68-826" aria-hidden="true" tabindex="-1"></a>    Total_LL_Failures, LL_Failure_Perc,  </span>
<span id="cb68-827"><a href="#cb68-827" aria-hidden="true" tabindex="-1"></a>    Total_True_Violations, True_Violation_Perc,  </span>
<span id="cb68-828"><a href="#cb68-828" aria-hidden="true" tabindex="-1"></a>    Replications_Needed, Adjusted_Replications_Needed  </span>
<span id="cb68-829"><a href="#cb68-829" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-830"><a href="#cb68-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(N_numeric, Population) <span class="sc">%&gt;%</span></span>
<span id="cb68-831"><a href="#cb68-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_numeric =</span> <span class="fu">trimws</span>(<span class="fu">as.numeric</span>(N_numeric)))</span>
<span id="cb68-832"><a href="#cb68-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-833"><a href="#cb68-833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-834"><a href="#cb68-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-835"><a href="#cb68-835" aria-hidden="true" tabindex="-1"></a><span class="fu">### Create APA Flextable of Label Switching, Errors, and Replications Needed for PART 2</span></span>
<span id="cb68-836"><a href="#cb68-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-839"><a href="#cb68-839" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-840"><a href="#cb68-840" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "summarize-violations-errors"</span></span>
<span id="cb68-841"><a href="#cb68-841" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-842"><a href="#cb68-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-843"><a href="#cb68-843" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-844"><a href="#cb68-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-845"><a href="#cb68-845" aria-hidden="true" tabindex="-1"></a>create_flextable <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb68-846"><a href="#cb68-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-847"><a href="#cb68-847" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure only the required columns are used</span></span>
<span id="cb68-848"><a href="#cb68-848" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb68-849"><a href="#cb68-849" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb68-850"><a href="#cb68-850" aria-hidden="true" tabindex="-1"></a>      N_numeric,  </span>
<span id="cb68-851"><a href="#cb68-851" aria-hidden="true" tabindex="-1"></a>      Population,  </span>
<span id="cb68-852"><a href="#cb68-852" aria-hidden="true" tabindex="-1"></a>      Total_Violations,</span>
<span id="cb68-853"><a href="#cb68-853" aria-hidden="true" tabindex="-1"></a>      Percentage_Violations,</span>
<span id="cb68-854"><a href="#cb68-854" aria-hidden="true" tabindex="-1"></a>      Total_Errors,</span>
<span id="cb68-855"><a href="#cb68-855" aria-hidden="true" tabindex="-1"></a>      ErrorRate,</span>
<span id="cb68-856"><a href="#cb68-856" aria-hidden="true" tabindex="-1"></a>      Total_LL_Failures,</span>
<span id="cb68-857"><a href="#cb68-857" aria-hidden="true" tabindex="-1"></a>      LL_Failure_Perc,</span>
<span id="cb68-858"><a href="#cb68-858" aria-hidden="true" tabindex="-1"></a>      Total_True_Violations,</span>
<span id="cb68-859"><a href="#cb68-859" aria-hidden="true" tabindex="-1"></a>      True_Violation_Perc,</span>
<span id="cb68-860"><a href="#cb68-860" aria-hidden="true" tabindex="-1"></a>      Replications_Needed,</span>
<span id="cb68-861"><a href="#cb68-861" aria-hidden="true" tabindex="-1"></a>      Adjusted_Replications_Needed</span>
<span id="cb68-862"><a href="#cb68-862" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb68-863"><a href="#cb68-863" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()  <span class="co"># Ensures proper structure before passing to flextable</span></span>
<span id="cb68-864"><a href="#cb68-864" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-865"><a href="#cb68-865" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the flextable</span></span>
<span id="cb68-866"><a href="#cb68-866" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb68-867"><a href="#cb68-867" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_header_labels</span>(</span>
<span id="cb68-868"><a href="#cb68-868" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_numeric =</span> <span class="st">"N"</span>,</span>
<span id="cb68-869"><a href="#cb68-869" aria-hidden="true" tabindex="-1"></a>      <span class="at">Population =</span> <span class="st">"Tâ‚â‚"</span>,  <span class="co"># Column remains "Population"</span></span>
<span id="cb68-870"><a href="#cb68-870" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Violations =</span> <span class="st">"V"</span>,</span>
<span id="cb68-871"><a href="#cb68-871" aria-hidden="true" tabindex="-1"></a>      <span class="at">Percentage_Violations =</span> <span class="st">"V %"</span>,</span>
<span id="cb68-872"><a href="#cb68-872" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Errors =</span> <span class="st">"\u03B5"</span>,  <span class="co"># Epsilon</span></span>
<span id="cb68-873"><a href="#cb68-873" aria-hidden="true" tabindex="-1"></a>      <span class="at">ErrorRate =</span> <span class="st">"\u03B5 %"</span>,</span>
<span id="cb68-874"><a href="#cb68-874" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_LL_Failures =</span> <span class="st">"\u2112\u2097"</span>,  <span class="co"># â„’â‚—</span></span>
<span id="cb68-875"><a href="#cb68-875" aria-hidden="true" tabindex="-1"></a>      <span class="at">LL_Failure_Perc =</span> <span class="st">"\u2112\u2097 %"</span>,  <span class="co"># â„’â‚—%</span></span>
<span id="cb68-876"><a href="#cb68-876" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_True_Violations =</span> <span class="st">"\u03C4\u1D65"</span>,  <span class="co"># Tau subscript v (ðœáµ¥)</span></span>
<span id="cb68-877"><a href="#cb68-877" aria-hidden="true" tabindex="-1"></a>      <span class="at">True_Violation_Perc =</span> <span class="st">"\u03C4\u1D65 %"</span>,</span>
<span id="cb68-878"><a href="#cb68-878" aria-hidden="true" tabindex="-1"></a>      <span class="at">Replications_Needed =</span> <span class="st">"Reps Reqâ€™d"</span>,</span>
<span id="cb68-879"><a href="#cb68-879" aria-hidden="true" tabindex="-1"></a>      <span class="at">Adjusted_Replications_Needed =</span> <span class="st">"\u2206 Reps Reqâ€™d"</span>  <span class="co"># Delta Symbol</span></span>
<span id="cb68-880"><a href="#cb68-880" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-881"><a href="#cb68-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-882"><a href="#cb68-882" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply special formatting to headers</span></span>
<span id="cb68-883"><a href="#cb68-883" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"N"</span>)))</span>
<span id="cb68-884"><a href="#cb68-884" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"T"</span>), <span class="fu">as_sub</span>(<span class="st">"11"</span>)))</span>
<span id="cb68-885"><a href="#cb68-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-886"><a href="#cb68-886" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ðŸ”¹ Label Switching Violations</span></span>
<span id="cb68-887"><a href="#cb68-887" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>)))</span>
<span id="cb68-888"><a href="#cb68-888" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Percentage_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>), <span class="st">"%"</span>))</span>
<span id="cb68-889"><a href="#cb68-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-890"><a href="#cb68-890" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ðŸ”¹ Mplus Errors</span></span>
<span id="cb68-891"><a href="#cb68-891" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_Errors"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>)))  </span>
<span id="cb68-892"><a href="#cb68-892" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"ErrorRate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>), <span class="st">"%"</span>))</span>
<span id="cb68-893"><a href="#cb68-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-894"><a href="#cb68-894" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ðŸ”¹ NEW: LL Replication Failures (â„’â‚—)</span></span>
<span id="cb68-895"><a href="#cb68-895" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_LL_Failures"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u2112"</span>), <span class="fu">as_sub</span>(<span class="st">"â‚—"</span>)))</span>
<span id="cb68-896"><a href="#cb68-896" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"LL_Failure_Perc"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u2112"</span>), <span class="fu">as_sub</span>(<span class="st">"â‚—"</span>), <span class="st">"%"</span>))</span>
<span id="cb68-897"><a href="#cb68-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-898"><a href="#cb68-898" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ”¹ True Violations (ðœáµ¥)</span></span>
<span id="cb68-899"><a href="#cb68-899" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_True_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="fu">as_i</span>(<span class="st">"v"</span>))))  </span>
<span id="cb68-900"><a href="#cb68-900" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"True_Violation_Perc"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="fu">as_i</span>(<span class="st">"v"</span>)), <span class="st">"%"</span>))  </span>
<span id="cb68-901"><a href="#cb68-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-902"><a href="#cb68-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-903"><a href="#cb68-903" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ðŸ”¹ Replication Counts</span></span>
<span id="cb68-904"><a href="#cb68-904" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Replications_Needed"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"Reps"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Req'd"</span>))</span>
<span id="cb68-905"><a href="#cb68-905" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Adjusted_Replications_Needed"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u2206"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as_i</span>(<span class="st">"Reps"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Req'd"</span>))</span>
<span id="cb68-906"><a href="#cb68-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-907"><a href="#cb68-907" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply width settings</span></span>
<span id="cb68-908"><a href="#cb68-908" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">width =</span> <span class="fl">1.0</span>)</span>
<span id="cb68-909"><a href="#cb68-909" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)  </span>
<span id="cb68-910"><a href="#cb68-910" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-911"><a href="#cb68-911" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Percentage_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-912"><a href="#cb68-912" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_Errors"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb68-913"><a href="#cb68-913" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"ErrorRate"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb68-914"><a href="#cb68-914" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_LL_Failures"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb68-915"><a href="#cb68-915" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"LL_Failure_Perc"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb68-916"><a href="#cb68-916" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_True_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-917"><a href="#cb68-917" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"True_Violation_Perc"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-918"><a href="#cb68-918" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Replications_Needed"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-919"><a href="#cb68-919" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Adjusted_Replications_Needed"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-920"><a href="#cb68-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-921"><a href="#cb68-921" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">colformat_num</span>(</span>
<span id="cb68-922"><a href="#cb68-922" aria-hidden="true" tabindex="-1"></a>  ft,</span>
<span id="cb68-923"><a href="#cb68-923" aria-hidden="true" tabindex="-1"></a>  <span class="at">j =</span> <span class="fu">c</span>(<span class="st">"Percentage_Violations"</span>, <span class="st">"ErrorRate"</span>, <span class="st">"LL_Failure_Perc"</span>, <span class="st">"True_Violation_Perc"</span> ),  </span>
<span id="cb68-924"><a href="#cb68-924" aria-hidden="true" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="st">"%"</span>  <span class="co"># âœ… Adds percentage symbol</span></span>
<span id="cb68-925"><a href="#cb68-925" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-926"><a href="#cb68-926" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add padding below the subheaders</span></span>
<span id="cb68-927"><a href="#cb68-927" aria-hidden="true" tabindex="-1"></a><span class="co">#ft &lt;- ft %&gt;%</span></span>
<span id="cb68-928"><a href="#cb68-928" aria-hidden="true" tabindex="-1"></a> <span class="co"># padding(part = "header", padding = c(0, 0, 6, 0))  # Adjust as needed for top, right, bottom, and left padding</span></span>
<span id="cb68-929"><a href="#cb68-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-930"><a href="#cb68-930" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enable autofit</span></span>
<span id="cb68-931"><a href="#cb68-931" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">set_table_properties</span>(ft, <span class="at">layout =</span> <span class="st">"fixed"</span>)</span>
<span id="cb68-932"><a href="#cb68-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-933"><a href="#cb68-933" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Center all cells</span></span>
<span id="cb68-934"><a href="#cb68-934" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">align</span>(ft, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb68-935"><a href="#cb68-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-936"><a href="#cb68-936" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Align header text at the bottom of the cells</span></span>
<span id="cb68-937"><a href="#cb68-937" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ft &lt;- valign(ft, part = "header", valign = "bottom")</span></span>
<span id="cb68-938"><a href="#cb68-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-939"><a href="#cb68-939" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Merge vertically identical rows in the "N_numeric" column</span></span>
<span id="cb68-940"><a href="#cb68-940" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">merge_v</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>)</span>
<span id="cb68-941"><a href="#cb68-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-942"><a href="#cb68-942" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply font to the entire table</span></span>
<span id="cb68-943"><a href="#cb68-943" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">font</span>(ft, <span class="at">fontname =</span> <span class="st">"Avenir Next LT Pro"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb68-944"><a href="#cb68-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-945"><a href="#cb68-945" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(</span>
<span id="cb68-946"><a href="#cb68-946" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb68-947"><a href="#cb68-947" aria-hidden="true" tabindex="-1"></a>    <span class="at">part =</span> <span class="st">"body"</span>,</span>
<span id="cb68-948"><a href="#cb68-948" aria-hidden="true" tabindex="-1"></a>    <span class="at">j =</span> <span class="st">"N_numeric"</span>,</span>
<span id="cb68-949"><a href="#cb68-949" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="sc">~</span> <span class="sc">!</span><span class="fu">duplicated</span>(N_numeric),</span>
<span id="cb68-950"><a href="#cb68-950" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as_paragraph</span>(</span>
<span id="cb68-951"><a href="#cb68-951" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_i</span>(<span class="st">"N"</span>),  </span>
<span id="cb68-952"><a href="#cb68-952" aria-hidden="true" tabindex="-1"></a>      <span class="st">" =\u2009"</span>,  <span class="co"># THIN SPACE (Unicode U+2009)</span></span>
<span id="cb68-953"><a href="#cb68-953" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.character</span>(<span class="fu">format</span>(N_numeric, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>))  <span class="co"># Keeps proper formatting</span></span>
<span id="cb68-954"><a href="#cb68-954" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-955"><a href="#cb68-955" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-956"><a href="#cb68-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-957"><a href="#cb68-957" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add subheader row</span></span>
<span id="cb68-958"><a href="#cb68-958" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">add_header_row</span>(</span>
<span id="cb68-959"><a href="#cb68-959" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb68-960"><a href="#cb68-960" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"N Reps = 500"</span>, <span class="st">"Violations"</span>, <span class="st">"Errors"</span>, <span class="st">"LL Replication"</span>, <span class="st">"True Violations"</span>, <span class="st">"Adjustments"</span>),  </span>
<span id="cb68-961"><a href="#cb68-961" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)  </span>
<span id="cb68-962"><a href="#cb68-962" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-963"><a href="#cb68-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-964"><a href="#cb68-964" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define a transparent border</span></span>
<span id="cb68-965"><a href="#cb68-965" aria-hidden="true" tabindex="-1"></a>  no_border <span class="ot">&lt;-</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">width =</span> <span class="dv">0</span>)</span>
<span id="cb68-966"><a href="#cb68-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-967"><a href="#cb68-967" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Remove ONLY the bottom border under the first three columns (the blank subheader)**</span></span>
<span id="cb68-968"><a href="#cb68-968" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">hline</span>(ft, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">border =</span> no_border, <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb68-969"><a href="#cb68-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-970"><a href="#cb68-970" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding color with a correct method</span></span>
<span id="cb68-971"><a href="#cb68-971" aria-hidden="true" tabindex="-1"></a>  total_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)  <span class="co"># Get the total number of rows in your data</span></span>
<span id="cb68-972"><a href="#cb68-972" aria-hidden="true" tabindex="-1"></a>  color_rows <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>, total_rows)  <span class="co"># Initialize a logical vector for coloring rows</span></span>
<span id="cb68-973"><a href="#cb68-973" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, total_rows, <span class="at">by =</span> <span class="dv">12</span>)) {</span>
<span id="cb68-974"><a href="#cb68-974" aria-hidden="true" tabindex="-1"></a>    color_rows[i<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Apply color to every 6 rows</span></span>
<span id="cb68-975"><a href="#cb68-975" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-976"><a href="#cb68-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-977"><a href="#cb68-977" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply background color with a lighter shade of gray</span></span>
<span id="cb68-978"><a href="#cb68-978" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">bg</span>(ft, <span class="at">i =</span> color_rows, <span class="at">bg =</span> <span class="st">"#f0f0f0"</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb68-979"><a href="#cb68-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-980"><a href="#cb68-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ft)</span>
<span id="cb68-981"><a href="#cb68-981" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-982"><a href="#cb68-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-983"><a href="#cb68-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-984"><a href="#cb68-984" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate formatted flextables for each subset</span></span>
<span id="cb68-985"><a href="#cb68-985" aria-hidden="true" tabindex="-1"></a>violation_summary_table <span class="ot">&lt;-</span> <span class="fu">create_flextable</span>(violation_summary)</span>
<span id="cb68-986"><a href="#cb68-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-987"><a href="#cb68-987" aria-hidden="true" tabindex="-1"></a>violation_summary_table</span>
<span id="cb68-988"><a href="#cb68-988" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-989"><a href="#cb68-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-990"><a href="#cb68-990" aria-hidden="true" tabindex="-1"></a>Save Tables</span>
<span id="cb68-991"><a href="#cb68-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-994"><a href="#cb68-994" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-995"><a href="#cb68-995" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "render-violation-tables"</span></span>
<span id="cb68-996"><a href="#cb68-996" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-997"><a href="#cb68-997" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-998"><a href="#cb68-998" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-999"><a href="#cb68-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1000"><a href="#cb68-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">save_as_image</span>(violation_summary_table, <span class="at">path =</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zErrors"</span>, <span class="st">"l_l_e&amp;v_1.svg"</span>))</span>
<span id="cb68-1001"><a href="#cb68-1001" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb68-1002"><a href="#cb68-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1003"><a href="#cb68-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1004"><a href="#cb68-1004" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-1005"><a href="#cb68-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1006"><a href="#cb68-1006" aria-hidden="true" tabindex="-1"></a><span class="fu"># PART 2 Re-Run Simulations</span></span>
<span id="cb68-1007"><a href="#cb68-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1008"><a href="#cb68-1008" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-1009"><a href="#cb68-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1010"><a href="#cb68-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">### Re-Run Simulation with Dynamic Replication Conditions</span></span>
<span id="cb68-1011"><a href="#cb68-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1012"><a href="#cb68-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,eval = FALSE}</span></span>
<span id="cb68-1013"><a href="#cb68-1013" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: "lta-lta-simulation2"</span></span>
<span id="cb68-1014"><a href="#cb68-1014" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb68-1015"><a href="#cb68-1015" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb68-1016"><a href="#cb68-1016" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb68-1017"><a href="#cb68-1017" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb68-1018"><a href="#cb68-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1019"><a href="#cb68-1019" aria-hidden="true" tabindex="-1"></a><span class="in">  # Define the Mplus object with the dynamic replications</span></span>
<span id="cb68-1020"><a href="#cb68-1020" aria-hidden="true" tabindex="-1"></a><span class="in">lta_lta_func &lt;- function(N_numeric, TPs, Replications_Needed) {</span></span>
<span id="cb68-1021"><a href="#cb68-1021" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb68-1022"><a href="#cb68-1022" aria-hidden="true" tabindex="-1"></a><span class="in">  # Manually construct the MONTECARLO section with dynamic NREPS</span></span>
<span id="cb68-1023"><a href="#cb68-1023" aria-hidden="true" tabindex="-1"></a><span class="in">  montecarlo_section &lt;- glue("</span></span>
<span id="cb68-1024"><a href="#cb68-1024" aria-hidden="true" tabindex="-1"></a><span class="in">    NAMES = u11-u15 u21-u25;</span></span>
<span id="cb68-1025"><a href="#cb68-1025" aria-hidden="true" tabindex="-1"></a><span class="in">    GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb68-1026"><a href="#cb68-1026" aria-hidden="true" tabindex="-1"></a><span class="in">    CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb68-1027"><a href="#cb68-1027" aria-hidden="true" tabindex="-1"></a><span class="in">    GENCLASSES = c1(2) c2(2);</span></span>
<span id="cb68-1028"><a href="#cb68-1028" aria-hidden="true" tabindex="-1"></a><span class="in">    CLASSES = c1(2) c2(2);</span></span>
<span id="cb68-1029"><a href="#cb68-1029" aria-hidden="true" tabindex="-1"></a><span class="in">    NOBSERVATIONS = {N_numeric};</span></span>
<span id="cb68-1030"><a href="#cb68-1030" aria-hidden="true" tabindex="-1"></a><span class="in">    SEED = 07252005;</span></span>
<span id="cb68-1031"><a href="#cb68-1031" aria-hidden="true" tabindex="-1"></a><span class="in">    NREPS = {Replications_Needed};  ! Dynamic number of replications</span></span>
<span id="cb68-1032"><a href="#cb68-1032" aria-hidden="true" tabindex="-1"></a><span class="in">    !!SAVE = repM1*.dat;</span></span>
<span id="cb68-1033"><a href="#cb68-1033" aria-hidden="true" tabindex="-1"></a><span class="in">    RESULTS = LTA_LTA_N_{N_numeric}_TP_{TPs}_TH_1.csv;</span></span>
<span id="cb68-1034"><a href="#cb68-1034" aria-hidden="true" tabindex="-1"></a><span class="in">  ")</span></span>
<span id="cb68-1035"><a href="#cb68-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1036"><a href="#cb68-1036" aria-hidden="true" tabindex="-1"></a><span class="in">  # Define the Mplus model using MplusAutomation, using glue for the content</span></span>
<span id="cb68-1037"><a href="#cb68-1037" aria-hidden="true" tabindex="-1"></a><span class="in">  LTA_LTA &lt;- mplusObject(</span></span>
<span id="cb68-1038"><a href="#cb68-1038" aria-hidden="true" tabindex="-1"></a><span class="in">    TITLE = glue("Generate LTA_LTA_N_{N_numeric}_TP_{TPs}_TH_1;"),</span></span>
<span id="cb68-1039"><a href="#cb68-1039" aria-hidden="true" tabindex="-1"></a><span class="in">    MONTECARLO = montecarlo_section,  # Use the dynamically constructed MONTECARLO section</span></span>
<span id="cb68-1040"><a href="#cb68-1040" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb68-1041"><a href="#cb68-1041" aria-hidden="true" tabindex="-1"></a><span class="in">    ANALYSIS =</span></span>
<span id="cb68-1042"><a href="#cb68-1042" aria-hidden="true" tabindex="-1"></a><span class="in">      "TYPE = MIXTURE;</span></span>
<span id="cb68-1043"><a href="#cb68-1043" aria-hidden="true" tabindex="-1"></a><span class="in">      processors = 24;</span></span>
<span id="cb68-1044"><a href="#cb68-1044" aria-hidden="true" tabindex="-1"></a><span class="in">      starts= 50 10;</span></span>
<span id="cb68-1045"><a href="#cb68-1045" aria-hidden="true" tabindex="-1"></a><span class="in">      logcriterion=0.00001;</span></span>
<span id="cb68-1046"><a href="#cb68-1046" aria-hidden="true" tabindex="-1"></a><span class="in">      mconv=0.00001;",</span></span>
<span id="cb68-1047"><a href="#cb68-1047" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb68-1048"><a href="#cb68-1048" aria-hidden="true" tabindex="-1"></a><span class="in">    OUTPUT = "TECH9",</span></span>
<span id="cb68-1049"><a href="#cb68-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1050"><a href="#cb68-1050" aria-hidden="true" tabindex="-1"></a><span class="in">    MODELPOPULATION = glue("    </span></span>
<span id="cb68-1051"><a href="#cb68-1051" aria-hidden="true" tabindex="-1"></a><span class="in">        %OVERALL%</span></span>
<span id="cb68-1052"><a href="#cb68-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1053"><a href="#cb68-1053" aria-hidden="true" tabindex="-1"></a><span class="in">       [c1#1-c2#1*0];</span></span>
<span id="cb68-1054"><a href="#cb68-1054" aria-hidden="true" tabindex="-1"></a><span class="in">        c2#1 on c1#1*{TPs};</span></span>
<span id="cb68-1055"><a href="#cb68-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1056"><a href="#cb68-1056" aria-hidden="true" tabindex="-1"></a><span class="in">      MODEL POPULATION-c1:</span></span>
<span id="cb68-1057"><a href="#cb68-1057" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#1%</span></span>
<span id="cb68-1058"><a href="#cb68-1058" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb68-1059"><a href="#cb68-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1060"><a href="#cb68-1060" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#2%</span></span>
<span id="cb68-1061"><a href="#cb68-1061" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb68-1062"><a href="#cb68-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1063"><a href="#cb68-1063" aria-hidden="true" tabindex="-1"></a><span class="in">      MODEL POPULATION-c2:  </span></span>
<span id="cb68-1064"><a href="#cb68-1064" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#1%</span></span>
<span id="cb68-1065"><a href="#cb68-1065" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb68-1066"><a href="#cb68-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1067"><a href="#cb68-1067" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#2%</span></span>
<span id="cb68-1068"><a href="#cb68-1068" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb68-1069"><a href="#cb68-1069" aria-hidden="true" tabindex="-1"></a><span class="in">       "),</span></span>
<span id="cb68-1070"><a href="#cb68-1070" aria-hidden="true" tabindex="-1"></a><span class="in">     </span></span>
<span id="cb68-1071"><a href="#cb68-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1072"><a href="#cb68-1072" aria-hidden="true" tabindex="-1"></a><span class="in">    MODEL =</span></span>
<span id="cb68-1073"><a href="#cb68-1073" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("    </span></span>
<span id="cb68-1074"><a href="#cb68-1074" aria-hidden="true" tabindex="-1"></a><span class="in">        %OVERALL%</span></span>
<span id="cb68-1075"><a href="#cb68-1075" aria-hidden="true" tabindex="-1"></a><span class="in">          [c1#1-c2#1*0](par1-par2);</span></span>
<span id="cb68-1076"><a href="#cb68-1076" aria-hidden="true" tabindex="-1"></a><span class="in">            c2#1 on c1#1*{TPs} (par11);</span></span>
<span id="cb68-1077"><a href="#cb68-1077" aria-hidden="true" tabindex="-1"></a><span class="in">            </span></span>
<span id="cb68-1078"><a href="#cb68-1078" aria-hidden="true" tabindex="-1"></a><span class="in">     MODEL c1:</span></span>
<span id="cb68-1079"><a href="#cb68-1079" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#1%</span></span>
<span id="cb68-1080"><a href="#cb68-1080" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb68-1081"><a href="#cb68-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1082"><a href="#cb68-1082" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#2%</span></span>
<span id="cb68-1083"><a href="#cb68-1083" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb68-1084"><a href="#cb68-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1085"><a href="#cb68-1085" aria-hidden="true" tabindex="-1"></a><span class="in">    MODEL c2:   </span></span>
<span id="cb68-1086"><a href="#cb68-1086" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#1%</span></span>
<span id="cb68-1087"><a href="#cb68-1087" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb68-1088"><a href="#cb68-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1089"><a href="#cb68-1089" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#2%</span></span>
<span id="cb68-1090"><a href="#cb68-1090" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb68-1091"><a href="#cb68-1091" aria-hidden="true" tabindex="-1"></a><span class="in">          "),</span></span>
<span id="cb68-1092"><a href="#cb68-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1093"><a href="#cb68-1093" aria-hidden="true" tabindex="-1"></a><span class="in">    MODELCONSTRAINT = if (TPs == 1.385) {</span></span>
<span id="cb68-1094"><a href="#cb68-1094" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("</span></span>
<span id="cb68-1095"><a href="#cb68-1095" aria-hidden="true" tabindex="-1"></a><span class="in">      New(trans11*.80 trans12*.20 trans21*.5 trans22*.5 </span></span>
<span id="cb68-1096"><a href="#cb68-1096" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11*.5 prob12*.5 prob21*.65 prob22*.35);</span></span>
<span id="cb68-1097"><a href="#cb68-1097" aria-hidden="true" tabindex="-1"></a><span class="in">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-1098"><a href="#cb68-1098" aria-hidden="true" tabindex="-1"></a><span class="in">      trans12 = 1-trans11;</span></span>
<span id="cb68-1099"><a href="#cb68-1099" aria-hidden="true" tabindex="-1"></a><span class="in">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-1100"><a href="#cb68-1100" aria-hidden="true" tabindex="-1"></a><span class="in">      trans22 = 1-trans21;</span></span>
<span id="cb68-1101"><a href="#cb68-1101" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-1102"><a href="#cb68-1102" aria-hidden="true" tabindex="-1"></a><span class="in">      prob12 = 1 - prob11;</span></span>
<span id="cb68-1103"><a href="#cb68-1103" aria-hidden="true" tabindex="-1"></a><span class="in">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb68-1104"><a href="#cb68-1104" aria-hidden="true" tabindex="-1"></a><span class="in">      prob22 = 1- prob21;</span></span>
<span id="cb68-1105"><a href="#cb68-1105" aria-hidden="true" tabindex="-1"></a><span class="in">      ")</span></span>
<span id="cb68-1106"><a href="#cb68-1106" aria-hidden="true" tabindex="-1"></a><span class="in">    } else if (TPs == .85) {</span></span>
<span id="cb68-1107"><a href="#cb68-1107" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("</span></span>
<span id="cb68-1108"><a href="#cb68-1108" aria-hidden="true" tabindex="-1"></a><span class="in">      New(trans11*.70 trans12*.30 trans21*.5 trans22*.5 </span></span>
<span id="cb68-1109"><a href="#cb68-1109" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11*.5 prob12*.5 prob21*.60 prob22*.40);</span></span>
<span id="cb68-1110"><a href="#cb68-1110" aria-hidden="true" tabindex="-1"></a><span class="in">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-1111"><a href="#cb68-1111" aria-hidden="true" tabindex="-1"></a><span class="in">      trans12 = 1-trans11;</span></span>
<span id="cb68-1112"><a href="#cb68-1112" aria-hidden="true" tabindex="-1"></a><span class="in">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-1113"><a href="#cb68-1113" aria-hidden="true" tabindex="-1"></a><span class="in">      trans22 = 1-trans21;</span></span>
<span id="cb68-1114"><a href="#cb68-1114" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-1115"><a href="#cb68-1115" aria-hidden="true" tabindex="-1"></a><span class="in">      prob12 = 1 - prob11;</span></span>
<span id="cb68-1116"><a href="#cb68-1116" aria-hidden="true" tabindex="-1"></a><span class="in">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb68-1117"><a href="#cb68-1117" aria-hidden="true" tabindex="-1"></a><span class="in">      prob22 = 1- prob21;</span></span>
<span id="cb68-1118"><a href="#cb68-1118" aria-hidden="true" tabindex="-1"></a><span class="in">      ")</span></span>
<span id="cb68-1119"><a href="#cb68-1119" aria-hidden="true" tabindex="-1"></a><span class="in">    } else if (TPs == .41) {</span></span>
<span id="cb68-1120"><a href="#cb68-1120" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("</span></span>
<span id="cb68-1121"><a href="#cb68-1121" aria-hidden="true" tabindex="-1"></a><span class="in">      New(trans11*.60 trans12*.40 trans21*.5 trans22*.5 </span></span>
<span id="cb68-1122"><a href="#cb68-1122" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11*.5 prob12*.5 prob21*.55 prob22*.45);</span></span>
<span id="cb68-1123"><a href="#cb68-1123" aria-hidden="true" tabindex="-1"></a><span class="in">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-1124"><a href="#cb68-1124" aria-hidden="true" tabindex="-1"></a><span class="in">      trans12 = 1-trans11;</span></span>
<span id="cb68-1125"><a href="#cb68-1125" aria-hidden="true" tabindex="-1"></a><span class="in">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-1126"><a href="#cb68-1126" aria-hidden="true" tabindex="-1"></a><span class="in">      trans22 = 1-trans21;</span></span>
<span id="cb68-1127"><a href="#cb68-1127" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-1128"><a href="#cb68-1128" aria-hidden="true" tabindex="-1"></a><span class="in">      prob12 = 1 - prob11;</span></span>
<span id="cb68-1129"><a href="#cb68-1129" aria-hidden="true" tabindex="-1"></a><span class="in">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb68-1130"><a href="#cb68-1130" aria-hidden="true" tabindex="-1"></a><span class="in">      prob22 = 1- prob21;</span></span>
<span id="cb68-1131"><a href="#cb68-1131" aria-hidden="true" tabindex="-1"></a><span class="in">      ")</span></span>
<span id="cb68-1132"><a href="#cb68-1132" aria-hidden="true" tabindex="-1"></a><span class="in">    } else if (TPs == -.41) {</span></span>
<span id="cb68-1133"><a href="#cb68-1133" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("</span></span>
<span id="cb68-1134"><a href="#cb68-1134" aria-hidden="true" tabindex="-1"></a><span class="in">      New(trans11*.40 trans12*.60 trans21*.5 trans22*.5 </span></span>
<span id="cb68-1135"><a href="#cb68-1135" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11*.5 prob12*.5 prob21*.45 prob22*.55);</span></span>
<span id="cb68-1136"><a href="#cb68-1136" aria-hidden="true" tabindex="-1"></a><span class="in">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-1137"><a href="#cb68-1137" aria-hidden="true" tabindex="-1"></a><span class="in">      trans12 = 1-trans11;</span></span>
<span id="cb68-1138"><a href="#cb68-1138" aria-hidden="true" tabindex="-1"></a><span class="in">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-1139"><a href="#cb68-1139" aria-hidden="true" tabindex="-1"></a><span class="in">      trans22 = 1-trans21;</span></span>
<span id="cb68-1140"><a href="#cb68-1140" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-1141"><a href="#cb68-1141" aria-hidden="true" tabindex="-1"></a><span class="in">      prob12 = 1 - prob11;</span></span>
<span id="cb68-1142"><a href="#cb68-1142" aria-hidden="true" tabindex="-1"></a><span class="in">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb68-1143"><a href="#cb68-1143" aria-hidden="true" tabindex="-1"></a><span class="in">      prob22 = 1- prob21;</span></span>
<span id="cb68-1144"><a href="#cb68-1144" aria-hidden="true" tabindex="-1"></a><span class="in">      ")</span></span>
<span id="cb68-1145"><a href="#cb68-1145" aria-hidden="true" tabindex="-1"></a><span class="in">    } else if (TPs == -.85) {</span></span>
<span id="cb68-1146"><a href="#cb68-1146" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("</span></span>
<span id="cb68-1147"><a href="#cb68-1147" aria-hidden="true" tabindex="-1"></a><span class="in">      New(trans11*.30 trans12*.70 trans21*.5 trans22*.5 </span></span>
<span id="cb68-1148"><a href="#cb68-1148" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11*.5 prob12*.5 prob21*.40 prob22*.60);</span></span>
<span id="cb68-1149"><a href="#cb68-1149" aria-hidden="true" tabindex="-1"></a><span class="in">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-1150"><a href="#cb68-1150" aria-hidden="true" tabindex="-1"></a><span class="in">      trans12 = 1-trans11;</span></span>
<span id="cb68-1151"><a href="#cb68-1151" aria-hidden="true" tabindex="-1"></a><span class="in">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-1152"><a href="#cb68-1152" aria-hidden="true" tabindex="-1"></a><span class="in">      trans22 = 1-trans21;</span></span>
<span id="cb68-1153"><a href="#cb68-1153" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-1154"><a href="#cb68-1154" aria-hidden="true" tabindex="-1"></a><span class="in">      prob12 = 1 - prob11;</span></span>
<span id="cb68-1155"><a href="#cb68-1155" aria-hidden="true" tabindex="-1"></a><span class="in">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb68-1156"><a href="#cb68-1156" aria-hidden="true" tabindex="-1"></a><span class="in">      prob22 = 1- prob21;</span></span>
<span id="cb68-1157"><a href="#cb68-1157" aria-hidden="true" tabindex="-1"></a><span class="in">      ")</span></span>
<span id="cb68-1158"><a href="#cb68-1158" aria-hidden="true" tabindex="-1"></a><span class="in">    } else if (TPs == -1.385) {</span></span>
<span id="cb68-1159"><a href="#cb68-1159" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("</span></span>
<span id="cb68-1160"><a href="#cb68-1160" aria-hidden="true" tabindex="-1"></a><span class="in">      New(trans11*.20 trans12*.80 trans21*.5 trans22*.5 </span></span>
<span id="cb68-1161"><a href="#cb68-1161" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11*.5 prob12*.5 prob21*.35 prob22*.65);</span></span>
<span id="cb68-1162"><a href="#cb68-1162" aria-hidden="true" tabindex="-1"></a><span class="in">      trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb68-1163"><a href="#cb68-1163" aria-hidden="true" tabindex="-1"></a><span class="in">      trans12 = 1-trans11;</span></span>
<span id="cb68-1164"><a href="#cb68-1164" aria-hidden="true" tabindex="-1"></a><span class="in">      trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb68-1165"><a href="#cb68-1165" aria-hidden="true" tabindex="-1"></a><span class="in">      trans22 = 1-trans21;</span></span>
<span id="cb68-1166"><a href="#cb68-1166" aria-hidden="true" tabindex="-1"></a><span class="in">      prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb68-1167"><a href="#cb68-1167" aria-hidden="true" tabindex="-1"></a><span class="in">      prob12 = 1 - prob11;</span></span>
<span id="cb68-1168"><a href="#cb68-1168" aria-hidden="true" tabindex="-1"></a><span class="in">      prob21 = prob11*trans11 + prob12*trans21;</span></span>
<span id="cb68-1169"><a href="#cb68-1169" aria-hidden="true" tabindex="-1"></a><span class="in">      prob22 = 1- prob21;</span></span>
<span id="cb68-1170"><a href="#cb68-1170" aria-hidden="true" tabindex="-1"></a><span class="in">      ")</span></span>
<span id="cb68-1171"><a href="#cb68-1171" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb68-1172"><a href="#cb68-1172" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-1173"><a href="#cb68-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1174"><a href="#cb68-1174" aria-hidden="true" tabindex="-1"></a><span class="in">  # Run the Mplus model using MplusAutomation</span></span>
<span id="cb68-1175"><a href="#cb68-1175" aria-hidden="true" tabindex="-1"></a><span class="in">  LTA_LTA_Model &lt;- mplusModeler(LTA_LTA,</span></span>
<span id="cb68-1176"><a href="#cb68-1176" aria-hidden="true" tabindex="-1"></a><span class="in">                                dataout = here('Simulations', 'STUDY_1', "2 Time Points", "1_2T_LTA_GEN_LTA_ANALYZED_REP", glue("LTA_LTA_N_{N_numeric}_TP_{TPs}_TH_1.dat")),</span></span>
<span id="cb68-1177"><a href="#cb68-1177" aria-hidden="true" tabindex="-1"></a><span class="in">                                modelout = here('Simulations', 'STUDY_1', "2 Time Points", "1_2T_LTA_GEN_LTA_ANALYZED_REP", glue("LTA_LTA_N_{N_numeric}_TP_{TPs}_TH_1.inp")),</span></span>
<span id="cb68-1178"><a href="#cb68-1178" aria-hidden="true" tabindex="-1"></a><span class="in">                                run = 1, check = TRUE)</span></span>
<span id="cb68-1179"><a href="#cb68-1179" aria-hidden="true" tabindex="-1"></a><span class="in">  return(LTA_LTA_Model)</span></span>
<span id="cb68-1180"><a href="#cb68-1180" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb68-1181"><a href="#cb68-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1182"><a href="#cb68-1182" aria-hidden="true" tabindex="-1"></a><span class="in">library(parallel)</span></span>
<span id="cb68-1183"><a href="#cb68-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1184"><a href="#cb68-1184" aria-hidden="true" tabindex="-1"></a><span class="in"># Start the cluster</span></span>
<span id="cb68-1185"><a href="#cb68-1185" aria-hidden="true" tabindex="-1"></a><span class="in">num_cores &lt;- detectCores() - 1</span></span>
<span id="cb68-1186"><a href="#cb68-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1187"><a href="#cb68-1187" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 2: Select the cluster type based on the system (PSOCK for Windows, FORK for macOS/Linux)</span></span>
<span id="cb68-1188"><a href="#cb68-1188" aria-hidden="true" tabindex="-1"></a><span class="in">cluster_type &lt;- ifelse(.Platform$OS.type == "windows", "PSOCK", "FORK")</span></span>
<span id="cb68-1189"><a href="#cb68-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1190"><a href="#cb68-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1191"><a href="#cb68-1191" aria-hidden="true" tabindex="-1"></a><span class="in">cl &lt;- makeCluster(num_cores, type = cluster_type)</span></span>
<span id="cb68-1192"><a href="#cb68-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1193"><a href="#cb68-1193" aria-hidden="true" tabindex="-1"></a><span class="in"># Export necessary objects to the cluster</span></span>
<span id="cb68-1194"><a href="#cb68-1194" aria-hidden="true" tabindex="-1"></a><span class="in">clusterExport(cl, c("lta_lta_func", "violation_summary", "here", "glue", "mplusModeler", "mplusObject"))</span></span>
<span id="cb68-1195"><a href="#cb68-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1196"><a href="#cb68-1196" aria-hidden="true" tabindex="-1"></a><span class="in"># Ensure required libraries are loaded on each node</span></span>
<span id="cb68-1197"><a href="#cb68-1197" aria-hidden="true" tabindex="-1"></a><span class="in">clusterEvalQ(cl, {</span></span>
<span id="cb68-1198"><a href="#cb68-1198" aria-hidden="true" tabindex="-1"></a><span class="in">  library(MplusAutomation)</span></span>
<span id="cb68-1199"><a href="#cb68-1199" aria-hidden="true" tabindex="-1"></a><span class="in">  library(glue)</span></span>
<span id="cb68-1200"><a href="#cb68-1200" aria-hidden="true" tabindex="-1"></a><span class="in">  library(here)</span></span>
<span id="cb68-1201"><a href="#cb68-1201" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb68-1202"><a href="#cb68-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1203"><a href="#cb68-1203" aria-hidden="true" tabindex="-1"></a><span class="in">result_list &lt;- parLapply(cl, 1:nrow(violation_summary), function(i) {</span></span>
<span id="cb68-1204"><a href="#cb68-1204" aria-hidden="true" tabindex="-1"></a><span class="in">  lta_lta_func(</span></span>
<span id="cb68-1205"><a href="#cb68-1205" aria-hidden="true" tabindex="-1"></a><span class="in">    violation_summary$N_numeric[i], </span></span>
<span id="cb68-1206"><a href="#cb68-1206" aria-hidden="true" tabindex="-1"></a><span class="in">    violation_summary$TPs[i],  </span></span>
<span id="cb68-1207"><a href="#cb68-1207" aria-hidden="true" tabindex="-1"></a><span class="in">    violation_summary$Replications_Needed[i]</span></span>
<span id="cb68-1208"><a href="#cb68-1208" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb68-1209"><a href="#cb68-1209" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb68-1210"><a href="#cb68-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1211"><a href="#cb68-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1212"><a href="#cb68-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1213"><a href="#cb68-1213" aria-hidden="true" tabindex="-1"></a><span class="in"># Stop the cluster after the simulation</span></span>
<span id="cb68-1214"><a href="#cb68-1214" aria-hidden="true" tabindex="-1"></a><span class="in">stopCluster(cl)</span></span>
<span id="cb68-1215"><a href="#cb68-1215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1216"><a href="#cb68-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1217"><a href="#cb68-1217" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-1218"><a href="#cb68-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1219"><a href="#cb68-1219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Check for Label Switching and Errors - Part 2</span></span>
<span id="cb68-1220"><a href="#cb68-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1221"><a href="#cb68-1221" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In this section: we re conduct the steps for aggregating the label switching and errors to guarantee that we will have at minimum 500 replications per condition.</span></span>
<span id="cb68-1222"><a href="#cb68-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1223"><a href="#cb68-1223" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-1224"><a href="#cb68-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1225"><a href="#cb68-1225" aria-hidden="true" tabindex="-1"></a>*Load all CSV files and combine them into a single data frame.*</span>
<span id="cb68-1226"><a href="#cb68-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1229"><a href="#cb68-1229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1230"><a href="#cb68-1230" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "combine-csv-files-parallel2"</span></span>
<span id="cb68-1231"><a href="#cb68-1231" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1232"><a href="#cb68-1232" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1233"><a href="#cb68-1233" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1234"><a href="#cb68-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1235"><a href="#cb68-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1236"><a href="#cb68-1236" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct CSV directory</span></span>
<span id="cb68-1237"><a href="#cb68-1237" aria-hidden="true" tabindex="-1"></a>csv_directory <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'1_2T_LTA_GEN_LTA_ANALYZED_REP'</span>)</span>
<span id="cb68-1238"><a href="#cb68-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1239"><a href="#cb68-1239" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document</span></span>
<span id="cb68-1240"><a href="#cb68-1240" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'data_scraping.R'</span>))</span>
<span id="cb68-1241"><a href="#cb68-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1242"><a href="#cb68-1242" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate combine_data data frame in the global environment </span></span>
<span id="cb68-1243"><a href="#cb68-1243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1244"><a href="#cb68-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1245"><a href="#cb68-1245" aria-hidden="true" tabindex="-1"></a>Extract data from the appropriate rows from each 9-row chunk and prepare the data for further processing.</span>
<span id="cb68-1246"><a href="#cb68-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1249"><a href="#cb68-1249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1250"><a href="#cb68-1250" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "scrape-rows-process-data-parallel2"</span></span>
<span id="cb68-1251"><a href="#cb68-1251" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1252"><a href="#cb68-1252" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1253"><a href="#cb68-1253" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1254"><a href="#cb68-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1255"><a href="#cb68-1255" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Process the data using the child script</span></span>
<span id="cb68-1256"><a href="#cb68-1256" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step2_2t_LTA.R'</span>))</span>
<span id="cb68-1257"><a href="#cb68-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1258"><a href="#cb68-1258" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate final_combined data in global environment</span></span>
<span id="cb68-1259"><a href="#cb68-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1260"><a href="#cb68-1260" aria-hidden="true" tabindex="-1"></a>final_combined_data <span class="ot">&lt;-</span> final_combined_data <span class="sc">%&gt;%</span></span>
<span id="cb68-1261"><a href="#cb68-1261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-1262"><a href="#cb68-1262" aria-hidden="true" tabindex="-1"></a>    <span class="at">TRANS11 =</span> <span class="fu">as.numeric</span>(TRANS11),</span>
<span id="cb68-1263"><a href="#cb68-1263" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_11 =</span> <span class="fu">as.numeric</span>(SE_11),</span>
<span id="cb68-1264"><a href="#cb68-1264" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Ec"</span>), as.numeric),  <span class="co"># Convert all Ec columns</span></span>
<span id="cb68-1265"><a href="#cb68-1265" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_csv =</span> <span class="fu">as.numeric</span>(ll_csv)  <span class="co"># Convert Log-Likelihood values</span></span>
<span id="cb68-1266"><a href="#cb68-1266" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1267"><a href="#cb68-1267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1268"><a href="#cb68-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1269"><a href="#cb68-1269" aria-hidden="true" tabindex="-1"></a>*Convert the logits to probabilities and add the known actual values to each row.*</span>
<span id="cb68-1270"><a href="#cb68-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1273"><a href="#cb68-1273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1274"><a href="#cb68-1274" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "convert-logits-to-probabilities2"</span></span>
<span id="cb68-1275"><a href="#cb68-1275" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1276"><a href="#cb68-1276" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1277"><a href="#cb68-1277" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1278"><a href="#cb68-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1279"><a href="#cb68-1279" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Process the data and return results</span></span>
<span id="cb68-1280"><a href="#cb68-1280" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step_3.R'</span>))</span>
<span id="cb68-1281"><a href="#cb68-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1282"><a href="#cb68-1282" aria-hidden="true" tabindex="-1"></a><span class="co"># The objects `final_data_with_actuals` and `violators` should now be in the global environment</span></span>
<span id="cb68-1283"><a href="#cb68-1283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1284"><a href="#cb68-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1285"><a href="#cb68-1285" aria-hidden="true" tabindex="-1"></a>*Scrape Output Files for Errors*</span>
<span id="cb68-1286"><a href="#cb68-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1289"><a href="#cb68-1289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1290"><a href="#cb68-1290" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "process-out-files-parallel2"</span></span>
<span id="cb68-1291"><a href="#cb68-1291" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1292"><a href="#cb68-1292" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1293"><a href="#cb68-1293" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1294"><a href="#cb68-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1295"><a href="#cb68-1295" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct output directory for .out files</span></span>
<span id="cb68-1296"><a href="#cb68-1296" aria-hidden="true" tabindex="-1"></a>output_folder <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'1_2T_LTA_GEN_LTA_ANALYZED_REP'</span>)</span>
<span id="cb68-1297"><a href="#cb68-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1298"><a href="#cb68-1298" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document that processes .out files</span></span>
<span id="cb68-1299"><a href="#cb68-1299" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'out_scraping.R'</span>))</span>
<span id="cb68-1300"><a href="#cb68-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1301"><a href="#cb68-1301" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb68-1302"><a href="#cb68-1302" aria-hidden="true" tabindex="-1"></a><span class="co">#  âœ… SECTION 1 Generate Replication Summary Table</span></span>
<span id="cb68-1303"><a href="#cb68-1303" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb68-1304"><a href="#cb68-1304" aria-hidden="true" tabindex="-1"></a>replication_summary_table <span class="ot">&lt;-</span> replication_summary <span class="sc">%&gt;%</span></span>
<span id="cb68-1305"><a href="#cb68-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-1306"><a href="#cb68-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-1307"><a href="#cb68-1307" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Replication Summary"</span>,</span>
<span id="cb68-1308"><a href="#cb68-1308" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Folder: "</span>, output_folder)</span>
<span id="cb68-1309"><a href="#cb68-1309" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1310"><a href="#cb68-1310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb68-1311"><a href="#cb68-1311" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Total"</span>, <span class="st">"Replicated_Yes"</span>, <span class="st">"Replicated_No"</span>, <span class="st">"Error_Count"</span>),</span>
<span id="cb68-1312"><a href="#cb68-1312" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb68-1313"><a href="#cb68-1313" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1314"><a href="#cb68-1314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb68-1315"><a href="#cb68-1315" aria-hidden="true" tabindex="-1"></a>    <span class="at">FileName =</span> <span class="st">"File Name"</span>,</span>
<span id="cb68-1316"><a href="#cb68-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="st">"Total Replications"</span>,</span>
<span id="cb68-1317"><a href="#cb68-1317" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replicated_Yes =</span> <span class="st">"LL Replicated"</span>,</span>
<span id="cb68-1318"><a href="#cb68-1318" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replicated_No =</span> <span class="st">"LL Not Replicated"</span>,</span>
<span id="cb68-1319"><a href="#cb68-1319" aria-hidden="true" tabindex="-1"></a>    <span class="at">Error_Count =</span> <span class="st">"Errors"</span></span>
<span id="cb68-1320"><a href="#cb68-1320" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1321"><a href="#cb68-1321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb68-1322"><a href="#cb68-1322" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb68-1323"><a href="#cb68-1323" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb68-1324"><a href="#cb68-1324" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1325"><a href="#cb68-1325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb68-1326"><a href="#cb68-1326" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb68-1327"><a href="#cb68-1327" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb68-1328"><a href="#cb68-1328" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb68-1329"><a href="#cb68-1329" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">80</span>)</span>
<span id="cb68-1330"><a href="#cb68-1330" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1331"><a href="#cb68-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1332"><a href="#cb68-1332" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb68-1333"><a href="#cb68-1333" aria-hidden="true" tabindex="-1"></a>replication_summary_table</span>
<span id="cb68-1334"><a href="#cb68-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1335"><a href="#cb68-1335" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb68-1336"><a href="#cb68-1336" aria-hidden="true" tabindex="-1"></a><span class="co">#  âœ… SECTION 2 Row Count Validation</span></span>
<span id="cb68-1337"><a href="#cb68-1337" aria-hidden="true" tabindex="-1"></a><span class="co"># ===================================================== #</span></span>
<span id="cb68-1338"><a href="#cb68-1338" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_data_with_actuals:"</span>, <span class="fu">nrow</span>(final_data_with_actuals), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-1339"><a href="#cb68-1339" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_results:"</span>, <span class="fu">nrow</span>(final_results), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-1340"><a href="#cb68-1340" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in replication_summary:"</span>, <span class="fu">nrow</span>(replication_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-1341"><a href="#cb68-1341" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="cf">if</span> (<span class="fu">any</span>(replication_summary<span class="sc">$</span>LL_Not_Replicated <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb68-1342"><a href="#cb68-1342" aria-hidden="true" tabindex="-1"></a>  <span class="st">"âš ï¸ WARNING: Some LL values were NOT replicated! Check the Replication Summary table."</span></span>
<span id="cb68-1343"><a href="#cb68-1343" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb68-1344"><a href="#cb68-1344" aria-hidden="true" tabindex="-1"></a>  <span class="st">"âœ… All LL values were successfully replicated."</span></span>
<span id="cb68-1345"><a href="#cb68-1345" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb68-1346"><a href="#cb68-1346" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(final_data_with_actuals<span class="sc">$</span>ll_csv, final_results<span class="sc">$</span>ll_out, <span class="at">tolerance =</span> <span class="fl">1e-4</span>)</span>
<span id="cb68-1347"><a href="#cb68-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1348"><a href="#cb68-1348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1349"><a href="#cb68-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1350"><a href="#cb68-1350" aria-hidden="true" tabindex="-1"></a><span class="fu">### Merge Errors with Main Data File</span></span>
<span id="cb68-1351"><a href="#cb68-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1352"><a href="#cb68-1352" aria-hidden="true" tabindex="-1"></a>*Combine error information with main data file*</span>
<span id="cb68-1353"><a href="#cb68-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1356"><a href="#cb68-1356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1357"><a href="#cb68-1357" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "merge-errors2"</span></span>
<span id="cb68-1358"><a href="#cb68-1358" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1359"><a href="#cb68-1359" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1360"><a href="#cb68-1360" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1361"><a href="#cb68-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1362"><a href="#cb68-1362" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb68-1363"><a href="#cb68-1363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb68-1364"><a href="#cb68-1364" aria-hidden="true" tabindex="-1"></a>    final_results <span class="sc">%&gt;%</span> <span class="fu">select</span>(FileName, Replication, ll_out, LL_Replicated, ErrorFlag), </span>
<span id="cb68-1365"><a href="#cb68-1365" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"FileName"</span>, <span class="st">"Replication"</span>)</span>
<span id="cb68-1366"><a href="#cb68-1366" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1367"><a href="#cb68-1367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-1368"><a href="#cb68-1368" aria-hidden="true" tabindex="-1"></a>    <span class="at">Any_Violation =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Any_Violation), <span class="dv">0</span>, Any_Violation),</span>
<span id="cb68-1369"><a href="#cb68-1369" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorFlag =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(ErrorFlag), <span class="dv">0</span>, ErrorFlag),</span>
<span id="cb68-1370"><a href="#cb68-1370" aria-hidden="true" tabindex="-1"></a>    <span class="at">LL_Replicated =</span> <span class="fu">ifelse</span>(LL_Replicated <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),  <span class="co"># âœ… Convert Yes/No to 1/0</span></span>
<span id="cb68-1371"><a href="#cb68-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1372"><a href="#cb68-1372" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ðŸ”¹ Create a new True Violation column</span></span>
<span id="cb68-1373"><a href="#cb68-1373" aria-hidden="true" tabindex="-1"></a>    <span class="at">True_Violation =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-1374"><a href="#cb68-1374" aria-hidden="true" tabindex="-1"></a>      Any_Violation <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> ErrorFlag <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> LL_Replicated <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># âœ… At least one violation</span></span>
<span id="cb68-1375"><a href="#cb68-1375" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb68-1376"><a href="#cb68-1376" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-1377"><a href="#cb68-1377" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1378"><a href="#cb68-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1379"><a href="#cb68-1379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1380"><a href="#cb68-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1381"><a href="#cb68-1381" aria-hidden="true" tabindex="-1"></a>Visualize differences between ll_out and ll_csv</span>
<span id="cb68-1382"><a href="#cb68-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1385"><a href="#cb68-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1386"><a href="#cb68-1386" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe with only rows where ll_out and ll_csv differ</span></span>
<span id="cb68-1387"><a href="#cb68-1387" aria-hidden="true" tabindex="-1"></a>ll_mismatch <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb68-1388"><a href="#cb68-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">round</span>(ll_out <span class="sc">-</span> ll_csv, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-1389"><a href="#cb68-1389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(diff <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-1390"><a href="#cb68-1390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FileName, Replication, ll_out, ll_csv, diff)</span>
<span id="cb68-1391"><a href="#cb68-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1392"><a href="#cb68-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1393"><a href="#cb68-1393" aria-hidden="true" tabindex="-1"></a>ll_check <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb68-1394"><a href="#cb68-1394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">round</span>(ll_out <span class="sc">-</span> ll_csv, <span class="dv">3</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Round before counting</span></span>
<span id="cb68-1395"><a href="#cb68-1395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(diff)</span>
<span id="cb68-1396"><a href="#cb68-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1397"><a href="#cb68-1397" aria-hidden="true" tabindex="-1"></a>ll_check_table <span class="ot">&lt;-</span> ll_check <span class="sc">%&gt;%</span></span>
<span id="cb68-1398"><a href="#cb68-1398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-1399"><a href="#cb68-1399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb68-1400"><a href="#cb68-1400" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"LL Difference Summary"</span>,</span>
<span id="cb68-1401"><a href="#cb68-1401" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Comparison of LL values between CSV and OUT files"</span></span>
<span id="cb68-1402"><a href="#cb68-1402" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1403"><a href="#cb68-1403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb68-1404"><a href="#cb68-1404" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff =</span> <span class="st">"LL Difference"</span>,</span>
<span id="cb68-1405"><a href="#cb68-1405" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="st">"Count"</span></span>
<span id="cb68-1406"><a href="#cb68-1406" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1407"><a href="#cb68-1407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb68-1408"><a href="#cb68-1408" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> diff,</span>
<span id="cb68-1409"><a href="#cb68-1409" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb68-1410"><a href="#cb68-1410" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1411"><a href="#cb68-1411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb68-1412"><a href="#cb68-1412" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb68-1413"><a href="#cb68-1413" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb68-1414"><a href="#cb68-1414" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1415"><a href="#cb68-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb68-1416"><a href="#cb68-1416" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb68-1417"><a href="#cb68-1417" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb68-1418"><a href="#cb68-1418" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb68-1419"><a href="#cb68-1419" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">50</span>)</span>
<span id="cb68-1420"><a href="#cb68-1420" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1421"><a href="#cb68-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1422"><a href="#cb68-1422" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb68-1423"><a href="#cb68-1423" aria-hidden="true" tabindex="-1"></a>ll_check_table</span>
<span id="cb68-1424"><a href="#cb68-1424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1425"><a href="#cb68-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1426"><a href="#cb68-1426" aria-hidden="true" tabindex="-1"></a>*Create Column Names from the File Name*</span>
<span id="cb68-1427"><a href="#cb68-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1430"><a href="#cb68-1430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1431"><a href="#cb68-1431" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "create-column-names-from-filename2"</span></span>
<span id="cb68-1432"><a href="#cb68-1432" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1433"><a href="#cb68-1433" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1434"><a href="#cb68-1434" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1435"><a href="#cb68-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1436"><a href="#cb68-1436" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns based on the information in the FileName and set factors</span></span>
<span id="cb68-1437"><a href="#cb68-1437" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb68-1438"><a href="#cb68-1438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-1439"><a href="#cb68-1439" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the sample size (N) from the FileName with the correct values</span></span>
<span id="cb68-1440"><a href="#cb68-1440" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-1441"><a href="#cb68-1441" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_4000"</span>, FileName) <span class="sc">~</span> <span class="dv">4</span>,  <span class="co"># Correct value for N_4000</span></span>
<span id="cb68-1442"><a href="#cb68-1442" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_500"</span>, FileName) <span class="sc">~</span> <span class="dv">1</span>,   </span>
<span id="cb68-1443"><a href="#cb68-1443" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_1000"</span>, FileName) <span class="sc">~</span> <span class="dv">2</span>,  </span>
<span id="cb68-1444"><a href="#cb68-1444" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_2000"</span>, FileName) <span class="sc">~</span> <span class="dv">3</span>,  </span>
<span id="cb68-1445"><a href="#cb68-1445" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb68-1446"><a href="#cb68-1446" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb68-1447"><a href="#cb68-1447" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map the TPs from the FileName to the appropriate Population labels</span></span>
<span id="cb68-1448"><a href="#cb68-1448" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-1449"><a href="#cb68-1449" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".800"</span>,  </span>
<span id="cb68-1450"><a href="#cb68-1450" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".700"</span>,  </span>
<span id="cb68-1451"><a href="#cb68-1451" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".600"</span>,   </span>
<span id="cb68-1452"><a href="#cb68-1452" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".400"</span>,  </span>
<span id="cb68-1453"><a href="#cb68-1453" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".300"</span>, </span>
<span id="cb68-1454"><a href="#cb68-1454" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".200"</span>,</span>
<span id="cb68-1455"><a href="#cb68-1455" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb68-1456"><a href="#cb68-1456" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb68-1457"><a href="#cb68-1457" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the Transitions variable based on Population values</span></span>
<span id="cb68-1458"><a href="#cb68-1458" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-1459"><a href="#cb68-1459" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>) <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># Assign 1 for Population .200, .300, .400</span></span>
<span id="cb68-1460"><a href="#cb68-1460" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>) <span class="sc">~</span> <span class="dv">2</span>,  <span class="co"># Assign 2 for Population .600, .700, .800</span></span>
<span id="cb68-1461"><a href="#cb68-1461" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb68-1462"><a href="#cb68-1462" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-1463"><a href="#cb68-1463" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1464"><a href="#cb68-1464" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert columns to factors, ordering N_4000 first in the factor levels</span></span>
<span id="cb68-1465"><a href="#cb68-1465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-1466"><a href="#cb68-1466" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"N = 4000"</span>, <span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>)),</span>
<span id="cb68-1467"><a href="#cb68-1467" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".800"</span>, <span class="st">".700"</span>, <span class="st">".600"</span>, <span class="st">".400"</span>, <span class="st">".300"</span>, <span class="st">".200"</span>)),</span>
<span id="cb68-1468"><a href="#cb68-1468" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">factor</span>(Transitions, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mover"</span>, <span class="st">"Stayer"</span>))</span>
<span id="cb68-1469"><a href="#cb68-1469" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1470"><a href="#cb68-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1471"><a href="#cb68-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1472"><a href="#cb68-1472" aria-hidden="true" tabindex="-1"></a>*Calculate Violation Percentages per Condition*</span>
<span id="cb68-1473"><a href="#cb68-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1476"><a href="#cb68-1476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1477"><a href="#cb68-1477" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "calculate-violations2"</span></span>
<span id="cb68-1478"><a href="#cb68-1478" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1479"><a href="#cb68-1479" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1480"><a href="#cb68-1480" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1481"><a href="#cb68-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1482"><a href="#cb68-1482" aria-hidden="true" tabindex="-1"></a>violation_summary2 <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb68-1483"><a href="#cb68-1483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-1484"><a href="#cb68-1484" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure numeric conversion for N</span></span>
<span id="cb68-1485"><a href="#cb68-1485" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, <span class="fu">as.character</span>(N))),</span>
<span id="cb68-1486"><a href="#cb68-1486" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(N_numeric), <span class="dv">0</span>, N_numeric)  <span class="co"># Ensure no missing values</span></span>
<span id="cb68-1487"><a href="#cb68-1487" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1488"><a href="#cb68-1488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName, Population, N, N_numeric) <span class="sc">%&gt;%</span></span>
<span id="cb68-1489"><a href="#cb68-1489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb68-1490"><a href="#cb68-1490" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> <span class="fu">n</span>(),</span>
<span id="cb68-1491"><a href="#cb68-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1492"><a href="#cb68-1492" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Label Switching Violations</span></span>
<span id="cb68-1493"><a href="#cb68-1493" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Violations =</span> <span class="fu">sum</span>(Any_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),   </span>
<span id="cb68-1494"><a href="#cb68-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1495"><a href="#cb68-1495" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Mplus Errors</span></span>
<span id="cb68-1496"><a href="#cb68-1496" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Errors =</span> <span class="fu">sum</span>(ErrorFlag, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),           </span>
<span id="cb68-1497"><a href="#cb68-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1498"><a href="#cb68-1498" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… LL Replication Failures</span></span>
<span id="cb68-1499"><a href="#cb68-1499" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_LL_Failures =</span> <span class="fu">sum</span>(LL_Replicated <span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb68-1500"><a href="#cb68-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1501"><a href="#cb68-1501" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Compute True Violation Count</span></span>
<span id="cb68-1502"><a href="#cb68-1502" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_True_Violations =</span> <span class="fu">sum</span>(True_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb68-1503"><a href="#cb68-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1504"><a href="#cb68-1504" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Compute Violation Percentages</span></span>
<span id="cb68-1505"><a href="#cb68-1505" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage_Violations =</span> <span class="fu">round</span>((Total_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb68-1506"><a href="#cb68-1506" aria-hidden="true" tabindex="-1"></a>    <span class="at">True_Violation_Perc =</span> <span class="fu">round</span>((Total_True_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb68-1507"><a href="#cb68-1507" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> <span class="fu">round</span>((Total_Errors <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb68-1508"><a href="#cb68-1508" aria-hidden="true" tabindex="-1"></a>    <span class="at">LL_Failure_Perc =</span> <span class="fu">round</span>((Total_LL_Failures <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),  </span>
<span id="cb68-1509"><a href="#cb68-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1510"><a href="#cb68-1510" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb68-1511"><a href="#cb68-1511" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1512"><a href="#cb68-1512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-1513"><a href="#cb68-1513" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Compute Good Replications</span></span>
<span id="cb68-1514"><a href="#cb68-1514" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> Total_Rows <span class="sc">-</span> Total_True_Violations,</span>
<span id="cb68-1515"><a href="#cb68-1515" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> <span class="fu">ifelse</span>(GoodReplications <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, GoodReplications),</span>
<span id="cb68-1516"><a href="#cb68-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1517"><a href="#cb68-1517" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Reanalysis Needed Flag</span></span>
<span id="cb68-1518"><a href="#cb68-1518" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reanalysis_Needed =</span> <span class="fu">if_else</span>(GoodReplications <span class="sc">&gt;=</span> <span class="dv">500</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>),</span>
<span id="cb68-1519"><a href="#cb68-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1520"><a href="#cb68-1520" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… Assign Transition Probabilities (TPs) based on Population</span></span>
<span id="cb68-1521"><a href="#cb68-1521" aria-hidden="true" tabindex="-1"></a>    <span class="at">TPs =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-1522"><a href="#cb68-1522" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">~</span> <span class="fl">1.385</span>,</span>
<span id="cb68-1523"><a href="#cb68-1523" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".700"</span> <span class="sc">~</span> <span class="fl">0.85</span>,</span>
<span id="cb68-1524"><a href="#cb68-1524" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".600"</span> <span class="sc">~</span> <span class="fl">0.41</span>,</span>
<span id="cb68-1525"><a href="#cb68-1525" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".400"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.41</span>,</span>
<span id="cb68-1526"><a href="#cb68-1526" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".300"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.85</span>,</span>
<span id="cb68-1527"><a href="#cb68-1527" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">1.385</span>,</span>
<span id="cb68-1528"><a href="#cb68-1528" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb68-1529"><a href="#cb68-1529" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-1530"><a href="#cb68-1530" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1531"><a href="#cb68-1531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">factor</span>(N_numeric, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>)), <span class="fu">as.numeric</span>(Population)) <span class="sc">%&gt;%</span></span>
<span id="cb68-1532"><a href="#cb68-1532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-1533"><a href="#cb68-1533" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>, <span class="st">"N = 4000"</span>)),</span>
<span id="cb68-1534"><a href="#cb68-1534" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>, <span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>))</span>
<span id="cb68-1535"><a href="#cb68-1535" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1536"><a href="#cb68-1536" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-1537"><a href="#cb68-1537" aria-hidden="true" tabindex="-1"></a>  <span class="co"># âœ… FINAL SELECTION </span></span>
<span id="cb68-1538"><a href="#cb68-1538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb68-1539"><a href="#cb68-1539" aria-hidden="true" tabindex="-1"></a>    FileName, Population, N, N_numeric, TPs,  </span>
<span id="cb68-1540"><a href="#cb68-1540" aria-hidden="true" tabindex="-1"></a>    Total_Rows,  </span>
<span id="cb68-1541"><a href="#cb68-1541" aria-hidden="true" tabindex="-1"></a>    Total_Violations, Percentage_Violations,  </span>
<span id="cb68-1542"><a href="#cb68-1542" aria-hidden="true" tabindex="-1"></a>    Total_Errors, ErrorRate,  </span>
<span id="cb68-1543"><a href="#cb68-1543" aria-hidden="true" tabindex="-1"></a>    Total_LL_Failures, LL_Failure_Perc,  </span>
<span id="cb68-1544"><a href="#cb68-1544" aria-hidden="true" tabindex="-1"></a>    Total_True_Violations, True_Violation_Perc,  </span>
<span id="cb68-1545"><a href="#cb68-1545" aria-hidden="true" tabindex="-1"></a>    GoodReplications,  </span>
<span id="cb68-1546"><a href="#cb68-1546" aria-hidden="true" tabindex="-1"></a>    Reanalysis_Needed  <span class="co"># </span></span>
<span id="cb68-1547"><a href="#cb68-1547" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1548"><a href="#cb68-1548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(N_numeric, Population) <span class="sc">%&gt;%</span></span>
<span id="cb68-1549"><a href="#cb68-1549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_numeric =</span> <span class="fu">trimws</span>(<span class="fu">as.numeric</span>(N_numeric)))</span>
<span id="cb68-1550"><a href="#cb68-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1551"><a href="#cb68-1551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1552"><a href="#cb68-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1553"><a href="#cb68-1553" aria-hidden="true" tabindex="-1"></a>*Summarize &amp; Visualize Label Switching Percentage Results*</span>
<span id="cb68-1554"><a href="#cb68-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1557"><a href="#cb68-1557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1558"><a href="#cb68-1558" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "summarize-violations-errors2"</span></span>
<span id="cb68-1559"><a href="#cb68-1559" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1560"><a href="#cb68-1560" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1561"><a href="#cb68-1561" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1562"><a href="#cb68-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1563"><a href="#cb68-1563" aria-hidden="true" tabindex="-1"></a>create_flextable <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb68-1564"><a href="#cb68-1564" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-1565"><a href="#cb68-1565" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure only the required columns are used</span></span>
<span id="cb68-1566"><a href="#cb68-1566" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb68-1567"><a href="#cb68-1567" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb68-1568"><a href="#cb68-1568" aria-hidden="true" tabindex="-1"></a>      N_numeric,  </span>
<span id="cb68-1569"><a href="#cb68-1569" aria-hidden="true" tabindex="-1"></a>      Population,  </span>
<span id="cb68-1570"><a href="#cb68-1570" aria-hidden="true" tabindex="-1"></a>      Total_Violations,</span>
<span id="cb68-1571"><a href="#cb68-1571" aria-hidden="true" tabindex="-1"></a>      Percentage_Violations,</span>
<span id="cb68-1572"><a href="#cb68-1572" aria-hidden="true" tabindex="-1"></a>      Total_Errors,</span>
<span id="cb68-1573"><a href="#cb68-1573" aria-hidden="true" tabindex="-1"></a>      ErrorRate,</span>
<span id="cb68-1574"><a href="#cb68-1574" aria-hidden="true" tabindex="-1"></a>      Total_LL_Failures,</span>
<span id="cb68-1575"><a href="#cb68-1575" aria-hidden="true" tabindex="-1"></a>      LL_Failure_Perc,</span>
<span id="cb68-1576"><a href="#cb68-1576" aria-hidden="true" tabindex="-1"></a>      Total_True_Violations,</span>
<span id="cb68-1577"><a href="#cb68-1577" aria-hidden="true" tabindex="-1"></a>      True_Violation_Perc,</span>
<span id="cb68-1578"><a href="#cb68-1578" aria-hidden="true" tabindex="-1"></a>      GoodReplications,</span>
<span id="cb68-1579"><a href="#cb68-1579" aria-hidden="true" tabindex="-1"></a>      Reanalysis_Needed</span>
<span id="cb68-1580"><a href="#cb68-1580" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1581"><a href="#cb68-1581" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()  <span class="co"># Ensure proper structure before passing to flextable</span></span>
<span id="cb68-1582"><a href="#cb68-1582" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-1583"><a href="#cb68-1583" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the flextable</span></span>
<span id="cb68-1584"><a href="#cb68-1584" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb68-1585"><a href="#cb68-1585" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_header_labels</span>(</span>
<span id="cb68-1586"><a href="#cb68-1586" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_numeric =</span> <span class="st">"N"</span>,</span>
<span id="cb68-1587"><a href="#cb68-1587" aria-hidden="true" tabindex="-1"></a>      <span class="at">Population =</span> <span class="st">"T11"</span>,  </span>
<span id="cb68-1588"><a href="#cb68-1588" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Violations =</span> <span class="st">"V"</span>,</span>
<span id="cb68-1589"><a href="#cb68-1589" aria-hidden="true" tabindex="-1"></a>      <span class="at">Percentage_Violations =</span> <span class="st">"V %"</span>,</span>
<span id="cb68-1590"><a href="#cb68-1590" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Errors =</span> <span class="st">"\u03B5"</span>,  </span>
<span id="cb68-1591"><a href="#cb68-1591" aria-hidden="true" tabindex="-1"></a>      <span class="at">ErrorRate =</span> <span class="st">"\u03B5 %"</span>,</span>
<span id="cb68-1592"><a href="#cb68-1592" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_LL_Failures =</span> <span class="st">"â„’â‚—"</span>,  </span>
<span id="cb68-1593"><a href="#cb68-1593" aria-hidden="true" tabindex="-1"></a>      <span class="at">LL_Failure_Perc =</span> <span class="st">"â„’â‚— %"</span>,</span>
<span id="cb68-1594"><a href="#cb68-1594" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_True_Violations =</span> <span class="st">"\u03C4áµ¥"</span>,  </span>
<span id="cb68-1595"><a href="#cb68-1595" aria-hidden="true" tabindex="-1"></a>      <span class="at">True_Violation_Perc =</span> <span class="st">"\u03C4áµ¥ %"</span>,</span>
<span id="cb68-1596"><a href="#cb68-1596" aria-hidden="true" tabindex="-1"></a>      <span class="at">GoodReplications =</span> <span class="st">"Good Reps"</span>,</span>
<span id="cb68-1597"><a href="#cb68-1597" aria-hidden="true" tabindex="-1"></a>      <span class="at">Reanalysis_Needed =</span> <span class="st">"Reanalysis Needed"</span></span>
<span id="cb68-1598"><a href="#cb68-1598" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-1599"><a href="#cb68-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1600"><a href="#cb68-1600" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply special formatting to headers</span></span>
<span id="cb68-1601"><a href="#cb68-1601" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"N"</span>)))</span>
<span id="cb68-1602"><a href="#cb68-1602" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"T"</span>), <span class="fu">as_sub</span>(<span class="st">"11"</span>)))</span>
<span id="cb68-1603"><a href="#cb68-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1604"><a href="#cb68-1604" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Label Switching Violations</span></span>
<span id="cb68-1605"><a href="#cb68-1605" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>)))</span>
<span id="cb68-1606"><a href="#cb68-1606" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Percentage_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>), <span class="st">"%"</span>))</span>
<span id="cb68-1607"><a href="#cb68-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1608"><a href="#cb68-1608" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mplus Errors</span></span>
<span id="cb68-1609"><a href="#cb68-1609" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_Errors"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>)))  </span>
<span id="cb68-1610"><a href="#cb68-1610" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"ErrorRate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>), <span class="st">"%"</span>))</span>
<span id="cb68-1611"><a href="#cb68-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1612"><a href="#cb68-1612" aria-hidden="true" tabindex="-1"></a>  <span class="co"># LL Replication Failures</span></span>
<span id="cb68-1613"><a href="#cb68-1613" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_LL_Failures"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"â„’"</span>), <span class="fu">as_sub</span>(<span class="st">"â‚—"</span>)))  </span>
<span id="cb68-1614"><a href="#cb68-1614" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"LL_Failure_Perc"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"â„’"</span>), <span class="fu">as_sub</span>(<span class="st">"â‚—"</span>), <span class="st">"%"</span>))</span>
<span id="cb68-1615"><a href="#cb68-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1616"><a href="#cb68-1616" aria-hidden="true" tabindex="-1"></a>  <span class="co"># True Violations</span></span>
<span id="cb68-1617"><a href="#cb68-1617" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_True_Violations"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="st">"áµ¥"</span>)))  </span>
<span id="cb68-1618"><a href="#cb68-1618" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"True_Violation_Perc"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="st">"áµ¥"</span>), <span class="st">"%"</span>))  </span>
<span id="cb68-1619"><a href="#cb68-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1620"><a href="#cb68-1620" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Good Replications and Reanalysis Needed</span></span>
<span id="cb68-1621"><a href="#cb68-1621" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"GoodReplications"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Good"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Reps"</span>))</span>
<span id="cb68-1622"><a href="#cb68-1622" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Reanalysis_Needed"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Reanalysis"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Needed?"</span>))</span>
<span id="cb68-1623"><a href="#cb68-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1624"><a href="#cb68-1624" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply width settings</span></span>
<span id="cb68-1625"><a href="#cb68-1625" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">width =</span> <span class="fl">1.0</span>)</span>
<span id="cb68-1626"><a href="#cb68-1626" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)  </span>
<span id="cb68-1627"><a href="#cb68-1627" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1628"><a href="#cb68-1628" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Percentage_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1629"><a href="#cb68-1629" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_Errors"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb68-1630"><a href="#cb68-1630" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"ErrorRate"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb68-1631"><a href="#cb68-1631" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_LL_Failures"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1632"><a href="#cb68-1632" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"LL_Failure_Perc"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1633"><a href="#cb68-1633" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_True_Violations"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1634"><a href="#cb68-1634" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"True_Violation_Perc"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1635"><a href="#cb68-1635" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"GoodReplications"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1636"><a href="#cb68-1636" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Reanalysis_Needed"</span>, <span class="at">width =</span> <span class="fl">0.7</span>)</span>
<span id="cb68-1637"><a href="#cb68-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1638"><a href="#cb68-1638" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">colformat_num</span>(</span>
<span id="cb68-1639"><a href="#cb68-1639" aria-hidden="true" tabindex="-1"></a>  ft,</span>
<span id="cb68-1640"><a href="#cb68-1640" aria-hidden="true" tabindex="-1"></a>  <span class="at">j =</span> <span class="fu">c</span>(<span class="st">"Percentage_Violations"</span>, <span class="st">"ErrorRate"</span>, <span class="st">"LL_Failure_Perc"</span>, <span class="st">"True_Violation_Perc"</span> ),  </span>
<span id="cb68-1641"><a href="#cb68-1641" aria-hidden="true" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="st">"%"</span>  <span class="co"># âœ… Adds percentage symbol</span></span>
<span id="cb68-1642"><a href="#cb68-1642" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-1643"><a href="#cb68-1643" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add padding below the subheaders</span></span>
<span id="cb68-1644"><a href="#cb68-1644" aria-hidden="true" tabindex="-1"></a><span class="co">#ft &lt;- ft %&gt;%</span></span>
<span id="cb68-1645"><a href="#cb68-1645" aria-hidden="true" tabindex="-1"></a> <span class="co"># padding(part = "header", padding = c(0, 0, 6, 0))  # Adjust as needed for top, right, bottom, and left padding</span></span>
<span id="cb68-1646"><a href="#cb68-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1647"><a href="#cb68-1647" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enable autofit</span></span>
<span id="cb68-1648"><a href="#cb68-1648" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">set_table_properties</span>(ft, <span class="at">layout =</span> <span class="st">"fixed"</span>)</span>
<span id="cb68-1649"><a href="#cb68-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1650"><a href="#cb68-1650" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Center all cells</span></span>
<span id="cb68-1651"><a href="#cb68-1651" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">align</span>(ft, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb68-1652"><a href="#cb68-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1653"><a href="#cb68-1653" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Align header text at the bottom of the cells</span></span>
<span id="cb68-1654"><a href="#cb68-1654" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ft &lt;- valign(ft, part = "header", valign = "bottom")</span></span>
<span id="cb68-1655"><a href="#cb68-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1656"><a href="#cb68-1656" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Merge vertically identical rows in the "N_numeric" column</span></span>
<span id="cb68-1657"><a href="#cb68-1657" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">merge_v</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>)</span>
<span id="cb68-1658"><a href="#cb68-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1659"><a href="#cb68-1659" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply font to the entire table</span></span>
<span id="cb68-1660"><a href="#cb68-1660" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">font</span>(ft, <span class="at">fontname =</span> <span class="st">"Avenir Next LT Pro"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb68-1661"><a href="#cb68-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1662"><a href="#cb68-1662" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(</span>
<span id="cb68-1663"><a href="#cb68-1663" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb68-1664"><a href="#cb68-1664" aria-hidden="true" tabindex="-1"></a>    <span class="at">part =</span> <span class="st">"body"</span>,</span>
<span id="cb68-1665"><a href="#cb68-1665" aria-hidden="true" tabindex="-1"></a>    <span class="at">j =</span> <span class="st">"N_numeric"</span>,</span>
<span id="cb68-1666"><a href="#cb68-1666" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="sc">~</span> <span class="sc">!</span><span class="fu">duplicated</span>(N_numeric),</span>
<span id="cb68-1667"><a href="#cb68-1667" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as_paragraph</span>(</span>
<span id="cb68-1668"><a href="#cb68-1668" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_i</span>(<span class="st">"N"</span>),  </span>
<span id="cb68-1669"><a href="#cb68-1669" aria-hidden="true" tabindex="-1"></a>      <span class="st">" =\u2009"</span>,  <span class="co"># THIN SPACE (Unicode U+2009)</span></span>
<span id="cb68-1670"><a href="#cb68-1670" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.character</span>(<span class="fu">format</span>(N_numeric, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>))  <span class="co"># Keeps proper formatting</span></span>
<span id="cb68-1671"><a href="#cb68-1671" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-1672"><a href="#cb68-1672" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1673"><a href="#cb68-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1674"><a href="#cb68-1674" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add subheader row</span></span>
<span id="cb68-1675"><a href="#cb68-1675" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">add_header_row</span>(</span>
<span id="cb68-1676"><a href="#cb68-1676" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb68-1677"><a href="#cb68-1677" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"N Reps = Varies"</span>, <span class="st">"Violations"</span>, <span class="st">"Errors"</span>, <span class="st">"LL Replication"</span>, <span class="st">"True Violations"</span>, <span class="st">"Success?"</span>),  </span>
<span id="cb68-1678"><a href="#cb68-1678" aria-hidden="true" tabindex="-1"></a>    <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)  </span>
<span id="cb68-1679"><a href="#cb68-1679" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1680"><a href="#cb68-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1681"><a href="#cb68-1681" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define a transparent border</span></span>
<span id="cb68-1682"><a href="#cb68-1682" aria-hidden="true" tabindex="-1"></a>  no_border <span class="ot">&lt;-</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">width =</span> <span class="dv">0</span>)</span>
<span id="cb68-1683"><a href="#cb68-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1684"><a href="#cb68-1684" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Remove ONLY the bottom border under the first three columns (the blank subheader)**</span></span>
<span id="cb68-1685"><a href="#cb68-1685" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">hline</span>(ft, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">border =</span> no_border, <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb68-1686"><a href="#cb68-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1687"><a href="#cb68-1687" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding color with a correct method</span></span>
<span id="cb68-1688"><a href="#cb68-1688" aria-hidden="true" tabindex="-1"></a>  total_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)  <span class="co"># Get the total number of rows in your data</span></span>
<span id="cb68-1689"><a href="#cb68-1689" aria-hidden="true" tabindex="-1"></a>  color_rows <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>, total_rows)  <span class="co"># Initialize a logical vector for coloring rows</span></span>
<span id="cb68-1690"><a href="#cb68-1690" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, total_rows, <span class="at">by =</span> <span class="dv">12</span>)) {</span>
<span id="cb68-1691"><a href="#cb68-1691" aria-hidden="true" tabindex="-1"></a>    color_rows[i<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Apply color to every 6 rows</span></span>
<span id="cb68-1692"><a href="#cb68-1692" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-1693"><a href="#cb68-1693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1694"><a href="#cb68-1694" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply background color with a lighter shade of gray</span></span>
<span id="cb68-1695"><a href="#cb68-1695" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">bg</span>(ft, <span class="at">i =</span> color_rows, <span class="at">bg =</span> <span class="st">"#f0f0f0"</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb68-1696"><a href="#cb68-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1697"><a href="#cb68-1697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ft)</span>
<span id="cb68-1698"><a href="#cb68-1698" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-1699"><a href="#cb68-1699" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-1700"><a href="#cb68-1700" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate formatted flextables for each subset</span></span>
<span id="cb68-1701"><a href="#cb68-1701" aria-hidden="true" tabindex="-1"></a>violation_summary_table2 <span class="ot">&lt;-</span> <span class="fu">create_flextable</span>(violation_summary2)</span>
<span id="cb68-1702"><a href="#cb68-1702" aria-hidden="true" tabindex="-1"></a>violation_summary_table2</span>
<span id="cb68-1703"><a href="#cb68-1703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1704"><a href="#cb68-1704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1705"><a href="#cb68-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1706"><a href="#cb68-1706" aria-hidden="true" tabindex="-1"></a>Save the Table</span>
<span id="cb68-1707"><a href="#cb68-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1710"><a href="#cb68-1710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1711"><a href="#cb68-1711" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "render-violation-tables2"</span></span>
<span id="cb68-1712"><a href="#cb68-1712" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1713"><a href="#cb68-1713" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1714"><a href="#cb68-1714" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1715"><a href="#cb68-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1716"><a href="#cb68-1716" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">save_as_image</span>(violation_summary_table2, <span class="at">path =</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zErrors"</span>, <span class="st">"zl_l_e&amp;v_2.svg"</span>)</span>
<span id="cb68-1717"><a href="#cb68-1717" aria-hidden="true" tabindex="-1"></a>   ))</span>
<span id="cb68-1718"><a href="#cb68-1718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1719"><a href="#cb68-1719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1720"><a href="#cb68-1720" aria-hidden="true" tabindex="-1"></a>Prepare data for Submission Table</span>
<span id="cb68-1721"><a href="#cb68-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1724"><a href="#cb68-1724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1725"><a href="#cb68-1725" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "prepare-data-final-table"</span></span>
<span id="cb68-1726"><a href="#cb68-1726" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1727"><a href="#cb68-1727" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1728"><a href="#cb68-1728" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1729"><a href="#cb68-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1730"><a href="#cb68-1730" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Rename columns in violation_summary2 (except join keys)</span></span>
<span id="cb68-1731"><a href="#cb68-1731" aria-hidden="true" tabindex="-1"></a>violation_summary2 <span class="ot">&lt;-</span> violation_summary2 <span class="sc">%&gt;%</span></span>
<span id="cb68-1732"><a href="#cb68-1732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_2"</span>), </span>
<span id="cb68-1733"><a href="#cb68-1733" aria-hidden="true" tabindex="-1"></a>              <span class="sc">-</span><span class="fu">c</span>(Population, N, N_numeric))  <span class="co"># âœ… Remove FileName from keys</span></span>
<span id="cb68-1734"><a href="#cb68-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1735"><a href="#cb68-1735" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Merge both datasets on common keys</span></span>
<span id="cb68-1736"><a href="#cb68-1736" aria-hidden="true" tabindex="-1"></a>violation_summary_final <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb68-1737"><a href="#cb68-1737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(violation_summary2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Population"</span>, <span class="st">"N"</span>, <span class="st">"N_numeric"</span>)) <span class="sc">%&gt;%</span>  <span class="co"># âœ… Remove FileName from join</span></span>
<span id="cb68-1738"><a href="#cb68-1738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-1739"><a href="#cb68-1739" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> Total_Rows,</span>
<span id="cb68-1740"><a href="#cb68-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1741"><a href="#cb68-1741" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initial and Final Violation Rates</span></span>
<span id="cb68-1742"><a href="#cb68-1742" aria-hidden="true" tabindex="-1"></a>    <span class="at">Violation_Rate =</span> Percentage_Violations,  </span>
<span id="cb68-1743"><a href="#cb68-1743" aria-hidden="true" tabindex="-1"></a>    <span class="at">Final_Violation_Rate =</span> Percentage_Violations_2,</span>
<span id="cb68-1744"><a href="#cb68-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1745"><a href="#cb68-1745" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initial and Final LL Failure Rates</span></span>
<span id="cb68-1746"><a href="#cb68-1746" aria-hidden="true" tabindex="-1"></a>    <span class="at">LL_Failure_Rate =</span> LL_Failure_Perc,</span>
<span id="cb68-1747"><a href="#cb68-1747" aria-hidden="true" tabindex="-1"></a>    <span class="at">Final_LL_Failure_Rate =</span> LL_Failure_Perc_2,</span>
<span id="cb68-1748"><a href="#cb68-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1749"><a href="#cb68-1749" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initial and Final Error Rates</span></span>
<span id="cb68-1750"><a href="#cb68-1750" aria-hidden="true" tabindex="-1"></a>    <span class="at">Error_Rate =</span> ErrorRate,</span>
<span id="cb68-1751"><a href="#cb68-1751" aria-hidden="true" tabindex="-1"></a>    <span class="at">Final_Error_Rate =</span> ErrorRate_2,</span>
<span id="cb68-1752"><a href="#cb68-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1753"><a href="#cb68-1753" aria-hidden="true" tabindex="-1"></a>    <span class="co"># âœ… NEW: Initial and Final True Violation Rates</span></span>
<span id="cb68-1754"><a href="#cb68-1754" aria-hidden="true" tabindex="-1"></a>    <span class="at">True_Violation_Rate =</span> True_Violation_Perc,</span>
<span id="cb68-1755"><a href="#cb68-1755" aria-hidden="true" tabindex="-1"></a>    <span class="at">Final_True_Violation_Rate =</span> True_Violation_Perc_2,</span>
<span id="cb68-1756"><a href="#cb68-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1757"><a href="#cb68-1757" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replications &amp; Success</span></span>
<span id="cb68-1758"><a href="#cb68-1758" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reps_Needed_for_Success =</span> Replications_Needed,</span>
<span id="cb68-1759"><a href="#cb68-1759" aria-hidden="true" tabindex="-1"></a>    <span class="at">Successful_Replications =</span> GoodReplications_2,</span>
<span id="cb68-1760"><a href="#cb68-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1761"><a href="#cb68-1761" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Status: Check if we achieved 500+ successful replications</span></span>
<span id="cb68-1762"><a href="#cb68-1762" aria-hidden="true" tabindex="-1"></a>    <span class="at">Status =</span> <span class="fu">if_else</span>(Successful_Replications <span class="sc">&gt;=</span> <span class="dv">500</span>, <span class="st">"âœ… Fixed"</span>, <span class="st">"âš ï¸ Additional Runs Required"</span>)</span>
<span id="cb68-1763"><a href="#cb68-1763" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1764"><a href="#cb68-1764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb68-1765"><a href="#cb68-1765" aria-hidden="true" tabindex="-1"></a>    N_numeric, Population, Total_Rows, </span>
<span id="cb68-1766"><a href="#cb68-1766" aria-hidden="true" tabindex="-1"></a>    Violation_Rate, LL_Failure_Rate, Error_Rate, True_Violation_Rate,  <span class="co"># âœ… Initial Rates</span></span>
<span id="cb68-1767"><a href="#cb68-1767" aria-hidden="true" tabindex="-1"></a>    Final_Violation_Rate, Final_LL_Failure_Rate, Final_Error_Rate, Final_True_Violation_Rate,  <span class="co"># âœ… Final Rates</span></span>
<span id="cb68-1768"><a href="#cb68-1768" aria-hidden="true" tabindex="-1"></a>    Reps_Needed_for_Success, Successful_Replications, Status  <span class="co"># âœ… Success Metrics</span></span>
<span id="cb68-1769"><a href="#cb68-1769" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1770"><a href="#cb68-1770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">factor</span>(N_numeric, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>)), Population) <span class="sc">%&gt;%</span></span>
<span id="cb68-1771"><a href="#cb68-1771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_numeric =</span> <span class="fu">trimws</span>(<span class="fu">as.numeric</span>(N_numeric)))</span>
<span id="cb68-1772"><a href="#cb68-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1773"><a href="#cb68-1773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1774"><a href="#cb68-1774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1775"><a href="#cb68-1775" aria-hidden="true" tabindex="-1"></a>Create flextable Function for Final Table</span>
<span id="cb68-1776"><a href="#cb68-1776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1779"><a href="#cb68-1779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1780"><a href="#cb68-1780" aria-hidden="true" tabindex="-1"></a>create_flextable <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb68-1781"><a href="#cb68-1781" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-1782"><a href="#cb68-1782" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep only the required columns</span></span>
<span id="cb68-1783"><a href="#cb68-1783" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb68-1784"><a href="#cb68-1784" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb68-1785"><a href="#cb68-1785" aria-hidden="true" tabindex="-1"></a>      N_numeric,  </span>
<span id="cb68-1786"><a href="#cb68-1786" aria-hidden="true" tabindex="-1"></a>      Population,  </span>
<span id="cb68-1787"><a href="#cb68-1787" aria-hidden="true" tabindex="-1"></a>      Total_Rows,</span>
<span id="cb68-1788"><a href="#cb68-1788" aria-hidden="true" tabindex="-1"></a>      Violation_Rate,</span>
<span id="cb68-1789"><a href="#cb68-1789" aria-hidden="true" tabindex="-1"></a>      LL_Failure_Rate,</span>
<span id="cb68-1790"><a href="#cb68-1790" aria-hidden="true" tabindex="-1"></a>      Error_Rate,</span>
<span id="cb68-1791"><a href="#cb68-1791" aria-hidden="true" tabindex="-1"></a>      True_Violation_Rate,   <span class="co"># âœ… NEW</span></span>
<span id="cb68-1792"><a href="#cb68-1792" aria-hidden="true" tabindex="-1"></a>      Reps_Needed_for_Success,</span>
<span id="cb68-1793"><a href="#cb68-1793" aria-hidden="true" tabindex="-1"></a>      Final_Violation_Rate,</span>
<span id="cb68-1794"><a href="#cb68-1794" aria-hidden="true" tabindex="-1"></a>      Final_LL_Failure_Rate,</span>
<span id="cb68-1795"><a href="#cb68-1795" aria-hidden="true" tabindex="-1"></a>      Final_Error_Rate,</span>
<span id="cb68-1796"><a href="#cb68-1796" aria-hidden="true" tabindex="-1"></a>      Final_True_Violation_Rate,   <span class="co"># âœ… NEW</span></span>
<span id="cb68-1797"><a href="#cb68-1797" aria-hidden="true" tabindex="-1"></a>      Successful_Replications</span>
<span id="cb68-1798"><a href="#cb68-1798" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb68-1799"><a href="#cb68-1799" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()  </span>
<span id="cb68-1800"><a href="#cb68-1800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1801"><a href="#cb68-1801" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the flextable</span></span>
<span id="cb68-1802"><a href="#cb68-1802" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb68-1803"><a href="#cb68-1803" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_header_labels</span>(</span>
<span id="cb68-1804"><a href="#cb68-1804" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_numeric =</span> <span class="st">"N"</span>,</span>
<span id="cb68-1805"><a href="#cb68-1805" aria-hidden="true" tabindex="-1"></a>      <span class="at">Population =</span> <span class="st">"T11"</span>,  </span>
<span id="cb68-1806"><a href="#cb68-1806" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Rows =</span> <span class="st">"N Reps"</span>,</span>
<span id="cb68-1807"><a href="#cb68-1807" aria-hidden="true" tabindex="-1"></a>      <span class="at">Violation_Rate =</span> <span class="st">"V %"</span>,</span>
<span id="cb68-1808"><a href="#cb68-1808" aria-hidden="true" tabindex="-1"></a>      <span class="at">LL_Failure_Rate =</span> <span class="st">"â„’â‚— %"</span>,</span>
<span id="cb68-1809"><a href="#cb68-1809" aria-hidden="true" tabindex="-1"></a>      <span class="at">Error_Rate =</span> <span class="st">"\u03B5 %"</span>,</span>
<span id="cb68-1810"><a href="#cb68-1810" aria-hidden="true" tabindex="-1"></a>      <span class="at">True_Violation_Rate =</span> <span class="st">"\u03C4áµ¥ %"</span>,   <span class="co"># âœ… NEW</span></span>
<span id="cb68-1811"><a href="#cb68-1811" aria-hidden="true" tabindex="-1"></a>      <span class="at">Reps_Needed_for_Success =</span> <span class="st">"Reps Needed"</span>,</span>
<span id="cb68-1812"><a href="#cb68-1812" aria-hidden="true" tabindex="-1"></a>      <span class="at">Final_Violation_Rate =</span> <span class="st">"V %"</span>,</span>
<span id="cb68-1813"><a href="#cb68-1813" aria-hidden="true" tabindex="-1"></a>      <span class="at">Final_LL_Failure_Rate =</span> <span class="st">"â„’â‚— %"</span>,</span>
<span id="cb68-1814"><a href="#cb68-1814" aria-hidden="true" tabindex="-1"></a>      <span class="at">Final_Error_Rate =</span> <span class="st">"\u03B5 %"</span>,</span>
<span id="cb68-1815"><a href="#cb68-1815" aria-hidden="true" tabindex="-1"></a>      <span class="at">Final_True_Violation_Rate =</span> <span class="st">"\u03C4áµ¥ %"</span>,  <span class="co"># âœ… NEW</span></span>
<span id="cb68-1816"><a href="#cb68-1816" aria-hidden="true" tabindex="-1"></a>      <span class="at">Successful_Replications =</span> <span class="st">"Successful Reps"</span></span>
<span id="cb68-1817"><a href="#cb68-1817" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-1818"><a href="#cb68-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1819"><a href="#cb68-1819" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply special formatting to headers</span></span>
<span id="cb68-1820"><a href="#cb68-1820" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"N"</span>)))</span>
<span id="cb68-1821"><a href="#cb68-1821" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"T"</span>), <span class="fu">as_sub</span>(<span class="st">"11"</span>)))</span>
<span id="cb68-1822"><a href="#cb68-1822" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Total_Rows"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"N"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Reps"</span>))</span>
<span id="cb68-1823"><a href="#cb68-1823" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Violation_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>), <span class="st">"%"</span>))</span>
<span id="cb68-1824"><a href="#cb68-1824" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"LL_Failure_Rate"</span>, </span>
<span id="cb68-1825"><a href="#cb68-1825" aria-hidden="true" tabindex="-1"></a>              <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"â„’"</span>), <span class="fu">as_chunk</span>(<span class="st">"l"</span>, <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">10</span>, <span class="at">vertical.align =</span> <span class="st">"subscript"</span>)), <span class="st">"%"</span>))</span>
<span id="cb68-1826"><a href="#cb68-1826" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Error_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>), <span class="st">"%"</span>))</span>
<span id="cb68-1827"><a href="#cb68-1827" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"True_Violation_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="st">"áµ¥"</span>), <span class="st">"%"</span>))  <span class="co"># âœ… NEW</span></span>
<span id="cb68-1828"><a href="#cb68-1828" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Final_Violation_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"V"</span>), <span class="st">"%"</span>))</span>
<span id="cb68-1829"><a href="#cb68-1829" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Final_LL_Failure_Rate"</span>, </span>
<span id="cb68-1830"><a href="#cb68-1830" aria-hidden="true" tabindex="-1"></a>              <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"â„’"</span>), <span class="fu">as_chunk</span>(<span class="st">"l"</span>, <span class="at">props =</span> <span class="fu">fp_text</span>(<span class="at">font.size =</span> <span class="dv">10</span>, <span class="at">vertical.align =</span> <span class="st">"subscript"</span>)), <span class="st">"%"</span>))</span>
<span id="cb68-1831"><a href="#cb68-1831" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Final_Error_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03B5"</span>), <span class="st">"%"</span>))</span>
<span id="cb68-1832"><a href="#cb68-1832" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Final_True_Violation_Rate"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"\u03C4"</span>), <span class="fu">as_sub</span>(<span class="st">"áµ¥"</span>), <span class="st">"%"</span>))  <span class="co"># âœ… NEW</span></span>
<span id="cb68-1833"><a href="#cb68-1833" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Reps_Needed_for_Success"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_i</span>(<span class="st">"N"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Reps 2"</span>))</span>
<span id="cb68-1834"><a href="#cb68-1834" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(ft, <span class="at">part =</span> <span class="st">"header"</span>, <span class="at">j =</span> <span class="st">"Successful_Replications"</span>, <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">"Successful"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Reps"</span>))</span>
<span id="cb68-1835"><a href="#cb68-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1836"><a href="#cb68-1836" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set column widths</span></span>
<span id="cb68-1837"><a href="#cb68-1837" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb68-1838"><a href="#cb68-1838" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Population"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)  </span>
<span id="cb68-1839"><a href="#cb68-1839" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Total_Rows"</span>, <span class="at">width =</span> <span class="fl">0.6</span>) </span>
<span id="cb68-1840"><a href="#cb68-1840" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Violation_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1841"><a href="#cb68-1841" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"LL_Failure_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1842"><a href="#cb68-1842" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Error_Rate"</span>, <span class="at">width =</span> <span class="fl">0.4</span>)</span>
<span id="cb68-1843"><a href="#cb68-1843" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"True_Violation_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)  <span class="co"># âœ… NEW</span></span>
<span id="cb68-1844"><a href="#cb68-1844" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Reps_Needed_for_Success"</span>, <span class="at">width =</span> .<span class="dv">7</span>)</span>
<span id="cb68-1845"><a href="#cb68-1845" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Final_Violation_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1846"><a href="#cb68-1846" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Final_LL_Failure_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb68-1847"><a href="#cb68-1847" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Final_Error_Rate"</span>, <span class="at">width =</span> <span class="fl">0.4</span>)</span>
<span id="cb68-1848"><a href="#cb68-1848" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Final_True_Violation_Rate"</span>, <span class="at">width =</span> <span class="fl">0.6</span>)  <span class="co"># âœ… NEW</span></span>
<span id="cb68-1849"><a href="#cb68-1849" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">j =</span> <span class="st">"Successful_Replications"</span>, <span class="at">width =</span> .<span class="dv">6</span>)</span>
<span id="cb68-1850"><a href="#cb68-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1851"><a href="#cb68-1851" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-1852"><a href="#cb68-1852" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-1853"><a href="#cb68-1853" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Correct vertical centering: Merge "N = _" across 6-row blocks**</span></span>
<span id="cb68-1854"><a href="#cb68-1854" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">merge_v</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>)  </span>
<span id="cb68-1855"><a href="#cb68-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1856"><a href="#cb68-1856" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Ensure "N = ..." appears only ONCE in the center of the 6-row block**</span></span>
<span id="cb68-1857"><a href="#cb68-1857" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(</span>
<span id="cb68-1858"><a href="#cb68-1858" aria-hidden="true" tabindex="-1"></a>  ft,</span>
<span id="cb68-1859"><a href="#cb68-1859" aria-hidden="true" tabindex="-1"></a>  <span class="at">part =</span> <span class="st">"body"</span>,</span>
<span id="cb68-1860"><a href="#cb68-1860" aria-hidden="true" tabindex="-1"></a>  <span class="at">j =</span> <span class="st">"N_numeric"</span>,</span>
<span id="cb68-1861"><a href="#cb68-1861" aria-hidden="true" tabindex="-1"></a>  <span class="at">i =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(data), <span class="at">by =</span> <span class="dv">6</span>),  <span class="co"># Every 6th row</span></span>
<span id="cb68-1862"><a href="#cb68-1862" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">as_paragraph</span>(</span>
<span id="cb68-1863"><a href="#cb68-1863" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_i</span>(<span class="st">"N"</span>),  </span>
<span id="cb68-1864"><a href="#cb68-1864" aria-hidden="true" tabindex="-1"></a>    <span class="st">" =\u2009"</span>,  <span class="co"># THIN SPACE (Unicode U+2009)</span></span>
<span id="cb68-1865"><a href="#cb68-1865" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(N_numeric, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)  <span class="co"># Updated</span></span>
<span id="cb68-1866"><a href="#cb68-1866" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1867"><a href="#cb68-1867" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-1868"><a href="#cb68-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1869"><a href="#cb68-1869" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Fully remove duplicate N values in merged rows**</span></span>
<span id="cb68-1870"><a href="#cb68-1870" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">compose</span>(</span>
<span id="cb68-1871"><a href="#cb68-1871" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb68-1872"><a href="#cb68-1872" aria-hidden="true" tabindex="-1"></a>    <span class="at">part =</span> <span class="st">"body"</span>,</span>
<span id="cb68-1873"><a href="#cb68-1873" aria-hidden="true" tabindex="-1"></a>    <span class="at">j =</span> <span class="st">"N_numeric"</span>,</span>
<span id="cb68-1874"><a href="#cb68-1874" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(data), <span class="at">by =</span> <span class="dv">6</span>)),  </span>
<span id="cb68-1875"><a href="#cb68-1875" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="st">""</span>)</span>
<span id="cb68-1876"><a href="#cb68-1876" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1877"><a href="#cb68-1877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1878"><a href="#cb68-1878" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Align vertically centered**</span></span>
<span id="cb68-1879"><a href="#cb68-1879" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">valign</span>(ft, <span class="at">j =</span> <span class="st">"N_numeric"</span>, <span class="at">valign =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb68-1880"><a href="#cb68-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1881"><a href="#cb68-1881" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Center all text</span></span>
<span id="cb68-1882"><a href="#cb68-1882" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">align</span>(ft, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb68-1883"><a href="#cb68-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1884"><a href="#cb68-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1885"><a href="#cb68-1885" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply percentage formatting</span></span>
<span id="cb68-1886"><a href="#cb68-1886" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">colformat_num</span>(</span>
<span id="cb68-1887"><a href="#cb68-1887" aria-hidden="true" tabindex="-1"></a>    ft,</span>
<span id="cb68-1888"><a href="#cb68-1888" aria-hidden="true" tabindex="-1"></a>    <span class="at">j =</span> <span class="fu">c</span>(<span class="st">"Violation_Rate"</span>, <span class="st">"LL_Failure_Rate"</span>, <span class="st">"Error_Rate"</span>, <span class="st">"True_Violation_Rate"</span>,</span>
<span id="cb68-1889"><a href="#cb68-1889" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Final_Violation_Rate"</span>, <span class="st">"Final_LL_Failure_Rate"</span>, <span class="st">"Final_Error_Rate"</span>, <span class="st">"Final_True_Violation_Rate"</span>),  </span>
<span id="cb68-1890"><a href="#cb68-1890" aria-hidden="true" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="st">"%"</span>  </span>
<span id="cb68-1891"><a href="#cb68-1891" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-1892"><a href="#cb68-1892" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-1893"><a href="#cb68-1893" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">add_header_row</span>(</span>
<span id="cb68-1894"><a href="#cb68-1894" aria-hidden="true" tabindex="-1"></a>  ft,</span>
<span id="cb68-1895"><a href="#cb68-1895" aria-hidden="true" tabindex="-1"></a>  <span class="at">values =</span> <span class="fu">c</span>(<span class="st">" "</span>, <span class="st">"Initial Reps"</span>, <span class="st">"Final Reps"</span>, <span class="st">" "</span>),</span>
<span id="cb68-1896"><a href="#cb68-1896" aria-hidden="true" tabindex="-1"></a>  <span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb68-1897"><a href="#cb68-1897" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-1898"><a href="#cb68-1898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1899"><a href="#cb68-1899" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define a transparent border</span></span>
<span id="cb68-1900"><a href="#cb68-1900" aria-hidden="true" tabindex="-1"></a>  no_border <span class="ot">&lt;-</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">width =</span> <span class="dv">0</span>)</span>
<span id="cb68-1901"><a href="#cb68-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1902"><a href="#cb68-1902" aria-hidden="true" tabindex="-1"></a>  <span class="co"># **Remove ONLY the bottom border under the first three columns (the blank subheader)**</span></span>
<span id="cb68-1903"><a href="#cb68-1903" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">hline</span>(ft, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">border =</span> no_border, <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb68-1904"><a href="#cb68-1904" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">hline</span>(ft, <span class="at">i =</span> <span class="dv">1</span>, <span class="at">j =</span> <span class="dv">13</span>, <span class="at">border =</span> no_border, <span class="at">part =</span> <span class="st">"header"</span>)</span>
<span id="cb68-1905"><a href="#cb68-1905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1906"><a href="#cb68-1906" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Autofit table layout</span></span>
<span id="cb68-1907"><a href="#cb68-1907" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">set_table_properties</span>(ft, <span class="at">layout =</span> <span class="st">"fixed"</span>)</span>
<span id="cb68-1908"><a href="#cb68-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1909"><a href="#cb68-1909" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply font settings</span></span>
<span id="cb68-1910"><a href="#cb68-1910" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">font</span>(ft, <span class="at">fontname =</span> <span class="st">"Avenir Next"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb68-1911"><a href="#cb68-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1912"><a href="#cb68-1912" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get total number of rows</span></span>
<span id="cb68-1913"><a href="#cb68-1913" aria-hidden="true" tabindex="-1"></a>total_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb68-1914"><a href="#cb68-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1915"><a href="#cb68-1915" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a logical vector marking every 6 rows for coloring</span></span>
<span id="cb68-1916"><a href="#cb68-1916" aria-hidden="true" tabindex="-1"></a>color_rows <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>, total_rows)  </span>
<span id="cb68-1917"><a href="#cb68-1917" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, total_rows, <span class="at">by =</span> <span class="dv">12</span>)) {  </span>
<span id="cb68-1918"><a href="#cb68-1918" aria-hidden="true" tabindex="-1"></a>  color_rows[i<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># âœ… Color every 6-row block</span></span>
<span id="cb68-1919"><a href="#cb68-1919" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-1920"><a href="#cb68-1920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1921"><a href="#cb68-1921" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply background color</span></span>
<span id="cb68-1922"><a href="#cb68-1922" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">bg</span>(ft, <span class="at">i =</span> color_rows, <span class="at">bg =</span> <span class="st">"#f0f0f0"</span>, <span class="at">part =</span> <span class="st">"body"</span>)</span>
<span id="cb68-1923"><a href="#cb68-1923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1924"><a href="#cb68-1924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ft)</span>
<span id="cb68-1925"><a href="#cb68-1925" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-1926"><a href="#cb68-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1927"><a href="#cb68-1927" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate formatted flextable</span></span>
<span id="cb68-1928"><a href="#cb68-1928" aria-hidden="true" tabindex="-1"></a>violation_summary_final_table <span class="ot">&lt;-</span> <span class="fu">create_flextable</span>(violation_summary_final)</span>
<span id="cb68-1929"><a href="#cb68-1929" aria-hidden="true" tabindex="-1"></a>violation_summary_final_table</span>
<span id="cb68-1930"><a href="#cb68-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1931"><a href="#cb68-1931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1932"><a href="#cb68-1932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1933"><a href="#cb68-1933" aria-hidden="true" tabindex="-1"></a>Save FINAL table</span>
<span id="cb68-1934"><a href="#cb68-1934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1937"><a href="#cb68-1937" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1938"><a href="#cb68-1938" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the flextable as an SVG</span></span>
<span id="cb68-1939"><a href="#cb68-1939" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">save_as_image</span>(</span>
<span id="cb68-1940"><a href="#cb68-1940" aria-hidden="true" tabindex="-1"></a>  violation_summary_final_table,</span>
<span id="cb68-1941"><a href="#cb68-1941" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="fu">here</span>(<span class="st">"Simulations"</span>, <span class="st">"STUDY_1"</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zErrors"</span>, <span class="st">"zl_l_e&amp;v_FINAL.svg"</span>)</span>
<span id="cb68-1942"><a href="#cb68-1942" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb68-1943"><a href="#cb68-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1944"><a href="#cb68-1944" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the flextable as a Word document</span></span>
<span id="cb68-1945"><a href="#cb68-1945" aria-hidden="true" tabindex="-1"></a><span class="co">#invisible(flextable::save_as_xlsx(</span></span>
<span id="cb68-1946"><a href="#cb68-1946" aria-hidden="true" tabindex="-1"></a> <span class="co"># violation_summary_final_table,</span></span>
<span id="cb68-1947"><a href="#cb68-1947" aria-hidden="true" tabindex="-1"></a>  <span class="co">#path = here("Simulations", "STUDY_1", "2 Time Points", "zErrors", "zl_l_e&amp;v_FINAL.docx")</span></span>
<span id="cb68-1948"><a href="#cb68-1948" aria-hidden="true" tabindex="-1"></a><span class="co">#))</span></span>
<span id="cb68-1949"><a href="#cb68-1949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1950"><a href="#cb68-1950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1951"><a href="#cb68-1951" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-1952"><a href="#cb68-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1953"><a href="#cb68-1953" aria-hidden="true" tabindex="-1"></a><span class="fu"># Final Data Preparation</span></span>
<span id="cb68-1954"><a href="#cb68-1954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1955"><a href="#cb68-1955" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-1956"><a href="#cb68-1956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1957"><a href="#cb68-1957" aria-hidden="true" tabindex="-1"></a><span class="fu">## Filter Cases with Violations and Errors</span></span>
<span id="cb68-1958"><a href="#cb68-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1959"><a href="#cb68-1959" aria-hidden="true" tabindex="-1"></a>*Filter out cases with any violations, leaving only the clean data.*</span>
<span id="cb68-1960"><a href="#cb68-1960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1963"><a href="#cb68-1963" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1964"><a href="#cb68-1964" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "delete-cases"</span></span>
<span id="cb68-1965"><a href="#cb68-1965" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-1966"><a href="#cb68-1966" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-1967"><a href="#cb68-1967" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-1968"><a href="#cb68-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1969"><a href="#cb68-1969" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out cases with no violations and no errors</span></span>
<span id="cb68-1970"><a href="#cb68-1970" aria-hidden="true" tabindex="-1"></a>filtered_data_with_no_violations <span class="ot">&lt;-</span> final_data_with_actuals[</span>
<span id="cb68-1971"><a href="#cb68-1971" aria-hidden="true" tabindex="-1"></a>  final_data_with_actuals<span class="sc">$</span>True_Violation <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb68-1972"><a href="#cb68-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1973"><a href="#cb68-1973" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the number of remaining rows after filtering</span></span>
<span id="cb68-1974"><a href="#cb68-1974" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Remaining rows after filtering:"</span>, <span class="fu">nrow</span>(filtered_data_with_no_violations), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-1975"><a href="#cb68-1975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1976"><a href="#cb68-1976" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify if there are any remaining violations or errors</span></span>
<span id="cb68-1977"><a href="#cb68-1977" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Any remaining violations:"</span>, <span class="fu">sum</span>(filtered_data_with_no_violations<span class="sc">$</span>True_Violation), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-1978"><a href="#cb68-1978" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Any remaining errors:"</span>, <span class="fu">sum</span>(filtered_data_with_no_violations<span class="sc">$</span>ErrorFlag), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb68-1979"><a href="#cb68-1979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1980"><a href="#cb68-1980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-1981"><a href="#cb68-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1982"><a href="#cb68-1982" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-1983"><a href="#cb68-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1984"><a href="#cb68-1984" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculate Monte Carlo Values via Bootstrapping</span></span>
<span id="cb68-1985"><a href="#cb68-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1986"><a href="#cb68-1986" aria-hidden="true" tabindex="-1"></a>*Calculate Monte Carlo values for&nbsp;`TRANS11`, including population values, averages, standard errors, Mean Squared Error (MSE), coverage, power, and dichotomous variables for Power and Coverage,*</span>
<span id="cb68-1987"><a href="#cb68-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1990"><a href="#cb68-1990" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-1991"><a href="#cb68-1991" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb68-1992"><a href="#cb68-1992" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb68-1993"><a href="#cb68-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-1994"><a href="#cb68-1994" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create a function that calculates mc_values from raw replication-level data</span></span>
<span id="cb68-1995"><a href="#cb68-1995" aria-hidden="true" tabindex="-1"></a>calc_mc_values <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb68-1996"><a href="#cb68-1996" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step A: Clean and convert columns as needed</span></span>
<span id="cb68-1997"><a href="#cb68-1997" aria-hidden="true" tabindex="-1"></a>  cleaned_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb68-1998"><a href="#cb68-1998" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb68-1999"><a href="#cb68-1999" aria-hidden="true" tabindex="-1"></a>      <span class="at">Population =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Population)),</span>
<span id="cb68-2000"><a href="#cb68-2000" aria-hidden="true" tabindex="-1"></a>      <span class="at">TRANS11 =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(TRANS11)),</span>
<span id="cb68-2001"><a href="#cb68-2001" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE_11 =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(SE_11))</span>
<span id="cb68-2002"><a href="#cb68-2002" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-2003"><a href="#cb68-2003" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-2004"><a href="#cb68-2004" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step B: Compute group-level summaries (without grouping by Transitions)</span></span>
<span id="cb68-2005"><a href="#cb68-2005" aria-hidden="true" tabindex="-1"></a>  mc_values <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb68-2006"><a href="#cb68-2006" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Population, N) <span class="sc">%&gt;%</span></span>
<span id="cb68-2007"><a href="#cb68-2007" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb68-2008"><a href="#cb68-2008" aria-hidden="true" tabindex="-1"></a>      <span class="at">group_size   =</span> <span class="fu">n</span>(),</span>
<span id="cb68-2009"><a href="#cb68-2009" aria-hidden="true" tabindex="-1"></a>      <span class="at">average      =</span> <span class="fu">round</span>(<span class="fu">mean</span>(TRANS11, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb68-2010"><a href="#cb68-2010" aria-hidden="true" tabindex="-1"></a>      <span class="at">average_SE   =</span> <span class="fu">round</span>(<span class="fu">mean</span>(SE_11, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb68-2011"><a href="#cb68-2011" aria-hidden="true" tabindex="-1"></a>      <span class="at">population_sd=</span> <span class="fu">round</span>(<span class="fu">sd</span>(TRANS11, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb68-2012"><a href="#cb68-2012" aria-hidden="true" tabindex="-1"></a>      <span class="at">MSE          =</span> <span class="fu">round</span>(<span class="fu">mean</span>((TRANS11 <span class="sc">-</span> Population)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb68-2013"><a href="#cb68-2013" aria-hidden="true" tabindex="-1"></a>      <span class="at">Coverage     =</span> <span class="fu">round</span>(<span class="fu">mean</span>((Population <span class="sc">&gt;=</span> (TRANS11 <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> SE_11)) <span class="sc">&amp;</span></span>
<span id="cb68-2014"><a href="#cb68-2014" aria-hidden="true" tabindex="-1"></a>                                  (Population <span class="sc">&lt;=</span> (TRANS11 <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> SE_11)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb68-2015"><a href="#cb68-2015" aria-hidden="true" tabindex="-1"></a>      <span class="at">Power        =</span> <span class="fu">round</span>(<span class="fu">mean</span>(TRANS11 <span class="sc">/</span> SE_11 <span class="sc">&gt;</span> <span class="fl">1.96</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb68-2016"><a href="#cb68-2016" aria-hidden="true" tabindex="-1"></a>      <span class="at">Reps_Used    =</span> <span class="fu">n</span>(),</span>
<span id="cb68-2017"><a href="#cb68-2017" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb68-2018"><a href="#cb68-2018" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-2019"><a href="#cb68-2019" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-2020"><a href="#cb68-2020" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step C: Merge in Transitions from the raw data (or from an auxiliary table if needed)</span></span>
<span id="cb68-2021"><a href="#cb68-2021" aria-hidden="true" tabindex="-1"></a>  mc_values <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb68-2022"><a href="#cb68-2022" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FileName, Population, N, Transitions) <span class="sc">%&gt;%</span></span>
<span id="cb68-2023"><a href="#cb68-2023" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-2024"><a href="#cb68-2024" aria-hidden="true" tabindex="-1"></a>    <span class="fu">right_join</span>(mc_values, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Population"</span>, <span class="st">"N"</span>))</span>
<span id="cb68-2025"><a href="#cb68-2025" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-2026"><a href="#cb68-2026" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step D: Calculate bias measures</span></span>
<span id="cb68-2027"><a href="#cb68-2027" aria-hidden="true" tabindex="-1"></a>  mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb68-2028"><a href="#cb68-2028" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb68-2029"><a href="#cb68-2029" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter_Bias_boot =</span> <span class="fu">round</span>((average <span class="sc">-</span> Population) <span class="sc">/</span> Population <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb68-2030"><a href="#cb68-2030" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE_Bias_boot        =</span> <span class="fu">round</span>((average_SE <span class="sc">-</span> population_sd) <span class="sc">/</span> (population_sd <span class="sc">+</span> <span class="fl">1e-6</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb68-2031"><a href="#cb68-2031" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-2032"><a href="#cb68-2032" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-2033"><a href="#cb68-2033" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (Optional: add any further transformations or dichotomizations)</span></span>
<span id="cb68-2034"><a href="#cb68-2034" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-2035"><a href="#cb68-2035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mc_values)</span>
<span id="cb68-2036"><a href="#cb68-2036" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-2037"><a href="#cb68-2037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2038"><a href="#cb68-2038" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create a parallelized bootstrap function that uses the above calculation on bootstrap samples</span></span>
<span id="cb68-2039"><a href="#cb68-2039" aria-hidden="true" tabindex="-1"></a>bootstrap_mc_values <span class="ot">&lt;-</span> <span class="cf">function</span>(data, n_bootstrap, sample_size) {</span>
<span id="cb68-2040"><a href="#cb68-2040" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-2041"><a href="#cb68-2041" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step A: Detect available cores and create a parallel cluster</span></span>
<span id="cb68-2042"><a href="#cb68-2042" aria-hidden="true" tabindex="-1"></a>  num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Use one less than total cores to avoid overloading the system</span></span>
<span id="cb68-2043"><a href="#cb68-2043" aria-hidden="true" tabindex="-1"></a>  cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>)  <span class="co"># Use FORK for Mac/Linux, PSOCK for Windows</span></span>
<span id="cb68-2044"><a href="#cb68-2044" aria-hidden="true" tabindex="-1"></a>  cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)  <span class="co"># Create the cluster</span></span>
<span id="cb68-2045"><a href="#cb68-2045" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-2046"><a href="#cb68-2046" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step B: Export necessary functions and objects to the cluster workers</span></span>
<span id="cb68-2047"><a href="#cb68-2047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"calc_mc_values"</span>, <span class="st">"sample_n"</span>, <span class="st">"%&gt;%"</span>, <span class="st">"filtered_data_with_no_violations"</span>))</span>
<span id="cb68-2048"><a href="#cb68-2048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clusterEvalQ</span>(cl, { <span class="fu">library</span>(dplyr) })  <span class="co"># Ensure each worker loads the required package</span></span>
<span id="cb68-2049"><a href="#cb68-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2050"><a href="#cb68-2050" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step C: Group data by condition variables (Population, N, Transitions)</span></span>
<span id="cb68-2051"><a href="#cb68-2051" aria-hidden="true" tabindex="-1"></a>  grouped_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb68-2052"><a href="#cb68-2052" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Population, N, Transitions) <span class="sc">%&gt;%</span></span>
<span id="cb68-2053"><a href="#cb68-2053" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_split</span>()  <span class="co"># Split data so each group runs separately in parallel</span></span>
<span id="cb68-2054"><a href="#cb68-2054" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-2055"><a href="#cb68-2055" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step D: Perform bootstrapping in parallel across worker nodes</span></span>
<span id="cb68-2056"><a href="#cb68-2056" aria-hidden="true" tabindex="-1"></a>  boot_results <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, grouped_data, <span class="cf">function</span>(group_data) {</span>
<span id="cb68-2057"><a href="#cb68-2057" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>n_bootstrap, <span class="cf">function</span>(i) {</span>
<span id="cb68-2058"><a href="#cb68-2058" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Step D1: Draw a bootstrap sample (with replacement) from the replications in this condition</span></span>
<span id="cb68-2059"><a href="#cb68-2059" aria-hidden="true" tabindex="-1"></a>      boot_sample <span class="ot">&lt;-</span> group_data <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(sample_size, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-2060"><a href="#cb68-2060" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb68-2061"><a href="#cb68-2061" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Step D2: Calculate MC values for the bootstrap sample</span></span>
<span id="cb68-2062"><a href="#cb68-2062" aria-hidden="true" tabindex="-1"></a>      boot_mc <span class="ot">&lt;-</span> <span class="fu">calc_mc_values</span>(boot_sample)</span>
<span id="cb68-2063"><a href="#cb68-2063" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb68-2064"><a href="#cb68-2064" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Step D3: Add Bootstrap Iteration number</span></span>
<span id="cb68-2065"><a href="#cb68-2065" aria-hidden="true" tabindex="-1"></a>      boot_mc <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Bootstrap_Iteration =</span> i)</span>
<span id="cb68-2066"><a href="#cb68-2066" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb68-2067"><a href="#cb68-2067" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span></span>
<span id="cb68-2068"><a href="#cb68-2068" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()  <span class="co"># Step E: Combine results from all parallel workers into a single dataframe</span></span>
<span id="cb68-2069"><a href="#cb68-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2070"><a href="#cb68-2070" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step F: Stop the parallel cluster to free system resources</span></span>
<span id="cb68-2071"><a href="#cb68-2071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopCluster</span>(cl)</span>
<span id="cb68-2072"><a href="#cb68-2072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2073"><a href="#cb68-2073" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step G: Return the final bootstrapped MC values</span></span>
<span id="cb68-2074"><a href="#cb68-2074" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(boot_results)</span>
<span id="cb68-2075"><a href="#cb68-2075" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-2076"><a href="#cb68-2076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2077"><a href="#cb68-2077" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Run the bootstrap procedure on your raw replication-level data</span></span>
<span id="cb68-2078"><a href="#cb68-2078" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">07252005</span>)</span>
<span id="cb68-2079"><a href="#cb68-2079" aria-hidden="true" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">bootstrap_mc_values</span>(filtered_data_with_no_violations, <span class="at">n_bootstrap =</span> <span class="dv">1000</span>, <span class="at">sample_size =</span> <span class="dv">500</span>)</span>
<span id="cb68-2080"><a href="#cb68-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2081"><a href="#cb68-2081" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Aggregate the bootstrap results to get mean bootstrap estimates per condition:</span></span>
<span id="cb68-2082"><a href="#cb68-2082" aria-hidden="true" tabindex="-1"></a>bootstrap_aggregates <span class="ot">&lt;-</span> boot_results <span class="sc">%&gt;%</span></span>
<span id="cb68-2083"><a href="#cb68-2083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Population, N, Transitions) <span class="sc">%&gt;%</span></span>
<span id="cb68-2084"><a href="#cb68-2084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb68-2085"><a href="#cb68-2085" aria-hidden="true" tabindex="-1"></a>    <span class="at">Parameter_Bias =</span> <span class="fu">mean</span>(Parameter_Bias_boot, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-2086"><a href="#cb68-2086" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_Bias       =</span> <span class="fu">mean</span>(SE_Bias_boot, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-2087"><a href="#cb68-2087" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb68-2088"><a href="#cb68-2088" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-2089"><a href="#cb68-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2090"><a href="#cb68-2090" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Calculate your original mc_values (using the full replication set) for comparison:</span></span>
<span id="cb68-2091"><a href="#cb68-2091" aria-hidden="true" tabindex="-1"></a>original_mc_values <span class="ot">&lt;-</span> <span class="fu">calc_mc_values</span>(filtered_data_with_no_violations)</span>
<span id="cb68-2092"><a href="#cb68-2092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2093"><a href="#cb68-2093" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Merge the bootstrap aggregates back to the original values (if desired)</span></span>
<span id="cb68-2094"><a href="#cb68-2094" aria-hidden="true" tabindex="-1"></a>final_mc_values <span class="ot">&lt;-</span> original_mc_values <span class="sc">%&gt;%</span></span>
<span id="cb68-2095"><a href="#cb68-2095" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bootstrap_aggregates, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Population"</span>, <span class="st">"N"</span>, <span class="st">"Transitions"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-2096"><a href="#cb68-2096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-2097"><a href="#cb68-2097" aria-hidden="true" tabindex="-1"></a>    <span class="at">Power_Dic    =</span> <span class="fu">ifelse</span>(Power <span class="sc">&gt;=</span> <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb68-2098"><a href="#cb68-2098" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coverage_Dic =</span> <span class="fu">ifelse</span>(Coverage <span class="sc">&gt;</span> <span class="fl">0.98</span> <span class="sc">|</span> Coverage <span class="sc">&lt;</span> <span class="fl">0.91</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb68-2099"><a href="#cb68-2099" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-2100"><a href="#cb68-2100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2101"><a href="#cb68-2101" aria-hidden="true" tabindex="-1"></a><span class="co"># Save or inspect the results</span></span>
<span id="cb68-2102"><a href="#cb68-2102" aria-hidden="true" tabindex="-1"></a><span class="co"># Save results</span></span>
<span id="cb68-2103"><a href="#cb68-2103" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(final_mc_values, <span class="fu">here</span>(<span class="st">"Simulations"</span>, <span class="st">"STUDY_1"</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zbootstrapping"</span>, <span class="st">"l_l_2t_mc_final_mc_values.csv"</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb68-2104"><a href="#cb68-2104" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(boot_results, <span class="fu">here</span>(<span class="st">"Simulations"</span>, <span class="st">"STUDY_1"</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zbootstrapping"</span>, <span class="st">"l_l_2t_boot_results.csv"</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb68-2105"><a href="#cb68-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2106"><a href="#cb68-2106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-2107"><a href="#cb68-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2108"><a href="#cb68-2108" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-2109"><a href="#cb68-2109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2110"><a href="#cb68-2110" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prepare Data for Visualization</span></span>
<span id="cb68-2111"><a href="#cb68-2111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2112"><a href="#cb68-2112" aria-hidden="true" tabindex="-1"></a><span class="fu">### Subset Data for Bias Plots</span></span>
<span id="cb68-2113"><a href="#cb68-2113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2114"><a href="#cb68-2114" aria-hidden="true" tabindex="-1"></a>*Subset the Monte Carlo data into mover transition probabilities (.2, .3, .4) and stayer transition probabilities (.6, .7, .8) based on population values*</span>
<span id="cb68-2115"><a href="#cb68-2115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2118"><a href="#cb68-2118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-2119"><a href="#cb68-2119" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "subset-data-for-bias-plots"</span></span>
<span id="cb68-2120"><a href="#cb68-2120" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-2121"><a href="#cb68-2121" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-2122"><a href="#cb68-2122" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-2123"><a href="#cb68-2123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2124"><a href="#cb68-2124" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming Population is numeric in all_data</span></span>
<span id="cb68-2125"><a href="#cb68-2125" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> final_mc_values</span>
<span id="cb68-2126"><a href="#cb68-2126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2127"><a href="#cb68-2127" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that the Population_Label uses numeric levels without leading zeros but assigns expression-based labels</span></span>
<span id="cb68-2128"><a href="#cb68-2128" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>Population_Label <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_data<span class="sc">$</span>Population, </span>
<span id="cb68-2129"><a href="#cb68-2129" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>),  <span class="co"># Numeric levels without leading zeros</span></span>
<span id="cb68-2130"><a href="#cb68-2130" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb68-2131"><a href="#cb68-2131" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .200"</span>),</span>
<span id="cb68-2132"><a href="#cb68-2132" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .300"</span>),</span>
<span id="cb68-2133"><a href="#cb68-2133" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .400"</span>),</span>
<span id="cb68-2134"><a href="#cb68-2134" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .600"</span>),</span>
<span id="cb68-2135"><a href="#cb68-2135" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .700"</span>),</span>
<span id="cb68-2136"><a href="#cb68-2136" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .800"</span>)</span>
<span id="cb68-2137"><a href="#cb68-2137" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-2138"><a href="#cb68-2138" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-2139"><a href="#cb68-2139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2140"><a href="#cb68-2140" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that N is consistently factored and ordered</span></span>
<span id="cb68-2141"><a href="#cb68-2141" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>N <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_data<span class="sc">$</span>N, </span>
<span id="cb68-2142"><a href="#cb68-2142" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>, <span class="st">"N = 4000"</span>)</span>
<span id="cb68-2143"><a href="#cb68-2143" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-2144"><a href="#cb68-2144" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb68-2145"><a href="#cb68-2145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Population, N)</span>
<span id="cb68-2146"><a href="#cb68-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2147"><a href="#cb68-2147" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset for Transitions movers (already correctly defined as "Mover")</span></span>
<span id="cb68-2148"><a href="#cb68-2148" aria-hidden="true" tabindex="-1"></a>subset_mover <span class="ot">&lt;-</span> <span class="fu">subset</span>(all_data, Transitions <span class="sc">==</span> <span class="st">"Mover"</span>)</span>
<span id="cb68-2149"><a href="#cb68-2149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2150"><a href="#cb68-2150" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset for Transitions stayers (already correctly defined as "Stayer")</span></span>
<span id="cb68-2151"><a href="#cb68-2151" aria-hidden="true" tabindex="-1"></a>subset_stayer <span class="ot">&lt;-</span> <span class="fu">subset</span>(all_data, Transitions <span class="sc">==</span> <span class="st">"Stayer"</span>)</span>
<span id="cb68-2152"><a href="#cb68-2152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2153"><a href="#cb68-2153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-2154"><a href="#cb68-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2155"><a href="#cb68-2155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prepare Function for Bias Plots</span></span>
<span id="cb68-2156"><a href="#cb68-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2159"><a href="#cb68-2159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-2160"><a href="#cb68-2160" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "plot-bias"</span></span>
<span id="cb68-2161"><a href="#cb68-2161" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-2162"><a href="#cb68-2162" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-2163"><a href="#cb68-2163" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-2164"><a href="#cb68-2164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2165"><a href="#cb68-2165" aria-hidden="true" tabindex="-1"></a>create_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title_suffix) {</span>
<span id="cb68-2166"><a href="#cb68-2166" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Common theme for the plots</span></span>
<span id="cb68-2167"><a href="#cb68-2167" aria-hidden="true" tabindex="-1"></a>  common_theme <span class="ot">&lt;-</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-2168"><a href="#cb68-2168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb68-2169"><a href="#cb68-2169" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-2170"><a href="#cb68-2170" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-2171"><a href="#cb68-2171" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-2172"><a href="#cb68-2172" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb68-2173"><a href="#cb68-2173" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb68-2174"><a href="#cb68-2174" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb68-2175"><a href="#cb68-2175" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-2176"><a href="#cb68-2176" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb68-2177"><a href="#cb68-2177" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb68-2178"><a href="#cb68-2178" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">10</span>),</span>
<span id="cb68-2179"><a href="#cb68-2179" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb68-2180"><a href="#cb68-2180" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-2181"><a href="#cb68-2181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2182"><a href="#cb68-2182" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Detect which legend items to show</span></span>
<span id="cb68-2183"><a href="#cb68-2183" aria-hidden="true" tabindex="-1"></a>  present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span>, <span class="st">"Standard Error Bias"</span>)</span>
<span id="cb68-2184"><a href="#cb68-2184" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(data<span class="sc">$</span>Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>)) present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(present_categories, <span class="st">"Coverage Failure"</span>)</span>
<span id="cb68-2185"><a href="#cb68-2185" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(data<span class="sc">$</span>Power_Dic <span class="sc">==</span> <span class="dv">0</span>)) present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(present_categories, <span class="st">"Power Failure"</span>)</span>
<span id="cb68-2186"><a href="#cb68-2186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2187"><a href="#cb68-2187" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define colors and shapes for different categories</span></span>
<span id="cb68-2188"><a href="#cb68-2188" aria-hidden="true" tabindex="-1"></a>  colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span> <span class="ot">=</span> <span class="st">"#7030A0"</span>, <span class="st">"Standard Error Bias"</span> <span class="ot">=</span> <span class="st">"#C830CC"</span>, </span>
<span id="cb68-2189"><a href="#cb68-2189" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Coverage Failure"</span> <span class="ot">=</span> <span class="st">"#7030A0"</span>, <span class="st">"Power Failure"</span> <span class="ot">=</span> <span class="st">"black"</span>)</span>
<span id="cb68-2190"><a href="#cb68-2190" aria-hidden="true" tabindex="-1"></a>  shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"Standard Error Bias"</span> <span class="ot">=</span> <span class="dv">18</span>, </span>
<span id="cb68-2191"><a href="#cb68-2191" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Coverage Failure"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Power Failure"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb68-2192"><a href="#cb68-2192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2193"><a href="#cb68-2193" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter colors and shapes based on detected categories</span></span>
<span id="cb68-2194"><a href="#cb68-2194" aria-hidden="true" tabindex="-1"></a>  filtered_colors <span class="ot">&lt;-</span> colors[present_categories]</span>
<span id="cb68-2195"><a href="#cb68-2195" aria-hidden="true" tabindex="-1"></a>  filtered_shapes <span class="ot">&lt;-</span> shapes[present_categories]</span>
<span id="cb68-2196"><a href="#cb68-2196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2197"><a href="#cb68-2197" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting</span></span>
<span id="cb68-2198"><a href="#cb68-2198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(N))) <span class="sc">+</span>  </span>
<span id="cb68-2199"><a href="#cb68-2199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Parameter Bias"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span>  </span>
<span id="cb68-2200"><a href="#cb68-2200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> SE_Bias, <span class="at">color =</span> <span class="st">"Standard Error Bias"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span>  </span>
<span id="cb68-2201"><a href="#cb68-2201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Parameter Bias"</span>), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">fill =</span> <span class="st">"#7030A0"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb68-2202"><a href="#cb68-2202" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> SE_Bias, <span class="at">color =</span> <span class="st">"Standard Error Bias"</span>), <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">fill =</span> <span class="st">"#C830CC"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb68-2203"><a href="#cb68-2203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Coverage Failure"</span>), <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"#7030A0"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb68-2204"><a href="#cb68-2204" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Power_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Power Failure"</span>), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb68-2205"><a href="#cb68-2205" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Coverage Failure"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb68-2206"><a href="#cb68-2206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Power_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Power Failure"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb68-2207"><a href="#cb68-2207" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb68-2208"><a href="#cb68-2208" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> filtered_colors, </span>
<span id="cb68-2209"><a href="#cb68-2209" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> present_categories, </span>
<span id="cb68-2210"><a href="#cb68-2210" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> present_categories,</span>
<span id="cb68-2211"><a href="#cb68-2211" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb68-2212"><a href="#cb68-2212" aria-hidden="true" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> filtered_shapes)</span>
<span id="cb68-2213"><a href="#cb68-2213" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb68-2214"><a href="#cb68-2214" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span>  </span>
<span id="cb68-2215"><a href="#cb68-2215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb68-2216"><a href="#cb68-2216" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb68-2217"><a href="#cb68-2217" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Bias (%)"</span>,</span>
<span id="cb68-2218"><a href="#cb68-2218" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb68-2219"><a href="#cb68-2219" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"LTA Generated, LTA Analyzed with"</span>, title_suffix, <span class="st">"Transition Probabilities"</span>)</span>
<span id="cb68-2220"><a href="#cb68-2220" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb68-2221"><a href="#cb68-2221" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>)) <span class="sc">+</span>  </span>
<span id="cb68-2222"><a href="#cb68-2222" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">as.character</span>(Population_Label), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span>  </span>
<span id="cb68-2223"><a href="#cb68-2223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 500"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 1000"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 2000"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 4000"</span>))) <span class="sc">+</span>  </span>
<span id="cb68-2224"><a href="#cb68-2224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span>  </span>
<span id="cb68-2225"><a href="#cb68-2225" aria-hidden="true" tabindex="-1"></a>    common_theme <span class="sc">+</span></span>
<span id="cb68-2226"><a href="#cb68-2226" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#7030A0"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  </span>
<span id="cb68-2227"><a href="#cb68-2227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#C830CC"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb68-2228"><a href="#cb68-2228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb68-2229"><a href="#cb68-2229" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb68-2230"><a href="#cb68-2230" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"outside"</span>, </span>
<span id="cb68-2231"><a href="#cb68-2231" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-2232"><a href="#cb68-2232" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb68-2233"><a href="#cb68-2233" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb68-2234"><a href="#cb68-2234" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-2235"><a href="#cb68-2235" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-2236"><a href="#cb68-2236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-2237"><a href="#cb68-2237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2238"><a href="#cb68-2238" aria-hidden="true" tabindex="-1"></a><span class="fu">### Render Bias Figures</span></span>
<span id="cb68-2239"><a href="#cb68-2239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2242"><a href="#cb68-2242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-2243"><a href="#cb68-2243" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "plot-movers"</span></span>
<span id="cb68-2244"><a href="#cb68-2244" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-2245"><a href="#cb68-2245" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-2246"><a href="#cb68-2246" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-2247"><a href="#cb68-2247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2248"><a href="#cb68-2248" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and print plot for Mover</span></span>
<span id="cb68-2249"><a href="#cb68-2249" aria-hidden="true" tabindex="-1"></a>plot_mover <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(subset_mover, <span class="st">"Mover"</span>)</span>
<span id="cb68-2250"><a href="#cb68-2250" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen</span></span>
<span id="cb68-2251"><a href="#cb68-2251" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-format: svg</span></span>
<span id="cb68-2252"><a href="#cb68-2252" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_mover)</span>
<span id="cb68-2253"><a href="#cb68-2253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2254"><a href="#cb68-2254" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove title for the saved version</span></span>
<span id="cb68-2255"><a href="#cb68-2255" aria-hidden="true" tabindex="-1"></a>plot_mover_no_title <span class="ot">&lt;-</span> plot_mover <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>)</span>
<span id="cb68-2256"><a href="#cb68-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2257"><a href="#cb68-2257" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Mover plot without title as .svg</span></span>
<span id="cb68-2258"><a href="#cb68-2258" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zFigures"</span>, <span class="st">"x2t_lta_lta_plots"</span>, <span class="st">"plot_mover.svg"</span>), <span class="at">plot =</span> plot_mover_no_title, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> <span class="st">"svg"</span>)</span>
<span id="cb68-2259"><a href="#cb68-2259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-2260"><a href="#cb68-2260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2263"><a href="#cb68-2263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-2264"><a href="#cb68-2264" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "plot-stayers"</span></span>
<span id="cb68-2265"><a href="#cb68-2265" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-2266"><a href="#cb68-2266" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-2267"><a href="#cb68-2267" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-2268"><a href="#cb68-2268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2269"><a href="#cb68-2269" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and print plot for Stayer</span></span>
<span id="cb68-2270"><a href="#cb68-2270" aria-hidden="true" tabindex="-1"></a>plot_stayer <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(subset_stayer, <span class="st">"Stayer"</span>)</span>
<span id="cb68-2271"><a href="#cb68-2271" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen</span></span>
<span id="cb68-2272"><a href="#cb68-2272" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-format: svg</span></span>
<span id="cb68-2273"><a href="#cb68-2273" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_stayer)</span>
<span id="cb68-2274"><a href="#cb68-2274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2275"><a href="#cb68-2275" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove title for the saved version</span></span>
<span id="cb68-2276"><a href="#cb68-2276" aria-hidden="true" tabindex="-1"></a>plot_stayer_no_title <span class="ot">&lt;-</span> plot_stayer <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>)</span>
<span id="cb68-2277"><a href="#cb68-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2278"><a href="#cb68-2278" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Stayer plot without title as .svg</span></span>
<span id="cb68-2279"><a href="#cb68-2279" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zFigures"</span>, <span class="st">"x2t_lta_lta_plots"</span>, <span class="st">"plot_stayer.svg"</span>), <span class="at">plot =</span> plot_stayer_no_title, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> <span class="st">"svg"</span>)</span>
<span id="cb68-2280"><a href="#cb68-2280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-2281"><a href="#cb68-2281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2282"><a href="#cb68-2282" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-2283"><a href="#cb68-2283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2284"><a href="#cb68-2284" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Prepare Data for Heat Maps**</span></span>
<span id="cb68-2285"><a href="#cb68-2285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2286"><a href="#cb68-2286" aria-hidden="true" tabindex="-1"></a>*Prepare data for heat map creation by ensuring correct formatting for population values, and subsetting the data based on class proportions and sample sizes.*</span>
<span id="cb68-2287"><a href="#cb68-2287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2290"><a href="#cb68-2290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-2291"><a href="#cb68-2291" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "prepare-data-for-heatmaps"</span></span>
<span id="cb68-2292"><a href="#cb68-2292" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-2293"><a href="#cb68-2293" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-2294"><a href="#cb68-2294" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-2295"><a href="#cb68-2295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2296"><a href="#cb68-2296" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Separate the movers and stayers and ensure sorting by N and Population for each transition</span></span>
<span id="cb68-2297"><a href="#cb68-2297" aria-hidden="true" tabindex="-1"></a>movers <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb68-2298"><a href="#cb68-2298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Transitions <span class="sc">==</span> <span class="st">"Mover"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-2299"><a href="#cb68-2299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, N)), Population)  <span class="co"># Sort movers by numeric N and Population</span></span>
<span id="cb68-2300"><a href="#cb68-2300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2301"><a href="#cb68-2301" aria-hidden="true" tabindex="-1"></a>stayers <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb68-2302"><a href="#cb68-2302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Transitions <span class="sc">==</span> <span class="st">"Stayer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-2303"><a href="#cb68-2303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, N)), Population)  <span class="co"># Sort stayers by numeric N and Population</span></span>
<span id="cb68-2304"><a href="#cb68-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2305"><a href="#cb68-2305" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Assign N_Label only once for each N within Movers and Stayers</span></span>
<span id="cb68-2306"><a href="#cb68-2306" aria-hidden="true" tabindex="-1"></a>movers <span class="ot">&lt;-</span> movers <span class="sc">%&gt;%</span></span>
<span id="cb68-2307"><a href="#cb68-2307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(N) <span class="sc">%&gt;%</span></span>
<span id="cb68-2308"><a href="#cb68-2308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_Label =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">2</span>, <span class="fu">as.character</span>(N), <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-2309"><a href="#cb68-2309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb68-2310"><a href="#cb68-2310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2311"><a href="#cb68-2311" aria-hidden="true" tabindex="-1"></a>stayers <span class="ot">&lt;-</span> stayers <span class="sc">%&gt;%</span></span>
<span id="cb68-2312"><a href="#cb68-2312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(N) <span class="sc">%&gt;%</span></span>
<span id="cb68-2313"><a href="#cb68-2313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_Label =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">2</span>, <span class="fu">as.character</span>(N), <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-2314"><a href="#cb68-2314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb68-2315"><a href="#cb68-2315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2316"><a href="#cb68-2316" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Combine movers and stayers back into one dataset, keeping them separate by transitions</span></span>
<span id="cb68-2317"><a href="#cb68-2317" aria-hidden="true" tabindex="-1"></a>all_data_sorted <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(movers, stayers)</span>
<span id="cb68-2318"><a href="#cb68-2318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2319"><a href="#cb68-2319" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Select necessary columns for the final display</span></span>
<span id="cb68-2320"><a href="#cb68-2320" aria-hidden="true" tabindex="-1"></a>test_map <span class="ot">&lt;-</span> <span class="fu">select</span>(all_data_sorted, N_Label, Population, average, Coverage, Power, Parameter_Bias, SE_Bias)</span>
<span id="cb68-2321"><a href="#cb68-2321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-2322"><a href="#cb68-2322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2323"><a href="#cb68-2323" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prepare Function for Heat Map Creation</span></span>
<span id="cb68-2324"><a href="#cb68-2324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2327"><a href="#cb68-2327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-2328"><a href="#cb68-2328" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "create-heatmap-function"</span></span>
<span id="cb68-2329"><a href="#cb68-2329" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-2330"><a href="#cb68-2330" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-2331"><a href="#cb68-2331" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-2332"><a href="#cb68-2332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2333"><a href="#cb68-2333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2334"><a href="#cb68-2334" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create gt table based on subset data</span></span>
<span id="cb68-2335"><a href="#cb68-2335" aria-hidden="true" tabindex="-1"></a>create_gt_table <span class="ot">&lt;-</span> <span class="cf">function</span>(subset, transition_probability) {</span>
<span id="cb68-2336"><a href="#cb68-2336" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the gt object and set initial formatting</span></span>
<span id="cb68-2337"><a href="#cb68-2337" aria-hidden="true" tabindex="-1"></a>  gt_table <span class="ot">&lt;-</span> subset <span class="sc">%&gt;%</span></span>
<span id="cb68-2338"><a href="#cb68-2338" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-2339"><a href="#cb68-2339" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opt_table_font</span>(<span class="at">stack =</span> <span class="st">"geometric-humanist"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-2340"><a href="#cb68-2340" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb68-2341"><a href="#cb68-2341" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"LTA Generated &amp; LTA Analyzed with Transition Probability of"</span>, transition_probability)</span>
<span id="cb68-2342"><a href="#cb68-2342" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb68-2343"><a href="#cb68-2343" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb68-2344"><a href="#cb68-2344" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_Label =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb68-2345"><a href="#cb68-2345" aria-hidden="true" tabindex="-1"></a>      <span class="at">Population =</span> <span class="st">"Transition"</span>,</span>
<span id="cb68-2346"><a href="#cb68-2346" aria-hidden="true" tabindex="-1"></a>      <span class="at">average =</span> <span class="st">"Estimated&lt;br&gt;Probability"</span>,</span>
<span id="cb68-2347"><a href="#cb68-2347" aria-hidden="true" tabindex="-1"></a>      <span class="at">Coverage =</span> <span class="st">"Coverage"</span>,</span>
<span id="cb68-2348"><a href="#cb68-2348" aria-hidden="true" tabindex="-1"></a>      <span class="at">Power =</span> <span class="st">"Power"</span>,</span>
<span id="cb68-2349"><a href="#cb68-2349" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter_Bias =</span> <span class="st">"Parameter &lt;br&gt;Bias"</span>,</span>
<span id="cb68-2350"><a href="#cb68-2350" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE_Bias =</span> <span class="st">"Standard Error&lt;br&gt;Bias"</span>,</span>
<span id="cb68-2351"><a href="#cb68-2351" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fn =</span> md</span>
<span id="cb68-2352"><a href="#cb68-2352" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb68-2353"><a href="#cb68-2353" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb68-2354"><a href="#cb68-2354" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Bias"</span>,</span>
<span id="cb68-2355"><a href="#cb68-2355" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Parameter_Bias"</span>, <span class="st">"SE_Bias"</span>)</span>
<span id="cb68-2356"><a href="#cb68-2356" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb68-2357"><a href="#cb68-2357" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(</span>
<span id="cb68-2358"><a href="#cb68-2358" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Stayer Probabilities"</span>,  <span class="co"># Label for the first subgroup</span></span>
<span id="cb68-2359"><a href="#cb68-2359" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>)  <span class="co"># Rows corresponding to the first subgroup</span></span>
<span id="cb68-2360"><a href="#cb68-2360" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb68-2361"><a href="#cb68-2361" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(</span>
<span id="cb68-2362"><a href="#cb68-2362" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Mover Probabilities"</span>,  <span class="co"># Label for the second subgroup</span></span>
<span id="cb68-2363"><a href="#cb68-2363" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)  <span class="co"># Rows corresponding to the second subgroup</span></span>
<span id="cb68-2364"><a href="#cb68-2364" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb68-2365"><a href="#cb68-2365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb68-2366"><a href="#cb68-2366" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(</span>
<span id="cb68-2367"><a href="#cb68-2367" aria-hidden="true" tabindex="-1"></a>        <span class="at">font =</span> <span class="st">"bold italic"</span>  <span class="co"># Apply bold and italic styling</span></span>
<span id="cb68-2368"><a href="#cb68-2368" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb68-2369"><a href="#cb68-2369" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_row_groups</span>()  <span class="co"># Apply style to row subheaders</span></span>
<span id="cb68-2370"><a href="#cb68-2370" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb68-2371"><a href="#cb68-2371" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Parameter_Bias"</span>, <span class="st">"SE_Bias"</span>), <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb68-2372"><a href="#cb68-2372" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">4</span>, <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-2373"><a href="#cb68-2373" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_options</span>(</span>
<span id="cb68-2374"><a href="#cb68-2374" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.striping.include_table_body =</span> <span class="cn">FALSE</span>,  <span class="co"># Disables row striping</span></span>
<span id="cb68-2375"><a href="#cb68-2375" aria-hidden="true" tabindex="-1"></a>  <span class="at">table_body.hlines.color =</span> <span class="st">"white"</span>,  </span>
<span id="cb68-2376"><a href="#cb68-2376" aria-hidden="true" tabindex="-1"></a>  <span class="at">table.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb68-2377"><a href="#cb68-2377" aria-hidden="true" tabindex="-1"></a>  <span class="at">table.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb68-2378"><a href="#cb68-2378" aria-hidden="true" tabindex="-1"></a>  <span class="at">table_body.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb68-2379"><a href="#cb68-2379" aria-hidden="true" tabindex="-1"></a>  <span class="at">heading.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb68-2380"><a href="#cb68-2380" aria-hidden="true" tabindex="-1"></a>  <span class="at">column_labels.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb68-2381"><a href="#cb68-2381" aria-hidden="true" tabindex="-1"></a>  <span class="at">column_labels.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb68-2382"><a href="#cb68-2382" aria-hidden="true" tabindex="-1"></a>  <span class="at">row_group.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb68-2383"><a href="#cb68-2383" aria-hidden="true" tabindex="-1"></a>  <span class="at">row_group.border.top.color =</span> <span class="st">"black"</span></span>
<span id="cb68-2384"><a href="#cb68-2384" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb68-2385"><a href="#cb68-2385" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb68-2386"><a href="#cb68-2386" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"center"</span>),</span>
<span id="cb68-2387"><a href="#cb68-2387" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb68-2388"><a href="#cb68-2388" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-2389"><a href="#cb68-2389" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-2390"><a href="#cb68-2390" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply color highlighting for violations in Parameter Bias</span></span>
<span id="cb68-2391"><a href="#cb68-2391" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span>(subset<span class="sc">$</span>Parameter_Bias <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">9.99</span> <span class="sc">&amp;</span> subset<span class="sc">$</span>Parameter_Bias <span class="sc">&lt;=</span> <span class="fl">9.99</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb68-2392"><a href="#cb68-2392" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb68-2393"><a href="#cb68-2393" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb68-2394"><a href="#cb68-2394" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Parameter_Bias"</span>,</span>
<span id="cb68-2395"><a href="#cb68-2395" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> .data<span class="sc">$</span>Parameter_Bias <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">9.99</span> <span class="sc">|</span> .data<span class="sc">$</span>Parameter_Bias <span class="sc">&gt;</span> <span class="fl">9.99</span>,  <span class="co"># Apply color only if outside the threshold</span></span>
<span id="cb68-2396"><a href="#cb68-2396" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb68-2397"><a href="#cb68-2397" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#113386"</span>, <span class="st">"#DAE3FA"</span>, <span class="st">"#113386"</span>),  <span class="co"># Darker blue for larger deviations</span></span>
<span id="cb68-2398"><a href="#cb68-2398" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>)  <span class="co"># Adjust the domain to reflect the range of values</span></span>
<span id="cb68-2399"><a href="#cb68-2399" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb68-2400"><a href="#cb68-2400" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb68-2401"><a href="#cb68-2401" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Darker blue indicates larger deviations from zero *Parameter Bias* beyond the Â±9.99 threshold."</span>),</span>
<span id="cb68-2402"><a href="#cb68-2402" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Parameter_Bias"</span>)</span>
<span id="cb68-2403"><a href="#cb68-2403" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb68-2404"><a href="#cb68-2404" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-2405"><a href="#cb68-2405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2406"><a href="#cb68-2406" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply color highlighting for violations in SE Bias</span></span>
<span id="cb68-2407"><a href="#cb68-2407" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span>(subset<span class="sc">$</span>SE_Bias <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">4.99</span> <span class="sc">&amp;</span> subset<span class="sc">$</span>SE_Bias <span class="sc">&lt;=</span> <span class="fl">4.99</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb68-2408"><a href="#cb68-2408" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb68-2409"><a href="#cb68-2409" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb68-2410"><a href="#cb68-2410" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"SE_Bias"</span>,</span>
<span id="cb68-2411"><a href="#cb68-2411" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> .data<span class="sc">$</span>SE_Bias <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">4.99</span> <span class="sc">|</span> .data<span class="sc">$</span>SE_Bias <span class="sc">&gt;</span> <span class="fl">4.99</span>,  <span class="co"># Apply color only if outside the threshold</span></span>
<span id="cb68-2412"><a href="#cb68-2412" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb68-2413"><a href="#cb68-2413" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#781049"</span>, <span class="st">"#FDEAF4"</span>, <span class="st">"#781049"</span>),  <span class="co"># Darker red for larger deviations</span></span>
<span id="cb68-2414"><a href="#cb68-2414" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>, <span class="dv">80</span>)  <span class="co"># Adjust the domain for the SE_Bias range</span></span>
<span id="cb68-2415"><a href="#cb68-2415" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb68-2416"><a href="#cb68-2416" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb68-2417"><a href="#cb68-2417" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Darker red indicates larger deviations from zero *Standard Error Bias* beyond the Â±4.99 threshold."</span>),</span>
<span id="cb68-2418"><a href="#cb68-2418" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"SE_Bias"</span>)</span>
<span id="cb68-2419"><a href="#cb68-2419" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb68-2420"><a href="#cb68-2420" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-2421"><a href="#cb68-2421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2422"><a href="#cb68-2422" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(subset<span class="sc">$</span>Coverage <span class="sc">&lt;</span> <span class="fl">0.93</span> <span class="sc">|</span> subset<span class="sc">$</span>Coverage <span class="sc">&gt;</span> <span class="fl">0.979</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb68-2423"><a href="#cb68-2423" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb68-2424"><a href="#cb68-2424" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb68-2425"><a href="#cb68-2425" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Coverage"</span>,</span>
<span id="cb68-2426"><a href="#cb68-2426" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> subset<span class="sc">$</span>Coverage <span class="sc">&lt;</span> <span class="fl">0.93</span> <span class="sc">|</span> subset<span class="sc">$</span>Coverage <span class="sc">&gt;</span> <span class="fl">0.979</span>,</span>
<span id="cb68-2427"><a href="#cb68-2427" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb68-2428"><a href="#cb68-2428" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#024F2D"</span>, <span class="st">"white"</span>),  <span class="co"># Green for coverage issues</span></span>
<span id="cb68-2429"><a href="#cb68-2429" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb68-2430"><a href="#cb68-2430" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb68-2431"><a href="#cb68-2431" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb68-2432"><a href="#cb68-2432" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Green indicates failure to achieve adequate *Coverage*."</span>),</span>
<span id="cb68-2433"><a href="#cb68-2433" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Coverage"</span>)</span>
<span id="cb68-2434"><a href="#cb68-2434" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb68-2435"><a href="#cb68-2435" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-2436"><a href="#cb68-2436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2437"><a href="#cb68-2437" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(subset<span class="sc">$</span>Power <span class="sc">&lt;</span> <span class="fl">0.8</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb68-2438"><a href="#cb68-2438" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb68-2439"><a href="#cb68-2439" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb68-2440"><a href="#cb68-2440" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Power"</span>,</span>
<span id="cb68-2441"><a href="#cb68-2441" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> subset<span class="sc">$</span>Power <span class="sc">&lt;</span> <span class="fl">0.8</span>,</span>
<span id="cb68-2442"><a href="#cb68-2442" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb68-2443"><a href="#cb68-2443" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#502CD1"</span>, <span class="st">"white"</span>),  <span class="co"># Purple for power issues</span></span>
<span id="cb68-2444"><a href="#cb68-2444" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb68-2445"><a href="#cb68-2445" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb68-2446"><a href="#cb68-2446" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb68-2447"><a href="#cb68-2447" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Purple indicates failure to achieve adequate *Power*."</span>),</span>
<span id="cb68-2448"><a href="#cb68-2448" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Power"</span>)</span>
<span id="cb68-2449"><a href="#cb68-2449" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb68-2450"><a href="#cb68-2450" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-2451"><a href="#cb68-2451" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-2452"><a href="#cb68-2452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(gt_table)</span>
<span id="cb68-2453"><a href="#cb68-2453" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-2454"><a href="#cb68-2454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2455"><a href="#cb68-2455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2456"><a href="#cb68-2456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2457"><a href="#cb68-2457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2458"><a href="#cb68-2458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-2459"><a href="#cb68-2459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2460"><a href="#cb68-2460" aria-hidden="true" tabindex="-1"></a><span class="fu">### Render Heat map</span></span>
<span id="cb68-2461"><a href="#cb68-2461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2464"><a href="#cb68-2464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-2465"><a href="#cb68-2465" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "render-heatmap"</span></span>
<span id="cb68-2466"><a href="#cb68-2466" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-2467"><a href="#cb68-2467" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb68-2468"><a href="#cb68-2468" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb68-2469"><a href="#cb68-2469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2470"><a href="#cb68-2470" aria-hidden="true" tabindex="-1"></a>gt_table <span class="ot">&lt;-</span> <span class="fu">create_gt_table</span>(test_map, <span class="st">"Mover &amp; Stayers"</span>)</span>
<span id="cb68-2471"><a href="#cb68-2471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2472"><a href="#cb68-2472" aria-hidden="true" tabindex="-1"></a>gt_table</span>
<span id="cb68-2473"><a href="#cb68-2473" aria-hidden="true" tabindex="-1"></a><span class="co"># Further operations on gt_table</span></span>
<span id="cb68-2474"><a href="#cb68-2474" aria-hidden="true" tabindex="-1"></a>gt_table <span class="sc">|&gt;</span> <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">75</span>)) <span class="sc">|&gt;</span> <span class="fu">gtsave</span>(<span class="fu">here</span>(<span class="st">"Simulations"</span>, <span class="st">"STUDY_1"</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zHEATMAPS"</span>, <span class="st">"z2t_heatmaps"</span>, <span class="st">"2T_L_L.png"</span>)</span>
<span id="cb68-2475"><a href="#cb68-2475" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-2476"><a href="#cb68-2476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2477"><a href="#cb68-2477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2478"><a href="#cb68-2478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2479"><a href="#cb68-2479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>