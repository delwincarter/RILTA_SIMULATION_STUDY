<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Delwin Carter">
<meta name="dcterms.date" content="2025-01-26">

<title>Understanding the Performance of Random Intercepts Latent Transition Analysis (RI-LTA): A Monte Carlo Simulation Study using MplusAutomation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Study_1_2T_LTA_RILTA_files/libs/clipboard/clipboard.min.js"></script>
<script src="Study_1_2T_LTA_RILTA_files/libs/quarto-html/quarto.js"></script>
<script src="Study_1_2T_LTA_RILTA_files/libs/quarto-html/popper.min.js"></script>
<script src="Study_1_2T_LTA_RILTA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Study_1_2T_LTA_RILTA_files/libs/quarto-html/anchor.min.js"></script>
<link href="Study_1_2T_LTA_RILTA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Study_1_2T_LTA_RILTA_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Study_1_2T_LTA_RILTA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Study_1_2T_LTA_RILTA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Study_1_2T_LTA_RILTA_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Overview</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#study-1.2-lta-generated-rilta-analyzed" id="toc-study-1.2-lta-generated-rilta-analyzed" class="nav-link" data-scroll-target="#study-1.2-lta-generated-rilta-analyzed">Study 1.2: LTA Generated, RILTA Analyzed</a></li>
  </ul></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a>
  <ul class="collapse">
  <li><a href="#part-1-conduct-simulation" id="toc-part-1-conduct-simulation" class="nav-link" data-scroll-target="#part-1-conduct-simulation">Part 1: Conduct Simulation</a>
  <ul class="collapse">
  <li><a href="#setting-up-the-simulation-conditions" id="toc-setting-up-the-simulation-conditions" class="nav-link" data-scroll-target="#setting-up-the-simulation-conditions">Setting up the Simulation Conditions&nbsp;</a></li>
  </ul></li>
  <li><a href="#run-initial-simulation" id="toc-run-initial-simulation" class="nav-link" data-scroll-target="#run-initial-simulation">Run Initial Simulation</a></li>
  </ul></li>
  <li><a href="#data-processing-and-verification" id="toc-data-processing-and-verification" class="nav-link" data-scroll-target="#data-processing-and-verification">Data Processing and Verification</a>
  <ul class="collapse">
  <li><a href="#check-for-label-switching-and-errors" id="toc-check-for-label-switching-and-errors" class="nav-link" data-scroll-target="#check-for-label-switching-and-errors">Check for Label Switching and Errors</a>
  <ul class="collapse">
  <li><a href="#scrape-mplus-csv-files" id="toc-scrape-mplus-csv-files" class="nav-link" data-scroll-target="#scrape-mplus-csv-files">Scrape Mplus CSV Files</a></li>
  <li><a href="#slice-data-extract-parameters" id="toc-slice-data-extract-parameters" class="nav-link" data-scroll-target="#slice-data-extract-parameters">Slice Data / Extract Parameters</a></li>
  <li><a href="#wrangle-data" id="toc-wrangle-data" class="nav-link" data-scroll-target="#wrangle-data">Wrangle Data</a></li>
  <li><a href="#generate-plots-of-label-switching" id="toc-generate-plots-of-label-switching" class="nav-link" data-scroll-target="#generate-plots-of-label-switching">Generate Plots of Label Switching</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#error-handling" id="toc-error-handling" class="nav-link" data-scroll-target="#error-handling">Error Handling</a>
  <ul class="collapse">
  <li><a href="#scrape-for-errors" id="toc-scrape-for-errors" class="nav-link" data-scroll-target="#scrape-for-errors">Scrape for Errors</a></li>
  <li><a href="#tabulate-error-rates" id="toc-tabulate-error-rates" class="nav-link" data-scroll-target="#tabulate-error-rates">Tabulate Error Rates</a></li>
  <li><a href="#merge-errors-with-main-data-file" id="toc-merge-errors-with-main-data-file" class="nav-link" data-scroll-target="#merge-errors-with-main-data-file">Merge Errors with Main Data File</a></li>
  <li><a href="#scrape-file-name-components" id="toc-scrape-file-name-components" class="nav-link" data-scroll-target="#scrape-file-name-components">Scrape File Name Components</a></li>
  <li><a href="#calculate-violations" id="toc-calculate-violations" class="nav-link" data-scroll-target="#calculate-violations">Calculate Violations</a></li>
  <li><a href="#summarize-visualize-label-switching-percentage-results" id="toc-summarize-visualize-label-switching-percentage-results" class="nav-link" data-scroll-target="#summarize-visualize-label-switching-percentage-results">Summarize &amp; Visualize Label Switching Percentage Results</a></li>
  </ul></li>
  <li><a href="#re-run-simulation" id="toc-re-run-simulation" class="nav-link" data-scroll-target="#re-run-simulation">Re-Run Simulation</a>
  <ul class="collapse">
  <li><a href="#re-run-simulation-with-dynamic-replication-conditions" id="toc-re-run-simulation-with-dynamic-replication-conditions" class="nav-link" data-scroll-target="#re-run-simulation-with-dynamic-replication-conditions">Re-Run Simulation with Dynamic Replication Conditions</a></li>
  <li><a href="#check-for-label-switching-and-errors---part-2" id="toc-check-for-label-switching-and-errors---part-2" class="nav-link" data-scroll-target="#check-for-label-switching-and-errors---part-2">Check for Label Switching and Errors - Part 2</a></li>
  </ul></li>
  <li><a href="#final-data-preparation" id="toc-final-data-preparation" class="nav-link" data-scroll-target="#final-data-preparation">Final Data Preparation</a>
  <ul class="collapse">
  <li><a href="#filter-cases-with-violations-and-errors" id="toc-filter-cases-with-violations-and-errors" class="nav-link" data-scroll-target="#filter-cases-with-violations-and-errors">Filter Cases with Violations and Errors</a>
  <ul class="collapse">
  <li><a href="#randomly-sample-500-replications" id="toc-randomly-sample-500-replications" class="nav-link" data-scroll-target="#randomly-sample-500-replications">Randomly Sample 500 Replications</a></li>
  <li><a href="#calculate-monte-carlo-values" id="toc-calculate-monte-carlo-values" class="nav-link" data-scroll-target="#calculate-monte-carlo-values">Calculate Monte Carlo Values</a></li>
  <li><a href="#calculate-bias-and-dichotomous-variables" id="toc-calculate-bias-and-dichotomous-variables" class="nav-link" data-scroll-target="#calculate-bias-and-dichotomous-variables">Calculate Bias and Dichotomous Variables</a></li>
  </ul></li>
  <li><a href="#prepare-data-for-visualization" id="toc-prepare-data-for-visualization" class="nav-link" data-scroll-target="#prepare-data-for-visualization">Prepare Data for Visualization</a>
  <ul class="collapse">
  <li><a href="#subset-data-for-bias-plots" id="toc-subset-data-for-bias-plots" class="nav-link" data-scroll-target="#subset-data-for-bias-plots">Subset Data for Bias Plots</a></li>
  <li><a href="#prepare-function-for-bias-plots" id="toc-prepare-function-for-bias-plots" class="nav-link" data-scroll-target="#prepare-function-for-bias-plots">Prepare Function for Bias Plots</a></li>
  <li><a href="#render-bias-figures" id="toc-render-bias-figures" class="nav-link" data-scroll-target="#render-bias-figures">Render Bias Figures</a></li>
  </ul></li>
  <li><a href="#prepare-data-for-heat-maps" id="toc-prepare-data-for-heat-maps" class="nav-link" data-scroll-target="#prepare-data-for-heat-maps"><strong>Prepare Data for Heat Maps</strong></a>
  <ul class="collapse">
  <li><a href="#prepare-function-for-heat-map-creation" id="toc-prepare-function-for-heat-map-creation" class="nav-link" data-scroll-target="#prepare-function-for-heat-map-creation">Prepare Function for Heat Map Creation</a></li>
  <li><a href="#render-heat-map" id="toc-render-heat-map" class="nav-link" data-scroll-target="#render-heat-map">Render Heat Map</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Understanding the Performance of Random Intercepts Latent Transition Analysis (RI-LTA): A Monte Carlo Simulation Study using MplusAutomation</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Study 1.2: LTA Generated, RILTA Analyzed with Two Timepoints</p>
</div>



<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Delwin Carter </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 26, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<hr>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/LVG%20FINAL.png" class="img-fluid" width="300"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/UCSB_Gauchos_logo_PNG2.png" class="img-fluid" width="300"></p>
</div>
</div>
</div>
<hr>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="study-1.2-lta-generated-rilta-analyzed" class="level2">
<h2 class="anchored" data-anchor-id="study-1.2-lta-generated-rilta-analyzed">Study 1.2: LTA Generated, RILTA Analyzed</h2>
<hr>
<p><img src="images/LTA_RILTA.png" class="img-fluid" width="354"></p>
<hr>
<p>Load Packages</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MplusAutomation)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="simulation" class="level1">
<h1>Simulation</h1>
<hr>
<section id="part-1-conduct-simulation" class="level2">
<h2 class="anchored" data-anchor-id="part-1-conduct-simulation">Part 1: Conduct Simulation</h2>
<blockquote class="blockquote">
<p>In this section, I am conducting a simulation where I am generating data as Latent Transition Analysis and analyzing it as Random Intercepts Latent Transition Analysis to fully explore the modelâ€™s performance. The simulation consists of 24 conditions, combining four sample sizes (N = 500, 1000, 2000, 4000) with six transition probabilities linked to logits (<em>betas;</em> 1.385, .85, .41, -.41, -.85, -1.385), corresponding to probabilities of .8, .7, .6, .4, .3, and .2. These conditions are iterated over programmatically using MplusAutomation to set up and execute the models. To speed up the process, I employ parallel processing, which distributes computations across multiple CPU cores, enabling efficient completion of the simulations across all scenarios.</p>
</blockquote>
<p>Conditions:</p>
<p>Sample Size: N = 500, 1000, 2000, 4000</p>
<p>Transition logit (Probability): TPs = 1.385 (.8), .85 (.7), .41 (.6), -.41 (.4), -.85 (.3), -1.385 (.2)</p>
<p><img src="images/clipboard-3344253592.png" class="img-fluid" width="450"></p>
<section id="setting-up-the-simulation-conditions" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-the-simulation-conditions">Setting up the Simulation Conditions&nbsp;</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">N =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">TPs =</span> <span class="fu">c</span>(<span class="fl">1.385</span>, .<span class="dv">85</span>, .<span class="dv">41</span>, <span class="sc">-</span>.<span class="dv">41</span>, <span class="sc">-</span>.<span class="dv">85</span>, <span class="sc">-</span><span class="fl">1.385</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">TH =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the matrix using gt</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Simulation Conditions Matrix"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Combinations of Sample Sizes, Transition Probabilities, and Mixtures"</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>() <span class="co"># Centers all columns</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="zdglnantqf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zdglnantqf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zdglnantqf thead, #zdglnantqf tbody, #zdglnantqf tfoot, #zdglnantqf tr, #zdglnantqf td, #zdglnantqf th {
  border-style: none;
}

#zdglnantqf p {
  margin: 0;
  padding: 0;
}

#zdglnantqf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zdglnantqf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zdglnantqf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zdglnantqf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zdglnantqf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zdglnantqf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zdglnantqf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zdglnantqf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zdglnantqf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zdglnantqf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zdglnantqf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zdglnantqf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zdglnantqf .gt_spanner_row {
  border-bottom-style: hidden;
}

#zdglnantqf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zdglnantqf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zdglnantqf .gt_from_md > :first-child {
  margin-top: 0;
}

#zdglnantqf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zdglnantqf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zdglnantqf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zdglnantqf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zdglnantqf .gt_row_group_first td {
  border-top-width: 2px;
}

#zdglnantqf .gt_row_group_first th {
  border-top-width: 2px;
}

#zdglnantqf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdglnantqf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zdglnantqf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zdglnantqf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zdglnantqf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdglnantqf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zdglnantqf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zdglnantqf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zdglnantqf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zdglnantqf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zdglnantqf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdglnantqf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zdglnantqf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdglnantqf .gt_left {
  text-align: left;
}

#zdglnantqf .gt_center {
  text-align: center;
}

#zdglnantqf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zdglnantqf .gt_font_normal {
  font-weight: normal;
}

#zdglnantqf .gt_font_bold {
  font-weight: bold;
}

#zdglnantqf .gt_font_italic {
  font-style: italic;
}

#zdglnantqf .gt_super {
  font-size: 65%;
}

#zdglnantqf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zdglnantqf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zdglnantqf .gt_indent_1 {
  text-indent: 5px;
}

#zdglnantqf .gt_indent_2 {
  text-indent: 10px;
}

#zdglnantqf .gt_indent_3 {
  text-indent: 15px;
}

#zdglnantqf .gt_indent_4 {
  text-indent: 20px;
}

#zdglnantqf .gt_indent_5 {
  text-indent: 25px;
}

#zdglnantqf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zdglnantqf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal">Simulation Conditions Matrix</th>
</tr>
<tr class="odd gt_heading">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Combinations of Sample Sizes, Transition Probabilities, and Mixtures</th>
</tr>
<tr class="header gt_col_headings">
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">N</th>
<th id="TPs" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">TPs</th>
<th id="TH" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">TH</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2000</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">4000</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="TH">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="run-initial-simulation" class="level2">
<h2 class="anchored" data-anchor-id="run-initial-simulation">Run Initial Simulation</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create the cluster for parallel processing</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Detect the number of available cores (minus 1)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> <span class="st">"PSOCK"</span>)  <span class="co"># Create the PSOCK cluster</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>lta_rilta_func <span class="ot">&lt;-</span> <span class="cf">function</span>(N, TPs, TH) {</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  LTA_RILTA <span class="ot">&lt;-</span> <span class="fu">mplusObject</span>(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE =</span> <span class="fu">glue</span>(<span class="st">"Generate LTA_RILTA_N_{N}_TP = {TPs}_{TH}"</span>),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">MONTECARLO =</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"NAMES = u11-u15 u21-u25;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">      GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">      CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">      GENCLASSES = c1(2) c2(2);</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">      CLASSES = c1(2) c2(2);</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">      NOBSERVATIONS = {N};</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="st">      SEED = 07252005;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="st">      NREPS = 500;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="st">      !!SAVE = repM1*.dat;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">      RESULTS = LTA_RILTA_N_{N}_TP_{TPs}_TH_{TH}_WD.csv;"</span>),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANALYSIS =</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"TYPE = MIXTURE;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="st">      algorithm = integration;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="st">      processors = 24;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="st">      starts=50 10;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="st">      logcriterion=0.00001;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="st">      mconv=0.00001;"</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELPOPULATION =</span> <span class="fu">glue</span>(<span class="st">"    </span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="st">        %OVERALL%</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="st">       [c1#1-c2#1*0];</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="st">        c2#1 on c1#1*{TPs};</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#1%</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*{TH} u12$1*{TH} u13$1*{TH} u14$1*{TH} u15$1*{TH}] (p111-p115);</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#2%</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*-{TH} u12$1*-{TH} u13$1*-{TH} u14$1*-{TH} u15$1*-{TH}] (p121-p125);</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#1%</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*{TH} u22$1*{TH} u23$1*{TH} u24$1*{TH} u25$1*{TH}] (p111-p115);</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#2%</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*-{TH} u22$1*-{TH} u23$1*-{TH} u24$1*-{TH} u25$1*-{TH}] (p121-p125);</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="st">       "</span>),</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODEL =</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">"    </span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="st">        %OVERALL%</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="st">          [c1#1-c2#1*0](par1-par2);</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="st">            c2#1 on c1#1*{TPs} (par11);</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="st">        f by u11* u12 u13 u14-u15 (p1-p5)</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="st">             u21 u22 u23 u24 u25 (p1-p5);</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="st">        f@1;</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="st">        [f@0];</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a><span class="st">     MODEL c1:</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#1%</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*{TH} u12$1*{TH} u13$1*{TH} u14$1*{TH} u15$1*{TH}] (p111-p115);</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="st">        %c1#2%</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="st">     [u11$1*-{TH} u12$1*-{TH} u13$1*-{TH} u14$1*-{TH} u15$1*-{TH}] (p121-p125);</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="st">    MODEL c2:   </span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#1%</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*{TH} u22$1*{TH} u23$1*{TH} u24$1*{TH} u25$1*{TH}] (p111-p115);</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="st">        %c2#2%</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="st">     [u21$1*-{TH} u22$1*-{TH} u23$1*-{TH} u24$1*-{TH} u25$1*-{TH}] (p121-p125);</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="st">          "</span>),</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELCONSTRAINT =</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="fl">1.385</span>) {</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.80 trans12*.20 trans21*.5 trans22*.5</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.65 prob22*.35);</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>             <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">85</span>) {</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.70 trans12*.30 trans21*.5 trans22*.5</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.60 prob22*.4);</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>  <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">41</span>) {</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.60 trans12*.40 trans21*.5 trans22*.5</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.55 prob22*.45);</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>             <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span>.<span class="dv">41</span>) {</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.40 trans12*.60 trans21*.5 trans22*.5</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.45 prob22*.55);</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>             <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span>.<span class="dv">85</span>) {</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.30 trans12*.70 trans21*.5 trans22*.5</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.40 prob22*.60);</span></span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span><span class="fl">1.385</span>) {</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a><span class="st">         New(</span></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.20 trans12*.80 trans21*.5 trans22*.5</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.35 prob22*.65);</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;"</span>)</span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run Mplus model</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>  LTA_RILTA_Model<span class="ot">&lt;-</span> <span class="fu">mplusModeler</span>(LTA_RILTA, </span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">dataout =</span> <span class="fu">here</span>(<span class="st">"2 2T LTA GEN RILTA ANALYZED"</span>, <span class="fu">glue</span>(<span class="st">"LTA_RILTA_N_{N}_TP_{TPs}_TH_{TH}_WD.dat"</span>)),</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">modelout =</span> <span class="fu">glue</span>(<span class="fu">here</span>(<span class="st">"2 2T LTA GEN RILTA ANALYZED"</span>, <span class="st">"LTA_RILTA_N_{N}_TP_{TPs}_TH_{TH}_WD.inp"</span>)),</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">check =</span> <span class="cn">TRUE</span>, <span class="at">run =</span> <span class="cn">TRUE</span>, <span class="at">hashfilename =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(LTA_RILTA_Model)</span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Export necessary objects to the cluster</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"lta_rilta_func"</span>, <span class="st">"p1"</span>, <span class="st">"here"</span>, <span class="st">"glue"</span>, <span class="st">"mplusModeler"</span>, <span class="st">"mplusObject"</span>))</span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure necessary libraries are loaded on each cluster node</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MplusAutomation)</span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Run the simulation in parallel using the cluster</span></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>result_list <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p1), <span class="cf">function</span>(i) {</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lta_rilta_func</span>(p1<span class="sc">$</span>N[i], p1<span class="sc">$</span>TPs[i], p1<span class="sc">$</span>TH[i])</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Stop the cluster after the simulation</span></span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
</section>
<section id="data-processing-and-verification" class="level1">
<h1>Data Processing and Verification</h1>
<hr>
<section id="check-for-label-switching-and-errors" class="level2">
<h2 class="anchored" data-anchor-id="check-for-label-switching-and-errors">Check for Label Switching and Errors</h2>
<blockquote class="blockquote">
<p>In this section: .csv files are first merged into a single data frame, from which specific parameters are extracted. Logit values are then converted to probabilities, and known class values are incorporated into the data frame. A subset of cases involving label switching is selected randomly and plotted for visual review. Output files are scanned for errors, which are subsequently merged back into the original data file. Additional columns derived from the file name are added, and the percentage of violations is calculated. Both errors and label switching violations are visually represented, and the total number of corrected replications is reported.</p>
</blockquote>
<section id="scrape-mplus-csv-files" class="level3">
<h3 class="anchored" data-anchor-id="scrape-mplus-csv-files">Scrape Mplus CSV Files</h3>
<p><em>First, Load all CSV files and combine them into a single data frame.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct CSV directory</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>csv_directory <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'Study_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'2_2T_LTA_GEN_RILTA_ANALYZED'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'data_scraping.R'</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate combined_data dataframe in the global environment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="slice-data-extract-parameters" class="level3">
<h3 class="anchored" data-anchor-id="slice-data-extract-parameters">Slice Data / Extract Parameters</h3>
<p><em>Extract data from the appropriate rows from each 9-row chunk and prepare the data for further processing.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Process the data using the child script</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step2_2t_RILTA.R'</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate final_combined_data dataframe in global environment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wrangle-data" class="level3">
<h3 class="anchored" data-anchor-id="wrangle-data">Wrangle Data</h3>
<p><em>Convert the logits to probabilities and add the known actual values to each row.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3 and 4: Process the data and return results</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step_3.R'</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The objects `final_data_with_actuals` and `violators` should now be in the global environment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="generate-plots-of-label-switching" class="level3">
<h3 class="anchored" data-anchor-id="generate-plots-of-label-switching">Generate Plots of Label Switching</h3>
<p><em>Generate plots of randomly sampled violators for visual inspection using parallel processing.</em></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot width and height</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plot_width <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plot_height <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a random sample of up to 250 violators (ensure not to exceed the total number of violators)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">nrow</span>(violators), <span class="dv">250</span>)  <span class="co"># Handle cases where fewer than 250 violators exist</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>sampled_violators <span class="ot">&lt;-</span> violators[<span class="fu">sample</span>(<span class="fu">nrow</span>(violators), sample_size), ]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to create plots sequentially</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plot_violator <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  row_data <span class="ot">&lt;-</span> sampled_violators[i, ]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the file name from the current row</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  file_name <span class="ot">&lt;-</span> row_data<span class="sc">$</span>FileName</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract probability values for EC1 and EC2 (estimated probabilities) and AC1 and AC2 (actuals)</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  estimated_probabilities <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ec1u1"</span>, <span class="st">"Ec1u2"</span>, <span class="st">"Ec1u3"</span>, <span class="st">"Ec1u4"</span>, <span class="st">"Ec1u5"</span>)]),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ec2u1"</span>, <span class="st">"Ec2u2"</span>, <span class="st">"Ec2u3"</span>, <span class="st">"Ec2u4"</span>, <span class="st">"Ec2u5"</span>)])</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  actual_values <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ac1u1"</span>, <span class="st">"Ac1u2"</span>, <span class="st">"Ac1u3"</span>, <span class="st">"Ac1u4"</span>, <span class="st">"Ac1u5"</span>)]),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ac2u1"</span>, <span class="st">"Ac2u2"</span>, <span class="st">"Ac2u3"</span>, <span class="st">"Ac2u4"</span>, <span class="st">"Ac2u5"</span>)])</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create labels for the legend with actual values directly from the dataset</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"EC1: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"EC2: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"AC1: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"AC2: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u5, <span class="dv">3</span>), <span class="st">")"</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 6: Create a data frame for plotting</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Items =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">4</span>),</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">Probabilities =</span> <span class="fu">c</span>(estimated_probabilities, actual_values),</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Class =</span> <span class="fu">rep</span>(labels, <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 7: Create the plot with the file name in the title</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Items, <span class="at">y =</span> Probabilities, <span class="at">color =</span> Class, <span class="at">group =</span> Class)) <span class="sc">+</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> file_name, <span class="at">x =</span> <span class="st">"Items"</span>, <span class="at">y =</span> <span class="st">"Probabilities"</span>) <span class="sc">+</span>  <span class="co"># Only the file name in the title</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span>  <span class="co"># Adjust title size and center</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>      <span class="st">"darkblue"</span>, <span class="st">"darkgreen"</span>,  <span class="co"># EC1 and EC2 (Estimated Probabilities)</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>      <span class="st">"lightblue"</span>, <span class="st">"lightgreen"</span>  <span class="co"># AC1 and AC2 (Actual Values)</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="st">"z2t_lta_rilta_violator_plots"</span>, <span class="fu">paste0</span>(<span class="st">"violator_plot_"</span>, i, <span class="st">"_"</span>, file_name, <span class="st">".png"</span>)),</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot =</span> p, <span class="at">width =</span> plot_width, <span class="at">height =</span> plot_height)</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to generate plots sequentially (without parallelization)</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>sample_size, plot_violator))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
</section>
</section>
<section id="error-handling" class="level1">
<h1>Error Handling</h1>
<hr>
<section id="scrape-for-errors" class="level3">
<h3 class="anchored" data-anchor-id="scrape-for-errors">Scrape for Errors</h3>
<p><em>Scrape output files for errors</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct output directory for .out files</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>output_folder <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'2_2T_LTA_GEN_RILTA_ANALYZED'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document that processes .out files</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'out_scraping.R'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tabulate-error-rates" class="level3">
<h3 class="anchored" data-anchor-id="tabulate-error-rates">Tabulate Error Rates</h3>
<p><em>Create Visual Summary of Errors per Condition</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>replication_summary_table <span class="ot">&lt;-</span> replication_summary <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Replication Summary"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Folder: "</span>, output_folder)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ErrorRate"</span>),  <span class="co"># Use the actual column name, ensure it matches your dataframe</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">FileName =</span> <span class="st">"File Name"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">CompletedReplications =</span> <span class="st">"Completed Replications"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">RequestedReplications =</span> <span class="st">"Requested Replications"</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorReplications =</span> <span class="st">"Replications with Errors"</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> <span class="st">"Good Replications"</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> <span class="st">"Error Rate (%)"</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()  <span class="co"># This aligns all columns' text to center</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">80</span>)  <span class="co"># Adjust this percentage to reduce the width of the table</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>replication_summary_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="suwuvewnsf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#suwuvewnsf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#suwuvewnsf thead, #suwuvewnsf tbody, #suwuvewnsf tfoot, #suwuvewnsf tr, #suwuvewnsf td, #suwuvewnsf th {
  border-style: none;
}

#suwuvewnsf p {
  margin: 0;
  padding: 0;
}

#suwuvewnsf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 80%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#suwuvewnsf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#suwuvewnsf .gt_title {
  color: #333333;
  font-size: medium;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#suwuvewnsf .gt_subtitle {
  color: #333333;
  font-size: small;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#suwuvewnsf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#suwuvewnsf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#suwuvewnsf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#suwuvewnsf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#suwuvewnsf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#suwuvewnsf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#suwuvewnsf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#suwuvewnsf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#suwuvewnsf .gt_spanner_row {
  border-bottom-style: hidden;
}

#suwuvewnsf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#suwuvewnsf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#suwuvewnsf .gt_from_md > :first-child {
  margin-top: 0;
}

#suwuvewnsf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#suwuvewnsf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#suwuvewnsf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#suwuvewnsf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#suwuvewnsf .gt_row_group_first td {
  border-top-width: 2px;
}

#suwuvewnsf .gt_row_group_first th {
  border-top-width: 2px;
}

#suwuvewnsf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#suwuvewnsf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#suwuvewnsf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#suwuvewnsf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#suwuvewnsf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#suwuvewnsf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#suwuvewnsf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#suwuvewnsf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#suwuvewnsf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#suwuvewnsf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#suwuvewnsf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#suwuvewnsf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#suwuvewnsf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#suwuvewnsf .gt_left {
  text-align: left;
}

#suwuvewnsf .gt_center {
  text-align: center;
}

#suwuvewnsf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#suwuvewnsf .gt_font_normal {
  font-weight: normal;
}

#suwuvewnsf .gt_font_bold {
  font-weight: bold;
}

#suwuvewnsf .gt_font_italic {
  font-style: italic;
}

#suwuvewnsf .gt_super {
  font-size: 65%;
}

#suwuvewnsf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#suwuvewnsf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#suwuvewnsf .gt_indent_1 {
  text-indent: 5px;
}

#suwuvewnsf .gt_indent_2 {
  text-indent: 10px;
}

#suwuvewnsf .gt_indent_3 {
  text-indent: 15px;
}

#suwuvewnsf .gt_indent_4 {
  text-indent: 20px;
}

#suwuvewnsf .gt_indent_5 {
  text-indent: 25px;
}

#suwuvewnsf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#suwuvewnsf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="6" class="gt_heading gt_title gt_font_normal">Replication Summary</th>
</tr>
<tr class="odd gt_heading">
<th colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Folder: /Users/brucecarter/Library/CloudStorage/Box-Box/RILTAS/RILTA_SIMULATION_STUDY/Simulations/STUDY_1/2 Time Points/2_2T_LTA_GEN_RILTA_ANALYZED</th>
</tr>
<tr class="header gt_col_headings">
<th id="FileName" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">File Name</th>
<th id="RequestedReplications" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Requested Replications</th>
<th id="CompletedReplications" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Completed Replications</th>
<th id="ErrorReplications" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Replications with Errors</th>
<th id="GoodReplications" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Good Replications</th>
<th id="ErrorRate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Error Rate (%)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_-0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_-0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_-1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_-0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_-0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_-1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_-0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_-0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_-1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_-0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_-0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_-1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">500</td>
<td class="gt_row gt_center" headers="CompletedReplications">500</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">500</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compare rows in both .csv and .out data frames</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_data_with_actuals:"</span>, <span class="fu">nrow</span>(final_data_with_actuals), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows in final_data_with_actuals: 12000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the final number of rows to confirm data handling</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows in error_summary: "</span>, <span class="fu">nrow</span>(error_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows in error_summary:  12000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows in replication_summary: "</span>, <span class="fu">nrow</span>(replication_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows in replication_summary:  24 </code></pre>
</div>
</div>
</section>
<section id="merge-errors-with-main-data-file" class="level3">
<h3 class="anchored" data-anchor-id="merge-errors-with-main-data-file">Merge Errors with Main Data File</h3>
<p><em>Merge Errors with Main Data</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Process the data using the child script</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'merge_errors.R'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scrape-file-name-components" class="level3">
<h3 class="anchored" data-anchor-id="scrape-file-name-components">Scrape File Name Components</h3>
<p><em>Create Column Names from the File Name</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns based on the information in the FileName and set factors</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the sample size (N) from the FileName with the correct values</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_4000"</span>, FileName) <span class="sc">~</span> <span class="dv">4</span>,  <span class="co"># Correct value for N_4000</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_500"</span>, FileName) <span class="sc">~</span> <span class="dv">1</span>,   </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_1000"</span>, FileName) <span class="sc">~</span> <span class="dv">2</span>,  </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_2000"</span>, FileName) <span class="sc">~</span> <span class="dv">3</span>,  </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map the TPs from the FileName to the appropriate Population labels</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".800"</span>,   <span class="co"># Use ".800" instead of "0.800"</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".700"</span>,    <span class="co"># Use ".700" instead of "0.700"</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".600"</span>,    <span class="co"># Use ".600" instead of "0.600"</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".400"</span>,   <span class="co"># Use ".400" instead of "0.400"</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".300"</span>,   <span class="co"># Use ".300" instead of "0.300"</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".200"</span>,  <span class="co"># Use ".200" instead of "0.200"</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the Transitions variable based on Population values</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>) <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># Assign 1 for Population .200, .300, .400</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>) <span class="sc">~</span> <span class="dv">2</span>,  <span class="co"># Assign 2 for Population .600, .700, .800</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert columns to factors, ordering N_4000 first in the factor levels</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"N = 4000"</span>, <span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>)),</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".800"</span>, <span class="st">".700"</span>, <span class="st">".600"</span>, <span class="st">".400"</span>, <span class="st">".300"</span>, <span class="st">".200"</span>)),</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">factor</span>(Transitions, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mover"</span>, <span class="st">"Stayer"</span>))</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculate-violations" class="level3">
<h3 class="anchored" data-anchor-id="calculate-violations">Calculate Violations</h3>
<p><em>Calculate Violation Percentages per Condition</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Summarize violations per condition</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Any_Violation =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Any_Violation), <span class="dv">0</span>, Any_Violation),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorFlag =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(ErrorFlag), <span class="dv">0</span>, ErrorFlag)  <span class="co"># Ensure no missing values for ErrorFlag</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName, Population, N) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> <span class="fu">n</span>(),                                <span class="co"># Total runs</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Violations =</span> <span class="fu">sum</span>(Any_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Total violations</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Errors =</span> <span class="fu">sum</span>(ErrorFlag, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),         <span class="co"># Total errors from ErrorFlag</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage_Violations =</span> (Total_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="co"># % violations</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Calculate Replications Needed for label switching</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, <span class="fu">as.character</span>(N))), </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Additional_Runs =</span> (<span class="dv">500</span> <span class="sc">+</span> Total_Violations) <span class="sc">*</span> (Percentage_Violations <span class="sc">/</span> <span class="dv">100</span>), </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replications_Needed =</span> <span class="fu">ceiling</span>(<span class="dv">500</span> <span class="sc">+</span> Total_Violations <span class="sc">+</span> Additional_Runs <span class="sc">+</span> <span class="dv">20</span>),</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replications_Needed =</span> <span class="fu">if_else</span>(Replications_Needed <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="dv">500</span>, Replications_Needed),</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> Total_Errors <span class="sc">/</span> Total_Rows,  <span class="co"># Calculate ErrorRate directly</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adjusted_Replications_Needed =</span> <span class="fu">ceiling</span>(Replications_Needed <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> ErrorRate)),</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adjusted_Replications_Needed =</span> <span class="fu">if_else</span>(Adjusted_Replications_Needed <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="dv">500</span>, Adjusted_Replications_Needed)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    FileName, Population, N, N_numeric,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    Total_Rows, Total_Violations, Total_Errors, ErrorRate,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    Percentage_Violations, Replications_Needed, Adjusted_Replications_Needed</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarize-visualize-label-switching-percentage-results" class="level3">
<h3 class="anchored" data-anchor-id="summarize-visualize-label-switching-percentage-results">Summarize &amp; Visualize Label Switching Percentage Results</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure correct column names and assign TPs (logits) based on Population (for display and MplusAutomation)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">TPs =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">~</span> <span class="fl">1.385</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".700"</span> <span class="sc">~</span> <span class="fl">0.85</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".600"</span> <span class="sc">~</span> <span class="fl">0.41</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".400"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.41</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".300"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.85</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">1.385</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, create the table with formatted output</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>create_model_table <span class="ot">&lt;-</span> <span class="cf">function</span>(data, model) {</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Transition Probability</span><span class="st">`</span> <span class="ot">=</span> Population,  <span class="co"># Show transition probabilities</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>      TPs,                       <span class="co"># Logit values for MplusAutomation</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>      N, </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>      N_numeric,                 <span class="co"># Consistent naming for MplusAutomation</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Mplus Runs</span><span class="st">`</span> <span class="ot">=</span> Total_Rows,  <span class="co"># Total number of Mplus runs</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Violations</span><span class="st">`</span> <span class="ot">=</span> Total_Violations,  <span class="co"># Show total violations</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">% of Violations</span><span class="st">`</span> <span class="ot">=</span> Percentage_Violations, <span class="co"># Violation percentage</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Errors</span><span class="st">`</span> <span class="ot">=</span> Total_Errors,           <span class="co">#Total Errors#</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>      ErrorRate,              <span class="co"># Include the error rate</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Replications Needed</span><span class="st">`</span> <span class="ot">=</span> Replications_Needed,       <span class="co"># Include the calculated replications needed</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Adjusted Replications Needed</span><span class="st">`</span> <span class="ot">=</span> Adjusted_Replications_Needed  <span class="co"># Include the adjusted replications needed</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Monte Carlo Results:"</span>,</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Percentage of Cases with Label Switching and Replications Needed"</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"center"</span>,  <span class="co"># Center all columns</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_options</span>(</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">4</span>)  <span class="co"># Set padding between rows</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>),  <span class="co"># Center align the headers only</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">everything</span>())  <span class="co"># Apply to headers only</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and display the table</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> <span class="fu">create_model_table</span>(violation_summary)</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the final table</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>final_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="vyevfbzjff" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vyevfbzjff table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vyevfbzjff thead, #vyevfbzjff tbody, #vyevfbzjff tfoot, #vyevfbzjff tr, #vyevfbzjff td, #vyevfbzjff th {
  border-style: none;
}

#vyevfbzjff p {
  margin: 0;
  padding: 0;
}

#vyevfbzjff .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vyevfbzjff .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vyevfbzjff .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vyevfbzjff .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vyevfbzjff .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vyevfbzjff .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vyevfbzjff .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vyevfbzjff .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vyevfbzjff .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vyevfbzjff .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vyevfbzjff .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vyevfbzjff .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vyevfbzjff .gt_spanner_row {
  border-bottom-style: hidden;
}

#vyevfbzjff .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vyevfbzjff .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vyevfbzjff .gt_from_md > :first-child {
  margin-top: 0;
}

#vyevfbzjff .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vyevfbzjff .gt_row {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vyevfbzjff .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vyevfbzjff .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vyevfbzjff .gt_row_group_first td {
  border-top-width: 2px;
}

#vyevfbzjff .gt_row_group_first th {
  border-top-width: 2px;
}

#vyevfbzjff .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vyevfbzjff .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vyevfbzjff .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vyevfbzjff .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vyevfbzjff .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vyevfbzjff .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vyevfbzjff .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vyevfbzjff .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vyevfbzjff .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vyevfbzjff .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vyevfbzjff .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vyevfbzjff .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vyevfbzjff .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vyevfbzjff .gt_left {
  text-align: left;
}

#vyevfbzjff .gt_center {
  text-align: center;
}

#vyevfbzjff .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vyevfbzjff .gt_font_normal {
  font-weight: normal;
}

#vyevfbzjff .gt_font_bold {
  font-weight: bold;
}

#vyevfbzjff .gt_font_italic {
  font-style: italic;
}

#vyevfbzjff .gt_super {
  font-size: 65%;
}

#vyevfbzjff .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vyevfbzjff .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vyevfbzjff .gt_indent_1 {
  text-indent: 5px;
}

#vyevfbzjff .gt_indent_2 {
  text-indent: 10px;
}

#vyevfbzjff .gt_indent_3 {
  text-indent: 15px;
}

#vyevfbzjff .gt_indent_4 {
  text-indent: 20px;
}

#vyevfbzjff .gt_indent_5 {
  text-indent: 25px;
}

#vyevfbzjff .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vyevfbzjff div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="11" class="gt_heading gt_title gt_font_normal">Monte Carlo Results:</th>
</tr>
<tr class="odd gt_heading">
<th colspan="11" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Percentage of Cases with Label Switching and Replications Needed</th>
</tr>
<tr class="header gt_col_headings">
<th id="Transition-Probability" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Transition Probability</th>
<th id="TPs" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">TPs</th>
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">N</th>
<th id="N_numeric" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">N_numeric</th>
<th id="Total-Mplus-Runs" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total Mplus Runs</th>
<th id="Total-Violations" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total Violations</th>
<th id="a%-of-Violations" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">% of Violations</th>
<th id="Total-Errors" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total Errors</th>
<th id="ErrorRate" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">ErrorRate</th>
<th id="Replications-Needed" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Replications Needed</th>
<th id="Adjusted-Replications-Needed" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Adjusted Replications Needed</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.400</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="N">N = 1000</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">161</td>
<td class="gt_row gt_center" headers="% of Violations">32.2</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">894</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">894</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.300</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="N">N = 1000</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">160</td>
<td class="gt_row gt_center" headers="% of Violations">32.0</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">892</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">892</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N">N = 1000</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">142</td>
<td class="gt_row gt_center" headers="% of Violations">28.4</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">845</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">845</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.600</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="N">N = 1000</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">128</td>
<td class="gt_row gt_center" headers="% of Violations">25.6</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">809</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">809</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.700</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="N">N = 1000</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">123</td>
<td class="gt_row gt_center" headers="% of Violations">24.6</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">797</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">797</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N">N = 1000</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">120</td>
<td class="gt_row gt_center" headers="% of Violations">24.0</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">789</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">789</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.400</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="N">N = 2000</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">161</td>
<td class="gt_row gt_center" headers="% of Violations">32.2</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">894</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">894</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.300</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="N">N = 2000</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">158</td>
<td class="gt_row gt_center" headers="% of Violations">31.6</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">886</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">886</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N">N = 2000</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">178</td>
<td class="gt_row gt_center" headers="% of Violations">35.6</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">940</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">940</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.600</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="N">N = 2000</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">151</td>
<td class="gt_row gt_center" headers="% of Violations">30.2</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">868</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">868</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.700</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="N">N = 2000</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">122</td>
<td class="gt_row gt_center" headers="% of Violations">24.4</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">794</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">794</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N">N = 2000</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">133</td>
<td class="gt_row gt_center" headers="% of Violations">26.6</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">822</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">822</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.400</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="N">N = 4000</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">158</td>
<td class="gt_row gt_center" headers="% of Violations">31.6</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">886</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">886</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.300</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="N">N = 4000</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">179</td>
<td class="gt_row gt_center" headers="% of Violations">35.8</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">943</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">943</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N">N = 4000</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">177</td>
<td class="gt_row gt_center" headers="% of Violations">35.4</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">937</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">937</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.600</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="N">N = 4000</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">149</td>
<td class="gt_row gt_center" headers="% of Violations">29.8</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">863</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">863</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.700</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="N">N = 4000</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">133</td>
<td class="gt_row gt_center" headers="% of Violations">26.6</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">822</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">822</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N">N = 4000</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">122</td>
<td class="gt_row gt_center" headers="% of Violations">24.4</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">794</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">794</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.400</td>
<td class="gt_row gt_center" headers="TPs">-0.410</td>
<td class="gt_row gt_center" headers="N">N = 500</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">126</td>
<td class="gt_row gt_center" headers="% of Violations">25.2</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">804</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">804</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.300</td>
<td class="gt_row gt_center" headers="TPs">-0.850</td>
<td class="gt_row gt_center" headers="N">N = 500</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">140</td>
<td class="gt_row gt_center" headers="% of Violations">28.0</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">840</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">840</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N">N = 500</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">142</td>
<td class="gt_row gt_center" headers="% of Violations">28.4</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">845</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">845</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.600</td>
<td class="gt_row gt_center" headers="TPs">0.410</td>
<td class="gt_row gt_center" headers="N">N = 500</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">131</td>
<td class="gt_row gt_center" headers="% of Violations">26.2</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">817</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">817</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.700</td>
<td class="gt_row gt_center" headers="TPs">0.850</td>
<td class="gt_row gt_center" headers="N">N = 500</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">141</td>
<td class="gt_row gt_center" headers="% of Violations">28.2</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">842</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">842</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N">N = 500</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">122</td>
<td class="gt_row gt_center" headers="% of Violations">24.4</td>
<td class="gt_row gt_center" headers="Total Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0</td>
<td class="gt_row gt_center" headers="Replications Needed">794</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">794</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
</section>
<section id="re-run-simulation" class="level1">
<h1>Re-Run Simulation</h1>
<hr>
<section id="re-run-simulation-with-dynamic-replication-conditions" class="level3">
<h3 class="anchored" data-anchor-id="re-run-simulation-with-dynamic-replication-conditions">Re-Run Simulation with Dynamic Replication Conditions</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the Mplus object with the dynamic replications</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>lta_rilta_func <span class="ot">&lt;-</span> <span class="cf">function</span>(N_numeric, TPs, Replications_Needed) {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Manually construct the MONTECARLO section with dynamic NREPS</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  montecarlo_section <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="st">    NAMES = u11-u15 u21-u25;</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="st">    GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="st">    CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="st">    GENCLASSES = c1(2) c2(2);</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="st">    CLASSES = c1(2) c2(2);</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="st">    NOBSERVATIONS = {N_numeric};</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="st">    SEED = 07252005;</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="st">    NREPS = {Replications_Needed};  ! Dynamic number of replications</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="st">    !!SAVE = repM1*.dat;</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="st">    RESULTS = LTA_RILTA_N_{N_numeric}_TP_{TPs}_TH_1_WD.csv;</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the Mplus model using MplusAutomation, using glue for the content</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  LTA_RILTA <span class="ot">&lt;-</span> <span class="fu">mplusObject</span>(</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE =</span> <span class="fu">glue</span>(<span class="st">"Generate LTA_RILTA_N_{N_numeric}_TP_{TPs}_TH_1;"</span>),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">MONTECARLO =</span> montecarlo_section,  <span class="co"># Use the dynamically constructed MONTECARLO section</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANALYSIS =</span> <span class="st">"</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="st">      TYPE = MIXTURE;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="st">      algorithm = integration;</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="st">      processors = 24;</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="st">      starts = 50 10;</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="st">      logcriterion = 0.00001;</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="st">      mconv = 0.00001;</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELPOPULATION =</span> <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1-c2#1*0];</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>),</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODEL =</span> <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1-c2#1*0](par1-par2);</span></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (par11);</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a><span class="st">      f by u11* u12 u13 u14-u15 (p1-p5)</span></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a><span class="st">           u21 u22 u23 u24 u25 (p1-p5);</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a><span class="st">      f@1;</span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a><span class="st">      [f@0];</span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:</span></span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>),</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELCONSTRAINT =</span></span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="fl">1.385</span>) {</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.80 trans12*.20 trans21*.5 trans22*.5</span></span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.65 prob22*.35);</span></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>             <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">85</span>) {</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.70 trans12*.30 trans21*.5 trans22*.5</span></span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.60 prob22*.4);</span></span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>  <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">41</span>) {</span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.60 trans12*.40 trans21*.5 trans22*.5</span></span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.55 prob22*.45);</span></span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a>             <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span>.<span class="dv">41</span>) {</span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.40 trans12*.60 trans21*.5 trans22*.5</span></span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.45 prob22*.55);</span></span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb20-137"><a href="#cb20-137" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb20-138"><a href="#cb20-138" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb20-139"><a href="#cb20-139" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb20-140"><a href="#cb20-140" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb20-141"><a href="#cb20-141" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb20-142"><a href="#cb20-142" aria-hidden="true" tabindex="-1"></a>             <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span>.<span class="dv">85</span>) {</span>
<span id="cb20-143"><a href="#cb20-143" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb20-144"><a href="#cb20-144" aria-hidden="true" tabindex="-1"></a><span class="st">        New(</span></span>
<span id="cb20-145"><a href="#cb20-145" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.30 trans12*.70 trans21*.5 trans22*.5</span></span>
<span id="cb20-146"><a href="#cb20-146" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.40 prob22*.60);</span></span>
<span id="cb20-147"><a href="#cb20-147" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb20-149"><a href="#cb20-149" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb20-150"><a href="#cb20-150" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb20-151"><a href="#cb20-151" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb20-152"><a href="#cb20-152" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb20-153"><a href="#cb20-153" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb20-154"><a href="#cb20-154" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb20-155"><a href="#cb20-155" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;</span></span>
<span id="cb20-156"><a href="#cb20-156" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span>)</span>
<span id="cb20-157"><a href="#cb20-157" aria-hidden="true" tabindex="-1"></a>              } </span>
<span id="cb20-158"><a href="#cb20-158" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb20-159"><a href="#cb20-159" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="sc">-</span><span class="fl">1.385</span>) {</span>
<span id="cb20-160"><a href="#cb20-160" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb20-161"><a href="#cb20-161" aria-hidden="true" tabindex="-1"></a><span class="st">         New(</span></span>
<span id="cb20-162"><a href="#cb20-162" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.20 trans12*.80 trans21*.5 trans22*.5</span></span>
<span id="cb20-163"><a href="#cb20-163" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11*.5 prob12*.5 prob21*.35 prob22*.65);</span></span>
<span id="cb20-164"><a href="#cb20-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-165"><a href="#cb20-165" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb20-166"><a href="#cb20-166" aria-hidden="true" tabindex="-1"></a><span class="st">        trans12 = 1-trans11;</span></span>
<span id="cb20-167"><a href="#cb20-167" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb20-168"><a href="#cb20-168" aria-hidden="true" tabindex="-1"></a><span class="st">        trans22 = 1- trans21;</span></span>
<span id="cb20-169"><a href="#cb20-169" aria-hidden="true" tabindex="-1"></a><span class="st">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb20-170"><a href="#cb20-170" aria-hidden="true" tabindex="-1"></a><span class="st">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb20-171"><a href="#cb20-171" aria-hidden="true" tabindex="-1"></a><span class="st">        prob12 = 1 - prob11;</span></span>
<span id="cb20-172"><a href="#cb20-172" aria-hidden="true" tabindex="-1"></a><span class="st">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb20-173"><a href="#cb20-173" aria-hidden="true" tabindex="-1"></a><span class="st">        prob22 = 1- prob21;"</span>)</span>
<span id="cb20-174"><a href="#cb20-174" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb20-175"><a href="#cb20-175" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-176"><a href="#cb20-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-177"><a href="#cb20-177" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run the Mplus model using MplusAutomation</span></span>
<span id="cb20-178"><a href="#cb20-178" aria-hidden="true" tabindex="-1"></a>  LTA_RILTA_Model <span class="ot">&lt;-</span> <span class="fu">mplusModeler</span>(LTA_RILTA,</span>
<span id="cb20-179"><a href="#cb20-179" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">dataout =</span> <span class="fu">here</span>(<span class="st">"2 2T LTA GEN RILTA ANALYZED_REP"</span>, <span class="fu">glue</span>(<span class="st">"LTA_RILTA_N_{N_numeric}_TP_{TPs}_TH_1_WD.dat"</span>)),</span>
<span id="cb20-180"><a href="#cb20-180" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">modelout =</span> <span class="fu">here</span>(<span class="st">"2 2T LTA GEN RILTA ANALYZED_REP"</span>, <span class="fu">glue</span>(<span class="st">"LTA_RILTA_N_{N_numeric}_TP_{TPs}_TH_1_WD.inp"</span>)),</span>
<span id="cb20-181"><a href="#cb20-181" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">run =</span> <span class="dv">1</span>, <span class="at">check =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-182"><a href="#cb20-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LTA_RILTA_Model)</span>
<span id="cb20-183"><a href="#cb20-183" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-184"><a href="#cb20-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-185"><a href="#cb20-185" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb20-186"><a href="#cb20-186" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the cluster</span></span>
<span id="cb20-187"><a href="#cb20-187" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb20-188"><a href="#cb20-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-189"><a href="#cb20-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Select the cluster type based on the system (PSOCK for Windows, FORK for macOS/Linux)</span></span>
<span id="cb20-190"><a href="#cb20-190" aria-hidden="true" tabindex="-1"></a>cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>)</span>
<span id="cb20-191"><a href="#cb20-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-192"><a href="#cb20-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-193"><a href="#cb20-193" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)</span>
<span id="cb20-194"><a href="#cb20-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-195"><a href="#cb20-195" aria-hidden="true" tabindex="-1"></a><span class="co"># Export necessary objects to the cluster</span></span>
<span id="cb20-196"><a href="#cb20-196" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"lta_rilta_func"</span>, <span class="st">"violation_summary"</span>, <span class="st">"here"</span>, <span class="st">"glue"</span>, <span class="st">"mplusModeler"</span>, <span class="st">"mplusObject"</span>))</span>
<span id="cb20-197"><a href="#cb20-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-198"><a href="#cb20-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure required libraries are loaded on each node</span></span>
<span id="cb20-199"><a href="#cb20-199" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb20-200"><a href="#cb20-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MplusAutomation)</span>
<span id="cb20-201"><a href="#cb20-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb20-202"><a href="#cb20-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb20-203"><a href="#cb20-203" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-204"><a href="#cb20-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-205"><a href="#cb20-205" aria-hidden="true" tabindex="-1"></a>result_list <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(violation_summary), <span class="cf">function</span>(i) {</span>
<span id="cb20-206"><a href="#cb20-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lta_rilta_func</span>(</span>
<span id="cb20-207"><a href="#cb20-207" aria-hidden="true" tabindex="-1"></a>    violation_summary<span class="sc">$</span>N_numeric[i], </span>
<span id="cb20-208"><a href="#cb20-208" aria-hidden="true" tabindex="-1"></a>    violation_summary<span class="sc">$</span>TPs[i],  </span>
<span id="cb20-209"><a href="#cb20-209" aria-hidden="true" tabindex="-1"></a>    violation_summary<span class="sc">$</span>Replications_Needed[i]</span>
<span id="cb20-210"><a href="#cb20-210" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-211"><a href="#cb20-211" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-212"><a href="#cb20-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-213"><a href="#cb20-213" aria-hidden="true" tabindex="-1"></a><span class="co"># Stop the cluster after the simulation</span></span>
<span id="cb20-214"><a href="#cb20-214" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="check-for-label-switching-and-errors---part-2" class="level2">
<h2 class="anchored" data-anchor-id="check-for-label-switching-and-errors---part-2">Check for Label Switching and Errors - Part 2</h2>
<blockquote class="blockquote">
<p>In this section: we re conduct the steps for aggregating the label switching and errors to guarantee that we will have at minimum 500 replications per condition.</p>
</blockquote>
<hr>
<p><em>Load all CSV files and combine them into a single data frame.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct CSV directory</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>csv_directory <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'2_2T_LTA_GEN_RILTA_ANALYZED_REP'</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'data_scraping.R'</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate combine_data in global environment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Extract data from the appropriate rows from each 9-row chunk and prepare the data for further processing.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Process the data using the child script</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step2_2t_RILTA.R'</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Will will populate final_combined data in global environment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Convert the logits to probabilities and add the known actual values to each row.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3 and 4: Process the data and return results</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step_3.R'</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The objects `final_data_with_actuals` and `violators` should now be in the global environment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Scrape output files for errors</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct output directory for .out files</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>output_folder <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'2_2T_LTA_GEN_RILTA_ANALYZED_REP'</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document that processes .out files</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'out_scraping.R'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Create Visual Summary of Errors per Condition</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>replication_summary_table <span class="ot">&lt;-</span> replication_summary <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Replication Summary"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Folder: "</span>, output_folder)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ErrorRate"</span>),  <span class="co"># Use the actual column name, ensure it matches your dataframe</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">FileName =</span> <span class="st">"File Name"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">CompletedReplications =</span> <span class="st">"Completed Replications"</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">RequestedReplications =</span> <span class="st">"Requested Replications"</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorReplications =</span> <span class="st">"Replications with Errors"</span>,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> <span class="st">"Good Replications"</span>,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> <span class="st">"Error Rate (%)"</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()  <span class="co"># This aligns all columns' text to center</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">80</span>)  <span class="co"># Adjust this percentage to reduce the width of the table</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>replication_summary_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="hqflxhqdpb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hqflxhqdpb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hqflxhqdpb thead, #hqflxhqdpb tbody, #hqflxhqdpb tfoot, #hqflxhqdpb tr, #hqflxhqdpb td, #hqflxhqdpb th {
  border-style: none;
}

#hqflxhqdpb p {
  margin: 0;
  padding: 0;
}

#hqflxhqdpb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 80%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hqflxhqdpb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hqflxhqdpb .gt_title {
  color: #333333;
  font-size: medium;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hqflxhqdpb .gt_subtitle {
  color: #333333;
  font-size: small;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hqflxhqdpb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hqflxhqdpb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hqflxhqdpb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hqflxhqdpb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hqflxhqdpb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hqflxhqdpb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hqflxhqdpb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hqflxhqdpb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hqflxhqdpb .gt_spanner_row {
  border-bottom-style: hidden;
}

#hqflxhqdpb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hqflxhqdpb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hqflxhqdpb .gt_from_md > :first-child {
  margin-top: 0;
}

#hqflxhqdpb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hqflxhqdpb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hqflxhqdpb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hqflxhqdpb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hqflxhqdpb .gt_row_group_first td {
  border-top-width: 2px;
}

#hqflxhqdpb .gt_row_group_first th {
  border-top-width: 2px;
}

#hqflxhqdpb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hqflxhqdpb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hqflxhqdpb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hqflxhqdpb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hqflxhqdpb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hqflxhqdpb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hqflxhqdpb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hqflxhqdpb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hqflxhqdpb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hqflxhqdpb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hqflxhqdpb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hqflxhqdpb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hqflxhqdpb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hqflxhqdpb .gt_left {
  text-align: left;
}

#hqflxhqdpb .gt_center {
  text-align: center;
}

#hqflxhqdpb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hqflxhqdpb .gt_font_normal {
  font-weight: normal;
}

#hqflxhqdpb .gt_font_bold {
  font-weight: bold;
}

#hqflxhqdpb .gt_font_italic {
  font-style: italic;
}

#hqflxhqdpb .gt_super {
  font-size: 65%;
}

#hqflxhqdpb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hqflxhqdpb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hqflxhqdpb .gt_indent_1 {
  text-indent: 5px;
}

#hqflxhqdpb .gt_indent_2 {
  text-indent: 10px;
}

#hqflxhqdpb .gt_indent_3 {
  text-indent: 15px;
}

#hqflxhqdpb .gt_indent_4 {
  text-indent: 20px;
}

#hqflxhqdpb .gt_indent_5 {
  text-indent: 25px;
}

#hqflxhqdpb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hqflxhqdpb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="6" class="gt_heading gt_title gt_font_normal">Replication Summary</th>
</tr>
<tr class="odd gt_heading">
<th colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Folder: /Users/brucecarter/Library/CloudStorage/Box-Box/RILTAS/RILTA_SIMULATION_STUDY/Simulations/STUDY_1/2 Time Points/2_2T_LTA_GEN_RILTA_ANALYZED_REP</th>
</tr>
<tr class="header gt_col_headings">
<th id="FileName" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">File Name</th>
<th id="RequestedReplications" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Requested Replications</th>
<th id="CompletedReplications" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Completed Replications</th>
<th id="ErrorReplications" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Replications with Errors</th>
<th id="GoodReplications" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Good Replications</th>
<th id="ErrorRate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Error Rate (%)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_-0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">894</td>
<td class="gt_row gt_center" headers="CompletedReplications">894</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">894</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_-0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">892</td>
<td class="gt_row gt_center" headers="CompletedReplications">892</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">892</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_-1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">845</td>
<td class="gt_row gt_center" headers="CompletedReplications">845</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">845</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">809</td>
<td class="gt_row gt_center" headers="CompletedReplications">809</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">809</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">797</td>
<td class="gt_row gt_center" headers="CompletedReplications">797</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">797</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_1000_tp_1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">789</td>
<td class="gt_row gt_center" headers="CompletedReplications">789</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">789</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_-0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">894</td>
<td class="gt_row gt_center" headers="CompletedReplications">894</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">894</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_-0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">886</td>
<td class="gt_row gt_center" headers="CompletedReplications">886</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">886</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_-1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">940</td>
<td class="gt_row gt_center" headers="CompletedReplications">940</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">940</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">868</td>
<td class="gt_row gt_center" headers="CompletedReplications">868</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">868</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">794</td>
<td class="gt_row gt_center" headers="CompletedReplications">794</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">794</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_2000_tp_1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">822</td>
<td class="gt_row gt_center" headers="CompletedReplications">822</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">822</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_-0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">886</td>
<td class="gt_row gt_center" headers="CompletedReplications">886</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">886</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_-0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">943</td>
<td class="gt_row gt_center" headers="CompletedReplications">943</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">943</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_-1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">937</td>
<td class="gt_row gt_center" headers="CompletedReplications">937</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">937</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">863</td>
<td class="gt_row gt_center" headers="CompletedReplications">863</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">863</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">822</td>
<td class="gt_row gt_center" headers="CompletedReplications">822</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">822</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_4000_tp_1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">794</td>
<td class="gt_row gt_center" headers="CompletedReplications">794</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">794</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_-0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">804</td>
<td class="gt_row gt_center" headers="CompletedReplications">804</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">804</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_-0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">840</td>
<td class="gt_row gt_center" headers="CompletedReplications">840</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">840</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_-1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">845</td>
<td class="gt_row gt_center" headers="CompletedReplications">845</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">845</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_0.41_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">817</td>
<td class="gt_row gt_center" headers="CompletedReplications">817</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">817</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_0.85_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">842</td>
<td class="gt_row gt_center" headers="CompletedReplications">842</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">842</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="FileName">lta_rilta_n_500_tp_1.385_th_1_wd</td>
<td class="gt_row gt_center" headers="RequestedReplications">794</td>
<td class="gt_row gt_center" headers="CompletedReplications">794</td>
<td class="gt_row gt_center" headers="ErrorReplications">0</td>
<td class="gt_row gt_center" headers="GoodReplications">794</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compare rows in both .csv and .out data frames</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_data_with_actuals:"</span>, <span class="fu">nrow</span>(final_data_with_actuals), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows in final_data_with_actuals: 20417 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the final number of rows to confirm data handling</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows in error_summary: "</span>, <span class="fu">nrow</span>(error_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows in error_summary:  20417 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows in replication_summary: "</span>, <span class="fu">nrow</span>(replication_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows in replication_summary:  24 </code></pre>
</div>
</div>
<p><em>Merge Errors with Main Data</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Process the data using the child script</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'merge_errors.R'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Create Column Names from the File Name</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns based on the information in the FileName and set factors</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the sample size (N) from the FileName with the correct values</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_4000"</span>, FileName) <span class="sc">~</span> <span class="dv">4</span>,  <span class="co"># Correct value for N_4000</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_500"</span>, FileName) <span class="sc">~</span> <span class="dv">1</span>,   </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_1000"</span>, FileName) <span class="sc">~</span> <span class="dv">2</span>,  </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_2000"</span>, FileName) <span class="sc">~</span> <span class="dv">3</span>,  </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map the TPs from the FileName to the appropriate Population labels</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".800"</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".700"</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".600"</span>,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".400"</span>,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".300"</span>,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".200"</span>,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the Transitions variable based on Population values</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>) <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># Assign 1 for Population .200, .300, .400</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>) <span class="sc">~</span> <span class="dv">2</span>,  <span class="co"># Assign 2 for Population .600, .700, .800</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert columns to factors, ordering N_4000 first in the factor levels</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"N = 4000"</span>, <span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>)),</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".800"</span>, <span class="st">".700"</span>, <span class="st">".600"</span>, <span class="st">".400"</span>, <span class="st">".300"</span>, <span class="st">".200"</span>)),</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">factor</span>(Transitions, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mover"</span>, <span class="st">"Stayer"</span>))</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Calculate Violation Percentages per Condition</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Any_Violation =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Any_Violation), <span class="dv">0</span>, Any_Violation),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorFlag =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(ErrorFlag), <span class="dv">0</span>, ErrorFlag)  <span class="co"># No missing values for ErrorFlag</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName, Population, N) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> <span class="fu">n</span>(),                                <span class="co"># Total runs</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Violations =</span> <span class="fu">sum</span>(Any_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Sum of violations</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Errors =</span> <span class="fu">sum</span>(ErrorFlag, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),     <span class="co"># Sum of errors</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage_Violations =</span> (Total_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="co"># Percentage of violations</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(replication_summary <span class="sc">%&gt;%</span> <span class="fu">select</span>(FileName, CompletedReplications), <span class="at">by =</span> <span class="st">"FileName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">CompletedReplications =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(CompletedReplications), <span class="dv">500</span>, CompletedReplications),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, N)),</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> CompletedReplications <span class="sc">-</span> Total_Violations <span class="sc">-</span> Total_Errors,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> <span class="fu">ifelse</span>(GoodReplications <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, GoodReplications),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reanalysis_Needed =</span> <span class="fu">if_else</span>(GoodReplications <span class="sc">&gt;=</span> <span class="dv">500</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>),  <span class="co"># Flag for reanalysis needed</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> Total_Errors <span class="sc">/</span> Total_Rows,          <span class="co"># Calculate ErrorRate</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replications_Needed =</span> <span class="fu">ceiling</span>(CompletedReplications <span class="sc">+</span> Total_Violations <span class="sc">+</span> (CompletedReplications <span class="sc">*</span> Percentage_Violations <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="dv">20</span>),</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adjusted_Replications_Needed =</span> <span class="fu">ceiling</span>(Replications_Needed <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> ErrorRate))</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    FileName, Population, N, N_numeric, Total_Rows, Total_Violations,</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    Total_Errors, ErrorRate, Percentage_Violations, GoodReplications,</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>    Replications_Needed, Adjusted_Replications_Needed,</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>    Reanalysis_Needed</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Summarize &amp; Visualize Label Switching Percentage Results</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for rows with non-zero error rates and clean N_numeric</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the TPs assignment to force formatting</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">TPs =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="fl">1.385</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".700"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="fl">0.85</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".600"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="fl">0.41</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".400"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="sc">-</span><span class="fl">0.41</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".300"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="sc">-</span><span class="fl">0.85</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="sc">-</span><span class="fl">1.385</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, <span class="fu">as.character</span>(N)))  <span class="co"># Clean N_numeric by stripping out "N = "</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize and visualize the final table</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Transition Probability</span><span class="st">`</span> <span class="ot">=</span> Population,  <span class="co"># Rename column for clarity</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    TPs,  <span class="co"># Logit values</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    N_numeric,  <span class="co"># Cleaned sample size</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Mplus Runs</span><span class="st">`</span> <span class="ot">=</span> Total_Rows,  <span class="co"># Total runs</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    Total_Violations,  <span class="co"># Total violations</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">% of Violations</span><span class="st">`</span> <span class="ot">=</span> Percentage_Violations,  <span class="co"># Violation percentage</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    Total_Errors, </span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    ErrorRate,  <span class="co"># Error rate</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    Replications_Needed,  <span class="co"># Replications needed</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Adjusted Replications Needed</span><span class="st">`</span> <span class="ot">=</span> Adjusted_Replications_Needed,  <span class="co"># Adjusted replications needed</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    Reanalysis_Needed</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Monte Carlo Results:"</span>,</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Percentage of Cases with Label Switching and Replications Needed"</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,  <span class="co"># Center all columns</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">% of Violations</span><span class="st">`</span>, ErrorRate),</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span>  <span class="co"># Ensure these percentages are formatted to 2 decimal places</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">4</span>)  <span class="co"># Set padding between rows</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>),  <span class="co"># Center align the headers only</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">everything</span>())  <span class="co"># Apply to headers only</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>final_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="pbcvfwmkmb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pbcvfwmkmb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pbcvfwmkmb thead, #pbcvfwmkmb tbody, #pbcvfwmkmb tfoot, #pbcvfwmkmb tr, #pbcvfwmkmb td, #pbcvfwmkmb th {
  border-style: none;
}

#pbcvfwmkmb p {
  margin: 0;
  padding: 0;
}

#pbcvfwmkmb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pbcvfwmkmb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pbcvfwmkmb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pbcvfwmkmb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pbcvfwmkmb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pbcvfwmkmb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbcvfwmkmb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pbcvfwmkmb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pbcvfwmkmb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pbcvfwmkmb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pbcvfwmkmb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pbcvfwmkmb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pbcvfwmkmb .gt_spanner_row {
  border-bottom-style: hidden;
}

#pbcvfwmkmb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pbcvfwmkmb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pbcvfwmkmb .gt_from_md > :first-child {
  margin-top: 0;
}

#pbcvfwmkmb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pbcvfwmkmb .gt_row {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pbcvfwmkmb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pbcvfwmkmb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pbcvfwmkmb .gt_row_group_first td {
  border-top-width: 2px;
}

#pbcvfwmkmb .gt_row_group_first th {
  border-top-width: 2px;
}

#pbcvfwmkmb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbcvfwmkmb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pbcvfwmkmb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pbcvfwmkmb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbcvfwmkmb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbcvfwmkmb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pbcvfwmkmb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pbcvfwmkmb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pbcvfwmkmb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbcvfwmkmb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pbcvfwmkmb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbcvfwmkmb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pbcvfwmkmb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbcvfwmkmb .gt_left {
  text-align: left;
}

#pbcvfwmkmb .gt_center {
  text-align: center;
}

#pbcvfwmkmb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pbcvfwmkmb .gt_font_normal {
  font-weight: normal;
}

#pbcvfwmkmb .gt_font_bold {
  font-weight: bold;
}

#pbcvfwmkmb .gt_font_italic {
  font-style: italic;
}

#pbcvfwmkmb .gt_super {
  font-size: 65%;
}

#pbcvfwmkmb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pbcvfwmkmb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pbcvfwmkmb .gt_indent_1 {
  text-indent: 5px;
}

#pbcvfwmkmb .gt_indent_2 {
  text-indent: 10px;
}

#pbcvfwmkmb .gt_indent_3 {
  text-indent: 15px;
}

#pbcvfwmkmb .gt_indent_4 {
  text-indent: 20px;
}

#pbcvfwmkmb .gt_indent_5 {
  text-indent: 25px;
}

#pbcvfwmkmb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pbcvfwmkmb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="11" class="gt_heading gt_title gt_font_normal">Monte Carlo Results:</th>
</tr>
<tr class="odd gt_heading">
<th colspan="11" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Percentage of Cases with Label Switching and Replications Needed</th>
</tr>
<tr class="header gt_col_headings">
<th id="Transition-Probability" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Transition Probability</th>
<th id="TPs" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">TPs</th>
<th id="N_numeric" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">N_numeric</th>
<th id="Total-Mplus-Runs" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total Mplus Runs</th>
<th id="Total_Violations" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total_Violations</th>
<th id="a%-of-Violations" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">% of Violations</th>
<th id="Total_Errors" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total_Errors</th>
<th id="ErrorRate" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">ErrorRate</th>
<th id="Replications_Needed" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Replications_Needed</th>
<th id="Adjusted-Replications-Needed" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Adjusted Replications Needed</th>
<th id="Reanalysis_Needed" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Reanalysis_Needed</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.400</td>
<td class="gt_row gt_center" headers="TPs">-0.41</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">894</td>
<td class="gt_row gt_center" headers="Total_Violations">263</td>
<td class="gt_row gt_center" headers="% of Violations">29.42</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1440</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1440</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.300</td>
<td class="gt_row gt_center" headers="TPs">-0.85</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">892</td>
<td class="gt_row gt_center" headers="Total_Violations">277</td>
<td class="gt_row gt_center" headers="% of Violations">31.05</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1466</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1466</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">845</td>
<td class="gt_row gt_center" headers="Total_Violations">249</td>
<td class="gt_row gt_center" headers="% of Violations">29.47</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1363</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1363</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.600</td>
<td class="gt_row gt_center" headers="TPs">0.41</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">809</td>
<td class="gt_row gt_center" headers="Total_Violations">211</td>
<td class="gt_row gt_center" headers="% of Violations">26.08</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1251</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1251</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.700</td>
<td class="gt_row gt_center" headers="TPs">0.85</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">797</td>
<td class="gt_row gt_center" headers="Total_Violations">195</td>
<td class="gt_row gt_center" headers="% of Violations">24.47</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1207</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1207</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">789</td>
<td class="gt_row gt_center" headers="Total_Violations">179</td>
<td class="gt_row gt_center" headers="% of Violations">22.69</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1167</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1167</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.400</td>
<td class="gt_row gt_center" headers="TPs">-0.41</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">894</td>
<td class="gt_row gt_center" headers="Total_Violations">278</td>
<td class="gt_row gt_center" headers="% of Violations">31.10</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1470</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1470</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.300</td>
<td class="gt_row gt_center" headers="TPs">-0.85</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">886</td>
<td class="gt_row gt_center" headers="Total_Violations">274</td>
<td class="gt_row gt_center" headers="% of Violations">30.93</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1454</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1454</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">940</td>
<td class="gt_row gt_center" headers="Total_Violations">331</td>
<td class="gt_row gt_center" headers="% of Violations">35.21</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1622</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1622</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.600</td>
<td class="gt_row gt_center" headers="TPs">0.41</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">868</td>
<td class="gt_row gt_center" headers="Total_Violations">233</td>
<td class="gt_row gt_center" headers="% of Violations">26.84</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1354</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1354</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.700</td>
<td class="gt_row gt_center" headers="TPs">0.85</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">794</td>
<td class="gt_row gt_center" headers="Total_Violations">200</td>
<td class="gt_row gt_center" headers="% of Violations">25.19</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1214</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1214</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">822</td>
<td class="gt_row gt_center" headers="Total_Violations">202</td>
<td class="gt_row gt_center" headers="% of Violations">24.57</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1246</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1246</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.400</td>
<td class="gt_row gt_center" headers="TPs">-0.41</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">886</td>
<td class="gt_row gt_center" headers="Total_Violations">286</td>
<td class="gt_row gt_center" headers="% of Violations">32.28</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1478</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1478</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.300</td>
<td class="gt_row gt_center" headers="TPs">-0.85</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">943</td>
<td class="gt_row gt_center" headers="Total_Violations">342</td>
<td class="gt_row gt_center" headers="% of Violations">36.27</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1647</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1647</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">937</td>
<td class="gt_row gt_center" headers="Total_Violations">335</td>
<td class="gt_row gt_center" headers="% of Violations">35.75</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1627</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1627</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.600</td>
<td class="gt_row gt_center" headers="TPs">0.41</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">863</td>
<td class="gt_row gt_center" headers="Total_Violations">260</td>
<td class="gt_row gt_center" headers="% of Violations">30.13</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1403</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1403</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.700</td>
<td class="gt_row gt_center" headers="TPs">0.85</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">822</td>
<td class="gt_row gt_center" headers="Total_Violations">230</td>
<td class="gt_row gt_center" headers="% of Violations">27.98</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1302</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1302</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">4000</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">794</td>
<td class="gt_row gt_center" headers="Total_Violations">194</td>
<td class="gt_row gt_center" headers="% of Violations">24.43</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1202</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1202</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.400</td>
<td class="gt_row gt_center" headers="TPs">-0.41</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">804</td>
<td class="gt_row gt_center" headers="Total_Violations">201</td>
<td class="gt_row gt_center" headers="% of Violations">25.00</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1226</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1226</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.300</td>
<td class="gt_row gt_center" headers="TPs">-0.85</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">840</td>
<td class="gt_row gt_center" headers="Total_Violations">226</td>
<td class="gt_row gt_center" headers="% of Violations">26.90</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1312</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1312</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">845</td>
<td class="gt_row gt_center" headers="Total_Violations">248</td>
<td class="gt_row gt_center" headers="% of Violations">29.35</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1361</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1361</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.600</td>
<td class="gt_row gt_center" headers="TPs">0.41</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">817</td>
<td class="gt_row gt_center" headers="Total_Violations">209</td>
<td class="gt_row gt_center" headers="% of Violations">25.58</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1255</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1255</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.700</td>
<td class="gt_row gt_center" headers="TPs">0.85</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">842</td>
<td class="gt_row gt_center" headers="Total_Violations">231</td>
<td class="gt_row gt_center" headers="% of Violations">27.43</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1324</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1324</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">794</td>
<td class="gt_row gt_center" headers="Total_Violations">207</td>
<td class="gt_row gt_center" headers="% of Violations">26.07</td>
<td class="gt_row gt_center" headers="Total_Errors">0</td>
<td class="gt_row gt_center" headers="ErrorRate">0.00</td>
<td class="gt_row gt_center" headers="Replications_Needed">1228</td>
<td class="gt_row gt_center" headers="Adjusted Replications Needed">1228</td>
<td class="gt_row gt_center" headers="Reanalysis_Needed">No</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
</section>
<section id="final-data-preparation" class="level1">
<h1>Final Data Preparation</h1>
<hr>
<section id="filter-cases-with-violations-and-errors" class="level2">
<h2 class="anchored" data-anchor-id="filter-cases-with-violations-and-errors">Filter Cases with Violations and Errors</h2>
<p><em>Filter out cases with any violations, leaving only the clean data.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out cases with no violations and no errors</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>filtered_data_with_no_violations <span class="ot">&lt;-</span> final_data_with_actuals[</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  final_data_with_actuals<span class="sc">$</span>Any_Violation <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> final_data_with_actuals<span class="sc">$</span>ErrorFlag <span class="sc">==</span> <span class="dv">0</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="randomly-sample-500-replications" class="level3">
<h3 class="anchored" data-anchor-id="randomly-sample-500-replications">Randomly Sample 500 Replications</h3>
<p><em>Take random sample of replications to achieve n = 500</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">07252005</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check initial counts to ensure each FileName group has at least 500 rows</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>initial_counts <span class="ot">&lt;-</span> filtered_data_with_no_violations <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Initial_Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()  <span class="co"># Remove any NA values quietly within the pipeline</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify groups with insufficient rows</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>insufficient_groups <span class="ot">&lt;-</span> initial_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Initial_Count <span class="sc">&lt;</span> <span class="dv">500</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle based on whether insufficient groups exist</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(insufficient_groups) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Message to indicate successful operation</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"All FileName groups had at least 500 rows.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Proceed with sampling</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  sampled_data <span class="ot">&lt;-</span> filtered_data_with_no_violations <span class="sc">%&gt;%</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(FileName) <span class="sc">%&gt;%</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="dv">500</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print confirmation that sampling was successful</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sampling completed successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the groups that don't meet the requirement</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Some FileName groups do not have at least 500 rows. Sampling not performed.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Groups with insufficient rows:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(insufficient_groups)</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>All FileName groups had at least 500 rows.
Sampling completed successfully.</code></pre>
</div>
</div>
<hr>
</section>
<section id="calculate-monte-carlo-values" class="level3">
<h3 class="anchored" data-anchor-id="calculate-monte-carlo-values">Calculate Monte Carlo Values</h3>
<p><em>Calculate Monte Carlo values for&nbsp;<code>TRANS11</code>, including population values, averages, standard errors, Mean Squared Error (MSE), coverage, and power</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Monte Carlo Values</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'compute_mc.R'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculate-bias-and-dichotomous-variables" class="level3">
<h3 class="anchored" data-anchor-id="calculate-bias-and-dichotomous-variables">Calculate Bias and Dichotomous Variables</h3>
<p><em>Calculate dichotomous variables for Power and Coverage, compute Parameter and SE Bias, and prepare subsets for movers and stayers.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Calculate dichotomous variable for Power (1 if Power &gt;= 0.8, else 0)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Power_Dic =</span> <span class="fu">ifelse</span>(Power <span class="sc">&gt;=</span> <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Calculate dichotomous variable for Coverage (0 if outside [0.91, 0.98], else 1)</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Coverage_Dic =</span> <span class="fu">ifelse</span>(Coverage <span class="sc">&gt;</span> <span class="fl">0.98</span> <span class="sc">|</span> Coverage <span class="sc">&lt;</span> <span class="fl">0.91</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Remove any groupings before further calculations</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Ensure numeric columns are correctly formatted and **convert Population only for calculations**</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep average as numeric but **do not convert Population for display purposes**</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">average =</span> <span class="fu">as.numeric</span>(average),</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_numeric =</span> <span class="fu">as.numeric</span>(Population),  <span class="co"># Create a temporary numeric version of Population</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">average_se =</span> <span class="fu">as.numeric</span>(average_SE),</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_sd =</span> <span class="fu">as.numeric</span>(population_sd)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Calculate Parameter Bias and SE Bias, rounding the results to 2 decimal places</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use population_numeric for the calculations, but **retain Population in the original format**</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Parameter_Bias =</span> (average <span class="sc">-</span> population_numeric) <span class="sc">/</span> population_numeric <span class="sc">*</span> <span class="dv">100</span>,  <span class="co"># Bias for the parameter</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_Bias =</span> (average_se <span class="sc">-</span> population_sd) <span class="sc">/</span> population_sd <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Bias for the standard error</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Parameter_Bias, SE_Bias), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">2</span>)))  <span class="co"># Round to 2 decimal places</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the temporary numeric population column if no longer needed</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>population_numeric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="prepare-data-for-visualization" class="level2">
<h2 class="anchored" data-anchor-id="prepare-data-for-visualization">Prepare Data for Visualization</h2>
<section id="subset-data-for-bias-plots" class="level3">
<h3 class="anchored" data-anchor-id="subset-data-for-bias-plots">Subset Data for Bias Plots</h3>
<p><em>Subset the Monte Carlo data into mover transition probabilities (.2, .3, .4) and stayer transition probabilities (.6, .7, .8) based on population values</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming Population is numeric in all_data</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> mc_values</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that the Population_Label uses numeric levels without leading zeros but assigns expression-based labels</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>Population_Label <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_data<span class="sc">$</span>Population, </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>),  <span class="co"># Numeric levels without leading zeros</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .200"</span>),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .300"</span>),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .400"</span>),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .600"</span>),</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .700"</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .800"</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset for Transitions movers (already correctly defined as "Mover")</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>subset_mover <span class="ot">&lt;-</span> <span class="fu">subset</span>(all_data, Transitions <span class="sc">==</span> <span class="st">"Mover"</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset for Transitions stayers (already correctly defined as "Stayer")</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>subset_stayer <span class="ot">&lt;-</span> <span class="fu">subset</span>(all_data, Transitions <span class="sc">==</span> <span class="st">"Stayer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prepare-function-for-bias-plots" class="level3">
<h3 class="anchored" data-anchor-id="prepare-function-for-bias-plots">Prepare Function for Bias Plots</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>create_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title_suffix) {</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Common theme for the plots</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  common_theme <span class="ot">&lt;-</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">10</span>),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Detect which legend items to show</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span>, <span class="st">"Standard Error Bias"</span>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(data<span class="sc">$</span>Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>)) present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(present_categories, <span class="st">"Coverage Failure"</span>)</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(data<span class="sc">$</span>Power_Dic <span class="sc">==</span> <span class="dv">0</span>)) present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(present_categories, <span class="st">"Power Failure"</span>)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define colors and shapes for different categories</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span> <span class="ot">=</span> <span class="st">"#7030A0"</span>, <span class="st">"Standard Error Bias"</span> <span class="ot">=</span> <span class="st">"#C830CC"</span>, </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Coverage Failure"</span> <span class="ot">=</span> <span class="st">"#7030A0"</span>, <span class="st">"Power Failure"</span> <span class="ot">=</span> <span class="st">"black"</span>)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"Standard Error Bias"</span> <span class="ot">=</span> <span class="dv">18</span>, </span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Coverage Failure"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Power Failure"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter colors and shapes based on detected categories</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  filtered_colors <span class="ot">&lt;-</span> colors[present_categories]</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  filtered_shapes <span class="ot">&lt;-</span> shapes[present_categories]</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(N))) <span class="sc">+</span>  </span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Parameter Bias"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span>  </span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> SE_Bias, <span class="at">color =</span> <span class="st">"Standard Error Bias"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span>  </span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Parameter Bias"</span>), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">fill =</span> <span class="st">"#7030A0"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> SE_Bias, <span class="at">color =</span> <span class="st">"Standard Error Bias"</span>), <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">fill =</span> <span class="st">"#C830CC"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Coverage Failure"</span>), <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"#7030A0"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Power_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Power Failure"</span>), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Coverage Failure"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Power_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Power Failure"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> filtered_colors, </span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> present_categories, </span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> present_categories,</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> filtered_shapes)</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span>  </span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Bias (%)"</span>,</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"LTA Generated, RILTA Analyzed with"</span>, title_suffix, <span class="st">"Transition Probabilities"</span>)</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>, <span class="dv">30</span>)) <span class="sc">+</span>  </span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">as.character</span>(Population_Label), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span>  </span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 500"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 1000"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 2000"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 4000"</span>))) <span class="sc">+</span>  </span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">30</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span>  </span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>    common_theme <span class="sc">+</span></span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#7030A0"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  </span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#C830CC"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"outside"</span>, </span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="render-bias-figures" class="level3">
<h3 class="anchored" data-anchor-id="render-bias-figures">Render Bias Figures</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and print plot for Mover</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>plot_mover <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(subset_mover, <span class="st">"Mover"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-format: svg</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_mover)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Study_1_2T_LTA_RILTA_files/figure-html/plot-movers-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove title for the saved version</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>plot_mover_no_title <span class="ot">&lt;-</span> plot_mover <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Mover plot without title as .svg</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zFIGURES"</span>, <span class="st">"x2t_lta_rilta_plots"</span>, <span class="st">"plot_mover.svg"</span>), <span class="at">plot =</span> plot_mover_no_title, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> <span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and print plot for Stayer</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>plot_stayer <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(subset_stayer, <span class="st">"Stayer"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-format: svg</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_stayer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Study_1_2T_LTA_RILTA_files/figure-html/plot-stayers-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove title for the saved version</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>plot_stayer_no_title <span class="ot">&lt;-</span> plot_stayer <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Stayer plot without title as .svg</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zFIGURES"</span>, <span class="st">"x2t_lta_rilta_plots"</span>, <span class="st">"plot_stayer.svg"</span>), <span class="at">plot =</span> plot_stayer_no_title, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> <span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="prepare-data-for-heat-maps" class="level2">
<h2 class="anchored" data-anchor-id="prepare-data-for-heat-maps"><strong>Prepare Data for Heat Maps</strong></h2>
<p><em>Prepare data for heat map creation by ensuring correct formatting for population values, and subsetting the data based on class proportions and sample sizes.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Separate the movers and stayers and ensure sorting by N and Population for each transition</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>movers <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Transitions <span class="sc">==</span> <span class="st">"Mover"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, N)), Population)  <span class="co"># Sort movers by numeric N and Population</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>stayers <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Transitions <span class="sc">==</span> <span class="st">"Stayer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, N)), Population)  <span class="co"># Sort stayers by numeric N and Population</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Assign N_Label only once for each N within Movers and Stayers</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>movers <span class="ot">&lt;-</span> movers <span class="sc">%&gt;%</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(N) <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_Label =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">2</span>, <span class="fu">as.character</span>(N), <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>stayers <span class="ot">&lt;-</span> stayers <span class="sc">%&gt;%</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(N) <span class="sc">%&gt;%</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_Label =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">2</span>, <span class="fu">as.character</span>(N), <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Combine movers and stayers back into one dataset, keeping them separate by transitions</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>all_data_sorted <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(movers, stayers)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Select necessary columns for the final display</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>test_map <span class="ot">&lt;-</span> <span class="fu">select</span>(all_data_sorted, N_Label, Population, average, Coverage, Power, Parameter_Bias, SE_Bias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="prepare-function-for-heat-map-creation" class="level3">
<h3 class="anchored" data-anchor-id="prepare-function-for-heat-map-creation">Prepare Function for Heat Map Creation</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create gt table based on subset data</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>create_gt_table <span class="ot">&lt;-</span> <span class="cf">function</span>(subset, transition_probability) {</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the gt object and set initial formatting</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  gt_table <span class="ot">&lt;-</span> subset <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opt_table_font</span>(<span class="at">stack =</span> <span class="st">"geometric-humanist"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"LTA Generated &amp; LTA Analyzed with Transition Probability of"</span>, transition_probability)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_Label =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">average =</span> <span class="st">"Estimated&lt;br&gt;Probability"</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">Coverage =</span> <span class="st">"Coverage"</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">Power =</span> <span class="st">"Power"</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter_Bias =</span> <span class="st">"Parameter &lt;br&gt;Bias"</span>,</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE_Bias =</span> <span class="st">"Standard Error&lt;br&gt;Bias"</span>,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fn =</span> md</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Bias"</span>,</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Parameter_Bias"</span>, <span class="st">"SE_Bias"</span>)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Stayer Probabilities"</span>,  <span class="co"># Label for the first subgroup</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>)  <span class="co"># Rows corresponding to the first subgroup</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Mover Probabilities"</span>,  <span class="co"># Label for the second subgroup</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)  <span class="co"># Rows corresponding to the second subgroup</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">font =</span> <span class="st">"bold italic"</span>  <span class="co"># Apply bold and italic styling</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_row_groups</span>()  <span class="co"># Apply style to row subheaders</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Parameter_Bias"</span>, <span class="st">"SE_Bias"</span>), <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">3</span>, <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_options</span>(</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.hlines.color =</span> <span class="st">"white"</span>,</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_group.border.bottom.color =</span> <span class="st">"black"</span> ,</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_group.border.top.color =</span> <span class="st">"black"</span> </span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"center"</span>),</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Apply color highlighting for violations in Parameter Bias</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span>(subset<span class="sc">$</span>Parameter_Bias <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">9.99</span> <span class="sc">&amp;</span> subset<span class="sc">$</span>Parameter_Bias <span class="sc">&lt;=</span> <span class="fl">9.99</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Parameter_Bias"</span>,</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> .data<span class="sc">$</span>Parameter_Bias <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">9.99</span> <span class="sc">|</span> .data<span class="sc">$</span>Parameter_Bias <span class="sc">&gt;</span> <span class="fl">9.99</span>,  <span class="co"># Apply color only if outside the threshold</span></span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#113386"</span>, <span class="st">"#DAE3FA"</span>, <span class="st">"#113386"</span>),  <span class="co"># Darker blue for larger deviations</span></span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>)  <span class="co"># Adjust the domain to reflect the range of values</span></span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Darker blue indicates larger deviations from zero *Parameter Bias* beyond the Â±9.99 threshold."</span>),</span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Parameter_Bias"</span>)</span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply color highlighting for violations in SE Bias</span></span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span>(subset<span class="sc">$</span>SE_Bias <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">4.99</span> <span class="sc">&amp;</span> subset<span class="sc">$</span>SE_Bias <span class="sc">&lt;=</span> <span class="fl">4.99</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"SE_Bias"</span>,</span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> .data<span class="sc">$</span>SE_Bias <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">4.99</span> <span class="sc">|</span> .data<span class="sc">$</span>SE_Bias <span class="sc">&gt;</span> <span class="fl">4.99</span>,  <span class="co"># Apply color only if outside the threshold</span></span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#B4186E"</span>, <span class="st">"#F9D5E9"</span>, <span class="st">"#B4186E"</span>),  <span class="co"># Darker red for larger deviations</span></span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>, <span class="dv">80</span>)  <span class="co"># Adjust the domain for the SE_Bias range</span></span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Darker red indicates larger deviations from zero *Standard Error Bias* beyond the Â±4.99 threshold."</span>),</span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"SE_Bias"</span>)</span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(subset<span class="sc">$</span>Coverage <span class="sc">&lt;</span> <span class="fl">0.93</span> <span class="sc">|</span> subset<span class="sc">$</span>Coverage <span class="sc">&gt;</span> <span class="fl">0.979</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Coverage"</span>,</span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> subset<span class="sc">$</span>Coverage <span class="sc">&lt;</span> <span class="fl">0.93</span> <span class="sc">|</span> subset<span class="sc">$</span>Coverage <span class="sc">&gt;</span> <span class="fl">0.979</span>,</span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#93C6B1"</span>, <span class="st">"white"</span>),  <span class="co"># Green for coverage issues</span></span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Green indicates failure to achieve adequate *Coverage*."</span>),</span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Coverage"</span>)</span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(subset<span class="sc">$</span>Power <span class="sc">&lt;</span> <span class="fl">0.8</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb48-104"><a href="#cb48-104" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb48-105"><a href="#cb48-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Power"</span>,</span>
<span id="cb48-106"><a href="#cb48-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> subset<span class="sc">$</span>Power <span class="sc">&lt;</span> <span class="fl">0.8</span>,</span>
<span id="cb48-107"><a href="#cb48-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb48-108"><a href="#cb48-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#502CD1"</span>, <span class="st">"white"</span>),  <span class="co"># Purple for power issues</span></span>
<span id="cb48-109"><a href="#cb48-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb48-110"><a href="#cb48-110" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb48-111"><a href="#cb48-111" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb48-112"><a href="#cb48-112" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Purple indicates failure to achieve adequate *Power*."</span>),</span>
<span id="cb48-113"><a href="#cb48-113" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Power"</span>)</span>
<span id="cb48-114"><a href="#cb48-114" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb48-115"><a href="#cb48-115" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-116"><a href="#cb48-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-117"><a href="#cb48-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(gt_table)</span>
<span id="cb48-118"><a href="#cb48-118" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="render-heat-map" class="level3">
<h3 class="anchored" data-anchor-id="render-heat-map">Render Heat Map</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "render-heatmap"</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>gt_table <span class="ot">&lt;-</span> <span class="fu">create_gt_table</span>(test_map, <span class="st">".200 &amp; .800"</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Further operations on gt_table</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>gt_table <span class="sc">|&gt;</span> </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">75</span>)) <span class="sc">|&gt;</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gtsave</span>(<span class="fu">here</span>(<span class="st">"2 Time Points"</span>, <span class="st">"zHEATMAPS"</span>, <span class="st">"z2t_heatmaps"</span>, <span class="st">"z2t_heatmaps"</span>, <span class="st">"2T_L_R.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in file(con, "wb"): cannot open file
'/Users/brucecarter/Library/CloudStorage/Box-Box/RILTAS/RILTA_SIMULATION_STUDY/2
Time Points/zHEATMAPS/z2t_heatmaps/z2t_heatmaps/2T_L_R.png': No such file or
directory</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in callback(...): An error occurred: Error in file(con, "wb"): cannot open the connection</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>file:////var/folders/kc/rvq95x857cl2gyvg8pdl2t680000gn/T//RtmpH0MiC1/file16e3cc8d96ed.html screenshot completed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in normalizePath(value): path[1]="An error occurred: Error in file(con, "wb"): cannot open the connection
": No such file or directory</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>gt_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="uaujoeuful" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uaujoeuful table {
  font-family: Avenir, Montserrat, Corbel, 'URW Gothic', source-sans-pro, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uaujoeuful thead, #uaujoeuful tbody, #uaujoeuful tfoot, #uaujoeuful tr, #uaujoeuful td, #uaujoeuful th {
  border-style: none;
}

#uaujoeuful p {
  margin: 0;
  padding: 0;
}

#uaujoeuful .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uaujoeuful .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uaujoeuful .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uaujoeuful .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uaujoeuful .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uaujoeuful .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#uaujoeuful .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uaujoeuful .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uaujoeuful .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uaujoeuful .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uaujoeuful .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uaujoeuful .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uaujoeuful .gt_spanner_row {
  border-bottom-style: hidden;
}

#uaujoeuful .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uaujoeuful .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: middle;
}

#uaujoeuful .gt_from_md > :first-child {
  margin-top: 0;
}

#uaujoeuful .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uaujoeuful .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uaujoeuful .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uaujoeuful .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uaujoeuful .gt_row_group_first td {
  border-top-width: 2px;
}

#uaujoeuful .gt_row_group_first th {
  border-top-width: 2px;
}

#uaujoeuful .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uaujoeuful .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uaujoeuful .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uaujoeuful .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uaujoeuful .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uaujoeuful .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uaujoeuful .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uaujoeuful .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uaujoeuful .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#uaujoeuful .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uaujoeuful .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uaujoeuful .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uaujoeuful .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uaujoeuful .gt_left {
  text-align: left;
}

#uaujoeuful .gt_center {
  text-align: center;
}

#uaujoeuful .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uaujoeuful .gt_font_normal {
  font-weight: normal;
}

#uaujoeuful .gt_font_bold {
  font-weight: bold;
}

#uaujoeuful .gt_font_italic {
  font-style: italic;
}

#uaujoeuful .gt_super {
  font-size: 65%;
}

#uaujoeuful .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uaujoeuful .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uaujoeuful .gt_indent_1 {
  text-indent: 5px;
}

#uaujoeuful .gt_indent_2 {
  text-indent: 10px;
}

#uaujoeuful .gt_indent_3 {
  text-indent: 15px;
}

#uaujoeuful .gt_indent_4 {
  text-indent: 20px;
}

#uaujoeuful .gt_indent_5 {
  text-indent: 25px;
}

#uaujoeuful .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#uaujoeuful div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border">LTA Generated &amp; LTA Analyzed with Transition Probability of .200 &amp; .800</th>
</tr>
<tr class="odd gt_col_headings gt_spanner_row">
<th rowspan="2" id="N_Label" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Sample Size</th>
<th rowspan="2" id="Population" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Population</th>
<th rowspan="2" id="average" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimated<br>Probability</th>
<th rowspan="2" id="Coverage" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Coverage<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th rowspan="2" id="Power" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Power</th>
<th colspan="2" id="Bias" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Bias
</div></th>
</tr>
<tr class="header gt_col_headings">
<th id="Parameter_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Parameter <br>Bias</th>
<th id="SE_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Standard Error<br>Bias<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="7" id="Mover Probabilities" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Mover Probabilities</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.2</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.183</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage" style="background-color: #F7FBF9; color: #000000">0.926</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">0.838</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’8.50</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">3.39</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label">N = 500</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.3</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.277</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.930</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">0.918</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’7.67</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.4</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.378</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.938</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">0.954</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’5.50</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.2</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.188</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage" style="background-color: #F7FBF9; color: #000000">0.928</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">0.958</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’6.00</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label">N = 1000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.3</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.287</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.954</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">0.978</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’4.33</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.4</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.385</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.960</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">0.992</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’3.75</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias" style="background-color: #F4C7DE; color: #000000">6.82</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.2</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.194</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.960</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">0.998</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’3.00</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias" style="background-color: #F4C5DC; color: #000000">7.69</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label">N = 2000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.3</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.293</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.952</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’2.33</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias" style="background-color: #F4C6DE; color: #000000">6.90</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.4</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.393</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.958</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’1.75</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">3.33</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.2</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.194</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.950</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’3.00</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label">N = 4000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.3</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.294</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.944</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’2.00</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias">4.76</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Mover Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Mover Probabilities  Population">0.4</td>
<td class="gt_row gt_center" headers="Mover Probabilities  average">0.395</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Coverage">0.966</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Mover Probabilities  Parameter_Bias">âˆ’1.25</td>
<td class="gt_row gt_center" headers="Mover Probabilities  SE_Bias" style="background-color: #F2C0D9; color: #000000">10.00</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="7" id="Stayer Probabilities" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Stayer Probabilities</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.6</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.581</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.960</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">0.980</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’3.17</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias" style="background-color: #F4C7DE; color: #000000">âˆ’6.67</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label">N = 500</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.7</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.685</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.954</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">0.986</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’2.14</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias" style="background-color: #EBACC9; color: #000000">âˆ’19.75</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.8</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.791</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.960</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">0.994</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’1.13</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias" style="background-color: #E8A3C3; color: #000000">âˆ’23.88</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.6</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.591</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.962</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">0.998</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’1.50</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label">N = 1000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.7</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.695</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.956</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’0.71</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.8</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.796</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.952</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’0.50</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias" style="background-color: #F4C7DE; color: #000000">6.67</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.6</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.596</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.962</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’0.67</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">3.70</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label">N = 2000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.7</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.698</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.952</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’0.29</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.8</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.799</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.958</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’0.13</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.6</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.598</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.964</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’0.33</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label">N = 4000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.7</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.698</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.952</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’0.29</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias" style="background-color: #F5C9DF; color: #000000">5.88</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Stayer Probabilities  N_Label"></td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Population">0.8</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  average">0.798</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Coverage">0.954</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Power">1.000</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  Parameter_Bias">âˆ’0.25</td>
<td class="gt_row gt_center" headers="Stayer Probabilities  SE_Bias">0.00</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="7" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Green indicates failure to achieve adequate <em>Coverage</em>.</td>
</tr>
<tr class="even">
<td colspan="7" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Darker red indicates larger deviations from zero <em>Standard Error Bias</em> beyond the Â±4.99 threshold.</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb55" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Understanding the Performance of Random Intercepts Latent Transition Analysis (RI-LTA): A Monte Carlo Simulation Study using MplusAutomation"</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Study 1.2: LTA Generated, RILTA Analyzed with Two Timepoints"</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Delwin Carter"</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.time(), '%B %d, %Y')`"</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Overview"</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-float:</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co">      collapsed: false</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co">      smooth-scroll: true</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: flatly</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-format: svg</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co">    font:</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="co">      main: "Avenir Next LT Pro, Arial, sans-serif"</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="an">knitr:</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="co">  opts_chunk:</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="co">    echo: true</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="co">    out.width: "100%"</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="co">    fig.align: "center"</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>::: {layout-ncol="2"}</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/LVG%20FINAL.png)</span>{width="300"}</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/UCSB_Gauchos_logo_PNG2.png)</span>{width="300"}</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Study 1.2: LTA Generated, RILTA Analyzed</span></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/LTA_RILTA.png)</span>{width="354"}</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>Load Packages</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: "load-libraries"</span></span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a><span class="in">library(MplusAutomation)</span></span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a><span class="in">library(here)</span></span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a><span class="in">library(gt)</span></span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a><span class="in">library(janitor)</span></span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a><span class="in">library(glue)</span></span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggtext)</span></span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a><span class="in">library(rlang)</span></span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a><span class="in">library(knitr)</span></span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a><span class="in">library(kableExtra)</span></span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a><span class="in">library(parallel)</span></span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a><span class="in">library(tools)</span></span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simulation</span></span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1: Conduct Simulation</span></span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-81"><a href="#cb55-81" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In this section, I am conducting a simulation where I am generating data as Latent Transition Analysis and analyzing it as Random Intercepts Latent Transition Analysis to fully explore the model's performance. The simulation consists of 24 conditions, combining four sample sizes (N = 500, 1000, 2000, 4000) with six transition probabilities linked to logits (*betas;* 1.385, .85, .41, -.41, -.85, -1.385), corresponding to probabilities of .8, .7, .6, .4, .3, and .2. These conditions are iterated over programmatically using MplusAutomation to set up and execute the models. To speed up the process, I employ parallel processing, which distributes computations across multiple CPU cores, enabling efficient completion of the simulations across all scenarios.</span></span>
<span id="cb55-82"><a href="#cb55-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a>Conditions:</span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-85"><a href="#cb55-85" aria-hidden="true" tabindex="-1"></a>Sample Size: N = 500, 1000, 2000, 4000</span>
<span id="cb55-86"><a href="#cb55-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-87"><a href="#cb55-87" aria-hidden="true" tabindex="-1"></a>Transition logit (Probability): TPs = 1.385 (.8), .85 (.7), .41 (.6), -.41 (.4), -.85 (.3), -1.385 (.2)</span>
<span id="cb55-88"><a href="#cb55-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-89"><a href="#cb55-89" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/clipboard-3344253592.png)</span>{width="450"}</span>
<span id="cb55-90"><a href="#cb55-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-91"><a href="#cb55-91" aria-hidden="true" tabindex="-1"></a><span class="fu">### Setting up the Simulation Conditions&nbsp;</span></span>
<span id="cb55-92"><a href="#cb55-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-95"><a href="#cb55-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-96"><a href="#cb55-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "simulation-conditions"</span></span>
<span id="cb55-97"><a href="#cb55-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-98"><a href="#cb55-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-99"><a href="#cb55-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-100"><a href="#cb55-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-101"><a href="#cb55-101" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">N =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>),</span>
<span id="cb55-102"><a href="#cb55-102" aria-hidden="true" tabindex="-1"></a><span class="at">TPs =</span> <span class="fu">c</span>(<span class="fl">1.385</span>, .<span class="dv">85</span>, .<span class="dv">41</span>, <span class="sc">-</span>.<span class="dv">41</span>, <span class="sc">-</span>.<span class="dv">85</span>, <span class="sc">-</span><span class="fl">1.385</span>),</span>
<span id="cb55-103"><a href="#cb55-103" aria-hidden="true" tabindex="-1"></a><span class="at">TH =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb55-104"><a href="#cb55-104" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb55-105"><a href="#cb55-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the matrix using gt</span></span>
<span id="cb55-106"><a href="#cb55-106" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">%&gt;%</span></span>
<span id="cb55-107"><a href="#cb55-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-108"><a href="#cb55-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb55-109"><a href="#cb55-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Simulation Conditions Matrix"</span>,</span>
<span id="cb55-110"><a href="#cb55-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Combinations of Sample Sizes, Transition Probabilities, and Mixtures"</span></span>
<span id="cb55-111"><a href="#cb55-111" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-112"><a href="#cb55-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb55-113"><a href="#cb55-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb55-114"><a href="#cb55-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>() <span class="co"># Centers all columns</span></span>
<span id="cb55-115"><a href="#cb55-115" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-116"><a href="#cb55-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-117"><a href="#cb55-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-118"><a href="#cb55-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## Run Initial Simulation</span></span>
<span id="cb55-119"><a href="#cb55-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-120"><a href="#cb55-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,eval = FALSE}</span></span>
<span id="cb55-121"><a href="#cb55-121" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: "lta-rilta-simulation"</span></span>
<span id="cb55-122"><a href="#cb55-122" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb55-123"><a href="#cb55-123" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb55-124"><a href="#cb55-124" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb55-125"><a href="#cb55-125" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb55-126"><a href="#cb55-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-127"><a href="#cb55-127" aria-hidden="true" tabindex="-1"></a><span class="in">library(parallel)</span></span>
<span id="cb55-128"><a href="#cb55-128" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 1: Create the cluster for parallel processing</span></span>
<span id="cb55-129"><a href="#cb55-129" aria-hidden="true" tabindex="-1"></a><span class="in">num_cores &lt;- detectCores() - 1  # Detect the number of available cores (minus 1)</span></span>
<span id="cb55-130"><a href="#cb55-130" aria-hidden="true" tabindex="-1"></a><span class="in">cl &lt;- makeCluster(num_cores, type = "PSOCK")  # Create the PSOCK cluster</span></span>
<span id="cb55-131"><a href="#cb55-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-132"><a href="#cb55-132" aria-hidden="true" tabindex="-1"></a><span class="in">lta_rilta_func &lt;- function(N, TPs, TH) {</span></span>
<span id="cb55-133"><a href="#cb55-133" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb55-134"><a href="#cb55-134" aria-hidden="true" tabindex="-1"></a><span class="in">  LTA_RILTA &lt;- mplusObject(</span></span>
<span id="cb55-135"><a href="#cb55-135" aria-hidden="true" tabindex="-1"></a><span class="in">    TITLE = glue("Generate LTA_RILTA_N_{N}_TP = {TPs}_{TH}"),</span></span>
<span id="cb55-136"><a href="#cb55-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-137"><a href="#cb55-137" aria-hidden="true" tabindex="-1"></a><span class="in">    MONTECARLO =</span></span>
<span id="cb55-138"><a href="#cb55-138" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("NAMES = u11-u15 u21-u25;</span></span>
<span id="cb55-139"><a href="#cb55-139" aria-hidden="true" tabindex="-1"></a><span class="in">      GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb55-140"><a href="#cb55-140" aria-hidden="true" tabindex="-1"></a><span class="in">      CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb55-141"><a href="#cb55-141" aria-hidden="true" tabindex="-1"></a><span class="in">      GENCLASSES = c1(2) c2(2);</span></span>
<span id="cb55-142"><a href="#cb55-142" aria-hidden="true" tabindex="-1"></a><span class="in">      CLASSES = c1(2) c2(2);</span></span>
<span id="cb55-143"><a href="#cb55-143" aria-hidden="true" tabindex="-1"></a><span class="in">      NOBSERVATIONS = {N};</span></span>
<span id="cb55-144"><a href="#cb55-144" aria-hidden="true" tabindex="-1"></a><span class="in">      SEED = 07252005;</span></span>
<span id="cb55-145"><a href="#cb55-145" aria-hidden="true" tabindex="-1"></a><span class="in">      NREPS = 500;</span></span>
<span id="cb55-146"><a href="#cb55-146" aria-hidden="true" tabindex="-1"></a><span class="in">      !!SAVE = repM1*.dat;</span></span>
<span id="cb55-147"><a href="#cb55-147" aria-hidden="true" tabindex="-1"></a><span class="in">      RESULTS = LTA_RILTA_N_{N}_TP_{TPs}_TH_{TH}_WD.csv;"),</span></span>
<span id="cb55-148"><a href="#cb55-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-149"><a href="#cb55-149" aria-hidden="true" tabindex="-1"></a><span class="in">    ANALYSIS =</span></span>
<span id="cb55-150"><a href="#cb55-150" aria-hidden="true" tabindex="-1"></a><span class="in">      "TYPE = MIXTURE;</span></span>
<span id="cb55-151"><a href="#cb55-151" aria-hidden="true" tabindex="-1"></a><span class="in">      algorithm = integration;</span></span>
<span id="cb55-152"><a href="#cb55-152" aria-hidden="true" tabindex="-1"></a><span class="in">      processors = 24;</span></span>
<span id="cb55-153"><a href="#cb55-153" aria-hidden="true" tabindex="-1"></a><span class="in">      starts=50 10;</span></span>
<span id="cb55-154"><a href="#cb55-154" aria-hidden="true" tabindex="-1"></a><span class="in">      logcriterion=0.00001;</span></span>
<span id="cb55-155"><a href="#cb55-155" aria-hidden="true" tabindex="-1"></a><span class="in">      mconv=0.00001;",</span></span>
<span id="cb55-156"><a href="#cb55-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-157"><a href="#cb55-157" aria-hidden="true" tabindex="-1"></a><span class="in">    MODELPOPULATION = glue("    </span></span>
<span id="cb55-158"><a href="#cb55-158" aria-hidden="true" tabindex="-1"></a><span class="in">        %OVERALL%</span></span>
<span id="cb55-159"><a href="#cb55-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-160"><a href="#cb55-160" aria-hidden="true" tabindex="-1"></a><span class="in">       [c1#1-c2#1*0];</span></span>
<span id="cb55-161"><a href="#cb55-161" aria-hidden="true" tabindex="-1"></a><span class="in">        c2#1 on c1#1*{TPs};</span></span>
<span id="cb55-162"><a href="#cb55-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-163"><a href="#cb55-163" aria-hidden="true" tabindex="-1"></a><span class="in">      MODEL POPULATION-c1:</span></span>
<span id="cb55-164"><a href="#cb55-164" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#1%</span></span>
<span id="cb55-165"><a href="#cb55-165" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*{TH} u12$1*{TH} u13$1*{TH} u14$1*{TH} u15$1*{TH}] (p111-p115);</span></span>
<span id="cb55-166"><a href="#cb55-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-167"><a href="#cb55-167" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#2%</span></span>
<span id="cb55-168"><a href="#cb55-168" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*-{TH} u12$1*-{TH} u13$1*-{TH} u14$1*-{TH} u15$1*-{TH}] (p121-p125);</span></span>
<span id="cb55-169"><a href="#cb55-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-170"><a href="#cb55-170" aria-hidden="true" tabindex="-1"></a><span class="in">      MODEL POPULATION-c2:  </span></span>
<span id="cb55-171"><a href="#cb55-171" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#1%</span></span>
<span id="cb55-172"><a href="#cb55-172" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*{TH} u22$1*{TH} u23$1*{TH} u24$1*{TH} u25$1*{TH}] (p111-p115);</span></span>
<span id="cb55-173"><a href="#cb55-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-174"><a href="#cb55-174" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#2%</span></span>
<span id="cb55-175"><a href="#cb55-175" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*-{TH} u22$1*-{TH} u23$1*-{TH} u24$1*-{TH} u25$1*-{TH}] (p121-p125);</span></span>
<span id="cb55-176"><a href="#cb55-176" aria-hidden="true" tabindex="-1"></a><span class="in">       "),</span></span>
<span id="cb55-177"><a href="#cb55-177" aria-hidden="true" tabindex="-1"></a><span class="in">     </span></span>
<span id="cb55-178"><a href="#cb55-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-179"><a href="#cb55-179" aria-hidden="true" tabindex="-1"></a><span class="in">    MODEL =</span></span>
<span id="cb55-180"><a href="#cb55-180" aria-hidden="true" tabindex="-1"></a><span class="in">      glue("    </span></span>
<span id="cb55-181"><a href="#cb55-181" aria-hidden="true" tabindex="-1"></a><span class="in">        %OVERALL%</span></span>
<span id="cb55-182"><a href="#cb55-182" aria-hidden="true" tabindex="-1"></a><span class="in">          [c1#1-c2#1*0](par1-par2);</span></span>
<span id="cb55-183"><a href="#cb55-183" aria-hidden="true" tabindex="-1"></a><span class="in">            c2#1 on c1#1*{TPs} (par11);</span></span>
<span id="cb55-184"><a href="#cb55-184" aria-hidden="true" tabindex="-1"></a><span class="in">            </span></span>
<span id="cb55-185"><a href="#cb55-185" aria-hidden="true" tabindex="-1"></a><span class="in">        f by u11* u12 u13 u14-u15 (p1-p5)</span></span>
<span id="cb55-186"><a href="#cb55-186" aria-hidden="true" tabindex="-1"></a><span class="in">             u21 u22 u23 u24 u25 (p1-p5);</span></span>
<span id="cb55-187"><a href="#cb55-187" aria-hidden="true" tabindex="-1"></a><span class="in">        f@1;</span></span>
<span id="cb55-188"><a href="#cb55-188" aria-hidden="true" tabindex="-1"></a><span class="in">        [f@0];</span></span>
<span id="cb55-189"><a href="#cb55-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-190"><a href="#cb55-190" aria-hidden="true" tabindex="-1"></a><span class="in">     MODEL c1:</span></span>
<span id="cb55-191"><a href="#cb55-191" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#1%</span></span>
<span id="cb55-192"><a href="#cb55-192" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*{TH} u12$1*{TH} u13$1*{TH} u14$1*{TH} u15$1*{TH}] (p111-p115);</span></span>
<span id="cb55-193"><a href="#cb55-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-194"><a href="#cb55-194" aria-hidden="true" tabindex="-1"></a><span class="in">        %c1#2%</span></span>
<span id="cb55-195"><a href="#cb55-195" aria-hidden="true" tabindex="-1"></a><span class="in">     [u11$1*-{TH} u12$1*-{TH} u13$1*-{TH} u14$1*-{TH} u15$1*-{TH}] (p121-p125);</span></span>
<span id="cb55-196"><a href="#cb55-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-197"><a href="#cb55-197" aria-hidden="true" tabindex="-1"></a><span class="in">    MODEL c2:   </span></span>
<span id="cb55-198"><a href="#cb55-198" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#1%</span></span>
<span id="cb55-199"><a href="#cb55-199" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*{TH} u22$1*{TH} u23$1*{TH} u24$1*{TH} u25$1*{TH}] (p111-p115);</span></span>
<span id="cb55-200"><a href="#cb55-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-201"><a href="#cb55-201" aria-hidden="true" tabindex="-1"></a><span class="in">        %c2#2%</span></span>
<span id="cb55-202"><a href="#cb55-202" aria-hidden="true" tabindex="-1"></a><span class="in">     [u21$1*-{TH} u22$1*-{TH} u23$1*-{TH} u24$1*-{TH} u25$1*-{TH}] (p121-p125);</span></span>
<span id="cb55-203"><a href="#cb55-203" aria-hidden="true" tabindex="-1"></a><span class="in">          "),</span></span>
<span id="cb55-204"><a href="#cb55-204" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb55-205"><a href="#cb55-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-206"><a href="#cb55-206" aria-hidden="true" tabindex="-1"></a><span class="in">    MODELCONSTRAINT =</span></span>
<span id="cb55-207"><a href="#cb55-207" aria-hidden="true" tabindex="-1"></a><span class="in">      if (TPs == 1.385) {</span></span>
<span id="cb55-208"><a href="#cb55-208" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-209"><a href="#cb55-209" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb55-210"><a href="#cb55-210" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.80 trans12*.20 trans21*.5 trans22*.5</span></span>
<span id="cb55-211"><a href="#cb55-211" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.65 prob22*.35);</span></span>
<span id="cb55-212"><a href="#cb55-212" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-213"><a href="#cb55-213" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-214"><a href="#cb55-214" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-215"><a href="#cb55-215" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-216"><a href="#cb55-216" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-217"><a href="#cb55-217" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-218"><a href="#cb55-218" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-219"><a href="#cb55-219" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-220"><a href="#cb55-220" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb55-221"><a href="#cb55-221" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb55-222"><a href="#cb55-222" aria-hidden="true" tabindex="-1"></a><span class="in">      } </span></span>
<span id="cb55-223"><a href="#cb55-223" aria-hidden="true" tabindex="-1"></a><span class="in">             else if (TPs == .85) {</span></span>
<span id="cb55-224"><a href="#cb55-224" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-225"><a href="#cb55-225" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb55-226"><a href="#cb55-226" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.70 trans12*.30 trans21*.5 trans22*.5</span></span>
<span id="cb55-227"><a href="#cb55-227" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.60 prob22*.4);</span></span>
<span id="cb55-228"><a href="#cb55-228" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-229"><a href="#cb55-229" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-230"><a href="#cb55-230" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-231"><a href="#cb55-231" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-232"><a href="#cb55-232" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-233"><a href="#cb55-233" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-234"><a href="#cb55-234" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-235"><a href="#cb55-235" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-236"><a href="#cb55-236" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb55-237"><a href="#cb55-237" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb55-238"><a href="#cb55-238" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb55-239"><a href="#cb55-239" aria-hidden="true" tabindex="-1"></a><span class="in">            else  if (TPs == .41) {</span></span>
<span id="cb55-240"><a href="#cb55-240" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-241"><a href="#cb55-241" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb55-242"><a href="#cb55-242" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.60 trans12*.40 trans21*.5 trans22*.5</span></span>
<span id="cb55-243"><a href="#cb55-243" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.55 prob22*.45);</span></span>
<span id="cb55-244"><a href="#cb55-244" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-245"><a href="#cb55-245" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-246"><a href="#cb55-246" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-247"><a href="#cb55-247" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-248"><a href="#cb55-248" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-249"><a href="#cb55-249" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-250"><a href="#cb55-250" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-251"><a href="#cb55-251" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-252"><a href="#cb55-252" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb55-253"><a href="#cb55-253" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb55-254"><a href="#cb55-254" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb55-255"><a href="#cb55-255" aria-hidden="true" tabindex="-1"></a><span class="in">             else if (TPs == -.41) {</span></span>
<span id="cb55-256"><a href="#cb55-256" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-257"><a href="#cb55-257" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb55-258"><a href="#cb55-258" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.40 trans12*.60 trans21*.5 trans22*.5</span></span>
<span id="cb55-259"><a href="#cb55-259" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.45 prob22*.55);</span></span>
<span id="cb55-260"><a href="#cb55-260" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-261"><a href="#cb55-261" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-262"><a href="#cb55-262" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-263"><a href="#cb55-263" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-264"><a href="#cb55-264" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-265"><a href="#cb55-265" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-266"><a href="#cb55-266" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-267"><a href="#cb55-267" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-268"><a href="#cb55-268" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb55-269"><a href="#cb55-269" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb55-270"><a href="#cb55-270" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb55-271"><a href="#cb55-271" aria-hidden="true" tabindex="-1"></a><span class="in">             else if (TPs == -.85) {</span></span>
<span id="cb55-272"><a href="#cb55-272" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-273"><a href="#cb55-273" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb55-274"><a href="#cb55-274" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.30 trans12*.70 trans21*.5 trans22*.5</span></span>
<span id="cb55-275"><a href="#cb55-275" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.40 prob22*.60);</span></span>
<span id="cb55-276"><a href="#cb55-276" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-277"><a href="#cb55-277" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-278"><a href="#cb55-278" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-279"><a href="#cb55-279" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-280"><a href="#cb55-280" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-281"><a href="#cb55-281" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-282"><a href="#cb55-282" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-283"><a href="#cb55-283" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-284"><a href="#cb55-284" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb55-285"><a href="#cb55-285" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb55-286"><a href="#cb55-286" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb55-287"><a href="#cb55-287" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb55-288"><a href="#cb55-288" aria-hidden="true" tabindex="-1"></a><span class="in">        else if (TPs == -1.385) {</span></span>
<span id="cb55-289"><a href="#cb55-289" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-290"><a href="#cb55-290" aria-hidden="true" tabindex="-1"></a><span class="in">         New(</span></span>
<span id="cb55-291"><a href="#cb55-291" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.20 trans12*.80 trans21*.5 trans22*.5</span></span>
<span id="cb55-292"><a href="#cb55-292" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.35 prob22*.65);</span></span>
<span id="cb55-293"><a href="#cb55-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-294"><a href="#cb55-294" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-295"><a href="#cb55-295" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-296"><a href="#cb55-296" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-297"><a href="#cb55-297" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-298"><a href="#cb55-298" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-299"><a href="#cb55-299" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-300"><a href="#cb55-300" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-301"><a href="#cb55-301" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-302"><a href="#cb55-302" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;")</span></span>
<span id="cb55-303"><a href="#cb55-303" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb55-304"><a href="#cb55-304" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb55-305"><a href="#cb55-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-306"><a href="#cb55-306" aria-hidden="true" tabindex="-1"></a><span class="in">  # Run Mplus model</span></span>
<span id="cb55-307"><a href="#cb55-307" aria-hidden="true" tabindex="-1"></a><span class="in">  LTA_RILTA_Model&lt;- mplusModeler(LTA_RILTA, </span></span>
<span id="cb55-308"><a href="#cb55-308" aria-hidden="true" tabindex="-1"></a><span class="in">                                   dataout = here("2 2T LTA GEN RILTA ANALYZED", glue("LTA_RILTA_N_{N}_TP_{TPs}_TH_{TH}_WD.dat")),</span></span>
<span id="cb55-309"><a href="#cb55-309" aria-hidden="true" tabindex="-1"></a><span class="in">                                   modelout = glue(here("2 2T LTA GEN RILTA ANALYZED", "LTA_RILTA_N_{N}_TP_{TPs}_TH_{TH}_WD.inp")),</span></span>
<span id="cb55-310"><a href="#cb55-310" aria-hidden="true" tabindex="-1"></a><span class="in">                                   check = TRUE, run = TRUE, hashfilename = FALSE)</span></span>
<span id="cb55-311"><a href="#cb55-311" aria-hidden="true" tabindex="-1"></a><span class="in">return(LTA_RILTA_Model)</span></span>
<span id="cb55-312"><a href="#cb55-312" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb55-313"><a href="#cb55-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-314"><a href="#cb55-314" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 3: Export necessary objects to the cluster</span></span>
<span id="cb55-315"><a href="#cb55-315" aria-hidden="true" tabindex="-1"></a><span class="in">clusterExport(cl, c("lta_rilta_func", "p1", "here", "glue", "mplusModeler", "mplusObject"))</span></span>
<span id="cb55-316"><a href="#cb55-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-317"><a href="#cb55-317" aria-hidden="true" tabindex="-1"></a><span class="in"># Ensure necessary libraries are loaded on each cluster node</span></span>
<span id="cb55-318"><a href="#cb55-318" aria-hidden="true" tabindex="-1"></a><span class="in">clusterEvalQ(cl, {</span></span>
<span id="cb55-319"><a href="#cb55-319" aria-hidden="true" tabindex="-1"></a><span class="in">  library(MplusAutomation)</span></span>
<span id="cb55-320"><a href="#cb55-320" aria-hidden="true" tabindex="-1"></a><span class="in">  library(glue)</span></span>
<span id="cb55-321"><a href="#cb55-321" aria-hidden="true" tabindex="-1"></a><span class="in">  library(here)</span></span>
<span id="cb55-322"><a href="#cb55-322" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb55-323"><a href="#cb55-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-324"><a href="#cb55-324" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 4: Run the simulation in parallel using the cluster</span></span>
<span id="cb55-325"><a href="#cb55-325" aria-hidden="true" tabindex="-1"></a><span class="in">result_list &lt;- parLapply(cl, 1:nrow(p1), function(i) {</span></span>
<span id="cb55-326"><a href="#cb55-326" aria-hidden="true" tabindex="-1"></a><span class="in">  lta_rilta_func(p1$N[i], p1$TPs[i], p1$TH[i])</span></span>
<span id="cb55-327"><a href="#cb55-327" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb55-328"><a href="#cb55-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-329"><a href="#cb55-329" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 5: Stop the cluster after the simulation</span></span>
<span id="cb55-330"><a href="#cb55-330" aria-hidden="true" tabindex="-1"></a><span class="in">stopCluster(cl)</span></span>
<span id="cb55-331"><a href="#cb55-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-332"><a href="#cb55-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-333"><a href="#cb55-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-334"><a href="#cb55-334" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-335"><a href="#cb55-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-336"><a href="#cb55-336" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Processing and Verification</span></span>
<span id="cb55-337"><a href="#cb55-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-338"><a href="#cb55-338" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-339"><a href="#cb55-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-340"><a href="#cb55-340" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check for Label Switching and Errors</span></span>
<span id="cb55-341"><a href="#cb55-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-342"><a href="#cb55-342" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In this section: .csv files are first merged into a single data frame, from which specific parameters are extracted. Logit values are then converted to probabilities, and known class values are incorporated into the data frame. A subset of cases involving label switching is selected randomly and plotted for visual review. Output files are scanned for errors, which are subsequently merged back into the original data file. Additional columns derived from the file name are added, and the percentage of violations is calculated. Both errors and label switching violations are visually represented, and the total number of corrected replications is reported.</span></span>
<span id="cb55-343"><a href="#cb55-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-344"><a href="#cb55-344" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scrape Mplus CSV Files</span></span>
<span id="cb55-345"><a href="#cb55-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-346"><a href="#cb55-346" aria-hidden="true" tabindex="-1"></a>*First, Load all CSV files and combine them into a single data frame.*</span>
<span id="cb55-347"><a href="#cb55-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-350"><a href="#cb55-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-351"><a href="#cb55-351" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "combine-csv-files-parallel"</span></span>
<span id="cb55-352"><a href="#cb55-352" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-353"><a href="#cb55-353" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-354"><a href="#cb55-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-355"><a href="#cb55-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-356"><a href="#cb55-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-357"><a href="#cb55-357" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct CSV directory</span></span>
<span id="cb55-358"><a href="#cb55-358" aria-hidden="true" tabindex="-1"></a>csv_directory <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'Study_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'2_2T_LTA_GEN_RILTA_ANALYZED'</span>)</span>
<span id="cb55-359"><a href="#cb55-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-360"><a href="#cb55-360" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document</span></span>
<span id="cb55-361"><a href="#cb55-361" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'data_scraping.R'</span>))</span>
<span id="cb55-362"><a href="#cb55-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-363"><a href="#cb55-363" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate combined_data dataframe in the global environment</span></span>
<span id="cb55-364"><a href="#cb55-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-365"><a href="#cb55-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-366"><a href="#cb55-366" aria-hidden="true" tabindex="-1"></a><span class="fu">### Slice Data / Extract Parameters</span></span>
<span id="cb55-367"><a href="#cb55-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-368"><a href="#cb55-368" aria-hidden="true" tabindex="-1"></a>*Extract data from the appropriate rows from each 9-row chunk and prepare the data for further processing.*</span>
<span id="cb55-369"><a href="#cb55-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-372"><a href="#cb55-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-373"><a href="#cb55-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "scrape-rows-process-data-parallel"</span></span>
<span id="cb55-374"><a href="#cb55-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-375"><a href="#cb55-375" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-376"><a href="#cb55-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-377"><a href="#cb55-377" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-378"><a href="#cb55-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-379"><a href="#cb55-379" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Process the data using the child script</span></span>
<span id="cb55-380"><a href="#cb55-380" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step2_2t_RILTA.R'</span>))</span>
<span id="cb55-381"><a href="#cb55-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-382"><a href="#cb55-382" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate final_combined_data dataframe in global environment</span></span>
<span id="cb55-383"><a href="#cb55-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-384"><a href="#cb55-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-385"><a href="#cb55-385" aria-hidden="true" tabindex="-1"></a><span class="fu">### Wrangle Data</span></span>
<span id="cb55-386"><a href="#cb55-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-387"><a href="#cb55-387" aria-hidden="true" tabindex="-1"></a>*Convert the logits to probabilities and add the known actual values to each row.*</span>
<span id="cb55-388"><a href="#cb55-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-391"><a href="#cb55-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-392"><a href="#cb55-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "convert-logits-to-probabilities"</span></span>
<span id="cb55-393"><a href="#cb55-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-394"><a href="#cb55-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-395"><a href="#cb55-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-396"><a href="#cb55-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-397"><a href="#cb55-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-398"><a href="#cb55-398" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3 and 4: Process the data and return results</span></span>
<span id="cb55-399"><a href="#cb55-399" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step_3.R'</span>))</span>
<span id="cb55-400"><a href="#cb55-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-401"><a href="#cb55-401" aria-hidden="true" tabindex="-1"></a><span class="co"># The objects `final_data_with_actuals` and `violators` should now be in the global environment</span></span>
<span id="cb55-402"><a href="#cb55-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-403"><a href="#cb55-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-404"><a href="#cb55-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-405"><a href="#cb55-405" aria-hidden="true" tabindex="-1"></a><span class="fu">### Generate Plots of Label Switching</span></span>
<span id="cb55-406"><a href="#cb55-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-407"><a href="#cb55-407" aria-hidden="true" tabindex="-1"></a>*Generate plots of randomly sampled violators for visual inspection using parallel processing.*</span>
<span id="cb55-408"><a href="#cb55-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-409"><a href="#cb55-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb55-410"><a href="#cb55-410" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: "plot-violators"</span></span>
<span id="cb55-411"><a href="#cb55-411" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb55-412"><a href="#cb55-412" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb55-413"><a href="#cb55-413" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb55-414"><a href="#cb55-414" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb55-415"><a href="#cb55-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-416"><a href="#cb55-416" aria-hidden="true" tabindex="-1"></a><span class="in"># Set plot width and height</span></span>
<span id="cb55-417"><a href="#cb55-417" aria-hidden="true" tabindex="-1"></a><span class="in">plot_width &lt;- 8</span></span>
<span id="cb55-418"><a href="#cb55-418" aria-hidden="true" tabindex="-1"></a><span class="in">plot_height &lt;- 6</span></span>
<span id="cb55-419"><a href="#cb55-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-420"><a href="#cb55-420" aria-hidden="true" tabindex="-1"></a><span class="in"># Take a random sample of up to 250 violators (ensure not to exceed the total number of violators)</span></span>
<span id="cb55-421"><a href="#cb55-421" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(123)  # For reproducibility</span></span>
<span id="cb55-422"><a href="#cb55-422" aria-hidden="true" tabindex="-1"></a><span class="in">sample_size &lt;- min(nrow(violators), 250)  # Handle cases where fewer than 250 violators exist</span></span>
<span id="cb55-423"><a href="#cb55-423" aria-hidden="true" tabindex="-1"></a><span class="in">sampled_violators &lt;- violators[sample(nrow(violators), sample_size), ]</span></span>
<span id="cb55-424"><a href="#cb55-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-425"><a href="#cb55-425" aria-hidden="true" tabindex="-1"></a><span class="in"># Define the function to create plots sequentially</span></span>
<span id="cb55-426"><a href="#cb55-426" aria-hidden="true" tabindex="-1"></a><span class="in">plot_violator &lt;- function(i) {</span></span>
<span id="cb55-427"><a href="#cb55-427" aria-hidden="true" tabindex="-1"></a><span class="in">  row_data &lt;- sampled_violators[i, ]</span></span>
<span id="cb55-428"><a href="#cb55-428" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb55-429"><a href="#cb55-429" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extract the file name from the current row</span></span>
<span id="cb55-430"><a href="#cb55-430" aria-hidden="true" tabindex="-1"></a><span class="in">  file_name &lt;- row_data$FileName</span></span>
<span id="cb55-431"><a href="#cb55-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-432"><a href="#cb55-432" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extract probability values for EC1 and EC2 (estimated probabilities) and AC1 and AC2 (actuals)</span></span>
<span id="cb55-433"><a href="#cb55-433" aria-hidden="true" tabindex="-1"></a><span class="in">  estimated_probabilities &lt;- c(</span></span>
<span id="cb55-434"><a href="#cb55-434" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ec1u1", "Ec1u2", "Ec1u3", "Ec1u4", "Ec1u5")]),</span></span>
<span id="cb55-435"><a href="#cb55-435" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ec2u1", "Ec2u2", "Ec2u3", "Ec2u4", "Ec2u5")])</span></span>
<span id="cb55-436"><a href="#cb55-436" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb55-437"><a href="#cb55-437" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb55-438"><a href="#cb55-438" aria-hidden="true" tabindex="-1"></a><span class="in">  actual_values &lt;- c(</span></span>
<span id="cb55-439"><a href="#cb55-439" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ac1u1", "Ac1u2", "Ac1u3", "Ac1u4", "Ac1u5")]),</span></span>
<span id="cb55-440"><a href="#cb55-440" aria-hidden="true" tabindex="-1"></a><span class="in">    as.numeric(row_data[c("Ac2u1", "Ac2u2", "Ac2u3", "Ac2u4", "Ac2u5")])</span></span>
<span id="cb55-441"><a href="#cb55-441" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb55-442"><a href="#cb55-442" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb55-443"><a href="#cb55-443" aria-hidden="true" tabindex="-1"></a><span class="in">  # Create labels for the legend with actual values directly from the dataset</span></span>
<span id="cb55-444"><a href="#cb55-444" aria-hidden="true" tabindex="-1"></a><span class="in">  labels &lt;- c(</span></span>
<span id="cb55-445"><a href="#cb55-445" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("EC1: (", round(row_data$Ec1u1, 3), ", ", round(row_data$Ec1u2, 3), ", ", round(row_data$Ec1u3, 3), ", ", round(row_data$Ec1u4, 3), ", ", round(row_data$Ec1u5, 3), ")"),</span></span>
<span id="cb55-446"><a href="#cb55-446" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("EC2: (", round(row_data$Ec2u1, 3), ", ", round(row_data$Ec2u2, 3), ", ", round(row_data$Ec2u3, 3), ", ", round(row_data$Ec2u4, 3), ", ", round(row_data$Ec2u5, 3), ")"),</span></span>
<span id="cb55-447"><a href="#cb55-447" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("AC1: (", round(row_data$Ac1u1, 3), ", ", round(row_data$Ac1u2, 3), ", ", round(row_data$Ac1u3, 3), ", ", round(row_data$Ac1u4, 3), ", ", round(row_data$Ac1u5, 3), ")"),</span></span>
<span id="cb55-448"><a href="#cb55-448" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("AC2: (", round(row_data$Ac2u1, 3), ", ", round(row_data$Ac2u2, 3), ", ", round(row_data$Ac2u3, 3), ", ", round(row_data$Ac2u4, 3), ", ", round(row_data$Ac2u5, 3), ")")</span></span>
<span id="cb55-449"><a href="#cb55-449" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb55-450"><a href="#cb55-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-451"><a href="#cb55-451" aria-hidden="true" tabindex="-1"></a><span class="in">  # Step 6: Create a data frame for plotting</span></span>
<span id="cb55-452"><a href="#cb55-452" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_data &lt;- data.frame(</span></span>
<span id="cb55-453"><a href="#cb55-453" aria-hidden="true" tabindex="-1"></a><span class="in">    Items = rep(1:5, 4),</span></span>
<span id="cb55-454"><a href="#cb55-454" aria-hidden="true" tabindex="-1"></a><span class="in">    Probabilities = c(estimated_probabilities, actual_values),</span></span>
<span id="cb55-455"><a href="#cb55-455" aria-hidden="true" tabindex="-1"></a><span class="in">    Class = rep(labels, each = 5)</span></span>
<span id="cb55-456"><a href="#cb55-456" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb55-457"><a href="#cb55-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-458"><a href="#cb55-458" aria-hidden="true" tabindex="-1"></a><span class="in">  # Step 7: Create the plot with the file name in the title</span></span>
<span id="cb55-459"><a href="#cb55-459" aria-hidden="true" tabindex="-1"></a><span class="in">  p &lt;- ggplot(plot_data, aes(x = Items, y = Probabilities, color = Class, group = Class)) +</span></span>
<span id="cb55-460"><a href="#cb55-460" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_line(size = 1.2) +</span></span>
<span id="cb55-461"><a href="#cb55-461" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(size = 3) +</span></span>
<span id="cb55-462"><a href="#cb55-462" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(title = file_name, x = "Items", y = "Probabilities") +  # Only the file name in the title</span></span>
<span id="cb55-463"><a href="#cb55-463" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_minimal(base_size = 16) +</span></span>
<span id="cb55-464"><a href="#cb55-464" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(panel.background = element_rect(fill = "white"),</span></span>
<span id="cb55-465"><a href="#cb55-465" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.background = element_rect(fill = "white"),</span></span>
<span id="cb55-466"><a href="#cb55-466" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.title = element_text(size = 14, hjust = 0.5)) +  # Adjust title size and center</span></span>
<span id="cb55-467"><a href="#cb55-467" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = c(</span></span>
<span id="cb55-468"><a href="#cb55-468" aria-hidden="true" tabindex="-1"></a><span class="in">      "darkblue", "darkgreen",  # EC1 and EC2 (Estimated Probabilities)</span></span>
<span id="cb55-469"><a href="#cb55-469" aria-hidden="true" tabindex="-1"></a><span class="in">      "lightblue", "lightgreen"  # AC1 and AC2 (Actual Values)</span></span>
<span id="cb55-470"><a href="#cb55-470" aria-hidden="true" tabindex="-1"></a><span class="in">    ))</span></span>
<span id="cb55-471"><a href="#cb55-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-472"><a href="#cb55-472" aria-hidden="true" tabindex="-1"></a><span class="in">  ggsave(filename = file.path("z2t_lta_rilta_violator_plots", paste0("violator_plot_", i, "_", file_name, ".png")),</span></span>
<span id="cb55-473"><a href="#cb55-473" aria-hidden="true" tabindex="-1"></a><span class="in">         plot = p, width = plot_width, height = plot_height)</span></span>
<span id="cb55-474"><a href="#cb55-474" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb55-475"><a href="#cb55-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-476"><a href="#cb55-476" aria-hidden="true" tabindex="-1"></a><span class="in"># Apply the function to generate plots sequentially (without parallelization)</span></span>
<span id="cb55-477"><a href="#cb55-477" aria-hidden="true" tabindex="-1"></a><span class="in">invisible(lapply(1:sample_size, plot_violator))</span></span>
<span id="cb55-478"><a href="#cb55-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-479"><a href="#cb55-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-480"><a href="#cb55-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-481"><a href="#cb55-481" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-482"><a href="#cb55-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-483"><a href="#cb55-483" aria-hidden="true" tabindex="-1"></a><span class="fu"># Error Handling</span></span>
<span id="cb55-484"><a href="#cb55-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-485"><a href="#cb55-485" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-486"><a href="#cb55-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-487"><a href="#cb55-487" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scrape for Errors</span></span>
<span id="cb55-488"><a href="#cb55-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-489"><a href="#cb55-489" aria-hidden="true" tabindex="-1"></a>*Scrape output files for errors*</span>
<span id="cb55-490"><a href="#cb55-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-493"><a href="#cb55-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-494"><a href="#cb55-494" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "process-out-files-parallel"</span></span>
<span id="cb55-495"><a href="#cb55-495" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-496"><a href="#cb55-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-497"><a href="#cb55-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-498"><a href="#cb55-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-499"><a href="#cb55-499" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct output directory for .out files</span></span>
<span id="cb55-500"><a href="#cb55-500" aria-hidden="true" tabindex="-1"></a>output_folder <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'2_2T_LTA_GEN_RILTA_ANALYZED'</span>)</span>
<span id="cb55-501"><a href="#cb55-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-502"><a href="#cb55-502" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document that processes .out files</span></span>
<span id="cb55-503"><a href="#cb55-503" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'out_scraping.R'</span>))</span>
<span id="cb55-504"><a href="#cb55-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-505"><a href="#cb55-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-506"><a href="#cb55-506" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tabulate Error Rates</span></span>
<span id="cb55-507"><a href="#cb55-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-508"><a href="#cb55-508" aria-hidden="true" tabindex="-1"></a>*Create Visual Summary of Errors per Condition*</span>
<span id="cb55-509"><a href="#cb55-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-512"><a href="#cb55-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-513"><a href="#cb55-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "create-table-errors"</span></span>
<span id="cb55-514"><a href="#cb55-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-515"><a href="#cb55-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-516"><a href="#cb55-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-517"><a href="#cb55-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-518"><a href="#cb55-518" aria-hidden="true" tabindex="-1"></a>replication_summary_table <span class="ot">&lt;-</span> replication_summary <span class="sc">%&gt;%</span></span>
<span id="cb55-519"><a href="#cb55-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-520"><a href="#cb55-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb55-521"><a href="#cb55-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Replication Summary"</span>,</span>
<span id="cb55-522"><a href="#cb55-522" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Folder: "</span>, output_folder)</span>
<span id="cb55-523"><a href="#cb55-523" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-524"><a href="#cb55-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb55-525"><a href="#cb55-525" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ErrorRate"</span>),  <span class="co"># Use the actual column name, ensure it matches your dataframe</span></span>
<span id="cb55-526"><a href="#cb55-526" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb55-527"><a href="#cb55-527" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-528"><a href="#cb55-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb55-529"><a href="#cb55-529" aria-hidden="true" tabindex="-1"></a>    <span class="at">FileName =</span> <span class="st">"File Name"</span>,</span>
<span id="cb55-530"><a href="#cb55-530" aria-hidden="true" tabindex="-1"></a>    <span class="at">CompletedReplications =</span> <span class="st">"Completed Replications"</span>,</span>
<span id="cb55-531"><a href="#cb55-531" aria-hidden="true" tabindex="-1"></a>    <span class="at">RequestedReplications =</span> <span class="st">"Requested Replications"</span>,</span>
<span id="cb55-532"><a href="#cb55-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorReplications =</span> <span class="st">"Replications with Errors"</span>,</span>
<span id="cb55-533"><a href="#cb55-533" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> <span class="st">"Good Replications"</span>,</span>
<span id="cb55-534"><a href="#cb55-534" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> <span class="st">"Error Rate (%)"</span></span>
<span id="cb55-535"><a href="#cb55-535" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-536"><a href="#cb55-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb55-537"><a href="#cb55-537" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb55-538"><a href="#cb55-538" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()  <span class="co"># This aligns all columns' text to center</span></span>
<span id="cb55-539"><a href="#cb55-539" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-540"><a href="#cb55-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb55-541"><a href="#cb55-541" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb55-542"><a href="#cb55-542" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb55-543"><a href="#cb55-543" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb55-544"><a href="#cb55-544" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">80</span>)  <span class="co"># Adjust this percentage to reduce the width of the table</span></span>
<span id="cb55-545"><a href="#cb55-545" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-546"><a href="#cb55-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-547"><a href="#cb55-547" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb55-548"><a href="#cb55-548" aria-hidden="true" tabindex="-1"></a>replication_summary_table</span>
<span id="cb55-549"><a href="#cb55-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-550"><a href="#cb55-550" aria-hidden="true" tabindex="-1"></a><span class="co">#Compare rows in both .csv and .out data frames</span></span>
<span id="cb55-551"><a href="#cb55-551" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_data_with_actuals:"</span>, <span class="fu">nrow</span>(final_data_with_actuals), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-552"><a href="#cb55-552" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the final number of rows to confirm data handling</span></span>
<span id="cb55-553"><a href="#cb55-553" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows in error_summary: "</span>, <span class="fu">nrow</span>(error_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-554"><a href="#cb55-554" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows in replication_summary: "</span>, <span class="fu">nrow</span>(replication_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-555"><a href="#cb55-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-556"><a href="#cb55-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-557"><a href="#cb55-557" aria-hidden="true" tabindex="-1"></a><span class="fu">### Merge Errors with Main Data File</span></span>
<span id="cb55-558"><a href="#cb55-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-559"><a href="#cb55-559" aria-hidden="true" tabindex="-1"></a>*Merge Errors with Main Data*</span>
<span id="cb55-560"><a href="#cb55-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-563"><a href="#cb55-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-564"><a href="#cb55-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "merge-errors"</span></span>
<span id="cb55-565"><a href="#cb55-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-566"><a href="#cb55-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-567"><a href="#cb55-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-568"><a href="#cb55-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-569"><a href="#cb55-569" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Process the data using the child script</span></span>
<span id="cb55-570"><a href="#cb55-570" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'merge_errors.R'</span>))</span>
<span id="cb55-571"><a href="#cb55-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-572"><a href="#cb55-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-573"><a href="#cb55-573" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scrape File Name Components</span></span>
<span id="cb55-574"><a href="#cb55-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-575"><a href="#cb55-575" aria-hidden="true" tabindex="-1"></a>*Create Column Names from the File Name*</span>
<span id="cb55-576"><a href="#cb55-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-579"><a href="#cb55-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-580"><a href="#cb55-580" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "create-column-names-from-filename"</span></span>
<span id="cb55-581"><a href="#cb55-581" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-582"><a href="#cb55-582" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-583"><a href="#cb55-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-584"><a href="#cb55-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-585"><a href="#cb55-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-586"><a href="#cb55-586" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns based on the information in the FileName and set factors</span></span>
<span id="cb55-587"><a href="#cb55-587" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb55-588"><a href="#cb55-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-589"><a href="#cb55-589" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the sample size (N) from the FileName with the correct values</span></span>
<span id="cb55-590"><a href="#cb55-590" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-591"><a href="#cb55-591" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_4000"</span>, FileName) <span class="sc">~</span> <span class="dv">4</span>,  <span class="co"># Correct value for N_4000</span></span>
<span id="cb55-592"><a href="#cb55-592" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_500"</span>, FileName) <span class="sc">~</span> <span class="dv">1</span>,   </span>
<span id="cb55-593"><a href="#cb55-593" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_1000"</span>, FileName) <span class="sc">~</span> <span class="dv">2</span>,  </span>
<span id="cb55-594"><a href="#cb55-594" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_2000"</span>, FileName) <span class="sc">~</span> <span class="dv">3</span>,  </span>
<span id="cb55-595"><a href="#cb55-595" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb55-596"><a href="#cb55-596" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-597"><a href="#cb55-597" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map the TPs from the FileName to the appropriate Population labels</span></span>
<span id="cb55-598"><a href="#cb55-598" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-599"><a href="#cb55-599" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".800"</span>,   <span class="co"># Use ".800" instead of "0.800"</span></span>
<span id="cb55-600"><a href="#cb55-600" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".700"</span>,    <span class="co"># Use ".700" instead of "0.700"</span></span>
<span id="cb55-601"><a href="#cb55-601" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".600"</span>,    <span class="co"># Use ".600" instead of "0.600"</span></span>
<span id="cb55-602"><a href="#cb55-602" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".400"</span>,   <span class="co"># Use ".400" instead of "0.400"</span></span>
<span id="cb55-603"><a href="#cb55-603" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".300"</span>,   <span class="co"># Use ".300" instead of "0.300"</span></span>
<span id="cb55-604"><a href="#cb55-604" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".200"</span>,  <span class="co"># Use ".200" instead of "0.200"</span></span>
<span id="cb55-605"><a href="#cb55-605" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb55-606"><a href="#cb55-606" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-607"><a href="#cb55-607" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the Transitions variable based on Population values</span></span>
<span id="cb55-608"><a href="#cb55-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-609"><a href="#cb55-609" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>) <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># Assign 1 for Population .200, .300, .400</span></span>
<span id="cb55-610"><a href="#cb55-610" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>) <span class="sc">~</span> <span class="dv">2</span>,  <span class="co"># Assign 2 for Population .600, .700, .800</span></span>
<span id="cb55-611"><a href="#cb55-611" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb55-612"><a href="#cb55-612" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-613"><a href="#cb55-613" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-614"><a href="#cb55-614" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert columns to factors, ordering N_4000 first in the factor levels</span></span>
<span id="cb55-615"><a href="#cb55-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-616"><a href="#cb55-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"N = 4000"</span>, <span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>)),</span>
<span id="cb55-617"><a href="#cb55-617" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".800"</span>, <span class="st">".700"</span>, <span class="st">".600"</span>, <span class="st">".400"</span>, <span class="st">".300"</span>, <span class="st">".200"</span>)),</span>
<span id="cb55-618"><a href="#cb55-618" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">factor</span>(Transitions, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mover"</span>, <span class="st">"Stayer"</span>))</span>
<span id="cb55-619"><a href="#cb55-619" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-620"><a href="#cb55-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-621"><a href="#cb55-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-622"><a href="#cb55-622" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculate Violations</span></span>
<span id="cb55-623"><a href="#cb55-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-624"><a href="#cb55-624" aria-hidden="true" tabindex="-1"></a>*Calculate Violation Percentages per Condition*</span>
<span id="cb55-625"><a href="#cb55-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-628"><a href="#cb55-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-629"><a href="#cb55-629" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "calculate-violations"</span></span>
<span id="cb55-630"><a href="#cb55-630" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-631"><a href="#cb55-631" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-632"><a href="#cb55-632" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-633"><a href="#cb55-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-634"><a href="#cb55-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-635"><a href="#cb55-635" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Summarize violations per condition</span></span>
<span id="cb55-636"><a href="#cb55-636" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb55-637"><a href="#cb55-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-638"><a href="#cb55-638" aria-hidden="true" tabindex="-1"></a>    <span class="at">Any_Violation =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Any_Violation), <span class="dv">0</span>, Any_Violation),</span>
<span id="cb55-639"><a href="#cb55-639" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorFlag =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(ErrorFlag), <span class="dv">0</span>, ErrorFlag)  <span class="co"># Ensure no missing values for ErrorFlag</span></span>
<span id="cb55-640"><a href="#cb55-640" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-641"><a href="#cb55-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName, Population, N) <span class="sc">%&gt;%</span></span>
<span id="cb55-642"><a href="#cb55-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb55-643"><a href="#cb55-643" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> <span class="fu">n</span>(),                                <span class="co"># Total runs</span></span>
<span id="cb55-644"><a href="#cb55-644" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Violations =</span> <span class="fu">sum</span>(Any_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Total violations</span></span>
<span id="cb55-645"><a href="#cb55-645" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Errors =</span> <span class="fu">sum</span>(ErrorFlag, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),         <span class="co"># Total errors from ErrorFlag</span></span>
<span id="cb55-646"><a href="#cb55-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage_Violations =</span> (Total_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="co"># % violations</span></span>
<span id="cb55-647"><a href="#cb55-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb55-648"><a href="#cb55-648" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-649"><a href="#cb55-649" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Calculate Replications Needed for label switching</span></span>
<span id="cb55-650"><a href="#cb55-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-651"><a href="#cb55-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, <span class="fu">as.character</span>(N))), </span>
<span id="cb55-652"><a href="#cb55-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">Additional_Runs =</span> (<span class="dv">500</span> <span class="sc">+</span> Total_Violations) <span class="sc">*</span> (Percentage_Violations <span class="sc">/</span> <span class="dv">100</span>), </span>
<span id="cb55-653"><a href="#cb55-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replications_Needed =</span> <span class="fu">ceiling</span>(<span class="dv">500</span> <span class="sc">+</span> Total_Violations <span class="sc">+</span> Additional_Runs <span class="sc">+</span> <span class="dv">20</span>),</span>
<span id="cb55-654"><a href="#cb55-654" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replications_Needed =</span> <span class="fu">if_else</span>(Replications_Needed <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="dv">500</span>, Replications_Needed),</span>
<span id="cb55-655"><a href="#cb55-655" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> Total_Errors <span class="sc">/</span> Total_Rows,  <span class="co"># Calculate ErrorRate directly</span></span>
<span id="cb55-656"><a href="#cb55-656" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adjusted_Replications_Needed =</span> <span class="fu">ceiling</span>(Replications_Needed <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> ErrorRate)),</span>
<span id="cb55-657"><a href="#cb55-657" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adjusted_Replications_Needed =</span> <span class="fu">if_else</span>(Adjusted_Replications_Needed <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="dv">500</span>, Adjusted_Replications_Needed)</span>
<span id="cb55-658"><a href="#cb55-658" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-659"><a href="#cb55-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb55-660"><a href="#cb55-660" aria-hidden="true" tabindex="-1"></a>    FileName, Population, N, N_numeric,</span>
<span id="cb55-661"><a href="#cb55-661" aria-hidden="true" tabindex="-1"></a>    Total_Rows, Total_Violations, Total_Errors, ErrorRate,</span>
<span id="cb55-662"><a href="#cb55-662" aria-hidden="true" tabindex="-1"></a>    Percentage_Violations, Replications_Needed, Adjusted_Replications_Needed</span>
<span id="cb55-663"><a href="#cb55-663" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-664"><a href="#cb55-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-665"><a href="#cb55-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-666"><a href="#cb55-666" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarize &amp; Visualize Label Switching Percentage Results</span></span>
<span id="cb55-667"><a href="#cb55-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-670"><a href="#cb55-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-671"><a href="#cb55-671" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "summarize-violations"</span></span>
<span id="cb55-672"><a href="#cb55-672" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-673"><a href="#cb55-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-674"><a href="#cb55-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-675"><a href="#cb55-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-676"><a href="#cb55-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-677"><a href="#cb55-677" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure correct column names and assign TPs (logits) based on Population (for display and MplusAutomation)</span></span>
<span id="cb55-678"><a href="#cb55-678" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb55-679"><a href="#cb55-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-680"><a href="#cb55-680" aria-hidden="true" tabindex="-1"></a>    <span class="at">TPs =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-681"><a href="#cb55-681" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">~</span> <span class="fl">1.385</span>,</span>
<span id="cb55-682"><a href="#cb55-682" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".700"</span> <span class="sc">~</span> <span class="fl">0.85</span>,</span>
<span id="cb55-683"><a href="#cb55-683" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".600"</span> <span class="sc">~</span> <span class="fl">0.41</span>,</span>
<span id="cb55-684"><a href="#cb55-684" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".400"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.41</span>,</span>
<span id="cb55-685"><a href="#cb55-685" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".300"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.85</span>,</span>
<span id="cb55-686"><a href="#cb55-686" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">1.385</span>,</span>
<span id="cb55-687"><a href="#cb55-687" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb55-688"><a href="#cb55-688" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-689"><a href="#cb55-689" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-690"><a href="#cb55-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-691"><a href="#cb55-691" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, create the table with formatted output</span></span>
<span id="cb55-692"><a href="#cb55-692" aria-hidden="true" tabindex="-1"></a>create_model_table <span class="ot">&lt;-</span> <span class="cf">function</span>(data, model) {</span>
<span id="cb55-693"><a href="#cb55-693" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb55-694"><a href="#cb55-694" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb55-695"><a href="#cb55-695" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Transition Probability</span><span class="st">`</span> <span class="ot">=</span> Population,  <span class="co"># Show transition probabilities</span></span>
<span id="cb55-696"><a href="#cb55-696" aria-hidden="true" tabindex="-1"></a>      TPs,                       <span class="co"># Logit values for MplusAutomation</span></span>
<span id="cb55-697"><a href="#cb55-697" aria-hidden="true" tabindex="-1"></a>      N, </span>
<span id="cb55-698"><a href="#cb55-698" aria-hidden="true" tabindex="-1"></a>      N_numeric,                 <span class="co"># Consistent naming for MplusAutomation</span></span>
<span id="cb55-699"><a href="#cb55-699" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Mplus Runs</span><span class="st">`</span> <span class="ot">=</span> Total_Rows,  <span class="co"># Total number of Mplus runs</span></span>
<span id="cb55-700"><a href="#cb55-700" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Violations</span><span class="st">`</span> <span class="ot">=</span> Total_Violations,  <span class="co"># Show total violations</span></span>
<span id="cb55-701"><a href="#cb55-701" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">% of Violations</span><span class="st">`</span> <span class="ot">=</span> Percentage_Violations, <span class="co"># Violation percentage</span></span>
<span id="cb55-702"><a href="#cb55-702" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Errors</span><span class="st">`</span> <span class="ot">=</span> Total_Errors,           <span class="co">#Total Errors#</span></span>
<span id="cb55-703"><a href="#cb55-703" aria-hidden="true" tabindex="-1"></a>      ErrorRate,              <span class="co"># Include the error rate</span></span>
<span id="cb55-704"><a href="#cb55-704" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Replications Needed</span><span class="st">`</span> <span class="ot">=</span> Replications_Needed,       <span class="co"># Include the calculated replications needed</span></span>
<span id="cb55-705"><a href="#cb55-705" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Adjusted Replications Needed</span><span class="st">`</span> <span class="ot">=</span> Adjusted_Replications_Needed  <span class="co"># Include the adjusted replications needed</span></span>
<span id="cb55-706"><a href="#cb55-706" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-707"><a href="#cb55-707" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-708"><a href="#cb55-708" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb55-709"><a href="#cb55-709" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Monte Carlo Results:"</span>,</span>
<span id="cb55-710"><a href="#cb55-710" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Percentage of Cases with Label Switching and Replications Needed"</span></span>
<span id="cb55-711"><a href="#cb55-711" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-712"><a href="#cb55-712" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb55-713"><a href="#cb55-713" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"center"</span>,  <span class="co"># Center all columns</span></span>
<span id="cb55-714"><a href="#cb55-714" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb55-715"><a href="#cb55-715" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-716"><a href="#cb55-716" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_options</span>(</span>
<span id="cb55-717"><a href="#cb55-717" aria-hidden="true" tabindex="-1"></a>      <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">4</span>)  <span class="co"># Set padding between rows</span></span>
<span id="cb55-718"><a href="#cb55-718" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-719"><a href="#cb55-719" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb55-720"><a href="#cb55-720" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>),  <span class="co"># Center align the headers only</span></span>
<span id="cb55-721"><a href="#cb55-721" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">everything</span>())  <span class="co"># Apply to headers only</span></span>
<span id="cb55-722"><a href="#cb55-722" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-723"><a href="#cb55-723" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-724"><a href="#cb55-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-725"><a href="#cb55-725" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and display the table</span></span>
<span id="cb55-726"><a href="#cb55-726" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> <span class="fu">create_model_table</span>(violation_summary)</span>
<span id="cb55-727"><a href="#cb55-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-728"><a href="#cb55-728" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the final table</span></span>
<span id="cb55-729"><a href="#cb55-729" aria-hidden="true" tabindex="-1"></a>final_table</span>
<span id="cb55-730"><a href="#cb55-730" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-731"><a href="#cb55-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-732"><a href="#cb55-732" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-733"><a href="#cb55-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-734"><a href="#cb55-734" aria-hidden="true" tabindex="-1"></a><span class="fu"># Re-Run Simulation</span></span>
<span id="cb55-735"><a href="#cb55-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-736"><a href="#cb55-736" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-737"><a href="#cb55-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-738"><a href="#cb55-738" aria-hidden="true" tabindex="-1"></a><span class="fu">### Re-Run Simulation with Dynamic Replication Conditions</span></span>
<span id="cb55-739"><a href="#cb55-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-740"><a href="#cb55-740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,eval = FALSE}</span></span>
<span id="cb55-741"><a href="#cb55-741" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: "lta-rilta-simulation2"</span></span>
<span id="cb55-742"><a href="#cb55-742" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb55-743"><a href="#cb55-743" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb55-744"><a href="#cb55-744" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb55-745"><a href="#cb55-745" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb55-746"><a href="#cb55-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-747"><a href="#cb55-747" aria-hidden="true" tabindex="-1"></a><span class="in">  # Define the Mplus object with the dynamic replications</span></span>
<span id="cb55-748"><a href="#cb55-748" aria-hidden="true" tabindex="-1"></a><span class="in">lta_rilta_func &lt;- function(N_numeric, TPs, Replications_Needed) {</span></span>
<span id="cb55-749"><a href="#cb55-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-750"><a href="#cb55-750" aria-hidden="true" tabindex="-1"></a><span class="in">  # Manually construct the MONTECARLO section with dynamic NREPS</span></span>
<span id="cb55-751"><a href="#cb55-751" aria-hidden="true" tabindex="-1"></a><span class="in">  montecarlo_section &lt;- glue("</span></span>
<span id="cb55-752"><a href="#cb55-752" aria-hidden="true" tabindex="-1"></a><span class="in">    NAMES = u11-u15 u21-u25;</span></span>
<span id="cb55-753"><a href="#cb55-753" aria-hidden="true" tabindex="-1"></a><span class="in">    GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb55-754"><a href="#cb55-754" aria-hidden="true" tabindex="-1"></a><span class="in">    CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb55-755"><a href="#cb55-755" aria-hidden="true" tabindex="-1"></a><span class="in">    GENCLASSES = c1(2) c2(2);</span></span>
<span id="cb55-756"><a href="#cb55-756" aria-hidden="true" tabindex="-1"></a><span class="in">    CLASSES = c1(2) c2(2);</span></span>
<span id="cb55-757"><a href="#cb55-757" aria-hidden="true" tabindex="-1"></a><span class="in">    NOBSERVATIONS = {N_numeric};</span></span>
<span id="cb55-758"><a href="#cb55-758" aria-hidden="true" tabindex="-1"></a><span class="in">    SEED = 07252005;</span></span>
<span id="cb55-759"><a href="#cb55-759" aria-hidden="true" tabindex="-1"></a><span class="in">    NREPS = {Replications_Needed};  ! Dynamic number of replications</span></span>
<span id="cb55-760"><a href="#cb55-760" aria-hidden="true" tabindex="-1"></a><span class="in">    !!SAVE = repM1*.dat;</span></span>
<span id="cb55-761"><a href="#cb55-761" aria-hidden="true" tabindex="-1"></a><span class="in">    RESULTS = LTA_RILTA_N_{N_numeric}_TP_{TPs}_TH_1_WD.csv;</span></span>
<span id="cb55-762"><a href="#cb55-762" aria-hidden="true" tabindex="-1"></a><span class="in">  ")</span></span>
<span id="cb55-763"><a href="#cb55-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-764"><a href="#cb55-764" aria-hidden="true" tabindex="-1"></a><span class="in">  # Define the Mplus model using MplusAutomation, using glue for the content</span></span>
<span id="cb55-765"><a href="#cb55-765" aria-hidden="true" tabindex="-1"></a><span class="in">  LTA_RILTA &lt;- mplusObject(</span></span>
<span id="cb55-766"><a href="#cb55-766" aria-hidden="true" tabindex="-1"></a><span class="in">    TITLE = glue("Generate LTA_RILTA_N_{N_numeric}_TP_{TPs}_TH_1;"),</span></span>
<span id="cb55-767"><a href="#cb55-767" aria-hidden="true" tabindex="-1"></a><span class="in">    MONTECARLO = montecarlo_section,  # Use the dynamically constructed MONTECARLO section</span></span>
<span id="cb55-768"><a href="#cb55-768" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb55-769"><a href="#cb55-769" aria-hidden="true" tabindex="-1"></a><span class="in">    ANALYSIS = "</span></span>
<span id="cb55-770"><a href="#cb55-770" aria-hidden="true" tabindex="-1"></a><span class="in">      TYPE = MIXTURE;</span></span>
<span id="cb55-771"><a href="#cb55-771" aria-hidden="true" tabindex="-1"></a><span class="in">      algorithm = integration;</span></span>
<span id="cb55-772"><a href="#cb55-772" aria-hidden="true" tabindex="-1"></a><span class="in">      processors = 24;</span></span>
<span id="cb55-773"><a href="#cb55-773" aria-hidden="true" tabindex="-1"></a><span class="in">      starts = 50 10;</span></span>
<span id="cb55-774"><a href="#cb55-774" aria-hidden="true" tabindex="-1"></a><span class="in">      logcriterion = 0.00001;</span></span>
<span id="cb55-775"><a href="#cb55-775" aria-hidden="true" tabindex="-1"></a><span class="in">      mconv = 0.00001;</span></span>
<span id="cb55-776"><a href="#cb55-776" aria-hidden="true" tabindex="-1"></a><span class="in">    ",</span></span>
<span id="cb55-777"><a href="#cb55-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-778"><a href="#cb55-778" aria-hidden="true" tabindex="-1"></a><span class="in">    MODELPOPULATION = glue("</span></span>
<span id="cb55-779"><a href="#cb55-779" aria-hidden="true" tabindex="-1"></a><span class="in">      %OVERALL%</span></span>
<span id="cb55-780"><a href="#cb55-780" aria-hidden="true" tabindex="-1"></a><span class="in">      [c1#1-c2#1*0];</span></span>
<span id="cb55-781"><a href="#cb55-781" aria-hidden="true" tabindex="-1"></a><span class="in">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb55-782"><a href="#cb55-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-783"><a href="#cb55-783" aria-hidden="true" tabindex="-1"></a><span class="in">      MODEL POPULATION-c1:</span></span>
<span id="cb55-784"><a href="#cb55-784" aria-hidden="true" tabindex="-1"></a><span class="in">      %c1#1%</span></span>
<span id="cb55-785"><a href="#cb55-785" aria-hidden="true" tabindex="-1"></a><span class="in">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb55-786"><a href="#cb55-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-787"><a href="#cb55-787" aria-hidden="true" tabindex="-1"></a><span class="in">      %c1#2%</span></span>
<span id="cb55-788"><a href="#cb55-788" aria-hidden="true" tabindex="-1"></a><span class="in">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb55-789"><a href="#cb55-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-790"><a href="#cb55-790" aria-hidden="true" tabindex="-1"></a><span class="in">      MODEL POPULATION-c2:</span></span>
<span id="cb55-791"><a href="#cb55-791" aria-hidden="true" tabindex="-1"></a><span class="in">      %c2#1%</span></span>
<span id="cb55-792"><a href="#cb55-792" aria-hidden="true" tabindex="-1"></a><span class="in">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb55-793"><a href="#cb55-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-794"><a href="#cb55-794" aria-hidden="true" tabindex="-1"></a><span class="in">      %c2#2%</span></span>
<span id="cb55-795"><a href="#cb55-795" aria-hidden="true" tabindex="-1"></a><span class="in">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb55-796"><a href="#cb55-796" aria-hidden="true" tabindex="-1"></a><span class="in">    "),</span></span>
<span id="cb55-797"><a href="#cb55-797" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb55-798"><a href="#cb55-798" aria-hidden="true" tabindex="-1"></a><span class="in">    MODEL = glue("</span></span>
<span id="cb55-799"><a href="#cb55-799" aria-hidden="true" tabindex="-1"></a><span class="in">      %OVERALL%</span></span>
<span id="cb55-800"><a href="#cb55-800" aria-hidden="true" tabindex="-1"></a><span class="in">      [c1#1-c2#1*0](par1-par2);</span></span>
<span id="cb55-801"><a href="#cb55-801" aria-hidden="true" tabindex="-1"></a><span class="in">      c2#1 on c1#1*{TPs} (par11);</span></span>
<span id="cb55-802"><a href="#cb55-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-803"><a href="#cb55-803" aria-hidden="true" tabindex="-1"></a><span class="in">      f by u11* u12 u13 u14-u15 (p1-p5)</span></span>
<span id="cb55-804"><a href="#cb55-804" aria-hidden="true" tabindex="-1"></a><span class="in">           u21 u22 u23 u24 u25 (p1-p5);</span></span>
<span id="cb55-805"><a href="#cb55-805" aria-hidden="true" tabindex="-1"></a><span class="in">      f@1;</span></span>
<span id="cb55-806"><a href="#cb55-806" aria-hidden="true" tabindex="-1"></a><span class="in">      [f@0];</span></span>
<span id="cb55-807"><a href="#cb55-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-808"><a href="#cb55-808" aria-hidden="true" tabindex="-1"></a><span class="in">      MODEL c1:</span></span>
<span id="cb55-809"><a href="#cb55-809" aria-hidden="true" tabindex="-1"></a><span class="in">      %c1#1%</span></span>
<span id="cb55-810"><a href="#cb55-810" aria-hidden="true" tabindex="-1"></a><span class="in">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb55-811"><a href="#cb55-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-812"><a href="#cb55-812" aria-hidden="true" tabindex="-1"></a><span class="in">      %c1#2%</span></span>
<span id="cb55-813"><a href="#cb55-813" aria-hidden="true" tabindex="-1"></a><span class="in">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb55-814"><a href="#cb55-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-815"><a href="#cb55-815" aria-hidden="true" tabindex="-1"></a><span class="in">      MODEL c2:</span></span>
<span id="cb55-816"><a href="#cb55-816" aria-hidden="true" tabindex="-1"></a><span class="in">      %c2#1%</span></span>
<span id="cb55-817"><a href="#cb55-817" aria-hidden="true" tabindex="-1"></a><span class="in">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb55-818"><a href="#cb55-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-819"><a href="#cb55-819" aria-hidden="true" tabindex="-1"></a><span class="in">      %c2#2%</span></span>
<span id="cb55-820"><a href="#cb55-820" aria-hidden="true" tabindex="-1"></a><span class="in">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb55-821"><a href="#cb55-821" aria-hidden="true" tabindex="-1"></a><span class="in">    "),</span></span>
<span id="cb55-822"><a href="#cb55-822" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb55-823"><a href="#cb55-823" aria-hidden="true" tabindex="-1"></a><span class="in">    MODELCONSTRAINT =</span></span>
<span id="cb55-824"><a href="#cb55-824" aria-hidden="true" tabindex="-1"></a><span class="in">      if (TPs == 1.385) {</span></span>
<span id="cb55-825"><a href="#cb55-825" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-826"><a href="#cb55-826" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb55-827"><a href="#cb55-827" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.80 trans12*.20 trans21*.5 trans22*.5</span></span>
<span id="cb55-828"><a href="#cb55-828" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.65 prob22*.35);</span></span>
<span id="cb55-829"><a href="#cb55-829" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-830"><a href="#cb55-830" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-831"><a href="#cb55-831" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-832"><a href="#cb55-832" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-833"><a href="#cb55-833" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-834"><a href="#cb55-834" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-835"><a href="#cb55-835" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-836"><a href="#cb55-836" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-837"><a href="#cb55-837" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb55-838"><a href="#cb55-838" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb55-839"><a href="#cb55-839" aria-hidden="true" tabindex="-1"></a><span class="in">      } </span></span>
<span id="cb55-840"><a href="#cb55-840" aria-hidden="true" tabindex="-1"></a><span class="in">             else if (TPs == .85) {</span></span>
<span id="cb55-841"><a href="#cb55-841" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-842"><a href="#cb55-842" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb55-843"><a href="#cb55-843" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.70 trans12*.30 trans21*.5 trans22*.5</span></span>
<span id="cb55-844"><a href="#cb55-844" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.60 prob22*.4);</span></span>
<span id="cb55-845"><a href="#cb55-845" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-846"><a href="#cb55-846" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-847"><a href="#cb55-847" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-848"><a href="#cb55-848" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-849"><a href="#cb55-849" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-850"><a href="#cb55-850" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-851"><a href="#cb55-851" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-852"><a href="#cb55-852" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-853"><a href="#cb55-853" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb55-854"><a href="#cb55-854" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb55-855"><a href="#cb55-855" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb55-856"><a href="#cb55-856" aria-hidden="true" tabindex="-1"></a><span class="in">            else  if (TPs == .41) {</span></span>
<span id="cb55-857"><a href="#cb55-857" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-858"><a href="#cb55-858" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb55-859"><a href="#cb55-859" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.60 trans12*.40 trans21*.5 trans22*.5</span></span>
<span id="cb55-860"><a href="#cb55-860" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.55 prob22*.45);</span></span>
<span id="cb55-861"><a href="#cb55-861" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-862"><a href="#cb55-862" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-863"><a href="#cb55-863" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-864"><a href="#cb55-864" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-865"><a href="#cb55-865" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-866"><a href="#cb55-866" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-867"><a href="#cb55-867" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-868"><a href="#cb55-868" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-869"><a href="#cb55-869" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb55-870"><a href="#cb55-870" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb55-871"><a href="#cb55-871" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb55-872"><a href="#cb55-872" aria-hidden="true" tabindex="-1"></a><span class="in">             else if (TPs == -.41) {</span></span>
<span id="cb55-873"><a href="#cb55-873" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-874"><a href="#cb55-874" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb55-875"><a href="#cb55-875" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.40 trans12*.60 trans21*.5 trans22*.5</span></span>
<span id="cb55-876"><a href="#cb55-876" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.45 prob22*.55);</span></span>
<span id="cb55-877"><a href="#cb55-877" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-878"><a href="#cb55-878" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-879"><a href="#cb55-879" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-880"><a href="#cb55-880" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-881"><a href="#cb55-881" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-882"><a href="#cb55-882" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-883"><a href="#cb55-883" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-884"><a href="#cb55-884" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-885"><a href="#cb55-885" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb55-886"><a href="#cb55-886" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb55-887"><a href="#cb55-887" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb55-888"><a href="#cb55-888" aria-hidden="true" tabindex="-1"></a><span class="in">             else if (TPs == -.85) {</span></span>
<span id="cb55-889"><a href="#cb55-889" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-890"><a href="#cb55-890" aria-hidden="true" tabindex="-1"></a><span class="in">        New(</span></span>
<span id="cb55-891"><a href="#cb55-891" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.30 trans12*.70 trans21*.5 trans22*.5</span></span>
<span id="cb55-892"><a href="#cb55-892" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.40 prob22*.60);</span></span>
<span id="cb55-893"><a href="#cb55-893" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-894"><a href="#cb55-894" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-895"><a href="#cb55-895" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-896"><a href="#cb55-896" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-897"><a href="#cb55-897" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-898"><a href="#cb55-898" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-899"><a href="#cb55-899" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-900"><a href="#cb55-900" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-901"><a href="#cb55-901" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;</span></span>
<span id="cb55-902"><a href="#cb55-902" aria-hidden="true" tabindex="-1"></a><span class="in">        ")</span></span>
<span id="cb55-903"><a href="#cb55-903" aria-hidden="true" tabindex="-1"></a><span class="in">              } </span></span>
<span id="cb55-904"><a href="#cb55-904" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb55-905"><a href="#cb55-905" aria-hidden="true" tabindex="-1"></a><span class="in">        else if (TPs == -1.385) {</span></span>
<span id="cb55-906"><a href="#cb55-906" aria-hidden="true" tabindex="-1"></a><span class="in">        glue("</span></span>
<span id="cb55-907"><a href="#cb55-907" aria-hidden="true" tabindex="-1"></a><span class="in">         New(</span></span>
<span id="cb55-908"><a href="#cb55-908" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11*.20 trans12*.80 trans21*.5 trans22*.5</span></span>
<span id="cb55-909"><a href="#cb55-909" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11*.5 prob12*.5 prob21*.35 prob22*.65);</span></span>
<span id="cb55-910"><a href="#cb55-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-911"><a href="#cb55-911" aria-hidden="true" tabindex="-1"></a><span class="in">        trans11 = 1/(1+exp(-(par2+par11)));</span></span>
<span id="cb55-912"><a href="#cb55-912" aria-hidden="true" tabindex="-1"></a><span class="in">        trans12 = 1-trans11;</span></span>
<span id="cb55-913"><a href="#cb55-913" aria-hidden="true" tabindex="-1"></a><span class="in">        trans21 = 1/(1+exp(-par2));</span></span>
<span id="cb55-914"><a href="#cb55-914" aria-hidden="true" tabindex="-1"></a><span class="in">        trans22 = 1- trans21;</span></span>
<span id="cb55-915"><a href="#cb55-915" aria-hidden="true" tabindex="-1"></a><span class="in">        !marginal probabilities at T1 and T2:</span></span>
<span id="cb55-916"><a href="#cb55-916" aria-hidden="true" tabindex="-1"></a><span class="in">        prob11 = 1/(1+exp(-par1));</span></span>
<span id="cb55-917"><a href="#cb55-917" aria-hidden="true" tabindex="-1"></a><span class="in">        prob12 = 1 - prob11;</span></span>
<span id="cb55-918"><a href="#cb55-918" aria-hidden="true" tabindex="-1"></a><span class="in">        prob21 = prob11*trans11+prob12*trans21;</span></span>
<span id="cb55-919"><a href="#cb55-919" aria-hidden="true" tabindex="-1"></a><span class="in">        prob22 = 1- prob21;")</span></span>
<span id="cb55-920"><a href="#cb55-920" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb55-921"><a href="#cb55-921" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb55-922"><a href="#cb55-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-923"><a href="#cb55-923" aria-hidden="true" tabindex="-1"></a><span class="in">  # Run the Mplus model using MplusAutomation</span></span>
<span id="cb55-924"><a href="#cb55-924" aria-hidden="true" tabindex="-1"></a><span class="in">  LTA_RILTA_Model &lt;- mplusModeler(LTA_RILTA,</span></span>
<span id="cb55-925"><a href="#cb55-925" aria-hidden="true" tabindex="-1"></a><span class="in">                                  dataout = here("2 2T LTA GEN RILTA ANALYZED_REP", glue("LTA_RILTA_N_{N_numeric}_TP_{TPs}_TH_1_WD.dat")),</span></span>
<span id="cb55-926"><a href="#cb55-926" aria-hidden="true" tabindex="-1"></a><span class="in">                                  modelout = here("2 2T LTA GEN RILTA ANALYZED_REP", glue("LTA_RILTA_N_{N_numeric}_TP_{TPs}_TH_1_WD.inp")),</span></span>
<span id="cb55-927"><a href="#cb55-927" aria-hidden="true" tabindex="-1"></a><span class="in">                                  run = 1, check = TRUE)</span></span>
<span id="cb55-928"><a href="#cb55-928" aria-hidden="true" tabindex="-1"></a><span class="in">  return(LTA_RILTA_Model)</span></span>
<span id="cb55-929"><a href="#cb55-929" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb55-930"><a href="#cb55-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-931"><a href="#cb55-931" aria-hidden="true" tabindex="-1"></a><span class="in">library(parallel)</span></span>
<span id="cb55-932"><a href="#cb55-932" aria-hidden="true" tabindex="-1"></a><span class="in"># Start the cluster</span></span>
<span id="cb55-933"><a href="#cb55-933" aria-hidden="true" tabindex="-1"></a><span class="in">num_cores &lt;- detectCores() - 1</span></span>
<span id="cb55-934"><a href="#cb55-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-935"><a href="#cb55-935" aria-hidden="true" tabindex="-1"></a><span class="in"># Step 2: Select the cluster type based on the system (PSOCK for Windows, FORK for macOS/Linux)</span></span>
<span id="cb55-936"><a href="#cb55-936" aria-hidden="true" tabindex="-1"></a><span class="in">cluster_type &lt;- ifelse(.Platform$OS.type == "windows", "PSOCK", "FORK")</span></span>
<span id="cb55-937"><a href="#cb55-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-938"><a href="#cb55-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-939"><a href="#cb55-939" aria-hidden="true" tabindex="-1"></a><span class="in">cl &lt;- makeCluster(num_cores, type = cluster_type)</span></span>
<span id="cb55-940"><a href="#cb55-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-941"><a href="#cb55-941" aria-hidden="true" tabindex="-1"></a><span class="in"># Export necessary objects to the cluster</span></span>
<span id="cb55-942"><a href="#cb55-942" aria-hidden="true" tabindex="-1"></a><span class="in">clusterExport(cl, c("lta_rilta_func", "violation_summary", "here", "glue", "mplusModeler", "mplusObject"))</span></span>
<span id="cb55-943"><a href="#cb55-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-944"><a href="#cb55-944" aria-hidden="true" tabindex="-1"></a><span class="in"># Ensure required libraries are loaded on each node</span></span>
<span id="cb55-945"><a href="#cb55-945" aria-hidden="true" tabindex="-1"></a><span class="in">clusterEvalQ(cl, {</span></span>
<span id="cb55-946"><a href="#cb55-946" aria-hidden="true" tabindex="-1"></a><span class="in">  library(MplusAutomation)</span></span>
<span id="cb55-947"><a href="#cb55-947" aria-hidden="true" tabindex="-1"></a><span class="in">  library(glue)</span></span>
<span id="cb55-948"><a href="#cb55-948" aria-hidden="true" tabindex="-1"></a><span class="in">  library(here)</span></span>
<span id="cb55-949"><a href="#cb55-949" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb55-950"><a href="#cb55-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-951"><a href="#cb55-951" aria-hidden="true" tabindex="-1"></a><span class="in">result_list &lt;- parLapply(cl, 1:nrow(violation_summary), function(i) {</span></span>
<span id="cb55-952"><a href="#cb55-952" aria-hidden="true" tabindex="-1"></a><span class="in">  lta_rilta_func(</span></span>
<span id="cb55-953"><a href="#cb55-953" aria-hidden="true" tabindex="-1"></a><span class="in">    violation_summary$N_numeric[i], </span></span>
<span id="cb55-954"><a href="#cb55-954" aria-hidden="true" tabindex="-1"></a><span class="in">    violation_summary$TPs[i],  </span></span>
<span id="cb55-955"><a href="#cb55-955" aria-hidden="true" tabindex="-1"></a><span class="in">    violation_summary$Replications_Needed[i]</span></span>
<span id="cb55-956"><a href="#cb55-956" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb55-957"><a href="#cb55-957" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb55-958"><a href="#cb55-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-959"><a href="#cb55-959" aria-hidden="true" tabindex="-1"></a><span class="in"># Stop the cluster after the simulation</span></span>
<span id="cb55-960"><a href="#cb55-960" aria-hidden="true" tabindex="-1"></a><span class="in">stopCluster(cl)</span></span>
<span id="cb55-961"><a href="#cb55-961" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-962"><a href="#cb55-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-963"><a href="#cb55-963" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-964"><a href="#cb55-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-965"><a href="#cb55-965" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check for Label Switching and Errors - Part 2</span></span>
<span id="cb55-966"><a href="#cb55-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-967"><a href="#cb55-967" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In this section: we re conduct the steps for aggregating the label switching and errors to guarantee that we will have at minimum 500 replications per condition.</span></span>
<span id="cb55-968"><a href="#cb55-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-969"><a href="#cb55-969" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-970"><a href="#cb55-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-971"><a href="#cb55-971" aria-hidden="true" tabindex="-1"></a>*Load all CSV files and combine them into a single data frame.*</span>
<span id="cb55-972"><a href="#cb55-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-975"><a href="#cb55-975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-976"><a href="#cb55-976" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "combine-csv-files-parallel2"</span></span>
<span id="cb55-977"><a href="#cb55-977" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-978"><a href="#cb55-978" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-979"><a href="#cb55-979" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-980"><a href="#cb55-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-981"><a href="#cb55-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-982"><a href="#cb55-982" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct CSV directory</span></span>
<span id="cb55-983"><a href="#cb55-983" aria-hidden="true" tabindex="-1"></a>csv_directory <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'2_2T_LTA_GEN_RILTA_ANALYZED_REP'</span>)</span>
<span id="cb55-984"><a href="#cb55-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-985"><a href="#cb55-985" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document</span></span>
<span id="cb55-986"><a href="#cb55-986" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'data_scraping.R'</span>))</span>
<span id="cb55-987"><a href="#cb55-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-988"><a href="#cb55-988" aria-hidden="true" tabindex="-1"></a><span class="co"># Will populate combine_data in global environment</span></span>
<span id="cb55-989"><a href="#cb55-989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-990"><a href="#cb55-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-991"><a href="#cb55-991" aria-hidden="true" tabindex="-1"></a>*Extract data from the appropriate rows from each 9-row chunk and prepare the data for further processing.*</span>
<span id="cb55-992"><a href="#cb55-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-995"><a href="#cb55-995" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-996"><a href="#cb55-996" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "scrape-rows-process-data-parallel2"</span></span>
<span id="cb55-997"><a href="#cb55-997" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-998"><a href="#cb55-998" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-999"><a href="#cb55-999" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1000"><a href="#cb55-1000" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1001"><a href="#cb55-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1002"><a href="#cb55-1002" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Process the data using the child script</span></span>
<span id="cb55-1003"><a href="#cb55-1003" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step2_2t_RILTA.R'</span>))</span>
<span id="cb55-1004"><a href="#cb55-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1005"><a href="#cb55-1005" aria-hidden="true" tabindex="-1"></a><span class="co"># Will will populate final_combined data in global environment</span></span>
<span id="cb55-1006"><a href="#cb55-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1007"><a href="#cb55-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1008"><a href="#cb55-1008" aria-hidden="true" tabindex="-1"></a>*Convert the logits to probabilities and add the known actual values to each row.*</span>
<span id="cb55-1009"><a href="#cb55-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1012"><a href="#cb55-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1013"><a href="#cb55-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "convert-logits-to-probabilities2"</span></span>
<span id="cb55-1014"><a href="#cb55-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1015"><a href="#cb55-1015" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1016"><a href="#cb55-1016" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1017"><a href="#cb55-1017" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1018"><a href="#cb55-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1019"><a href="#cb55-1019" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3 and 4: Process the data and return results</span></span>
<span id="cb55-1020"><a href="#cb55-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'step_3.R'</span>))</span>
<span id="cb55-1021"><a href="#cb55-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1022"><a href="#cb55-1022" aria-hidden="true" tabindex="-1"></a><span class="co"># The objects `final_data_with_actuals` and `violators` should now be in the global environment</span></span>
<span id="cb55-1023"><a href="#cb55-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1024"><a href="#cb55-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1025"><a href="#cb55-1025" aria-hidden="true" tabindex="-1"></a>*Scrape output files for errors*</span>
<span id="cb55-1026"><a href="#cb55-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1029"><a href="#cb55-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1030"><a href="#cb55-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "process-out-files-parallel2"</span></span>
<span id="cb55-1031"><a href="#cb55-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1032"><a href="#cb55-1032" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1033"><a href="#cb55-1033" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1034"><a href="#cb55-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1035"><a href="#cb55-1035" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set the correct output directory for .out files</span></span>
<span id="cb55-1036"><a href="#cb55-1036" aria-hidden="true" tabindex="-1"></a>output_folder <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">'2 Time Points'</span>, <span class="st">'2_2T_LTA_GEN_RILTA_ANALYZED_REP'</span>)</span>
<span id="cb55-1037"><a href="#cb55-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1038"><a href="#cb55-1038" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Source the child document that processes .out files</span></span>
<span id="cb55-1039"><a href="#cb55-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'out_scraping.R'</span>))</span>
<span id="cb55-1040"><a href="#cb55-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1041"><a href="#cb55-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1042"><a href="#cb55-1042" aria-hidden="true" tabindex="-1"></a>*Create Visual Summary of Errors per Condition*</span>
<span id="cb55-1043"><a href="#cb55-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1046"><a href="#cb55-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1047"><a href="#cb55-1047" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "create-table-errors2"</span></span>
<span id="cb55-1048"><a href="#cb55-1048" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1049"><a href="#cb55-1049" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1050"><a href="#cb55-1050" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1051"><a href="#cb55-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1052"><a href="#cb55-1052" aria-hidden="true" tabindex="-1"></a>replication_summary_table <span class="ot">&lt;-</span> replication_summary <span class="sc">%&gt;%</span></span>
<span id="cb55-1053"><a href="#cb55-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-1054"><a href="#cb55-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb55-1055"><a href="#cb55-1055" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Replication Summary"</span>,</span>
<span id="cb55-1056"><a href="#cb55-1056" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Folder: "</span>, output_folder)</span>
<span id="cb55-1057"><a href="#cb55-1057" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1058"><a href="#cb55-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb55-1059"><a href="#cb55-1059" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ErrorRate"</span>),  <span class="co"># Use the actual column name, ensure it matches your dataframe</span></span>
<span id="cb55-1060"><a href="#cb55-1060" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb55-1061"><a href="#cb55-1061" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1062"><a href="#cb55-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb55-1063"><a href="#cb55-1063" aria-hidden="true" tabindex="-1"></a>    <span class="at">FileName =</span> <span class="st">"File Name"</span>,</span>
<span id="cb55-1064"><a href="#cb55-1064" aria-hidden="true" tabindex="-1"></a>    <span class="at">CompletedReplications =</span> <span class="st">"Completed Replications"</span>,</span>
<span id="cb55-1065"><a href="#cb55-1065" aria-hidden="true" tabindex="-1"></a>    <span class="at">RequestedReplications =</span> <span class="st">"Requested Replications"</span>,</span>
<span id="cb55-1066"><a href="#cb55-1066" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorReplications =</span> <span class="st">"Replications with Errors"</span>,</span>
<span id="cb55-1067"><a href="#cb55-1067" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> <span class="st">"Good Replications"</span>,</span>
<span id="cb55-1068"><a href="#cb55-1068" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> <span class="st">"Error Rate (%)"</span></span>
<span id="cb55-1069"><a href="#cb55-1069" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1070"><a href="#cb55-1070" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb55-1071"><a href="#cb55-1071" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb55-1072"><a href="#cb55-1072" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()  <span class="co"># This aligns all columns' text to center</span></span>
<span id="cb55-1073"><a href="#cb55-1073" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1074"><a href="#cb55-1074" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb55-1075"><a href="#cb55-1075" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb55-1076"><a href="#cb55-1076" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="st">"medium"</span>,</span>
<span id="cb55-1077"><a href="#cb55-1077" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="st">"small"</span>,</span>
<span id="cb55-1078"><a href="#cb55-1078" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">80</span>)  <span class="co"># Adjust this percentage to reduce the width of the table</span></span>
<span id="cb55-1079"><a href="#cb55-1079" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-1080"><a href="#cb55-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1081"><a href="#cb55-1081" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb55-1082"><a href="#cb55-1082" aria-hidden="true" tabindex="-1"></a>replication_summary_table</span>
<span id="cb55-1083"><a href="#cb55-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1084"><a href="#cb55-1084" aria-hidden="true" tabindex="-1"></a><span class="co">#Compare rows in both .csv and .out data frames</span></span>
<span id="cb55-1085"><a href="#cb55-1085" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows in final_data_with_actuals:"</span>, <span class="fu">nrow</span>(final_data_with_actuals), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-1086"><a href="#cb55-1086" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the final number of rows to confirm data handling</span></span>
<span id="cb55-1087"><a href="#cb55-1087" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows in error_summary: "</span>, <span class="fu">nrow</span>(error_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-1088"><a href="#cb55-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows in replication_summary: "</span>, <span class="fu">nrow</span>(replication_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-1089"><a href="#cb55-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1090"><a href="#cb55-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1091"><a href="#cb55-1091" aria-hidden="true" tabindex="-1"></a>*Merge Errors with Main Data*</span>
<span id="cb55-1092"><a href="#cb55-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1095"><a href="#cb55-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1096"><a href="#cb55-1096" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "merge-errors2"</span></span>
<span id="cb55-1097"><a href="#cb55-1097" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1098"><a href="#cb55-1098" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1099"><a href="#cb55-1099" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1100"><a href="#cb55-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1101"><a href="#cb55-1101" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Process the data using the child script</span></span>
<span id="cb55-1102"><a href="#cb55-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'merge_errors.R'</span>))</span>
<span id="cb55-1103"><a href="#cb55-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1104"><a href="#cb55-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1105"><a href="#cb55-1105" aria-hidden="true" tabindex="-1"></a>*Create Column Names from the File Name*</span>
<span id="cb55-1106"><a href="#cb55-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1109"><a href="#cb55-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1110"><a href="#cb55-1110" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "create-column-names-from-filename2"</span></span>
<span id="cb55-1111"><a href="#cb55-1111" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1112"><a href="#cb55-1112" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1113"><a href="#cb55-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1114"><a href="#cb55-1114" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1115"><a href="#cb55-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1116"><a href="#cb55-1116" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns based on the information in the FileName and set factors</span></span>
<span id="cb55-1117"><a href="#cb55-1117" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb55-1118"><a href="#cb55-1118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-1119"><a href="#cb55-1119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the sample size (N) from the FileName with the correct values</span></span>
<span id="cb55-1120"><a href="#cb55-1120" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-1121"><a href="#cb55-1121" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_4000"</span>, FileName) <span class="sc">~</span> <span class="dv">4</span>,  <span class="co"># Correct value for N_4000</span></span>
<span id="cb55-1122"><a href="#cb55-1122" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_500"</span>, FileName) <span class="sc">~</span> <span class="dv">1</span>,   </span>
<span id="cb55-1123"><a href="#cb55-1123" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_1000"</span>, FileName) <span class="sc">~</span> <span class="dv">2</span>,  </span>
<span id="cb55-1124"><a href="#cb55-1124" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"n_2000"</span>, FileName) <span class="sc">~</span> <span class="dv">3</span>,  </span>
<span id="cb55-1125"><a href="#cb55-1125" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb55-1126"><a href="#cb55-1126" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-1127"><a href="#cb55-1127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map the TPs from the FileName to the appropriate Population labels</span></span>
<span id="cb55-1128"><a href="#cb55-1128" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-1129"><a href="#cb55-1129" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".800"</span>,</span>
<span id="cb55-1130"><a href="#cb55-1130" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".700"</span>,</span>
<span id="cb55-1131"><a href="#cb55-1131" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".600"</span>,</span>
<span id="cb55-1132"><a href="#cb55-1132" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.41"</span>, FileName) <span class="sc">~</span> <span class="st">".400"</span>,</span>
<span id="cb55-1133"><a href="#cb55-1133" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-0.85"</span>, FileName) <span class="sc">~</span> <span class="st">".300"</span>,</span>
<span id="cb55-1134"><a href="#cb55-1134" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"tp_-1.385"</span>, FileName) <span class="sc">~</span> <span class="st">".200"</span>,</span>
<span id="cb55-1135"><a href="#cb55-1135" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb55-1136"><a href="#cb55-1136" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-1137"><a href="#cb55-1137" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the Transitions variable based on Population values</span></span>
<span id="cb55-1138"><a href="#cb55-1138" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-1139"><a href="#cb55-1139" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".300"</span>, <span class="st">".400"</span>) <span class="sc">~</span> <span class="dv">1</span>,  <span class="co"># Assign 1 for Population .200, .300, .400</span></span>
<span id="cb55-1140"><a href="#cb55-1140" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">".600"</span>, <span class="st">".700"</span>, <span class="st">".800"</span>) <span class="sc">~</span> <span class="dv">2</span>,  <span class="co"># Assign 2 for Population .600, .700, .800</span></span>
<span id="cb55-1141"><a href="#cb55-1141" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb55-1142"><a href="#cb55-1142" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-1143"><a href="#cb55-1143" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1144"><a href="#cb55-1144" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert columns to factors, ordering N_4000 first in the factor levels</span></span>
<span id="cb55-1145"><a href="#cb55-1145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-1146"><a href="#cb55-1146" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"N = 4000"</span>, <span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2000"</span>)),</span>
<span id="cb55-1147"><a href="#cb55-1147" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">".800"</span>, <span class="st">".700"</span>, <span class="st">".600"</span>, <span class="st">".400"</span>, <span class="st">".300"</span>, <span class="st">".200"</span>)),</span>
<span id="cb55-1148"><a href="#cb55-1148" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transitions =</span> <span class="fu">factor</span>(Transitions, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mover"</span>, <span class="st">"Stayer"</span>))</span>
<span id="cb55-1149"><a href="#cb55-1149" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-1150"><a href="#cb55-1150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1151"><a href="#cb55-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1152"><a href="#cb55-1152" aria-hidden="true" tabindex="-1"></a>*Calculate Violation Percentages per Condition*</span>
<span id="cb55-1153"><a href="#cb55-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1156"><a href="#cb55-1156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1157"><a href="#cb55-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "calculate-violations2"</span></span>
<span id="cb55-1158"><a href="#cb55-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1159"><a href="#cb55-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1160"><a href="#cb55-1160" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1161"><a href="#cb55-1161" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1162"><a href="#cb55-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1163"><a href="#cb55-1163" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb55-1164"><a href="#cb55-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-1165"><a href="#cb55-1165" aria-hidden="true" tabindex="-1"></a>    <span class="at">Any_Violation =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Any_Violation), <span class="dv">0</span>, Any_Violation),</span>
<span id="cb55-1166"><a href="#cb55-1166" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorFlag =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(ErrorFlag), <span class="dv">0</span>, ErrorFlag)  <span class="co"># No missing values for ErrorFlag</span></span>
<span id="cb55-1167"><a href="#cb55-1167" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1168"><a href="#cb55-1168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName, Population, N) <span class="sc">%&gt;%</span></span>
<span id="cb55-1169"><a href="#cb55-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb55-1170"><a href="#cb55-1170" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> <span class="fu">n</span>(),                                <span class="co"># Total runs</span></span>
<span id="cb55-1171"><a href="#cb55-1171" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Violations =</span> <span class="fu">sum</span>(Any_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Sum of violations</span></span>
<span id="cb55-1172"><a href="#cb55-1172" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Errors =</span> <span class="fu">sum</span>(ErrorFlag, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),     <span class="co"># Sum of errors</span></span>
<span id="cb55-1173"><a href="#cb55-1173" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage_Violations =</span> (Total_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="co"># Percentage of violations</span></span>
<span id="cb55-1174"><a href="#cb55-1174" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb55-1175"><a href="#cb55-1175" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1176"><a href="#cb55-1176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(replication_summary <span class="sc">%&gt;%</span> <span class="fu">select</span>(FileName, CompletedReplications), <span class="at">by =</span> <span class="st">"FileName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-1177"><a href="#cb55-1177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-1178"><a href="#cb55-1178" aria-hidden="true" tabindex="-1"></a>    <span class="at">CompletedReplications =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(CompletedReplications), <span class="dv">500</span>, CompletedReplications),</span>
<span id="cb55-1179"><a href="#cb55-1179" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, N)),</span>
<span id="cb55-1180"><a href="#cb55-1180" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> CompletedReplications <span class="sc">-</span> Total_Violations <span class="sc">-</span> Total_Errors,</span>
<span id="cb55-1181"><a href="#cb55-1181" aria-hidden="true" tabindex="-1"></a>    <span class="at">GoodReplications =</span> <span class="fu">ifelse</span>(GoodReplications <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, GoodReplications),</span>
<span id="cb55-1182"><a href="#cb55-1182" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reanalysis_Needed =</span> <span class="fu">if_else</span>(GoodReplications <span class="sc">&gt;=</span> <span class="dv">500</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>),  <span class="co"># Flag for reanalysis needed</span></span>
<span id="cb55-1183"><a href="#cb55-1183" aria-hidden="true" tabindex="-1"></a>    <span class="at">ErrorRate =</span> Total_Errors <span class="sc">/</span> Total_Rows,          <span class="co"># Calculate ErrorRate</span></span>
<span id="cb55-1184"><a href="#cb55-1184" aria-hidden="true" tabindex="-1"></a>    <span class="at">Replications_Needed =</span> <span class="fu">ceiling</span>(CompletedReplications <span class="sc">+</span> Total_Violations <span class="sc">+</span> (CompletedReplications <span class="sc">*</span> Percentage_Violations <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="dv">20</span>),</span>
<span id="cb55-1185"><a href="#cb55-1185" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adjusted_Replications_Needed =</span> <span class="fu">ceiling</span>(Replications_Needed <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> ErrorRate))</span>
<span id="cb55-1186"><a href="#cb55-1186" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1187"><a href="#cb55-1187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb55-1188"><a href="#cb55-1188" aria-hidden="true" tabindex="-1"></a>    FileName, Population, N, N_numeric, Total_Rows, Total_Violations,</span>
<span id="cb55-1189"><a href="#cb55-1189" aria-hidden="true" tabindex="-1"></a>    Total_Errors, ErrorRate, Percentage_Violations, GoodReplications,</span>
<span id="cb55-1190"><a href="#cb55-1190" aria-hidden="true" tabindex="-1"></a>    Replications_Needed, Adjusted_Replications_Needed,</span>
<span id="cb55-1191"><a href="#cb55-1191" aria-hidden="true" tabindex="-1"></a>    Reanalysis_Needed</span>
<span id="cb55-1192"><a href="#cb55-1192" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-1193"><a href="#cb55-1193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1194"><a href="#cb55-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1195"><a href="#cb55-1195" aria-hidden="true" tabindex="-1"></a>*Summarize &amp; Visualize Label Switching Percentage Results*</span>
<span id="cb55-1196"><a href="#cb55-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1199"><a href="#cb55-1199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1200"><a href="#cb55-1200" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "summarize-violations2"</span></span>
<span id="cb55-1201"><a href="#cb55-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1202"><a href="#cb55-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1203"><a href="#cb55-1203" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1204"><a href="#cb55-1204" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1205"><a href="#cb55-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1206"><a href="#cb55-1206" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for rows with non-zero error rates and clean N_numeric</span></span>
<span id="cb55-1207"><a href="#cb55-1207" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the TPs assignment to force formatting</span></span>
<span id="cb55-1208"><a href="#cb55-1208" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb55-1209"><a href="#cb55-1209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-1210"><a href="#cb55-1210" aria-hidden="true" tabindex="-1"></a>    <span class="at">TPs =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-1211"><a href="#cb55-1211" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="fl">1.385</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb55-1212"><a href="#cb55-1212" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".700"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="fl">0.85</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb55-1213"><a href="#cb55-1213" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".600"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="fl">0.41</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb55-1214"><a href="#cb55-1214" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".400"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="sc">-</span><span class="fl">0.41</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb55-1215"><a href="#cb55-1215" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".300"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="sc">-</span><span class="fl">0.85</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb55-1216"><a href="#cb55-1216" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">~</span> <span class="fu">formatC</span>(<span class="sc">-</span><span class="fl">1.385</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb55-1217"><a href="#cb55-1217" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb55-1218"><a href="#cb55-1218" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb55-1219"><a href="#cb55-1219" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, <span class="fu">as.character</span>(N)))  <span class="co"># Clean N_numeric by stripping out "N = "</span></span>
<span id="cb55-1220"><a href="#cb55-1220" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-1221"><a href="#cb55-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1222"><a href="#cb55-1222" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize and visualize the final table</span></span>
<span id="cb55-1223"><a href="#cb55-1223" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb55-1224"><a href="#cb55-1224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb55-1225"><a href="#cb55-1225" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Transition Probability</span><span class="st">`</span> <span class="ot">=</span> Population,  <span class="co"># Rename column for clarity</span></span>
<span id="cb55-1226"><a href="#cb55-1226" aria-hidden="true" tabindex="-1"></a>    TPs,  <span class="co"># Logit values</span></span>
<span id="cb55-1227"><a href="#cb55-1227" aria-hidden="true" tabindex="-1"></a>    N_numeric,  <span class="co"># Cleaned sample size</span></span>
<span id="cb55-1228"><a href="#cb55-1228" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Mplus Runs</span><span class="st">`</span> <span class="ot">=</span> Total_Rows,  <span class="co"># Total runs</span></span>
<span id="cb55-1229"><a href="#cb55-1229" aria-hidden="true" tabindex="-1"></a>    Total_Violations,  <span class="co"># Total violations</span></span>
<span id="cb55-1230"><a href="#cb55-1230" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">% of Violations</span><span class="st">`</span> <span class="ot">=</span> Percentage_Violations,  <span class="co"># Violation percentage</span></span>
<span id="cb55-1231"><a href="#cb55-1231" aria-hidden="true" tabindex="-1"></a>    Total_Errors, </span>
<span id="cb55-1232"><a href="#cb55-1232" aria-hidden="true" tabindex="-1"></a>    ErrorRate,  <span class="co"># Error rate</span></span>
<span id="cb55-1233"><a href="#cb55-1233" aria-hidden="true" tabindex="-1"></a>    Replications_Needed,  <span class="co"># Replications needed</span></span>
<span id="cb55-1234"><a href="#cb55-1234" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Adjusted Replications Needed</span><span class="st">`</span> <span class="ot">=</span> Adjusted_Replications_Needed,  <span class="co"># Adjusted replications needed</span></span>
<span id="cb55-1235"><a href="#cb55-1235" aria-hidden="true" tabindex="-1"></a>    Reanalysis_Needed</span>
<span id="cb55-1236"><a href="#cb55-1236" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1237"><a href="#cb55-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-1238"><a href="#cb55-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb55-1239"><a href="#cb55-1239" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Monte Carlo Results:"</span>,</span>
<span id="cb55-1240"><a href="#cb55-1240" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Percentage of Cases with Label Switching and Replications Needed"</span></span>
<span id="cb55-1241"><a href="#cb55-1241" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1242"><a href="#cb55-1242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb55-1243"><a href="#cb55-1243" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,  <span class="co"># Center all columns</span></span>
<span id="cb55-1244"><a href="#cb55-1244" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb55-1245"><a href="#cb55-1245" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1246"><a href="#cb55-1246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb55-1247"><a href="#cb55-1247" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">% of Violations</span><span class="st">`</span>, ErrorRate),</span>
<span id="cb55-1248"><a href="#cb55-1248" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span>  <span class="co"># Ensure these percentages are formatted to 2 decimal places</span></span>
<span id="cb55-1249"><a href="#cb55-1249" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1250"><a href="#cb55-1250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb55-1251"><a href="#cb55-1251" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">4</span>)  <span class="co"># Set padding between rows</span></span>
<span id="cb55-1252"><a href="#cb55-1252" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1253"><a href="#cb55-1253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb55-1254"><a href="#cb55-1254" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>),  <span class="co"># Center align the headers only</span></span>
<span id="cb55-1255"><a href="#cb55-1255" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">everything</span>())  <span class="co"># Apply to headers only</span></span>
<span id="cb55-1256"><a href="#cb55-1256" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-1257"><a href="#cb55-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1258"><a href="#cb55-1258" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb55-1259"><a href="#cb55-1259" aria-hidden="true" tabindex="-1"></a>final_table</span>
<span id="cb55-1260"><a href="#cb55-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1261"><a href="#cb55-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1262"><a href="#cb55-1262" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-1263"><a href="#cb55-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1264"><a href="#cb55-1264" aria-hidden="true" tabindex="-1"></a><span class="fu"># Final Data Preparation</span></span>
<span id="cb55-1265"><a href="#cb55-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1266"><a href="#cb55-1266" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-1267"><a href="#cb55-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1268"><a href="#cb55-1268" aria-hidden="true" tabindex="-1"></a><span class="fu">## Filter Cases with Violations and Errors</span></span>
<span id="cb55-1269"><a href="#cb55-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1270"><a href="#cb55-1270" aria-hidden="true" tabindex="-1"></a>*Filter out cases with any violations, leaving only the clean data.*</span>
<span id="cb55-1271"><a href="#cb55-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1274"><a href="#cb55-1274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1275"><a href="#cb55-1275" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "delete-cases"</span></span>
<span id="cb55-1276"><a href="#cb55-1276" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1277"><a href="#cb55-1277" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1278"><a href="#cb55-1278" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1279"><a href="#cb55-1279" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1280"><a href="#cb55-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1281"><a href="#cb55-1281" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out cases with no violations and no errors</span></span>
<span id="cb55-1282"><a href="#cb55-1282" aria-hidden="true" tabindex="-1"></a>filtered_data_with_no_violations <span class="ot">&lt;-</span> final_data_with_actuals[</span>
<span id="cb55-1283"><a href="#cb55-1283" aria-hidden="true" tabindex="-1"></a>  final_data_with_actuals<span class="sc">$</span>Any_Violation <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> final_data_with_actuals<span class="sc">$</span>ErrorFlag <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb55-1284"><a href="#cb55-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1285"><a href="#cb55-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1286"><a href="#cb55-1286" aria-hidden="true" tabindex="-1"></a><span class="fu">### Randomly Sample 500 Replications</span></span>
<span id="cb55-1287"><a href="#cb55-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1288"><a href="#cb55-1288" aria-hidden="true" tabindex="-1"></a>*Take random sample of replications to achieve n = 500*</span>
<span id="cb55-1289"><a href="#cb55-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1292"><a href="#cb55-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1293"><a href="#cb55-1293" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "select-500-random-replication"</span></span>
<span id="cb55-1294"><a href="#cb55-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1295"><a href="#cb55-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1296"><a href="#cb55-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1297"><a href="#cb55-1297" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1298"><a href="#cb55-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1299"><a href="#cb55-1299" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb55-1300"><a href="#cb55-1300" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">07252005</span>)</span>
<span id="cb55-1301"><a href="#cb55-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1302"><a href="#cb55-1302" aria-hidden="true" tabindex="-1"></a><span class="co"># Check initial counts to ensure each FileName group has at least 500 rows</span></span>
<span id="cb55-1303"><a href="#cb55-1303" aria-hidden="true" tabindex="-1"></a>initial_counts <span class="ot">&lt;-</span> filtered_data_with_no_violations <span class="sc">%&gt;%</span></span>
<span id="cb55-1304"><a href="#cb55-1304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName) <span class="sc">%&gt;%</span></span>
<span id="cb55-1305"><a href="#cb55-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Initial_Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-1306"><a href="#cb55-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()  <span class="co"># Remove any NA values quietly within the pipeline</span></span>
<span id="cb55-1307"><a href="#cb55-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1308"><a href="#cb55-1308" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify groups with insufficient rows</span></span>
<span id="cb55-1309"><a href="#cb55-1309" aria-hidden="true" tabindex="-1"></a>insufficient_groups <span class="ot">&lt;-</span> initial_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Initial_Count <span class="sc">&lt;</span> <span class="dv">500</span>)</span>
<span id="cb55-1310"><a href="#cb55-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1311"><a href="#cb55-1311" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle based on whether insufficient groups exist</span></span>
<span id="cb55-1312"><a href="#cb55-1312" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(insufficient_groups) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb55-1313"><a href="#cb55-1313" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Message to indicate successful operation</span></span>
<span id="cb55-1314"><a href="#cb55-1314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"All FileName groups had at least 500 rows.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-1315"><a href="#cb55-1315" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-1316"><a href="#cb55-1316" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Proceed with sampling</span></span>
<span id="cb55-1317"><a href="#cb55-1317" aria-hidden="true" tabindex="-1"></a>  sampled_data <span class="ot">&lt;-</span> filtered_data_with_no_violations <span class="sc">%&gt;%</span></span>
<span id="cb55-1318"><a href="#cb55-1318" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(FileName) <span class="sc">%&gt;%</span></span>
<span id="cb55-1319"><a href="#cb55-1319" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="dv">500</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-1320"><a href="#cb55-1320" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb55-1321"><a href="#cb55-1321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-1322"><a href="#cb55-1322" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print confirmation that sampling was successful</span></span>
<span id="cb55-1323"><a href="#cb55-1323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Sampling completed successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-1324"><a href="#cb55-1324" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb55-1325"><a href="#cb55-1325" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the groups that don't meet the requirement</span></span>
<span id="cb55-1326"><a href="#cb55-1326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Some FileName groups do not have at least 500 rows. Sampling not performed.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-1327"><a href="#cb55-1327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Groups with insufficient rows:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb55-1328"><a href="#cb55-1328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(insufficient_groups)</span>
<span id="cb55-1329"><a href="#cb55-1329" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-1330"><a href="#cb55-1330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1331"><a href="#cb55-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1332"><a href="#cb55-1332" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-1333"><a href="#cb55-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1334"><a href="#cb55-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculate Monte Carlo Values</span></span>
<span id="cb55-1335"><a href="#cb55-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1336"><a href="#cb55-1336" aria-hidden="true" tabindex="-1"></a>*Calculate Monte Carlo values for&nbsp;`TRANS11`, including population values, averages, standard errors, Mean Squared Error (MSE), coverage, and power*</span>
<span id="cb55-1337"><a href="#cb55-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1340"><a href="#cb55-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1341"><a href="#cb55-1341" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "compute-mc-values"</span></span>
<span id="cb55-1342"><a href="#cb55-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1343"><a href="#cb55-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1344"><a href="#cb55-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1345"><a href="#cb55-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1346"><a href="#cb55-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1347"><a href="#cb55-1347" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Monte Carlo Values</span></span>
<span id="cb55-1348"><a href="#cb55-1348" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">'Child_Docs'</span>, <span class="st">'compute_mc.R'</span>))</span>
<span id="cb55-1349"><a href="#cb55-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1350"><a href="#cb55-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1351"><a href="#cb55-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculate Bias and Dichotomous Variables</span></span>
<span id="cb55-1352"><a href="#cb55-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1353"><a href="#cb55-1353" aria-hidden="true" tabindex="-1"></a>*Calculate dichotomous variables for Power and Coverage, compute Parameter and SE Bias, and prepare subsets for movers and stayers.*</span>
<span id="cb55-1354"><a href="#cb55-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1357"><a href="#cb55-1357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1358"><a href="#cb55-1358" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "calculate-bias-dichotomous-variables"</span></span>
<span id="cb55-1359"><a href="#cb55-1359" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1360"><a href="#cb55-1360" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1361"><a href="#cb55-1361" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1362"><a href="#cb55-1362" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1363"><a href="#cb55-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1364"><a href="#cb55-1364" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Calculate dichotomous variable for Power (1 if Power &gt;= 0.8, else 0)</span></span>
<span id="cb55-1365"><a href="#cb55-1365" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb55-1366"><a href="#cb55-1366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Power_Dic =</span> <span class="fu">ifelse</span>(Power <span class="sc">&gt;=</span> <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb55-1367"><a href="#cb55-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1368"><a href="#cb55-1368" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Calculate dichotomous variable for Coverage (0 if outside [0.91, 0.98], else 1)</span></span>
<span id="cb55-1369"><a href="#cb55-1369" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb55-1370"><a href="#cb55-1370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Coverage_Dic =</span> <span class="fu">ifelse</span>(Coverage <span class="sc">&gt;</span> <span class="fl">0.98</span> <span class="sc">|</span> Coverage <span class="sc">&lt;</span> <span class="fl">0.91</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb55-1371"><a href="#cb55-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1372"><a href="#cb55-1372" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Remove any groupings before further calculations</span></span>
<span id="cb55-1373"><a href="#cb55-1373" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb55-1374"><a href="#cb55-1374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb55-1375"><a href="#cb55-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1376"><a href="#cb55-1376" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Ensure numeric columns are correctly formatted and **convert Population only for calculations**</span></span>
<span id="cb55-1377"><a href="#cb55-1377" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb55-1378"><a href="#cb55-1378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-1379"><a href="#cb55-1379" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep average as numeric but **do not convert Population for display purposes**</span></span>
<span id="cb55-1380"><a href="#cb55-1380" aria-hidden="true" tabindex="-1"></a>    <span class="at">average =</span> <span class="fu">as.numeric</span>(average),</span>
<span id="cb55-1381"><a href="#cb55-1381" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_numeric =</span> <span class="fu">as.numeric</span>(Population),  <span class="co"># Create a temporary numeric version of Population</span></span>
<span id="cb55-1382"><a href="#cb55-1382" aria-hidden="true" tabindex="-1"></a>    <span class="at">average_se =</span> <span class="fu">as.numeric</span>(average_SE),</span>
<span id="cb55-1383"><a href="#cb55-1383" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_sd =</span> <span class="fu">as.numeric</span>(population_sd)</span>
<span id="cb55-1384"><a href="#cb55-1384" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-1385"><a href="#cb55-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1386"><a href="#cb55-1386" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Calculate Parameter Bias and SE Bias, rounding the results to 2 decimal places</span></span>
<span id="cb55-1387"><a href="#cb55-1387" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb55-1388"><a href="#cb55-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-1389"><a href="#cb55-1389" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use population_numeric for the calculations, but **retain Population in the original format**</span></span>
<span id="cb55-1390"><a href="#cb55-1390" aria-hidden="true" tabindex="-1"></a>    <span class="at">Parameter_Bias =</span> (average <span class="sc">-</span> population_numeric) <span class="sc">/</span> population_numeric <span class="sc">*</span> <span class="dv">100</span>,  <span class="co"># Bias for the parameter</span></span>
<span id="cb55-1391"><a href="#cb55-1391" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_Bias =</span> (average_se <span class="sc">-</span> population_sd) <span class="sc">/</span> population_sd <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Bias for the standard error</span></span>
<span id="cb55-1392"><a href="#cb55-1392" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1393"><a href="#cb55-1393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Parameter_Bias, SE_Bias), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">2</span>)))  <span class="co"># Round to 2 decimal places</span></span>
<span id="cb55-1394"><a href="#cb55-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1395"><a href="#cb55-1395" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the temporary numeric population column if no longer needed</span></span>
<span id="cb55-1396"><a href="#cb55-1396" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb55-1397"><a href="#cb55-1397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>population_numeric)</span>
<span id="cb55-1398"><a href="#cb55-1398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1399"><a href="#cb55-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1400"><a href="#cb55-1400" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prepare Data for Visualization</span></span>
<span id="cb55-1401"><a href="#cb55-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1402"><a href="#cb55-1402" aria-hidden="true" tabindex="-1"></a><span class="fu">### Subset Data for Bias Plots</span></span>
<span id="cb55-1403"><a href="#cb55-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1404"><a href="#cb55-1404" aria-hidden="true" tabindex="-1"></a>*Subset the Monte Carlo data into mover transition probabilities (.2, .3, .4) and stayer transition probabilities (.6, .7, .8) based on population values*</span>
<span id="cb55-1405"><a href="#cb55-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1408"><a href="#cb55-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1409"><a href="#cb55-1409" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "subset-data-for-bias-plots"</span></span>
<span id="cb55-1410"><a href="#cb55-1410" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1411"><a href="#cb55-1411" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1412"><a href="#cb55-1412" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1413"><a href="#cb55-1413" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1414"><a href="#cb55-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1415"><a href="#cb55-1415" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming Population is numeric in all_data</span></span>
<span id="cb55-1416"><a href="#cb55-1416" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> mc_values</span>
<span id="cb55-1417"><a href="#cb55-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1418"><a href="#cb55-1418" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that the Population_Label uses numeric levels without leading zeros but assigns expression-based labels</span></span>
<span id="cb55-1419"><a href="#cb55-1419" aria-hidden="true" tabindex="-1"></a>all_data<span class="sc">$</span>Population_Label <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_data<span class="sc">$</span>Population, </span>
<span id="cb55-1420"><a href="#cb55-1420" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>),  <span class="co"># Numeric levels without leading zeros</span></span>
<span id="cb55-1421"><a href="#cb55-1421" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb55-1422"><a href="#cb55-1422" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .200"</span>),</span>
<span id="cb55-1423"><a href="#cb55-1423" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .300"</span>),</span>
<span id="cb55-1424"><a href="#cb55-1424" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .400"</span>),</span>
<span id="cb55-1425"><a href="#cb55-1425" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .600"</span>),</span>
<span id="cb55-1426"><a href="#cb55-1426" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .700"</span>),</span>
<span id="cb55-1427"><a href="#cb55-1427" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">italic</span>(T))[<span class="dv">11</span>] <span class="sc">~</span> <span class="st">" = .800"</span>)</span>
<span id="cb55-1428"><a href="#cb55-1428" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-1429"><a href="#cb55-1429" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-1430"><a href="#cb55-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1431"><a href="#cb55-1431" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset for Transitions movers (already correctly defined as "Mover")</span></span>
<span id="cb55-1432"><a href="#cb55-1432" aria-hidden="true" tabindex="-1"></a>subset_mover <span class="ot">&lt;-</span> <span class="fu">subset</span>(all_data, Transitions <span class="sc">==</span> <span class="st">"Mover"</span>)</span>
<span id="cb55-1433"><a href="#cb55-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1434"><a href="#cb55-1434" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset for Transitions stayers (already correctly defined as "Stayer")</span></span>
<span id="cb55-1435"><a href="#cb55-1435" aria-hidden="true" tabindex="-1"></a>subset_stayer <span class="ot">&lt;-</span> <span class="fu">subset</span>(all_data, Transitions <span class="sc">==</span> <span class="st">"Stayer"</span>)</span>
<span id="cb55-1436"><a href="#cb55-1436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1437"><a href="#cb55-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1438"><a href="#cb55-1438" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prepare Function for Bias Plots</span></span>
<span id="cb55-1439"><a href="#cb55-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1442"><a href="#cb55-1442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1443"><a href="#cb55-1443" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "plot-bias"</span></span>
<span id="cb55-1444"><a href="#cb55-1444" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1445"><a href="#cb55-1445" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1446"><a href="#cb55-1446" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1447"><a href="#cb55-1447" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1448"><a href="#cb55-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1449"><a href="#cb55-1449" aria-hidden="true" tabindex="-1"></a>create_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title_suffix) {</span>
<span id="cb55-1450"><a href="#cb55-1450" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Common theme for the plots</span></span>
<span id="cb55-1451"><a href="#cb55-1451" aria-hidden="true" tabindex="-1"></a>  common_theme <span class="ot">&lt;-</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-1452"><a href="#cb55-1452" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb55-1453"><a href="#cb55-1453" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-1454"><a href="#cb55-1454" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-1455"><a href="#cb55-1455" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-1456"><a href="#cb55-1456" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb55-1457"><a href="#cb55-1457" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb55-1458"><a href="#cb55-1458" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb55-1459"><a href="#cb55-1459" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-1460"><a href="#cb55-1460" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb55-1461"><a href="#cb55-1461" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb55-1462"><a href="#cb55-1462" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">10</span>),</span>
<span id="cb55-1463"><a href="#cb55-1463" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb55-1464"><a href="#cb55-1464" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-1465"><a href="#cb55-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1466"><a href="#cb55-1466" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Detect which legend items to show</span></span>
<span id="cb55-1467"><a href="#cb55-1467" aria-hidden="true" tabindex="-1"></a>  present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span>, <span class="st">"Standard Error Bias"</span>)</span>
<span id="cb55-1468"><a href="#cb55-1468" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(data<span class="sc">$</span>Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>)) present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(present_categories, <span class="st">"Coverage Failure"</span>)</span>
<span id="cb55-1469"><a href="#cb55-1469" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(data<span class="sc">$</span>Power_Dic <span class="sc">==</span> <span class="dv">0</span>)) present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(present_categories, <span class="st">"Power Failure"</span>)</span>
<span id="cb55-1470"><a href="#cb55-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1471"><a href="#cb55-1471" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define colors and shapes for different categories</span></span>
<span id="cb55-1472"><a href="#cb55-1472" aria-hidden="true" tabindex="-1"></a>  colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span> <span class="ot">=</span> <span class="st">"#7030A0"</span>, <span class="st">"Standard Error Bias"</span> <span class="ot">=</span> <span class="st">"#C830CC"</span>, </span>
<span id="cb55-1473"><a href="#cb55-1473" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Coverage Failure"</span> <span class="ot">=</span> <span class="st">"#7030A0"</span>, <span class="st">"Power Failure"</span> <span class="ot">=</span> <span class="st">"black"</span>)</span>
<span id="cb55-1474"><a href="#cb55-1474" aria-hidden="true" tabindex="-1"></a>  shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"Standard Error Bias"</span> <span class="ot">=</span> <span class="dv">18</span>, </span>
<span id="cb55-1475"><a href="#cb55-1475" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Coverage Failure"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Power Failure"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb55-1476"><a href="#cb55-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1477"><a href="#cb55-1477" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter colors and shapes based on detected categories</span></span>
<span id="cb55-1478"><a href="#cb55-1478" aria-hidden="true" tabindex="-1"></a>  filtered_colors <span class="ot">&lt;-</span> colors[present_categories]</span>
<span id="cb55-1479"><a href="#cb55-1479" aria-hidden="true" tabindex="-1"></a>  filtered_shapes <span class="ot">&lt;-</span> shapes[present_categories]</span>
<span id="cb55-1480"><a href="#cb55-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1481"><a href="#cb55-1481" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting</span></span>
<span id="cb55-1482"><a href="#cb55-1482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(N))) <span class="sc">+</span>  </span>
<span id="cb55-1483"><a href="#cb55-1483" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Parameter Bias"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span>  </span>
<span id="cb55-1484"><a href="#cb55-1484" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> SE_Bias, <span class="at">color =</span> <span class="st">"Standard Error Bias"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span>  </span>
<span id="cb55-1485"><a href="#cb55-1485" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Parameter Bias"</span>), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">fill =</span> <span class="st">"#7030A0"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb55-1486"><a href="#cb55-1486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> SE_Bias, <span class="at">color =</span> <span class="st">"Standard Error Bias"</span>), <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">fill =</span> <span class="st">"#C830CC"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb55-1487"><a href="#cb55-1487" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Coverage Failure"</span>), <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"#7030A0"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb55-1488"><a href="#cb55-1488" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Power_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Power Failure"</span>), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb55-1489"><a href="#cb55-1489" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Coverage Failure"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb55-1490"><a href="#cb55-1490" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Power_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Power Failure"</span>, <span class="at">group =</span> Population_Label), <span class="at">linewidth =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb55-1491"><a href="#cb55-1491" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb55-1492"><a href="#cb55-1492" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> filtered_colors, </span>
<span id="cb55-1493"><a href="#cb55-1493" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> present_categories, </span>
<span id="cb55-1494"><a href="#cb55-1494" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> present_categories,</span>
<span id="cb55-1495"><a href="#cb55-1495" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb55-1496"><a href="#cb55-1496" aria-hidden="true" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> filtered_shapes)</span>
<span id="cb55-1497"><a href="#cb55-1497" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb55-1498"><a href="#cb55-1498" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span>  </span>
<span id="cb55-1499"><a href="#cb55-1499" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb55-1500"><a href="#cb55-1500" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb55-1501"><a href="#cb55-1501" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Bias (%)"</span>,</span>
<span id="cb55-1502"><a href="#cb55-1502" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb55-1503"><a href="#cb55-1503" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"LTA Generated, RILTA Analyzed with"</span>, title_suffix, <span class="st">"Transition Probabilities"</span>)</span>
<span id="cb55-1504"><a href="#cb55-1504" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb55-1505"><a href="#cb55-1505" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>, <span class="dv">30</span>)) <span class="sc">+</span>  </span>
<span id="cb55-1506"><a href="#cb55-1506" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">as.character</span>(Population_Label), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span>  </span>
<span id="cb55-1507"><a href="#cb55-1507" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 500"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 1000"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 2000"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 4000"</span>))) <span class="sc">+</span>  </span>
<span id="cb55-1508"><a href="#cb55-1508" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">30</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span>  </span>
<span id="cb55-1509"><a href="#cb55-1509" aria-hidden="true" tabindex="-1"></a>    common_theme <span class="sc">+</span></span>
<span id="cb55-1510"><a href="#cb55-1510" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#7030A0"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  </span>
<span id="cb55-1511"><a href="#cb55-1511" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#C830CC"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb55-1512"><a href="#cb55-1512" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb55-1513"><a href="#cb55-1513" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb55-1514"><a href="#cb55-1514" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"outside"</span>, </span>
<span id="cb55-1515"><a href="#cb55-1515" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-1516"><a href="#cb55-1516" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb55-1517"><a href="#cb55-1517" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb55-1518"><a href="#cb55-1518" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-1519"><a href="#cb55-1519" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-1520"><a href="#cb55-1520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1521"><a href="#cb55-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1522"><a href="#cb55-1522" aria-hidden="true" tabindex="-1"></a><span class="fu">### Render Bias Figures</span></span>
<span id="cb55-1523"><a href="#cb55-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1526"><a href="#cb55-1526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1527"><a href="#cb55-1527" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "plot-movers"</span></span>
<span id="cb55-1528"><a href="#cb55-1528" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1529"><a href="#cb55-1529" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1530"><a href="#cb55-1530" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1531"><a href="#cb55-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1532"><a href="#cb55-1532" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and print plot for Mover</span></span>
<span id="cb55-1533"><a href="#cb55-1533" aria-hidden="true" tabindex="-1"></a>plot_mover <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(subset_mover, <span class="st">"Mover"</span>)</span>
<span id="cb55-1534"><a href="#cb55-1534" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen</span></span>
<span id="cb55-1535"><a href="#cb55-1535" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-format: svg</span></span>
<span id="cb55-1536"><a href="#cb55-1536" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_mover)</span>
<span id="cb55-1537"><a href="#cb55-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1538"><a href="#cb55-1538" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove title for the saved version</span></span>
<span id="cb55-1539"><a href="#cb55-1539" aria-hidden="true" tabindex="-1"></a>plot_mover_no_title <span class="ot">&lt;-</span> plot_mover <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>)</span>
<span id="cb55-1540"><a href="#cb55-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1541"><a href="#cb55-1541" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Mover plot without title as .svg</span></span>
<span id="cb55-1542"><a href="#cb55-1542" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zFIGURES"</span>, <span class="st">"x2t_lta_rilta_plots"</span>, <span class="st">"plot_mover.svg"</span>), <span class="at">plot =</span> plot_mover_no_title, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> <span class="st">"svg"</span>)</span>
<span id="cb55-1543"><a href="#cb55-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1544"><a href="#cb55-1544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1545"><a href="#cb55-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1548"><a href="#cb55-1548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1549"><a href="#cb55-1549" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "plot-stayers"</span></span>
<span id="cb55-1550"><a href="#cb55-1550" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1551"><a href="#cb55-1551" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1552"><a href="#cb55-1552" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1553"><a href="#cb55-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1554"><a href="#cb55-1554" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and print plot for Stayer</span></span>
<span id="cb55-1555"><a href="#cb55-1555" aria-hidden="true" tabindex="-1"></a>plot_stayer <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(subset_stayer, <span class="st">"Stayer"</span>)</span>
<span id="cb55-1556"><a href="#cb55-1556" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen</span></span>
<span id="cb55-1557"><a href="#cb55-1557" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-format: svg</span></span>
<span id="cb55-1558"><a href="#cb55-1558" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_stayer)</span>
<span id="cb55-1559"><a href="#cb55-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1560"><a href="#cb55-1560" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove title for the saved version</span></span>
<span id="cb55-1561"><a href="#cb55-1561" aria-hidden="true" tabindex="-1"></a>plot_stayer_no_title <span class="ot">&lt;-</span> plot_stayer <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>)</span>
<span id="cb55-1562"><a href="#cb55-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1563"><a href="#cb55-1563" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Stayer plot without title as .svg</span></span>
<span id="cb55-1564"><a href="#cb55-1564" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">'Simulations'</span>, <span class="st">'STUDY_1'</span>, <span class="st">"2 Time Points"</span>, <span class="st">"zFIGURES"</span>, <span class="st">"x2t_lta_rilta_plots"</span>, <span class="st">"plot_stayer.svg"</span>), <span class="at">plot =</span> plot_stayer_no_title, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> <span class="st">"svg"</span>)</span>
<span id="cb55-1565"><a href="#cb55-1565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1566"><a href="#cb55-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1567"><a href="#cb55-1567" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb55-1568"><a href="#cb55-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1569"><a href="#cb55-1569" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Prepare Data for Heat Maps**</span></span>
<span id="cb55-1570"><a href="#cb55-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1571"><a href="#cb55-1571" aria-hidden="true" tabindex="-1"></a>*Prepare data for heat map creation by ensuring correct formatting for population values, and subsetting the data based on class proportions and sample sizes.*</span>
<span id="cb55-1572"><a href="#cb55-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1575"><a href="#cb55-1575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1576"><a href="#cb55-1576" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "prepare-data-for-heatmaps"</span></span>
<span id="cb55-1577"><a href="#cb55-1577" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1578"><a href="#cb55-1578" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1579"><a href="#cb55-1579" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1580"><a href="#cb55-1580" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1581"><a href="#cb55-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1582"><a href="#cb55-1582" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Separate the movers and stayers and ensure sorting by N and Population for each transition</span></span>
<span id="cb55-1583"><a href="#cb55-1583" aria-hidden="true" tabindex="-1"></a>movers <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb55-1584"><a href="#cb55-1584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Transitions <span class="sc">==</span> <span class="st">"Mover"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-1585"><a href="#cb55-1585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, N)), Population)  <span class="co"># Sort movers by numeric N and Population</span></span>
<span id="cb55-1586"><a href="#cb55-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1587"><a href="#cb55-1587" aria-hidden="true" tabindex="-1"></a>stayers <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb55-1588"><a href="#cb55-1588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Transitions <span class="sc">==</span> <span class="st">"Stayer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-1589"><a href="#cb55-1589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, N)), Population)  <span class="co"># Sort stayers by numeric N and Population</span></span>
<span id="cb55-1590"><a href="#cb55-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1591"><a href="#cb55-1591" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Assign N_Label only once for each N within Movers and Stayers</span></span>
<span id="cb55-1592"><a href="#cb55-1592" aria-hidden="true" tabindex="-1"></a>movers <span class="ot">&lt;-</span> movers <span class="sc">%&gt;%</span></span>
<span id="cb55-1593"><a href="#cb55-1593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(N) <span class="sc">%&gt;%</span></span>
<span id="cb55-1594"><a href="#cb55-1594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_Label =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">2</span>, <span class="fu">as.character</span>(N), <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-1595"><a href="#cb55-1595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb55-1596"><a href="#cb55-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1597"><a href="#cb55-1597" aria-hidden="true" tabindex="-1"></a>stayers <span class="ot">&lt;-</span> stayers <span class="sc">%&gt;%</span></span>
<span id="cb55-1598"><a href="#cb55-1598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(N) <span class="sc">%&gt;%</span></span>
<span id="cb55-1599"><a href="#cb55-1599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_Label =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">2</span>, <span class="fu">as.character</span>(N), <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-1600"><a href="#cb55-1600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb55-1601"><a href="#cb55-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1602"><a href="#cb55-1602" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Combine movers and stayers back into one dataset, keeping them separate by transitions</span></span>
<span id="cb55-1603"><a href="#cb55-1603" aria-hidden="true" tabindex="-1"></a>all_data_sorted <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(movers, stayers)</span>
<span id="cb55-1604"><a href="#cb55-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1605"><a href="#cb55-1605" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Select necessary columns for the final display</span></span>
<span id="cb55-1606"><a href="#cb55-1606" aria-hidden="true" tabindex="-1"></a>test_map <span class="ot">&lt;-</span> <span class="fu">select</span>(all_data_sorted, N_Label, Population, average, Coverage, Power, Parameter_Bias, SE_Bias)</span>
<span id="cb55-1607"><a href="#cb55-1607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1608"><a href="#cb55-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1609"><a href="#cb55-1609" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prepare Function for Heat Map Creation</span></span>
<span id="cb55-1610"><a href="#cb55-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1613"><a href="#cb55-1613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1614"><a href="#cb55-1614" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "create-heatmap-function"</span></span>
<span id="cb55-1615"><a href="#cb55-1615" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1616"><a href="#cb55-1616" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1617"><a href="#cb55-1617" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1618"><a href="#cb55-1618" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb55-1619"><a href="#cb55-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1620"><a href="#cb55-1620" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create gt table based on subset data</span></span>
<span id="cb55-1621"><a href="#cb55-1621" aria-hidden="true" tabindex="-1"></a>create_gt_table <span class="ot">&lt;-</span> <span class="cf">function</span>(subset, transition_probability) {</span>
<span id="cb55-1622"><a href="#cb55-1622" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the gt object and set initial formatting</span></span>
<span id="cb55-1623"><a href="#cb55-1623" aria-hidden="true" tabindex="-1"></a>  gt_table <span class="ot">&lt;-</span> subset <span class="sc">%&gt;%</span></span>
<span id="cb55-1624"><a href="#cb55-1624" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-1625"><a href="#cb55-1625" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opt_table_font</span>(<span class="at">stack =</span> <span class="st">"geometric-humanist"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-1626"><a href="#cb55-1626" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb55-1627"><a href="#cb55-1627" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"LTA Generated &amp; LTA Analyzed with Transition Probability of"</span>, transition_probability)</span>
<span id="cb55-1628"><a href="#cb55-1628" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1629"><a href="#cb55-1629" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb55-1630"><a href="#cb55-1630" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_Label =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb55-1631"><a href="#cb55-1631" aria-hidden="true" tabindex="-1"></a>      <span class="at">average =</span> <span class="st">"Estimated&lt;br&gt;Probability"</span>,</span>
<span id="cb55-1632"><a href="#cb55-1632" aria-hidden="true" tabindex="-1"></a>      <span class="at">Coverage =</span> <span class="st">"Coverage"</span>,</span>
<span id="cb55-1633"><a href="#cb55-1633" aria-hidden="true" tabindex="-1"></a>      <span class="at">Power =</span> <span class="st">"Power"</span>,</span>
<span id="cb55-1634"><a href="#cb55-1634" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter_Bias =</span> <span class="st">"Parameter &lt;br&gt;Bias"</span>,</span>
<span id="cb55-1635"><a href="#cb55-1635" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE_Bias =</span> <span class="st">"Standard Error&lt;br&gt;Bias"</span>,</span>
<span id="cb55-1636"><a href="#cb55-1636" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fn =</span> md</span>
<span id="cb55-1637"><a href="#cb55-1637" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1638"><a href="#cb55-1638" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb55-1639"><a href="#cb55-1639" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Bias"</span>,</span>
<span id="cb55-1640"><a href="#cb55-1640" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Parameter_Bias"</span>, <span class="st">"SE_Bias"</span>)</span>
<span id="cb55-1641"><a href="#cb55-1641" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1642"><a href="#cb55-1642" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(</span>
<span id="cb55-1643"><a href="#cb55-1643" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Stayer Probabilities"</span>,  <span class="co"># Label for the first subgroup</span></span>
<span id="cb55-1644"><a href="#cb55-1644" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>)  <span class="co"># Rows corresponding to the first subgroup</span></span>
<span id="cb55-1645"><a href="#cb55-1645" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1646"><a href="#cb55-1646" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(</span>
<span id="cb55-1647"><a href="#cb55-1647" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Mover Probabilities"</span>,  <span class="co"># Label for the second subgroup</span></span>
<span id="cb55-1648"><a href="#cb55-1648" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)  <span class="co"># Rows corresponding to the second subgroup</span></span>
<span id="cb55-1649"><a href="#cb55-1649" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1650"><a href="#cb55-1650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb55-1651"><a href="#cb55-1651" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(</span>
<span id="cb55-1652"><a href="#cb55-1652" aria-hidden="true" tabindex="-1"></a>        <span class="at">font =</span> <span class="st">"bold italic"</span>  <span class="co"># Apply bold and italic styling</span></span>
<span id="cb55-1653"><a href="#cb55-1653" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb55-1654"><a href="#cb55-1654" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_row_groups</span>()  <span class="co"># Apply style to row subheaders</span></span>
<span id="cb55-1655"><a href="#cb55-1655" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1656"><a href="#cb55-1656" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Parameter_Bias"</span>, <span class="st">"SE_Bias"</span>), <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb55-1657"><a href="#cb55-1657" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">3</span>, <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-1658"><a href="#cb55-1658" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_options</span>(</span>
<span id="cb55-1659"><a href="#cb55-1659" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.hlines.color =</span> <span class="st">"white"</span>,</span>
<span id="cb55-1660"><a href="#cb55-1660" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb55-1661"><a href="#cb55-1661" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb55-1662"><a href="#cb55-1662" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb55-1663"><a href="#cb55-1663" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb55-1664"><a href="#cb55-1664" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb55-1665"><a href="#cb55-1665" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb55-1666"><a href="#cb55-1666" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_group.border.bottom.color =</span> <span class="st">"black"</span> ,</span>
<span id="cb55-1667"><a href="#cb55-1667" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_group.border.top.color =</span> <span class="st">"black"</span> </span>
<span id="cb55-1668"><a href="#cb55-1668" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1669"><a href="#cb55-1669" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb55-1670"><a href="#cb55-1670" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"center"</span>),</span>
<span id="cb55-1671"><a href="#cb55-1671" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb55-1672"><a href="#cb55-1672" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-1673"><a href="#cb55-1673" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-1674"><a href="#cb55-1674" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Apply color highlighting for violations in Parameter Bias</span></span>
<span id="cb55-1675"><a href="#cb55-1675" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span>(subset<span class="sc">$</span>Parameter_Bias <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">9.99</span> <span class="sc">&amp;</span> subset<span class="sc">$</span>Parameter_Bias <span class="sc">&lt;=</span> <span class="fl">9.99</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb55-1676"><a href="#cb55-1676" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb55-1677"><a href="#cb55-1677" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb55-1678"><a href="#cb55-1678" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Parameter_Bias"</span>,</span>
<span id="cb55-1679"><a href="#cb55-1679" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> .data<span class="sc">$</span>Parameter_Bias <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">9.99</span> <span class="sc">|</span> .data<span class="sc">$</span>Parameter_Bias <span class="sc">&gt;</span> <span class="fl">9.99</span>,  <span class="co"># Apply color only if outside the threshold</span></span>
<span id="cb55-1680"><a href="#cb55-1680" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb55-1681"><a href="#cb55-1681" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#113386"</span>, <span class="st">"#DAE3FA"</span>, <span class="st">"#113386"</span>),  <span class="co"># Darker blue for larger deviations</span></span>
<span id="cb55-1682"><a href="#cb55-1682" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>)  <span class="co"># Adjust the domain to reflect the range of values</span></span>
<span id="cb55-1683"><a href="#cb55-1683" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1684"><a href="#cb55-1684" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb55-1685"><a href="#cb55-1685" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Darker blue indicates larger deviations from zero *Parameter Bias* beyond the Â±9.99 threshold."</span>),</span>
<span id="cb55-1686"><a href="#cb55-1686" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Parameter_Bias"</span>)</span>
<span id="cb55-1687"><a href="#cb55-1687" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb55-1688"><a href="#cb55-1688" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-1689"><a href="#cb55-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1690"><a href="#cb55-1690" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply color highlighting for violations in SE Bias</span></span>
<span id="cb55-1691"><a href="#cb55-1691" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span>(subset<span class="sc">$</span>SE_Bias <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">4.99</span> <span class="sc">&amp;</span> subset<span class="sc">$</span>SE_Bias <span class="sc">&lt;=</span> <span class="fl">4.99</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb55-1692"><a href="#cb55-1692" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb55-1693"><a href="#cb55-1693" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb55-1694"><a href="#cb55-1694" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"SE_Bias"</span>,</span>
<span id="cb55-1695"><a href="#cb55-1695" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> .data<span class="sc">$</span>SE_Bias <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">4.99</span> <span class="sc">|</span> .data<span class="sc">$</span>SE_Bias <span class="sc">&gt;</span> <span class="fl">4.99</span>,  <span class="co"># Apply color only if outside the threshold</span></span>
<span id="cb55-1696"><a href="#cb55-1696" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb55-1697"><a href="#cb55-1697" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#B4186E"</span>, <span class="st">"#F9D5E9"</span>, <span class="st">"#B4186E"</span>),  <span class="co"># Darker red for larger deviations</span></span>
<span id="cb55-1698"><a href="#cb55-1698" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>, <span class="dv">80</span>)  <span class="co"># Adjust the domain for the SE_Bias range</span></span>
<span id="cb55-1699"><a href="#cb55-1699" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1700"><a href="#cb55-1700" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb55-1701"><a href="#cb55-1701" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Darker red indicates larger deviations from zero *Standard Error Bias* beyond the Â±4.99 threshold."</span>),</span>
<span id="cb55-1702"><a href="#cb55-1702" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"SE_Bias"</span>)</span>
<span id="cb55-1703"><a href="#cb55-1703" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb55-1704"><a href="#cb55-1704" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-1705"><a href="#cb55-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1706"><a href="#cb55-1706" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(subset<span class="sc">$</span>Coverage <span class="sc">&lt;</span> <span class="fl">0.93</span> <span class="sc">|</span> subset<span class="sc">$</span>Coverage <span class="sc">&gt;</span> <span class="fl">0.979</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb55-1707"><a href="#cb55-1707" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb55-1708"><a href="#cb55-1708" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb55-1709"><a href="#cb55-1709" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Coverage"</span>,</span>
<span id="cb55-1710"><a href="#cb55-1710" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> subset<span class="sc">$</span>Coverage <span class="sc">&lt;</span> <span class="fl">0.93</span> <span class="sc">|</span> subset<span class="sc">$</span>Coverage <span class="sc">&gt;</span> <span class="fl">0.979</span>,</span>
<span id="cb55-1711"><a href="#cb55-1711" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb55-1712"><a href="#cb55-1712" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#93C6B1"</span>, <span class="st">"white"</span>),  <span class="co"># Green for coverage issues</span></span>
<span id="cb55-1713"><a href="#cb55-1713" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb55-1714"><a href="#cb55-1714" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1715"><a href="#cb55-1715" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb55-1716"><a href="#cb55-1716" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Green indicates failure to achieve adequate *Coverage*."</span>),</span>
<span id="cb55-1717"><a href="#cb55-1717" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Coverage"</span>)</span>
<span id="cb55-1718"><a href="#cb55-1718" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb55-1719"><a href="#cb55-1719" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-1720"><a href="#cb55-1720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1721"><a href="#cb55-1721" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(subset<span class="sc">$</span>Power <span class="sc">&lt;</span> <span class="fl">0.8</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb55-1722"><a href="#cb55-1722" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb55-1723"><a href="#cb55-1723" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb55-1724"><a href="#cb55-1724" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Power"</span>,</span>
<span id="cb55-1725"><a href="#cb55-1725" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> subset<span class="sc">$</span>Power <span class="sc">&lt;</span> <span class="fl">0.8</span>,</span>
<span id="cb55-1726"><a href="#cb55-1726" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb55-1727"><a href="#cb55-1727" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#502CD1"</span>, <span class="st">"white"</span>),  <span class="co"># Purple for power issues</span></span>
<span id="cb55-1728"><a href="#cb55-1728" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb55-1729"><a href="#cb55-1729" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb55-1730"><a href="#cb55-1730" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb55-1731"><a href="#cb55-1731" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Purple indicates failure to achieve adequate *Power*."</span>),</span>
<span id="cb55-1732"><a href="#cb55-1732" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Power"</span>)</span>
<span id="cb55-1733"><a href="#cb55-1733" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb55-1734"><a href="#cb55-1734" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-1735"><a href="#cb55-1735" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-1736"><a href="#cb55-1736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(gt_table)</span>
<span id="cb55-1737"><a href="#cb55-1737" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-1738"><a href="#cb55-1738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-1739"><a href="#cb55-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1740"><a href="#cb55-1740" aria-hidden="true" tabindex="-1"></a><span class="fu">### Render Heat Map</span></span>
<span id="cb55-1741"><a href="#cb55-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1744"><a href="#cb55-1744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-1745"><a href="#cb55-1745" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "render-heatmap"</span></span>
<span id="cb55-1746"><a href="#cb55-1746" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb55-1747"><a href="#cb55-1747" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb55-1748"><a href="#cb55-1748" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb55-1749"><a href="#cb55-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1750"><a href="#cb55-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1751"><a href="#cb55-1751" aria-hidden="true" tabindex="-1"></a>gt_table <span class="ot">&lt;-</span> <span class="fu">create_gt_table</span>(test_map, <span class="st">".200 &amp; .800"</span>)</span>
<span id="cb55-1752"><a href="#cb55-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1753"><a href="#cb55-1753" aria-hidden="true" tabindex="-1"></a><span class="co"># Further operations on gt_table</span></span>
<span id="cb55-1754"><a href="#cb55-1754" aria-hidden="true" tabindex="-1"></a>gt_table <span class="sc">|&gt;</span> </span>
<span id="cb55-1755"><a href="#cb55-1755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">75</span>)) <span class="sc">|&gt;</span></span>
<span id="cb55-1756"><a href="#cb55-1756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gtsave</span>(<span class="fu">here</span>(<span class="st">"2 Time Points"</span>, <span class="st">"zHEATMAPS"</span>, <span class="st">"z2t_heatmaps"</span>, <span class="st">"z2t_heatmaps"</span>, <span class="st">"2T_L_R.png"</span>))</span>
<span id="cb55-1757"><a href="#cb55-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1758"><a href="#cb55-1758" aria-hidden="true" tabindex="-1"></a>gt_table</span>
<span id="cb55-1759"><a href="#cb55-1759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>