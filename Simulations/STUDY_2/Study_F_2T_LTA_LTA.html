<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Delwin Carter">

<title>Final Study (k = 3) LTA Generated, LTA Analyzed: Two Timepoints</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Study_F_2T_LTA_LTA_files/libs/clipboard/clipboard.min.js"></script>
<script src="Study_F_2T_LTA_LTA_files/libs/quarto-html/quarto.js"></script>
<script src="Study_F_2T_LTA_LTA_files/libs/quarto-html/popper.min.js"></script>
<script src="Study_F_2T_LTA_LTA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Study_F_2T_LTA_LTA_files/libs/quarto-html/anchor.min.js"></script>
<link href="Study_F_2T_LTA_LTA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Study_F_2T_LTA_LTA_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Study_F_2T_LTA_LTA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Study_F_2T_LTA_LTA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Study_F_2T_LTA_LTA_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">

<main class="content column-page" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final Study (k = 3) LTA Generated, LTA Analyzed: Two Timepoints</h1>
</div>



<div class="quarto-title-meta column-page">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Delwin Carter </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "load-libraries"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::opts_chunk$set(echo = TRUE, eval = TRUE, warning = FALSE, message = FALSE)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MplusAutomation)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="final-study-k-3" class="level1">
<h1>Final Study (k = 3):</h1>
</section>
<section id="lta-generated-lta-analyzed" class="level1">
<h1>LTA Generated, LTA Analyzed</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this section, we will simulate three models by generating them as a Latent Transition Models and analyzing them as a Latent Transition Models.</p>
<p><img src="images/LTA_LTA-01.png" class="img-fluid" width="324"></p>
</section>
<section id="model-1" class="level2">
<h2 class="anchored" data-anchor-id="model-1">Model 1:</h2>
<section id="conditions" class="level3">
<h3 class="anchored" data-anchor-id="conditions">Conditions:</h3>
</section>
<section id="sample-size-n-500-1000-2500-5000" class="level3">
<h3 class="anchored" data-anchor-id="sample-size-n-500-1000-2500-5000">Sample Size: N = 500, 1000, 2500, 5000</h3>
<p>Transition logit (Probability): TPs = 3.179 (Stayer), 0.407 (Mover)</p>
<p><img src="images/clipboard-2891141057.png" class="img-fluid" width="352"></p>
<p>_Figure 1: Transition Probabilities for Model 1_</p>
<p>Thresholds (logit; probability) = Small (1, .7; -1, .3)</p>
<p><img src="images/clipboard-3674477926.png" class="img-fluid" width="292"></p>
<p>_Figure 2: Probability Plot of Model 1_</p>
<p>Class Definition: Model 1</p>
<p>## Setting up the Simulation Conditions&nbsp;</p>
<p>We first define the matrix of conditions that will be iterated through in the simulation. The matrix includes varying sample sizes, transition probabilities (TPs), and mixture components (`mix`). These will be used to simulate latent transition models across different scenarios.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the simulation conditions</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">N =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2500</span>, <span class="dv">5000</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">TPs =</span> <span class="fu">c</span>(<span class="fl">3.179</span>, <span class="fl">0.407</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mix =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the matrix using gt</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Simulation Conditions Matrix"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Combinations of Sample Sizes, Transition Probabilities, and Mixtures"</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>() <span class="co"># Centers all columns</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="kvedsrwxem" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kvedsrwxem table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kvedsrwxem thead, #kvedsrwxem tbody, #kvedsrwxem tfoot, #kvedsrwxem tr, #kvedsrwxem td, #kvedsrwxem th {
  border-style: none;
}

#kvedsrwxem p {
  margin: 0;
  padding: 0;
}

#kvedsrwxem .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kvedsrwxem .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kvedsrwxem .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kvedsrwxem .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kvedsrwxem .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvedsrwxem .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvedsrwxem .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvedsrwxem .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kvedsrwxem .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kvedsrwxem .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kvedsrwxem .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kvedsrwxem .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kvedsrwxem .gt_spanner_row {
  border-bottom-style: hidden;
}

#kvedsrwxem .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kvedsrwxem .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kvedsrwxem .gt_from_md > :first-child {
  margin-top: 0;
}

#kvedsrwxem .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kvedsrwxem .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kvedsrwxem .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kvedsrwxem .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kvedsrwxem .gt_row_group_first td {
  border-top-width: 2px;
}

#kvedsrwxem .gt_row_group_first th {
  border-top-width: 2px;
}

#kvedsrwxem .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvedsrwxem .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kvedsrwxem .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kvedsrwxem .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvedsrwxem .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvedsrwxem .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kvedsrwxem .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kvedsrwxem .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kvedsrwxem .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvedsrwxem .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvedsrwxem .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvedsrwxem .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvedsrwxem .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvedsrwxem .gt_left {
  text-align: left;
}

#kvedsrwxem .gt_center {
  text-align: center;
}

#kvedsrwxem .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kvedsrwxem .gt_font_normal {
  font-weight: normal;
}

#kvedsrwxem .gt_font_bold {
  font-weight: bold;
}

#kvedsrwxem .gt_font_italic {
  font-style: italic;
}

#kvedsrwxem .gt_super {
  font-size: 65%;
}

#kvedsrwxem .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kvedsrwxem .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kvedsrwxem .gt_indent_1 {
  text-indent: 5px;
}

#kvedsrwxem .gt_indent_2 {
  text-indent: 10px;
}

#kvedsrwxem .gt_indent_3 {
  text-indent: 15px;
}

#kvedsrwxem .gt_indent_4 {
  text-indent: 20px;
}

#kvedsrwxem .gt_indent_5 {
  text-indent: 25px;
}

#kvedsrwxem .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kvedsrwxem div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal">Simulation Conditions Matrix</th>
</tr>
<tr class="odd gt_heading">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Combinations of Sample Sizes, Transition Probabilities, and Mixtures</th>
</tr>
<tr class="header gt_col_headings">
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">N</th>
<th id="TPs" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">TPs</th>
<th id="mix" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">mix</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">3.179</td>
<td class="gt_row gt_center" headers="mix">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">3.179</td>
<td class="gt_row gt_center" headers="mix">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2500</td>
<td class="gt_row gt_center" headers="TPs">3.179</td>
<td class="gt_row gt_center" headers="mix">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">5000</td>
<td class="gt_row gt_center" headers="TPs">3.179</td>
<td class="gt_row gt_center" headers="mix">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">0.407</td>
<td class="gt_row gt_center" headers="mix">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">0.407</td>
<td class="gt_row gt_center" headers="mix">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2500</td>
<td class="gt_row gt_center" headers="TPs">0.407</td>
<td class="gt_row gt_center" headers="mix">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">5000</td>
<td class="gt_row gt_center" headers="TPs">0.407</td>
<td class="gt_row gt_center" headers="mix">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">3.179</td>
<td class="gt_row gt_center" headers="mix">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">3.179</td>
<td class="gt_row gt_center" headers="mix">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2500</td>
<td class="gt_row gt_center" headers="TPs">3.179</td>
<td class="gt_row gt_center" headers="mix">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">5000</td>
<td class="gt_row gt_center" headers="TPs">3.179</td>
<td class="gt_row gt_center" headers="mix">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">500</td>
<td class="gt_row gt_center" headers="TPs">0.407</td>
<td class="gt_row gt_center" headers="mix">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">1000</td>
<td class="gt_row gt_center" headers="TPs">0.407</td>
<td class="gt_row gt_center" headers="mix">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="N">2500</td>
<td class="gt_row gt_center" headers="TPs">0.407</td>
<td class="gt_row gt_center" headers="mix">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="N">5000</td>
<td class="gt_row gt_center" headers="TPs">0.407</td>
<td class="gt_row gt_center" headers="mix">2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>## Simulation Setup&nbsp;</p>
<p>We will now run a Monte Carlo simulation for Model 1. The simulation will iterate over different combinations of sample sizes, transition probabilities, and mixture components. The following code sets up the cluster for parallel processing and defines the function to run the simulation.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create the cluster for parallel processing</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Detect the number of available cores (minus 1)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> <span class="st">"PSOCK"</span>)    <span class="co"># Create the PSOCK cluster</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Define the function for the simulation</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>lta_lta_func <span class="ot">&lt;-</span> <span class="cf">function</span>(N, TPs, mix) {</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.1: Construct the MODELPOPULATION argument based on the value of 'mix'</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  MODELPOPULATION <span class="ot">&lt;-</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p131-p135);</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p131-p135);</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">2</span>) { </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p131-p135);</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p131-p135);</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.2: Construct the MODEL argument based on the value of 'mix'</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  MODEL <span class="ot">&lt;-</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);  </span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p131-p135);</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:     </span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p131-p135);</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">2</span>) { </span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);  </span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p131-p135);</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:     </span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p131-p135);</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.3: Construct the MODELCONSTRAINT argument based on the value of 'TPs'</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>  MODELCONSTRAINT <span class="ot">&lt;-</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="fl">3.179</span>) {</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.8 trans12*.1 trans13*.1 </span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">407</span>) {</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.2 trans12*.4 trans13*.4 </span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 3: Construct the Mplus object</span></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>  LTA_LTA <span class="ot">&lt;-</span> <span class="fu">mplusObject</span>(</span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE =</span> <span class="fu">glue</span>(<span class="st">"Generate LTA_LTA_M1_N_{N}_TP_{TPs}_M_{mix}"</span>),</span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">MONTECARLO =</span> <span class="fu">glue</span>(<span class="st">"NAMES = u11-u15 u21-u25;</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a><span class="st">      GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a><span class="st">      CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a><span class="st">      GENCLASSES = c1(3) c2(3);</span></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a><span class="st">      CLASSES = c1(3) c2(3);</span></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a><span class="st">      NOBSERVATIONS = {N};</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a><span class="st">      SEED = 07252005;</span></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a><span class="st">      NREPS = 500;</span></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a><span class="st">      !SAVE = repM1*.dat;</span></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a><span class="st">      RESULTS = LTA_LTA_M1_N_{N}_TP_{TPs}_M_{mix}.csv;"</span>),</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANALYSIS =</span> <span class="st">"TYPE = MIXTURE;</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a><span class="st">      algorithm = integration;</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a><span class="st">      STARTS = 50 10;</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a><span class="st">      processors = 24;</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a><span class="st">      MITERATIONS = 1000;</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a><span class="st">      logcriterion=0.00001;</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a><span class="st">      mconv=0.00001;"</span>,</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELPOPULATION =</span> MODELPOPULATION,</span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODEL =</span> MODEL,</span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELCONSTRAINT =</span> MODELCONSTRAINT</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run Mplus model</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>  LTA_LTA_Model <span class="ot">&lt;-</span> <span class="fu">mplusModeler</span>(</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>    LTA_LTA, </span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataout =</span> <span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE"</span>, <span class="fu">glue</span>(<span class="st">"LTA_LTA_N_{N}_TP_{TPs}_M_{mix}.dat"</span>)),</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">modelout =</span> <span class="fu">glue</span>(<span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE"</span>, <span class="st">"LTA_LTA_M1_N_{N}_TP_{TPs}_M_{mix}.inp"</span>)),</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">check =</span> <span class="cn">TRUE</span>, <span class="at">run =</span> <span class="cn">TRUE</span>, <span class="at">hashfilename =</span> <span class="cn">FALSE</span></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LTA_LTA_Model)</span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Export necessary objects to the cluster</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"lta_lta_func"</span>, <span class="st">"p1"</span>))</span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that the necessary packages are loaded on each cluster node</span></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MplusAutomation)</span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Run the simulation in parallel using the cluster</span></span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>result_list <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p1), <span class="cf">function</span>(i) {</span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lta_lta_func</span>(p1<span class="sc">$</span>N[i], p1<span class="sc">$</span>TPs[i], p1<span class="sc">$</span>mix[i])</span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="model-2-lta-generated-lta-analyzed" class="level2">
<h2 class="anchored" data-anchor-id="model-2-lta-generated-lta-analyzed">Model 2: LTA Generated, LTA Analyzed</h2>
<section id="conditions-1" class="level3">
<h3 class="anchored" data-anchor-id="conditions-1">Conditions:</h3>
<p>Sample Size: N = 500, 1000, 2500, 5000</p>
<p>Transition logit (Probability): TPs = 3.179 (Stayer), 0.407 (Mover)</p>
<p><img src="images/clipboard-2891141057.png" class="img-fluid" width="352"></p>
<p>_Figure 3: Transition Probabilities for Model 2_</p>
<p>Thresholds= Model 2</p>
<p><img src="images/clipboard-4064704230.png" class="img-fluid" width="316"></p>
<p>_Figure 4: Probability Plot of Model 2_</p>
<p>We will now run a Monte Carlo simulation for Model 2. This simulation will iterate over different combinations of sample sizes, transition probabilities, and mixture components using the logits form the probability plot in Figure 4. The following code sets up the cluster for parallel processing and defines the function to run the simulation.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create the cluster for parallel processing</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Detect the number of available cores (minus 1)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> <span class="st">"PSOCK"</span>)    <span class="co"># Create the PSOCK cluster</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Define the function for Model 2 simulation</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>lta_lta_func2 <span class="ot">&lt;-</span> <span class="cf">function</span>(N, TPs, mix) {</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.1: Construct the MODELPOPULATION argument based on 'mix'</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  MODELPOPULATION <span class="ot">&lt;-</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*-1.21 u13$1*-1.45 u14$1*-1.55 u15$1*-5] (p111-p115);</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*-5 u13$1*.94 u14$1*-.02 u15$1*-.89] (p121-p125);</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*1.55 u13$1*4.17 u14$1*-.16 u15$1*-1.99] (p131-p135);</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*-1.21 u23$1*-1.45 u24$1*-1.55 u25$1*-5] (p111-p115);</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*-5 u23$1*.94 u24$1*-.02 u25$1*-.89] (p121-p125);</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*1.55 u23$1*4.17 u24$1*-.16 u25$1*-1.99] (p131-p135);</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*-1.21 u13$1*-1.45 u14$1*-1.55 u15$1*-5] (p111-p115);</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*-5 u13$1*.94 u14$1*-.02 u15$1*-.89] (p121-p125);</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*1.55 u13$1*4.17 u14$1*-.16 u15$1*-1.99] (p131-p135);</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*-1.21 u23$1*-1.45 u24$1*-1.55 u25$1*-5] (p111-p115);</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*-5 u23$1*.94 u24$1*-.02 u25$1*-.89] (p121-p125);</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*1.55 u23$1*4.17 u24$1*-.16 u25$1*-1.99] (p131-p135);</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.2: Construct the MODEL argument based on 'mix'</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>  MODEL <span class="ot">&lt;-</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*-1.21 u13$1*-1.45 u14$1*-1.55 u15$1*-5] (p111-p115);</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*-5 u13$1*.94 u14$1*-.02 u15$1*-.89] (p121-p125);</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*1.55 u13$1*4.17 u14$1*-.16 u15$1*-1.99] (p131-p135);</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:</span></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*-1.21 u23$1*-1.45 u24$1*-1.55 u25$1*-5] (p111-p115);</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*-5 u23$1*.94 u24$1*-.02 u25$1*-.89] (p121-p125);</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*1.55 u23$1*4.17 u24$1*-.16 u25$1*-1.99] (p131-p135);</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);</span></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*-1.21 u13$1*-1.45 u14$1*-1.55 u15$1*-5] (p111-p115);</span></span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*-5 u13$1*.94 u14$1*-.02 u15$1*-.89] (p121-p125);</span></span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*1.55 u13$1*4.17 u14$1*-.16 u15$1*-1.99] (p131-p135);</span></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:</span></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*-1.21 u23$1*-1.45 u24$1*-1.55 u25$1*-5] (p111-p115);</span></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*-5 u23$1*.94 u24$1*-.02 u25$1*-.89] (p121-p125);</span></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*1.55 u23$1*4.17 u24$1*-.16 u25$1*-1.99] (p131-p135);</span></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.3: Construct the MODELCONSTRAINT argument based on 'TPs'</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>  MODELCONSTRAINT <span class="ot">&lt;-</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="fl">3.179</span>) {</span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.8 trans12*.1 trans13*.1 </span></span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">407</span>) {</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.2 trans12*.4 trans13*.4 </span></span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.4: Create and run Mplus model</span></span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>  LTA_LTA2 <span class="ot">&lt;-</span> <span class="fu">mplusObject</span>(</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE =</span> <span class="fu">glue</span>(<span class="st">"Generate LTA_LTA_M2_N_{N}_TP_{TPs}_M_{mix}"</span>),</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">MONTECARLO =</span> <span class="fu">glue</span>(<span class="st">"NAMES = u11-u15 u21-u25;</span></span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a><span class="st">      GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a><span class="st">      CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a><span class="st">      GENCLASSES = c1(3) c2(3);</span></span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a><span class="st">      CLASSES = c1(3) c2(3);</span></span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a><span class="st">      NOBSERVATIONS = {N};</span></span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a><span class="st">      SEED = 07252005;</span></span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a><span class="st">      NREPS = 500;</span></span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a><span class="st">      !SAVE = repM2*.dat;</span></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a><span class="st">      RESULTS = LTA_LTA_M2_N_{N}_TP_{TPs}_M_{mix}.csv;"</span>),</span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANALYSIS =</span> <span class="st">"TYPE = MIXTURE;</span></span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a><span class="st">      algorithm = integration;</span></span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a><span class="st">      STARTS = 50 10;</span></span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a><span class="st">      processors = 24;</span></span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a><span class="st">      miterations = 1000; </span></span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a><span class="st">      logcriterion=0.00001;</span></span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a><span class="st">      mconv=0.00001;"</span>,</span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELPOPULATION =</span> MODELPOPULATION,</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODEL =</span> MODEL,</span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELCONSTRAINT =</span> MODELCONSTRAINT</span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a>  LTA_LTA_Model2 <span class="ot">&lt;-</span> <span class="fu">mplusModeler</span>(</span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a>    LTA_LTA2, </span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataout =</span> <span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE"</span>, <span class="fu">glue</span>(<span class="st">"LTA_LTA_M2_N_{N}_TP_{TPs}_M_{mix}.dat"</span>)),</span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">modelout =</span> <span class="fu">glue</span>(<span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE"</span>, <span class="st">"LTA_LTA_M2_N_{N}_TP_{TPs}_M_{mix}.inp"</span>)),</span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">check =</span> <span class="cn">TRUE</span>, <span class="at">run =</span> <span class="cn">TRUE</span>, <span class="at">hashfilename =</span> <span class="cn">FALSE</span></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LTA_LTA_Model2)</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Export necessary objects to the cluster</span></span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"lta_lta_func2"</span>, <span class="st">"p1"</span>))</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure packages are loaded on each cluster node</span></span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MplusAutomation)</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Run the simulation in parallel using the cluster</span></span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>result_list_model2 <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p1), <span class="cf">function</span>(i) {</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lta_lta_func2</span>(p1<span class="sc">$</span>N[i], p1<span class="sc">$</span>TPs[i], p1<span class="sc">$</span>mix[i])</span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a><span class="co"># Stop the cluster when done</span></span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="model-3-lta-generated-lta-analyzed" class="level2">
<h2 class="anchored" data-anchor-id="model-3-lta-generated-lta-analyzed">Model 3: LTA Generated, LTA Analyzed</h2>
<section id="conditions-2" class="level3">
<h3 class="anchored" data-anchor-id="conditions-2">Conditions:</h3>
<p>Sample Size: N = 500, 1000, 2500, 5000</p>
<p>Transition logit (Probability): TPs = 3.179 (Stayer), 0.407 (Mover)</p>
<p><img src="images/clipboard-2891141057.png" class="img-fluid" width="352"></p>
<p>_Figure 5: Transition Probabilities for Model 3_</p>
<p>Thresholds= Model 3</p>
<p><img src="images/clipboard-2467009665.png" class="img-fluid" width="344"></p>
<p>_Figure 6: Probability Plot for Model 3_</p>
<p>We will now run a Monte Carlo simulation for Model 3. This simulation will iterate over different combinations of sample sizes, transition probabilities, and mixture components using the logits form the probability plot in Figure 6. The following code sets up the cluster for parallel processing and defines the function to run the simulation.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create the cluster for parallel processing</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Detect number of available cores (minus 1)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> <span class="st">"PSOCK"</span>)    <span class="co"># Create the PSOCK cluster</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Define the function for Model 3 simulation</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>lta_lta_func3 <span class="ot">&lt;-</span> <span class="cf">function</span>(N, TPs, mix) {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.1: Construct the MODELPOPULATION argument for Model 3 based on 'mix'</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  MODELPOPULATION <span class="ot">&lt;-</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*2.38 u13$1*3.18 u14$1*4.59 u15$1*4.59] (p111-p115);</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*.62 u12$1*.81 u13$1*.82 u14$1*.28 u15$1*1.39] (p121-p125);</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1.45 u12$1*-2.44 u13$1*-5 u14$1*-1.70 u15$1*-.71] (p131-p135);</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*2.38 u23$1*3.18 u24$1*4.59 u25$1*4.59] (p111-p115);</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*.62 u22$1*.81 u23$1*.82 u24$1*.28 u25$1*1.39] (p121-p125);</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1.45 u22$1*-2.44 u23$1*-5 u24$1*-1.70 u25$1*-.71] (p131-p135);</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">2</span>) { </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*2.38 u13$1*3.18 u14$1*4.59 u15$1*4.59] (p111-p115);</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*.62 u12$1*.81 u13$1*.82 u14$1*.28 u15$1*1.39] (p121-p125);</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1.45 u12$1*-2.44 u13$1*-5 u14$1*-1.70 u15$1*-.71] (p131-p135);</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*2.38 u23$1*3.18 u24$1*4.59 u25$1*4.59] (p111-p115);</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*.62 u22$1*.81 u23$1*.82 u24$1*.28 u25$1*1.39] (p121-p125);</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1.45 u22$1*-2.44 u23$1*-5 u24$1*-1.70 u25$1*-.71] (p131-p135);</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.2: Construct the MODEL argument for Model 3 based on 'mix'</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>  MODEL <span class="ot">&lt;-</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*2.38 u13$1*3.18 u14$1*4.59 u15$1*4.59] (p111-p115);</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*.62 u12$1*.81 u13$1*.82 u14$1*.28 u15$1*1.39] (p121-p125);</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1.45 u12$1*-2.44 u13$1*-5 u14$1*-1.70 u15$1*-.71] (p131-p135);</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:     </span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*2.38 u23$1*3.18 u24$1*4.59 u25$1*4.59] (p111-p115);</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*.62 u22$1*.81 u23$1*.82 u24$1*.28 u25$1*1.39] (p121-p125);</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1.45 u22$1*-2.44 u23$1*-5 u24$1*-1.70 u25$1*-.71] (p131-p135);</span></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)      </span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (mix <span class="sc">==</span> <span class="dv">2</span>) { </span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);</span></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*2.38 u13$1*3.18 u14$1*4.59 u15$1*4.59] (p111-p115);</span></span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*.62 u12$1*.81 u13$1*.82 u14$1*.28 u15$1*1.39] (p121-p125);</span></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1.45 u12$1*-2.44 u13$1*-5 u14$1*-1.70 u15$1*-.71] (p131-p135);</span></span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:     </span></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*2.38 u23$1*3.18 u24$1*4.59 u25$1*4.59] (p111-p115);</span></span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*.62 u22$1*.81 u23$1*.82 u24$1*.28 u25$1*1.39] (p121-p125);</span></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1.45 u22$1*-2.44 u23$1*-5 u24$1*-1.70 u25$1*-.71] (p131-p135);</span></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)      </span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.3: Construct the MODELCONSTRAINT argument based on TPs</span></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>  MODELCONSTRAINT <span class="ot">&lt;-</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="fl">3.179</span>) {</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.8 trans12*.1 trans13*.1 </span></span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">407</span>) {</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.2 trans12*.4 trans13*.4 </span></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.4: Create and run Mplus model</span></span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>  LTA_LTA3 <span class="ot">&lt;-</span> <span class="fu">mplusObject</span>(</span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE =</span> <span class="fu">glue</span>(<span class="st">"Generate LTA_LTA_M3_N_{N}_TP_{TPs}_M_{mix}"</span>),</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">MONTECARLO =</span> <span class="fu">glue</span>(<span class="st">"NAMES = u11-u15 u21-u25;</span></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a><span class="st">      GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a><span class="st">      CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a><span class="st">      GENCLASSES = c1(3) c2(3);</span></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a><span class="st">      CLASSES = c1(3) c2(3);</span></span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a><span class="st">      NOBSERVATIONS = {N};</span></span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a><span class="st">      SEED = 07252005;</span></span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a><span class="st">      NREPS = 500;</span></span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a><span class="st">      !SAVE = repM3*.dat;</span></span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a><span class="st">      RESULTS = LTA_LTA_M3_N_{N}_TP_{TPs}_M_{mix}.csv;"</span>),</span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANALYSIS =</span> <span class="st">"TYPE = MIXTURE;</span></span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a><span class="st">      algorithm = integration;</span></span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a><span class="st">      STARTS = 50 10;</span></span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a><span class="st">      processors = 24;</span></span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a><span class="st">      miterations = 1000;</span></span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a><span class="st">      logcriterion=0.00001;</span></span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a><span class="st">      mconv=0.00001;"</span>,</span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELPOPULATION =</span> MODELPOPULATION,</span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODEL =</span> MODEL,</span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELCONSTRAINT =</span> MODELCONSTRAINT</span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run Mplus model</span></span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a>  LTA_LTA_Model3 <span class="ot">&lt;-</span> <span class="fu">mplusModeler</span>(LTA_LTA3, </span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dataout =</span> <span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE"</span>, <span class="fu">glue</span>(<span class="st">"LTA_LTA_M3_N_{N}_TP_{TPs}_M_{mix}.dat"</span>)),</span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">modelout =</span> <span class="fu">glue</span>(<span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE"</span>, <span class="st">"LTA_LTA_M3_N_{N}_TP_{TPs}_M_{mix}.inp"</span>)),</span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">check =</span> <span class="cn">TRUE</span>, <span class="at">run =</span> <span class="cn">TRUE</span>, <span class="at">hashfilename =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LTA_LTA_Model3)</span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Export necessary objects to the cluster</span></span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"lta_lta_func3"</span>, <span class="st">"p1"</span>))</span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure packages are loaded on each cluster node</span></span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MplusAutomation)</span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Run the simulation in parallel using the cluster</span></span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a>result_list_model3 <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p1), <span class="cf">function</span>(i) {</span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lta_lta_func3</span>(p1<span class="sc">$</span>N[i], p1<span class="sc">$</span>TPs[i], p1<span class="sc">$</span>mix[i])</span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Stop the cluster when done</span></span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="part-2" class="level1">
<h1>PART 2:</h1>
<section id="objective" class="level4">
<h4 class="anchored" data-anchor-id="objective">Objective</h4>
<p>Rerun Analysis <em>with VARIED NUMBER OF REPLICATIONS to meet the 500 number threshold</em></p>
</section>
<section id="model-1-1" class="level2">
<h2 class="anchored" data-anchor-id="model-1-1">Model 1</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the Mplus object with the dynamic replications</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>lta_lta_func <span class="ot">&lt;-</span> <span class="cf">function</span>(N_numeric, TPs, Mix, Replications_Needed) {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.1: Construct the MODELPOPULATION argument based on the value of 'Mix'</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  MODELPOPULATION <span class="ot">&lt;-</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p131-p135);</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p131-p135);</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">2</span>) { </span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p131-p135);</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p131-p135);</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.2: Construct the MODEL argument based on the value of 'Mix'</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>  MODEL <span class="ot">&lt;-</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);  </span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p131-p135);</span></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:     </span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p131-p135);</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">2</span>) { </span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);  </span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*1 u14$1*1 u15$1*1] (p111-p115);</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*1 u12$1*1 u13$1*-1 u14$1*-1 u15$1*-1] (p121-p125);</span></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1 u12$1*-1 u13$1*-1 u14$1*-1 u15$1*-1] (p131-p135);</span></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:     </span></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*1 u24$1*1 u25$1*1] (p111-p115);</span></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*1 u22$1*1 u23$1*-1 u24$1*-1 u25$1*-1] (p121-p125);</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1 u22$1*-1 u23$1*-1 u24$1*-1 u25$1*-1] (p131-p135);</span></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.3: Construct the MODELCONSTRAINT argument based on the value of 'TPs'</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>  MODELCONSTRAINT <span class="ot">&lt;-</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="fl">3.179</span>) {</span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.8 trans12*.1 trans13*.1 </span></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">407</span>) {</span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.2 trans12*.4 trans13*.4 </span></span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 3: Construct the Mplus object</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a>  LTA_LTA <span class="ot">&lt;-</span> <span class="fu">mplusObject</span>(</span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE =</span> <span class="fu">glue</span>(<span class="st">"Generate LTA_LTA_M1_N_{N_numeric}_TP_{TPs}_M_{Mix}"</span>),</span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">MONTECARLO =</span> <span class="fu">glue</span>(<span class="st">"NAMES = u11-u15 u21-u25;</span></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a><span class="st">      GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a><span class="st">      CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a><span class="st">      GENCLASSES = c1(3) c2(3);</span></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a><span class="st">      CLASSES = c1(3) c2(3);</span></span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a><span class="st">      NOBSERVATIONS = {N_numeric};</span></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a><span class="st">      SEED = 07252005;</span></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a><span class="st">      NREPS = {Replications_Needed};</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a><span class="st">      !SAVE = repM1*.dat;</span></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a><span class="st">      RESULTS = LTA_LTA_M1_N_{N_numeric}_TP_{TPs}_M_{Mix}.csv;"</span>),</span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANALYSIS =</span> <span class="st">"TYPE = MIXTURE;</span></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a><span class="st">      algorithm = integration;</span></span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a><span class="st">      STARTS = 50 10;</span></span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a><span class="st">      processors = 24;</span></span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a><span class="st">      MITERATIONS = 1000;</span></span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a><span class="st">      logcriterion=0.00001;</span></span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a><span class="st">      mconv=0.00001;"</span>,</span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELPOPULATION =</span> MODELPOPULATION,</span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODEL =</span> MODEL,</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELCONSTRAINT =</span> MODELCONSTRAINT</span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run Mplus model</span></span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a>  LTA_LTA_Model <span class="ot">&lt;-</span> <span class="fu">mplusModeler</span>(</span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a>    LTA_LTA, </span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataout =</span> <span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE_REP"</span>, <span class="fu">glue</span>(<span class="st">"LTA_LTA_N_{N_numeric}_TP_{TPs}_M_{Mix}.dat"</span>)),</span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">modelout =</span> <span class="fu">glue</span>(<span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE_REP"</span>, <span class="st">"LTA_LTA_M1_N_{N_numeric}_TP_{TPs}_M_{Mix}.inp"</span>)),</span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">check =</span> <span class="cn">TRUE</span>, <span class="at">run =</span> <span class="cn">TRUE</span>, <span class="at">hashfilename =</span> <span class="cn">FALSE</span></span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LTA_LTA_Model)</span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the cluster</span></span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Select the cluster type based on the system (PSOCK for Windows, FORK for macOS/Linux)</span></span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a>cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>)</span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)</span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Export necessary objects to the cluster</span></span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"lta_lta_func"</span>, <span class="st">"model1_data"</span>, <span class="st">"here"</span>, <span class="st">"glue"</span>, <span class="st">"mplusModeler"</span>, <span class="st">"mplusObject"</span>))</span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure required libraries are loaded on each node</span></span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MplusAutomation)</span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a>result_list <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(model1_data), <span class="cf">function</span>(i) {</span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lta_lta_func</span>(</span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a>    model1_data<span class="sc">$</span>N_numeric[i], </span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a>    model1_data<span class="sc">$</span>TPs[i],  </span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a>    model1_data<span class="sc">$</span>Mix[i],  </span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a>    model1_data<span class="sc">$</span>Replications_Needed[i]</span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a><span class="co"># Stop the cluster after the simulation</span></span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-2" class="level2">
<h2 class="anchored" data-anchor-id="model-2">Model 2:</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the Mplus object with the dynamic replications</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lta_lta_func2 <span class="ot">&lt;-</span> <span class="cf">function</span>(N_numeric, TPs, Mix, Replications_Needed) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.1: Construct the MODELPOPULATION argument based on 'mix'</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  MODELPOPULATION <span class="ot">&lt;-</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*-1.21 u13$1*-1.45 u14$1*-1.55 u15$1*-5] (p111-p115);</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*-5 u13$1*.94 u14$1*-.02 u15$1*-.89] (p121-p125);</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*1.55 u13$1*4.17 u14$1*-.16 u15$1*-1.99] (p131-p135);</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*-1.21 u23$1*-1.45 u24$1*-1.55 u25$1*-5] (p111-p115);</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*-5 u23$1*.94 u24$1*-.02 u25$1*-.89] (p121-p125);</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*1.55 u23$1*4.17 u24$1*-.16 u25$1*-1.99] (p131-p135);</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*-1.21 u13$1*-1.45 u14$1*-1.55 u15$1*-5] (p111-p115);</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*-5 u13$1*.94 u14$1*-.02 u15$1*-.89] (p121-p125);</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*1.55 u13$1*4.17 u14$1*-.16 u15$1*-1.99] (p131-p135);</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*-1.21 u23$1*-1.45 u24$1*-1.55 u25$1*-5] (p111-p115);</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*-5 u23$1*.94 u24$1*-.02 u25$1*-.89] (p121-p125);</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*1.55 u23$1*4.17 u24$1*-.16 u25$1*-1.99] (p131-p135);</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.2: Construct the MODEL argument based on 'mix'</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>  MODEL <span class="ot">&lt;-</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*-1.21 u13$1*-1.45 u14$1*-1.55 u15$1*-5] (p111-p115);</span></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*-5 u13$1*.94 u14$1*-.02 u15$1*-.89] (p121-p125);</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*1.55 u13$1*4.17 u14$1*-.16 u15$1*-1.99] (p131-p135);</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*-1.21 u23$1*-1.45 u24$1*-1.55 u25$1*-5] (p111-p115);</span></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*-5 u23$1*.94 u24$1*-.02 u25$1*-.89] (p121-p125);</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*1.55 u23$1*4.17 u24$1*-.16 u25$1*-1.99] (p131-p135);</span></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);</span></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*-1.21 u13$1*-1.45 u14$1*-1.55 u15$1*-5] (p111-p115);</span></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*-5 u13$1*.94 u14$1*-.02 u15$1*-.89] (p121-p125);</span></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-5 u12$1*1.55 u13$1*4.17 u14$1*-.16 u15$1*-1.99] (p131-p135);</span></span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:</span></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*-1.21 u23$1*-1.45 u24$1*-1.55 u25$1*-5] (p111-p115);</span></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*-5 u23$1*.94 u24$1*-.02 u25$1*-.89] (p121-p125);</span></span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-5 u22$1*1.55 u23$1*4.17 u24$1*-.16 u25$1*-1.99] (p131-p135);</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.3: Construct the MODELCONSTRAINT argument based on 'TPs'</span></span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>  MODELCONSTRAINT <span class="ot">&lt;-</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="fl">3.179</span>) {</span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.8 trans12*.1 trans13*.1 </span></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">407</span>) {</span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.2 trans12*.4 trans13*.4 </span></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.4: Create and run Mplus model</span></span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a>  LTA_LTA2 <span class="ot">&lt;-</span> <span class="fu">mplusObject</span>(</span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE =</span> <span class="fu">glue</span>(<span class="st">"Generate LTA_LTA_M2_N_{N_numeric}_TP_{TPs}_M_{Mix}"</span>),</span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">MONTECARLO =</span> <span class="fu">glue</span>(<span class="st">"NAMES = u11-u15 u21-u25;</span></span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a><span class="st">      GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a><span class="st">      CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a><span class="st">      GENCLASSES = c1(3) c2(3);</span></span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a><span class="st">      CLASSES = c1(3) c2(3);</span></span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a><span class="st">      NOBSERVATIONS = {N_numeric};</span></span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a><span class="st">      SEED = 07252005;</span></span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a><span class="st">      NREPS = {Replications_Needed};</span></span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a><span class="st">      !SAVE = repM2*.dat;</span></span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a><span class="st">      RESULTS = LTA_LTA_M2_N_{N_numeric}_TP_{TPs}_M_{Mix}.csv;"</span>),</span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANALYSIS =</span> <span class="st">"TYPE = MIXTURE;</span></span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a><span class="st">      algorithm = integration;</span></span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a><span class="st">      STARTS = 50 10;</span></span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a><span class="st">      processors = 24;</span></span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a><span class="st">      miterations = 1000; </span></span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a><span class="st">      logcriterion=0.00001;</span></span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a><span class="st">      mconv=0.00001;"</span>,</span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELPOPULATION =</span> MODELPOPULATION,</span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODEL =</span> MODEL,</span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELCONSTRAINT =</span> MODELCONSTRAINT</span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>  LTA_LTA_Model2 <span class="ot">&lt;-</span> <span class="fu">mplusModeler</span>(</span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>    LTA_LTA2, </span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataout =</span> <span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE_REP"</span>, <span class="fu">glue</span>(<span class="st">"LTA_LTA_M2_N_{N_numeric}_TP_{TPs}_M_{Mix}.dat"</span>)),</span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">modelout =</span> <span class="fu">glue</span>(<span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE_REP"</span>, <span class="st">"LTA_LTA_M2_N_{N_numeric}_TP_{TPs}_M_{Mix}.inp"</span>)),</span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">check =</span> <span class="cn">TRUE</span>, <span class="at">run =</span> <span class="cn">TRUE</span>, <span class="at">hashfilename =</span> <span class="cn">FALSE</span></span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LTA_LTA_Model2)</span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the cluster</span></span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Select the cluster type based on the system (PSOCK for Windows, FORK for macOS/Linux)</span></span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a>cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>)</span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)</span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a><span class="co"># Export necessary objects to the cluster</span></span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"lta_lta_func2"</span>, <span class="st">"model2_table"</span>, <span class="st">"here"</span>, <span class="st">"glue"</span>, <span class="st">"mplusModeler"</span>, <span class="st">"mplusObject"</span>))</span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure required libraries are loaded on each node</span></span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MplusAutomation)</span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a>result_list <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(model2_data), <span class="cf">function</span>(i) {</span>
<span id="cb7-207"><a href="#cb7-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lta_lta_func2</span>(</span>
<span id="cb7-208"><a href="#cb7-208" aria-hidden="true" tabindex="-1"></a>    model2_data<span class="sc">$</span>N_numeric[i], </span>
<span id="cb7-209"><a href="#cb7-209" aria-hidden="true" tabindex="-1"></a>    model2_data<span class="sc">$</span>TPs[i],  </span>
<span id="cb7-210"><a href="#cb7-210" aria-hidden="true" tabindex="-1"></a>    model2_data<span class="sc">$</span>Mix[i],  </span>
<span id="cb7-211"><a href="#cb7-211" aria-hidden="true" tabindex="-1"></a>    model2_data<span class="sc">$</span>Replications_Needed[i]</span>
<span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a><span class="co"># Stop the cluster after the simulation</span></span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-3" class="level2">
<h2 class="anchored" data-anchor-id="model-3">Model 3:</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the Mplus object with the dynamic replications</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>lta_lta_func3 <span class="ot">&lt;-</span> <span class="cf">function</span>(N_numeric, TPs, Mix, Replications_Needed) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.1: Construct the MODELPOPULATION argument for Model 3 based on 'mix'</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  MODELPOPULATION <span class="ot">&lt;-</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*2.38 u13$1*3.18 u14$1*4.59 u15$1*4.59] (p111-p115);</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*.62 u12$1*.81 u13$1*.82 u14$1*.28 u15$1*1.39] (p121-p125);</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1.45 u12$1*-2.44 u13$1*-5 u14$1*-1.70 u15$1*-.71] (p131-p135);</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*2.38 u23$1*3.18 u24$1*4.59 u25$1*4.59] (p111-p115);</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*.62 u22$1*.81 u23$1*.82 u24$1*.28 u25$1*1.39] (p121-p125);</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1.45 u22$1*-2.44 u23$1*-5 u24$1*-1.70 u25$1*-.71] (p131-p135);</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">2</span>) { </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] ; </span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] ; </span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs};</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1; </span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1; </span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147;</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c1:</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*2.38 u13$1*3.18 u14$1*4.59 u15$1*4.59] (p111-p115);</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*.62 u12$1*.81 u13$1*.82 u14$1*.28 u15$1*1.39] (p121-p125);</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1.45 u12$1*-2.44 u13$1*-5 u14$1*-1.70 u15$1*-.71] (p131-p135);</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL POPULATION-c2:  </span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*2.38 u23$1*3.18 u24$1*4.59 u25$1*4.59] (p111-p115);</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*.62 u22$1*.81 u23$1*.82 u24$1*.28 u25$1*1.39] (p121-p125);</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1.45 u22$1*-2.44 u23$1*-5 u24$1*-1.70 u25$1*-.71] (p131-p135);</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.2: Construct the MODEL argument for Model 3 based on 'mix'</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>  MODEL <span class="ot">&lt;-</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*0] ;</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*0] ;</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*2.38 u13$1*3.18 u14$1*4.59 u15$1*4.59] (p111-p115);</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*.62 u12$1*.81 u13$1*.82 u14$1*.28 u15$1*1.39] (p121-p125);</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1.45 u12$1*-2.44 u13$1*-5 u14$1*-1.70 u15$1*-.71] (p131-p135);</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:     </span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*2.38 u23$1*3.18 u24$1*4.59 u25$1*4.59] (p111-p115);</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*.62 u22$1*.81 u23$1*.82 u24$1*.28 u25$1*1.39] (p121-p125);</span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1.45 u22$1*-2.44 u23$1*-5 u24$1*-1.70 u25$1*-.71] (p131-p135);</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)      </span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Mix <span class="sc">==</span> <span class="dv">2</span>) { </span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"  </span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a><span class="st">      %OVERALL%</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#1*1.897] ;</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a><span class="st">      [c1#2*1.099] ;</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#1*-1.1] (a1);</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a><span class="st">      [c2#2*-1.1] (a2); </span></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#1*{TPs} (b11); </span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#1 on c1#2*1.1 (b21); </span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#1*1.1 (b12); </span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a><span class="st">      c2#2 on c1#2*1.793147 (b22);</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c1:</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#1%</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*5 u12$1*2.38 u13$1*3.18 u14$1*4.59 u15$1*4.59] (p111-p115);</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#2%</span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*.62 u12$1*.81 u13$1*.82 u14$1*.28 u15$1*1.39] (p121-p125);</span></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a><span class="st">      %c1#3%</span></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a><span class="st">      [u11$1*-1.45 u12$1*-2.44 u13$1*-5 u14$1*-1.70 u15$1*-.71] (p131-p135);</span></span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a><span class="st">      MODEL c2:     </span></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#1%</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*5 u22$1*2.38 u23$1*3.18 u24$1*4.59 u25$1*4.59] (p111-p115);</span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#2%</span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*.62 u22$1*.81 u23$1*.82 u24$1*.28 u25$1*1.39] (p121-p125);</span></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a><span class="st">      %c2#3%</span></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a><span class="st">      [u21$1*-1.45 u22$1*-2.44 u23$1*-5 u24$1*-1.70 u25$1*-.71] (p131-p135);</span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)      </span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.3: Construct the MODELCONSTRAINT argument based on TPs</span></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>  MODELCONSTRAINT <span class="ot">&lt;-</span> <span class="cf">if</span> (TPs <span class="sc">==</span> <span class="fl">3.179</span>) {</span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.8 trans12*.1 trans13*.1 </span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (TPs <span class="sc">==</span> .<span class="dv">407</span>) {</span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a><span class="st">      New(</span></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a><span class="st">        trans11*.2 trans12*.4 trans13*.4 </span></span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a><span class="st">        trans21*.25 trans22*.5 trans23*.25);</span></span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a><span class="st">      trans11 = exp(a1+b11)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a><span class="st">      trans12 = exp(a2+b12)/(exp(a1+b11)+exp(a2+b12)+1);</span></span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a><span class="st">      trans13 = 1-(trans11+trans12);</span></span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a><span class="st">      trans21 = exp(a1+b21)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a><span class="st">      trans22 = exp(a2+b22)/(exp(a1+b21)+exp(a2+b22)+1);</span></span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a><span class="st">      trans23 = 1-(trans21+trans22);</span></span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>)</span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2.4: Create and run Mplus model</span></span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>  LTA_LTA3 <span class="ot">&lt;-</span> <span class="fu">mplusObject</span>(</span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE =</span> <span class="fu">glue</span>(<span class="st">"Generate LTA_LTA_M3_N_{N_numeric}_TP_{TPs}_M_{Mix}"</span>),</span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">MONTECARLO =</span> <span class="fu">glue</span>(<span class="st">"NAMES = u11-u15 u21-u25;</span></span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a><span class="st">      GENERATE = u11-u15 u21-u25(1);</span></span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a><span class="st">      CATEGORICAL = u11-u15 u21-u25;</span></span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a><span class="st">      GENCLASSES = c1(3) c2(3);</span></span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a><span class="st">      CLASSES = c1(3) c2(3);</span></span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a><span class="st">      NOBSERVATIONS = {N_numeric};</span></span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a><span class="st">      SEED = 07252005;</span></span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a><span class="st">      NREPS = {Replications_Needed};</span></span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a><span class="st">      !SAVE = repM3*.dat;</span></span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a><span class="st">      RESULTS = LTA_LTA_M3_N_{N_numeric}_TP_{TPs}_M_{Mix}.csv;"</span>),</span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANALYSIS =</span> <span class="st">"TYPE = MIXTURE;</span></span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a><span class="st">      algorithm = integration;</span></span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a><span class="st">      STARTS = 50 10;</span></span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a><span class="st">      processors = 24;</span></span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a><span class="st">      miterations = 1000;</span></span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a><span class="st">      logcriterion=0.00001;</span></span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a><span class="st">      mconv=0.00001;"</span>,</span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELPOPULATION =</span> MODELPOPULATION,</span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODEL =</span> MODEL,</span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">MODELCONSTRAINT =</span> MODELCONSTRAINT</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run Mplus model</span></span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>  LTA_LTA_Model3 <span class="ot">&lt;-</span> <span class="fu">mplusModeler</span>(LTA_LTA3, </span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dataout =</span> <span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE_REP_REP"</span>, <span class="fu">glue</span>(<span class="st">"LTA_LTA_M3_N_{N_numeric}_TP_{TPs}_M_{Mix}.dat"</span>)),</span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">modelout =</span> <span class="fu">glue</span>(<span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE_REP"</span>, <span class="st">"LTA_LTA_M3_N_{N_numeric}_TP_{TPs}_M_{Mix}.inp"</span>)),</span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">check =</span> <span class="cn">TRUE</span>, <span class="at">run =</span> <span class="cn">TRUE</span>, <span class="at">hashfilename =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(LTA_LTA_Model3)</span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the cluster</span></span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Select the cluster type based on the system (PSOCK for Windows, FORK for macOS/Linux)</span></span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a>cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>)</span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)</span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a><span class="co"># Export necessary objects to the cluster</span></span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"lta_lta_func3"</span>, <span class="st">"model3_data"</span>, <span class="st">"here"</span>, <span class="st">"glue"</span>, <span class="st">"mplusModeler"</span>, <span class="st">"mplusObject"</span>))</span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure required libraries are loaded on each node</span></span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MplusAutomation)</span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a>result_list <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(model3_data), <span class="cf">function</span>(i) {</span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lta_lta_func3</span>(</span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a>    model3_data<span class="sc">$</span>N_numeric[i], </span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a>    model3_data<span class="sc">$</span>TPs[i],  </span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a>    model3_data<span class="sc">$</span>Mix[i],  </span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a>    model3_data<span class="sc">$</span>Replications_Needed[i]</span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a><span class="co"># Stop the cluster after the simulation</span></span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="check-for-label-switching" class="level1">
<h1>CHECK FOR LABEL SWITCHING</h1>
<p><strong>Objective:</strong>&nbsp;</p>
<p><em>Load all CSV files, combine them into a single data frame, and include the file name as a column.</em></p>
<section id="step-1-combine-all-csv-files-into-one-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="step-1-combine-all-csv-files-into-one-data-frame">Step 1: Combine All CSV Files into One Data Frame</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the directory where your CSV files are stored</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>csv_directory <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"1_LTA_GEN_LTA_ANLZE"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: List all CSV files in the directory</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>csv_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> csv_directory, <span class="at">pattern =</span> <span class="st">"*.csv"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Define a function to read and process each CSV file</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>read_csv_file <span class="ot">&lt;-</span> <span class="cf">function</span>(file) {</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">header =</span> <span class="cn">FALSE</span>)  <span class="co"># Read the CSV file</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>FileName <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">.[^.]*$"</span>, <span class="st">""</span>, <span class="fu">basename</span>(file))  <span class="co"># Remove the file extension</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Set up for parallel processing</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>) </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Create and run the cluster</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"read_csv_file"</span>, <span class="st">"gsub"</span>))</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">parLapply</span>(cl, csv_files, read_csv_file))</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)  <span class="co"># Stop the cluster after processing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-2-scrape-rows-and-process-data" class="level3">
<h3 class="anchored" data-anchor-id="step-2-scrape-rows-and-process-data">Step 2: Scrape Rows and Process Data</h3>
<p><strong>Objective:</strong>&nbsp;</p>
<p>Extract data from the appropriate rows from each 9-row chunk and prepare the data for further processing.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set up the number of cores to use (leave one core free for the system)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Select the cluster type based on the system (PSOCK for Windows, FORK for macOS/Linux)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Create the cluster</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Export necessary variables to each worker in the cluster</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"combined_data"</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Define the function to process each 9-row chunk</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>process_chunk <span class="ot">&lt;-</span> <span class="cf">function</span>(chunk_start, data) {</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (chunk_start <span class="sc">+</span> <span class="dv">8</span> <span class="sc">&lt;=</span> <span class="fu">nrow</span>(data)) {</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    row1 <span class="ot">&lt;-</span> data[chunk_start, ]        <span class="co"># Row 1</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    row2 <span class="ot">&lt;-</span> data[chunk_start <span class="sc">+</span> <span class="dv">1</span>, ]    <span class="co"># Row 2</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    row3 <span class="ot">&lt;-</span> data[chunk_start <span class="sc">+</span> <span class="dv">2</span>, ]    <span class="co"># Row 3</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    row4 <span class="ot">&lt;-</span> data[chunk_start <span class="sc">+</span> <span class="dv">3</span>, ]    <span class="co"># Row 4 (TRANS11)</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    row7 <span class="ot">&lt;-</span> data[chunk_start <span class="sc">+</span> <span class="dv">6</span>, ]    <span class="co"># Row 7 (SE_11)</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 5.1: Extract relevant data</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    rep_variable <span class="ot">&lt;-</span> row1[<span class="dv">1</span>]                      <span class="co"># Replication number from row 1, column 1</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    columns_1_to_10 <span class="ot">&lt;-</span> row2[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]                <span class="co"># Columns 1-10 from row 2</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    columns_1_to_5 <span class="ot">&lt;-</span> row3[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]                  <span class="co"># Columns 1-5 from row 3</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    trans11 <span class="ot">&lt;-</span> row4[<span class="dv">4</span>]                           <span class="co"># Column 4 from row 4 (TRANS11)</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    se11 <span class="ot">&lt;-</span> row7[<span class="dv">4</span>]                              <span class="co"># Column 4 from row 7 (SE_11)</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 5.2: Combine extracted columns into a single row</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    combined_data_chunk <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.character</span>(row1<span class="sc">$</span>FileName), <span class="fu">as.character</span>(rep_variable), </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.numeric</span>(columns_1_to_10), <span class="fu">as.numeric</span>(columns_1_to_5),</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.numeric</span>(trans11), <span class="fu">as.numeric</span>(se11))</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 5.3: Convert the combined row into a data frame</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>    single_row_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(combined_data_chunk), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 5.4: Rename columns, ensuring TRANS11 and SE_11 are included</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(single_row_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"FileName"</span>, <span class="st">"Rep"</span>, </span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Ec1u1"</span>, <span class="st">"Ec1u2"</span>, <span class="st">"Ec1u3"</span>, <span class="st">"Ec1u4"</span>, <span class="st">"Ec1u5"</span>, </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Ec2u1"</span>, <span class="st">"Ec2u2"</span>, <span class="st">"Ec2u3"</span>, <span class="st">"Ec2u4"</span>, <span class="st">"Ec2u5"</span>,</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Ec3u1"</span>, <span class="st">"Ec3u2"</span>, <span class="st">"Ec3u3"</span>, <span class="st">"Ec3u4"</span>, <span class="st">"Ec3u5"</span>,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"TRANS11"</span>, <span class="st">"SE_11"</span>)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(single_row_df)</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Set up the sequence of chunk starts (every 9 rows)</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>chunk_starts <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(combined_data), <span class="at">by =</span> <span class="dv">9</span>)</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Process chunks in parallel using parLapply</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, chunk_starts, process_chunk, <span class="at">data =</span> combined_data)</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 8: Stop the cluster after processing</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 9: Remove NULL elements (if any chunks are skipped)</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">Filter</span>(<span class="fu">Negate</span>(is.null), final_data)</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 10: Combine all processed chunks into a single data frame</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>final_combined_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, final_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-3-convert-logits-to-probabilities-and-add-actual-population-values" class="level3">
<h3 class="anchored" data-anchor-id="step-3-convert-logits-to-probabilities-and-add-actual-population-values">Step 3: Convert Logits to Probabilities and Add Actual (Population) Values</h3>
<p><strong>Objective:</strong>&nbsp;</p>
<p>Convert the logits to probabilities and add the known actual values to each row.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "convert-logits-to-probabilities"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the corrected actual values for M1, M2, and M3</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>M1Ac1u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.73</span>, <span class="fl">0.73</span>, <span class="fl">0.73</span>, <span class="fl">0.73</span>, <span class="fl">0.73</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>M1Ac2u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.73</span>, <span class="fl">0.73</span>, <span class="fl">0.27</span>, <span class="fl">0.27</span>, <span class="fl">0.27</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>M1Ac3u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.27</span>, <span class="fl">0.27</span>, <span class="fl">0.27</span>, <span class="fl">0.27</span>, <span class="fl">0.27</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>M2Ac1u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.0067</span>, <span class="fl">0.230</span>, <span class="fl">0.190</span>, <span class="fl">0.175</span>, <span class="fl">0.0067</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>M2Ac2u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9933</span>, <span class="fl">0.0067</span>, <span class="fl">0.720</span>, <span class="fl">0.495</span>, <span class="fl">0.290</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>M2Ac3u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.0067</span>, <span class="fl">0.825</span>, <span class="fl">0.985</span>, <span class="fl">0.460</span>, <span class="fl">0.120</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>M3Ac1u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9933</span>, <span class="fl">0.915</span>, <span class="fl">0.960</span>, <span class="fl">0.990</span>, <span class="fl">0.990</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>M3Ac2u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.650</span>, <span class="fl">0.692</span>, <span class="fl">0.695</span>, <span class="fl">0.570</span>, <span class="fl">0.800</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>M3Ac3u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.190</span>, <span class="fl">0.080</span>, <span class="fl">0.0067</span>, <span class="fl">0.155</span>, <span class="fl">0.330</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Define the function to get actual values based on the model</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>get_actual_values <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"M1"</span>) {</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(M1Ac1u, M1Ac2u, M1Ac3u))</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"M2"</span>) {</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(M2Ac1u, M2Ac2u, M2Ac3u))</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"M3"</span>) {</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(M3Ac1u, M3Ac2u, M3Ac3u))</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Unknown model"</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Set up the number of cores to use (leave one core free for the system)</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Select the cluster type based on the system (PSOCK for Windows, FORK for macOS/Linux)</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Create the cluster</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Export the necessary variables and functions to the cluster workers</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"final_combined_data"</span>, <span class="st">"get_actual_values"</span>, <span class="st">"M1Ac1u"</span>, <span class="st">"M1Ac2u"</span>, <span class="st">"M1Ac3u"</span>, <span class="st">"M2Ac1u"</span>, <span class="st">"M2Ac2u"</span>, <span class="st">"M2Ac3u"</span>, <span class="st">"M3Ac1u"</span>, <span class="st">"M3Ac2u"</span>, <span class="st">"M3Ac3u"</span>))</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Define the parallelized function to process each row and add actual values</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>process_row_parallel <span class="ot">&lt;-</span> <span class="cf">function</span>(i, data) {</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">".*(M[1-3]).*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, data<span class="sc">$</span>FileName[i])  <span class="co"># Extract M1, M2, or M3 from the FileName</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>  actual_values <span class="ot">&lt;-</span> <span class="fu">get_actual_values</span>(model)               <span class="co"># Get the actual values based on the model</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  combined_row <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data[i, ], <span class="fu">as.data.frame</span>(<span class="fu">t</span>(actual_values)))</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined_row)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 8: Convert logits to probabilities for columns 3 to 17 (Ec1u1 to Ec3u5)</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>logit_columns <span class="ot">&lt;-</span> final_combined_data[, <span class="dv">3</span><span class="sc">:</span><span class="dv">17</span>]  <span class="co"># Adjust to columns 3 to 17</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>probabilities <span class="ot">&lt;-</span> <span class="fu">apply</span>(logit_columns, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">as.numeric</span>(x))), <span class="dv">2</span>))</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 9: Combine probabilities with the FileName, Rep columns, and the TRANS11 and SE_11 columns</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>final_combined_data_with_trans_se <span class="ot">&lt;-</span> final_combined_data <span class="sc">%&gt;%</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FileName, Rep, TRANS11, SE_11) <span class="sc">%&gt;%</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">as.data.frame</span>(probabilities))</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 10: Apply the function to add actual values in parallel using parLapply</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(final_combined_data_with_trans_se), process_row_parallel, <span class="at">data =</span> final_combined_data_with_trans_se)</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 11: Stop the cluster after processing</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 12: Combine the results into a data frame</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, final_data_with_actuals)</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 13: Set column names for the actual values (from Ac1u1 to Ac3u5)</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(final_data_with_actuals)[(<span class="fu">ncol</span>(final_combined_data_with_trans_se) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">ncol</span>(final_data_with_actuals)] <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ac1u1"</span>, <span class="st">"Ac1u2"</span>, <span class="st">"Ac1u3"</span>, <span class="st">"Ac1u4"</span>, <span class="st">"Ac1u5"</span>,</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ac2u1"</span>, <span class="st">"Ac2u2"</span>, <span class="st">"Ac2u3"</span>, <span class="st">"Ac2u4"</span>, <span class="st">"Ac2u5"</span>,</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ac3u1"</span>, <span class="st">"Ac3u2"</span>, <span class="st">"Ac3u3"</span>, <span class="st">"Ac3u4"</span>, <span class="st">"Ac3u5"</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 14: Round all numeric columns to 3 decimal places</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 15: Ensure that TRANS11 and SE_11 columns are numeric and rounded to 3 decimal places</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>trans_se_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TRANS11"</span>, <span class="st">"SE_11"</span>)</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals[trans_se_columns] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(final_data_with_actuals[trans_se_columns], <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">as.numeric</span>(x), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-4-calculate-comparisons-and-flag-violations" class="level3">
<h3 class="anchored" data-anchor-id="step-4-calculate-comparisons-and-flag-violations">Step 4: Calculate Comparisons and Flag Violations</h3>
<p><strong>Objective:</strong>&nbsp;</p>
<p><em>Calculate the differences between the estimate and actual sums and flag any violations.</em></p>
<p>Step 4.1 Initialize Columns</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Initialize columns for comparisons and flags</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize for Model 1 comparison and flags</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X1v3_item1 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X2v3_item2 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X1v2_item3 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize for Model 3-specific comparison and flags</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X1v3_item1_model3 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X2v3_item3_model3 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X1v2_item4_model3 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize for Model 2-specific comparison and flags</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X2v3_item1_model2 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X3v2_item2_model2 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X3v1_item3_model2 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X2v1_sum_diff <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># Initialize the new column for sum differences</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>X3v1_sum_diff <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># Initialize the new column for sum differences</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Step 4 Part 2: Add Parallel Processing Setup</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Set up the number of cores to use (leave one core free for the system)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>  </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Select the cluster type based on the system (PSOCK for Windows, FORK for macOS/Linux)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>cluster_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Create the cluster</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores, <span class="at">type =</span> cluster_type)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Export necessary variables to each worker</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"final_data_with_actuals"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Step 4: Part 3 Parallelized Row Processing</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: "parallelized-row-processing"</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through the data and apply comparisons based on the models and items</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(final_data_with_actuals)) {</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the model type (M1, M2, M3) from the FileName</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">".*(M[1-3]).*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, final_data_with_actuals<span class="sc">$</span>FileName[i])</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For Model 1 (Example 1):</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"M1"</span>) {</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class 1 vs. Class 3 on Item 1 (Ec1 - Ec3)</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X1v3_item1[i] <span class="ot">&lt;-</span> final_data_with_actuals<span class="sc">$</span>Ec1u1[i] <span class="sc">-</span> final_data_with_actuals<span class="sc">$</span>Ec3u1[i]</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class 2 vs. Class 3 on Item 2 (Ec2 - Ec3)</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X2v3_item2[i] <span class="ot">&lt;-</span> final_data_with_actuals<span class="sc">$</span>Ec2u2[i] <span class="sc">-</span> final_data_with_actuals<span class="sc">$</span>Ec3u2[i]</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class 1 vs. Class 2 on Item 3 (Ec1 - Ec2)</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X1v2_item3[i] <span class="ot">&lt;-</span> final_data_with_actuals<span class="sc">$</span>Ec1u3[i] <span class="sc">-</span> final_data_with_actuals<span class="sc">$</span>Ec2u3[i]</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"M2"</span>) {</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For Model 2 (Example 2): Keep original method AND apply new logic</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class 2 vs. Class 3 on Item 1 (Ec2 - Ec3)</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X2v3_item1_model2[i] <span class="ot">&lt;-</span> final_data_with_actuals<span class="sc">$</span>Ec2u1[i] <span class="sc">-</span> final_data_with_actuals<span class="sc">$</span>Ec3u1[i]</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class 3 vs. Class 2 on Item 2 (Ec3 - Ec2)</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X3v2_item2_model2[i] <span class="ot">&lt;-</span> final_data_with_actuals<span class="sc">$</span>Ec3u2[i] <span class="sc">-</span> final_data_with_actuals<span class="sc">$</span>Ec2u2[i]</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class 3 vs. Class 1 on Item 3 (Ec3 - Ec1)</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X3v1_item3_model2[i] <span class="ot">&lt;-</span> final_data_with_actuals<span class="sc">$</span>Ec3u3[i] <span class="sc">-</span> final_data_with_actuals<span class="sc">$</span>Ec1u3[i]</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># New logic: Subtract summed probabilities for Class 2 vs. Class 1, Class 3 vs. Class 1</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    class_2_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(final_data_with_actuals[i, <span class="fu">c</span>(<span class="st">"Ec2u1"</span>, <span class="st">"Ec2u2"</span>, <span class="st">"Ec2u3"</span>, <span class="st">"Ec2u4"</span>, <span class="st">"Ec2u5"</span>)]))</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    class_3_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(final_data_with_actuals[i, <span class="fu">c</span>(<span class="st">"Ec3u1"</span>, <span class="st">"Ec3u2"</span>, <span class="st">"Ec3u3"</span>, <span class="st">"Ec3u4"</span>, <span class="st">"Ec3u5"</span>)]))</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    class_1_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(final_data_with_actuals[i, <span class="fu">c</span>(<span class="st">"Ec1u1"</span>, <span class="st">"Ec1u2"</span>, <span class="st">"Ec1u3"</span>, <span class="st">"Ec1u4"</span>, <span class="st">"Ec1u5"</span>)]))</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assign the sums for Model 2</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X2v1_sum_diff[i] <span class="ot">&lt;-</span> class_2_sum <span class="sc">-</span> class_1_sum</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X3v1_sum_diff[i] <span class="ot">&lt;-</span> class_3_sum <span class="sc">-</span> class_1_sum</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">"M3"</span>) {</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For Model 3 (Example 3):</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class 1 vs. Class 3 on Item 1 (Ec1 - Ec3)</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X1v3_item1_model3[i] <span class="ot">&lt;-</span> final_data_with_actuals<span class="sc">$</span>Ec1u1[i] <span class="sc">-</span> final_data_with_actuals<span class="sc">$</span>Ec3u1[i]</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class 2 vs. Class 3 on Item 3 (Ec2 - Ec3)</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X2v3_item3_model3[i] <span class="ot">&lt;-</span> final_data_with_actuals<span class="sc">$</span>Ec2u3[i] <span class="sc">-</span> final_data_with_actuals<span class="sc">$</span>Ec3u3[i]</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Class 1 vs. Class 2 on Item 4 (Ec1 - Ec2)</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X1v2_item4_model3[i] <span class="ot">&lt;-</span> final_data_with_actuals<span class="sc">$</span>Ec1u4[i] <span class="sc">-</span> final_data_with_actuals<span class="sc">$</span>Ec2u4[i]</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Step 4: Part 4 Flagging Logic</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Flagging process based on at least 1 negative value (violators) for Model 1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>Flag_M1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>(<span class="fu">cbind</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X1v3_item1 <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X2v3_item2 <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X1v2_item3 <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="sc">&gt;=</span> <span class="dv">1</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Model 2 flagging (sum comparisons included) - requires at least 1 violation</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>Flag_M2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>(<span class="fu">cbind</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X2v3_item1_model2 <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X3v2_item2_model2 <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X3v1_item3_model2 <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X2v1_sum_diff <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X3v1_sum_diff <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="sc">&gt;=</span> <span class="dv">1</span>, </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Model 3 flagging - requires at least 1 violation</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>Flag_M3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>(<span class="fu">cbind</span>(</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X1v3_item1_model3 <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X2v3_item3_model3 <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    final_data_with_actuals<span class="sc">$</span>X1v2_item4_model3 <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="sc">&gt;=</span> <span class="dv">1</span>, </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Final flagging for any violation across models - if any model flag is set</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals<span class="sc">$</span>Any_Violation <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  final_data_with_actuals<span class="sc">$</span>Flag_M1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> final_data_with_actuals<span class="sc">$</span>Flag_M2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> final_data_with_actuals<span class="sc">$</span>Flag_M3 <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Step 4: Part 5 Post-processing</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that all numeric columns are rounded and suppress scientific notation</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace NA values in Any_Violation with 0</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Any_Violation =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(Any_Violation), <span class="dv">0</span>, Any_Violation))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where there are violations (Any_Violation == 1)</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>violators <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Any_Violation <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-5-plot-random-sample-of-violators-for-visual-inspection" class="level3">
<h3 class="anchored" data-anchor-id="step-5-plot-random-sample-of-violators-for-visual-inspection"><strong>Step 5: Plot Random Sample of Violators for Visual Inspection</strong></h3>
<section id="objective-1" class="level4">
<h4 class="anchored" data-anchor-id="objective-1"><strong>Objective</strong></h4>
<p><em>Generate plots of randomly sampled violators for visual inspection using parallel processing.</em></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot width and height</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>plot_width <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>plot_height <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a random sample of 250 violators</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>sampled_violators <span class="ot">&lt;-</span> violators[<span class="fu">sample</span>(<span class="fu">nrow</span>(violators), <span class="dv">250</span>), ]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to create plots sequentially (without parallelization)</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plot_violator <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  row_data <span class="ot">&lt;-</span> sampled_violators[i, ]</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the file name from the current row</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  file_name <span class="ot">&lt;-</span> row_data<span class="sc">$</span>FileName</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract probability values for EC1 through AC3 (in order)</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  probabilities <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ec1u1"</span>, <span class="st">"Ec1u2"</span>, <span class="st">"Ec1u3"</span>, <span class="st">"Ec1u4"</span>, <span class="st">"Ec1u5"</span>)]),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ec2u1"</span>, <span class="st">"Ec2u2"</span>, <span class="st">"Ec2u3"</span>, <span class="st">"Ec2u4"</span>, <span class="st">"Ec2u5"</span>)]),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ec3u1"</span>, <span class="st">"Ec3u2"</span>, <span class="st">"Ec3u3"</span>, <span class="st">"Ec3u4"</span>, <span class="st">"Ec3u5"</span>)]),</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ac1u1"</span>, <span class="st">"Ac1u2"</span>, <span class="st">"Ac1u3"</span>, <span class="st">"Ac1u4"</span>, <span class="st">"Ac1u5"</span>)]),</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ac2u1"</span>, <span class="st">"Ac2u2"</span>, <span class="st">"Ac2u3"</span>, <span class="st">"Ac2u4"</span>, <span class="st">"Ac2u5"</span>)]),</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(row_data[<span class="fu">c</span>(<span class="st">"Ac3u1"</span>, <span class="st">"Ac3u2"</span>, <span class="st">"Ac3u3"</span>, <span class="st">"Ac3u4"</span>, <span class="st">"Ac3u5"</span>)])</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create labels for the legend with actual values directly from the dataset</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"EC1: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec1u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"EC2: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec2u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"EC3: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec3u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec3u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec3u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec3u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ec3u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"AC1: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac1u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"AC2: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac2u5, <span class="dv">3</span>), <span class="st">")"</span>),</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"AC3: ("</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac3u1, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac3u2, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac3u3, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac3u4, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(row_data<span class="sc">$</span>Ac3u5, <span class="dv">3</span>), <span class="st">")"</span>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 6: Create a data frame for plotting</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Items =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">6</span>),</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">Probabilities =</span> probabilities,</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Class =</span> <span class="fu">rep</span>(labels, <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 7: Create the plot with the file name in the title</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Items, <span class="at">y =</span> Probabilities, <span class="at">color =</span> Class, <span class="at">group =</span> Class)) <span class="sc">+</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> file_name, <span class="at">x =</span> <span class="st">"Items"</span>, <span class="at">y =</span> <span class="st">"Probabilities"</span>) <span class="sc">+</span>  <span class="co"># Only the file name in the title</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span>  <span class="co"># Adjust title size and center</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>      <span class="st">"darkblue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkred"</span>,  <span class="co"># AC1 to AC3</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>      <span class="st">"lightblue"</span>, <span class="st">"lightgreen"</span>, <span class="st">"lightcoral"</span>  <span class="co"># EC1 to EC3</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="st">"z2t_lta_lta_violator_plots"</span>, <span class="fu">paste0</span>(<span class="st">"violator_plot_"</span>, i, <span class="st">"_"</span>, file_name, <span class="st">".png"</span>)),</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot =</span> p, <span class="at">width =</span> plot_width, <span class="at">height =</span> plot_height)</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to generate plots sequentially (without parallelization)</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sampled_violators), plot_violator))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="step-6-summarize-violations" class="level3">
<h3 class="anchored" data-anchor-id="step-6-summarize-violations"><strong>Step 6: Summarize Violations</strong></h3>
<section id="objective-2" class="level4">
<h4 class="anchored" data-anchor-id="objective-2"><strong>Objective</strong></h4>
<p><em>Calculate the percentage of violations for each file, handling missing values appropriately.</em></p>
</section>
<section id="step-6-part-1-create-column-names-from-the-filename" class="level4">
<h4 class="anchored" data-anchor-id="step-6-part-1-create-column-names-from-the-filename">Step 6: Part 1 Create Column Names from the Filename</h4>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns based on the information in the FileName and set factors</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>final_data_with_actuals <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"M1"</span>, FileName) <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"M2"</span>, FileName) <span class="sc">~</span> <span class="st">"2"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"M3"</span>, FileName) <span class="sc">~</span> <span class="st">"3"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"N_5000"</span>, FileName) <span class="sc">~</span> <span class="dv">4</span>,  </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"N_500"</span>, FileName) <span class="sc">~</span> <span class="dv">1</span>,   </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"N_1000"</span>, FileName) <span class="sc">~</span> <span class="dv">2</span>,  </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"N_2500"</span>, FileName) <span class="sc">~</span> <span class="dv">3</span>,  </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mixing_proportion =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"M_1"</span>, FileName) <span class="sc">~</span> <span class="dv">1</span>,  </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"M_2"</span>, FileName) <span class="sc">~</span> <span class="dv">2</span>,  </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add Population column based on FileName and convert it to a factor with formatted labels</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"TP_0.407"</span>, FileName) <span class="sc">~</span> <span class="st">"0.200"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"TP_3.179"</span>, FileName) <span class="sc">~</span> <span class="st">"0.800"</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert columns to factors</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model =</span> <span class="fu">factor</span>(Model, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Model 1"</span>, <span class="st">"Model 2"</span>, <span class="st">"Model 3"</span>)),</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">factor</span>(N, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"N = 500"</span>, <span class="st">"N = 1000"</span>, <span class="st">"N = 2500"</span>, <span class="st">"N = 5000"</span>)),</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mixing_proportion =</span> <span class="fu">factor</span>(Mixing_proportion, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Even Proportions"</span>, <span class="st">"Uneven Proportions"</span>)),</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0.200"</span>, <span class="st">"0.800"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".800"</span>))</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-6-part-2-calculate-violation-percentages-per-condition" class="level4">
<h4 class="anchored" data-anchor-id="step-6-part-2-calculate-violation-percentages-per-condition">Step 6: Part 2 Calculate Violation Percentages per Condition</h4>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure no missing values in Any_Violation and create violation summary, including Population</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> final_data_with_actuals <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Any_Violation =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Any_Violation), <span class="dv">0</span>, Any_Violation)) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName, Model, Population, N, Mixing_proportion) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows =</span> <span class="fu">n</span>(),  <span class="co"># Total rows per group</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Violations =</span> <span class="fu">sum</span>(Any_Violation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Total violations</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage_Violations =</span> (Total_Violations <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Percentage of violations</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>FileName)  <span class="co"># Remove FileName after ungrouping</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FileName', 'Model', 'Population', 'N'. You
can override using the `.groups` argument.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that all numeric columns are rounded and suppress scientific notation</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-6-part-3-summarize-visualize-label-switching-percentage-results" class="level4">
<h4 class="anchored" data-anchor-id="step-6-part-3-summarize-visualize-label-switching-percentage-results">Step 6: Part 3 Summarize &amp; Visualize Label Switching Percentage Results</h4>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert `N` to a numeric `N_numeric` for consistent use</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_numeric =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N = "</span>, <span class="st">""</span>, <span class="fu">as.character</span>(N))))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate the number of replications needed based on N_numeric, Total Violations, and Percentage Violations</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>calculate_needed_reps <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate additional runs based on the percentage of violations</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">Additional_Runs =</span> (<span class="dv">500</span> <span class="sc">+</span> Total_Violations) <span class="sc">*</span> (Percentage_Violations <span class="sc">/</span> <span class="dv">100</span>),  </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate the total replications needed, ensuring a buffer of 20</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">Replications_Needed =</span> <span class="fu">ceiling</span>(<span class="dv">500</span> <span class="sc">+</span> Total_Violations <span class="sc">+</span> Additional_Runs <span class="sc">+</span> <span class="dv">20</span>),  </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Ensure a minimum of 500 replications</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">Replications_Needed =</span> <span class="fu">if_else</span>(Replications_Needed <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="dv">500</span>, Replications_Needed)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to update violation_summary with Replications_Needed</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> <span class="fu">calculate_needed_reps</span>(violation_summary)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Update columns, and map TPs based on Population (Transition Probabilities)</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>violation_summary <span class="ot">&lt;-</span> violation_summary <span class="sc">%&gt;%</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">TPs =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">~</span> <span class="fl">1.385</span>,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".700"</span> <span class="sc">~</span> <span class="fl">0.85</span>,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".600"</span> <span class="sc">~</span> <span class="fl">0.41</span>,</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".400"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.41</span>,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".300"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.85</span>,</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>      Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">1.385</span>,</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a numeric variable for Mixing Proportion (1 or 2)</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mix =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>      Mixing_proportion <span class="sc">==</span> <span class="st">"Even Proportions"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>      Mixing_proportion <span class="sc">==</span> <span class="st">"Uneven Proportions"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Transition Probability</span><span class="st">`</span> <span class="ot">=</span> Population  <span class="co"># Rename for clarity in display</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to filter and format data for each model as a data frame, without `gt` display formatting</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>create_model_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data, model) {</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Model <span class="sc">==</span> model) <span class="sc">%&gt;%</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Transition Probability</span><span class="st">`</span>,  <span class="co"># Show transition probabilities</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>      TPs,                       <span class="co"># Logit values for MplusAutomation</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>      N_numeric,                 <span class="co"># Consistent naming for MplusAutomation</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Mixing Proportion</span><span class="st">`</span> <span class="ot">=</span> Mixing_proportion,  <span class="co"># Include mixing proportions</span></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>      Mix,                       <span class="co"># Numeric mixing proportion</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Mplus Runs</span><span class="st">`</span> <span class="ot">=</span> Total_Rows,  <span class="co"># Total number of Mplus runs</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Violations</span><span class="st">`</span> <span class="ot">=</span> Total_Violations,  <span class="co"># Show total violations</span></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">% of Violations</span><span class="st">`</span> <span class="ot">=</span> Percentage_Violations,  <span class="co"># Show percentage of violations</span></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>      Replications_Needed  <span class="co"># Include the calculated replications needed</span></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the updated function to create data frames for each model</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>model1_data <span class="ot">&lt;-</span> <span class="fu">create_model_data</span>(violation_summary, <span class="st">"Model 1"</span>)</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>model2_data <span class="ot">&lt;-</span> <span class="fu">create_model_data</span>(violation_summary, <span class="st">"Model 2"</span>)</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>model3_data <span class="ot">&lt;-</span> <span class="fu">create_model_data</span>(violation_summary, <span class="st">"Model 3"</span>)</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Create display tables using `gt` if needed</span></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>model1_table <span class="ot">&lt;-</span> model1_data <span class="sc">%&gt;%</span></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model 1: Monte Carlo Results"</span>,</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Percentage of Cases with Label Switching and Replications Needed"</span></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">columns =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(<span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>), <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">everything</span>()))</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>model2_table <span class="ot">&lt;-</span> model2_data <span class="sc">%&gt;%</span></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model 2: Monte Carlo Results"</span>,</span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Percentage of Cases with Label Switching and Replications Needed"</span></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">columns =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(<span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>), <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">everything</span>()))</span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>model3_table <span class="ot">&lt;-</span> model3_data <span class="sc">%&gt;%</span></span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model 3: Monte Carlo Results"</span>,</span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Percentage of Cases with Label Switching and Replications Needed"</span></span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">columns =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(<span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>), <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">everything</span>()))</span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the tables (optional, for review)</span></span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a>model1_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ghbailzjmg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ghbailzjmg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ghbailzjmg thead, #ghbailzjmg tbody, #ghbailzjmg tfoot, #ghbailzjmg tr, #ghbailzjmg td, #ghbailzjmg th {
  border-style: none;
}

#ghbailzjmg p {
  margin: 0;
  padding: 0;
}

#ghbailzjmg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ghbailzjmg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ghbailzjmg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ghbailzjmg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ghbailzjmg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ghbailzjmg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ghbailzjmg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ghbailzjmg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ghbailzjmg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ghbailzjmg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ghbailzjmg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ghbailzjmg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ghbailzjmg .gt_spanner_row {
  border-bottom-style: hidden;
}

#ghbailzjmg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ghbailzjmg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ghbailzjmg .gt_from_md > :first-child {
  margin-top: 0;
}

#ghbailzjmg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ghbailzjmg .gt_row {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ghbailzjmg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ghbailzjmg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ghbailzjmg .gt_row_group_first td {
  border-top-width: 2px;
}

#ghbailzjmg .gt_row_group_first th {
  border-top-width: 2px;
}

#ghbailzjmg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghbailzjmg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ghbailzjmg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ghbailzjmg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ghbailzjmg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghbailzjmg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ghbailzjmg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ghbailzjmg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ghbailzjmg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ghbailzjmg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ghbailzjmg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghbailzjmg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ghbailzjmg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghbailzjmg .gt_left {
  text-align: left;
}

#ghbailzjmg .gt_center {
  text-align: center;
}

#ghbailzjmg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ghbailzjmg .gt_font_normal {
  font-weight: normal;
}

#ghbailzjmg .gt_font_bold {
  font-weight: bold;
}

#ghbailzjmg .gt_font_italic {
  font-style: italic;
}

#ghbailzjmg .gt_super {
  font-size: 65%;
}

#ghbailzjmg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ghbailzjmg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ghbailzjmg .gt_indent_1 {
  text-indent: 5px;
}

#ghbailzjmg .gt_indent_2 {
  text-indent: 10px;
}

#ghbailzjmg .gt_indent_3 {
  text-indent: 15px;
}

#ghbailzjmg .gt_indent_4 {
  text-indent: 20px;
}

#ghbailzjmg .gt_indent_5 {
  text-indent: 25px;
}

#ghbailzjmg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ghbailzjmg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="9" class="gt_heading gt_title gt_font_normal">Model 1: Monte Carlo Results</th>
</tr>
<tr class="odd gt_heading">
<th colspan="9" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Percentage of Cases with Label Switching and Replications Needed</th>
</tr>
<tr class="header gt_col_headings">
<th id="Transition-Probability" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Transition Probability</th>
<th id="TPs" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">TPs</th>
<th id="N_numeric" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">N_numeric</th>
<th id="Mixing-Proportion" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Mixing Proportion</th>
<th id="Mix" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Mix</th>
<th id="Total-Mplus-Runs" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total Mplus Runs</th>
<th id="Total-Violations" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total Violations</th>
<th id="a%-of-Violations" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">% of Violations</th>
<th id="Replications_Needed" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Replications_Needed</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">143</td>
<td class="gt_row gt_center" headers="% of Violations">28.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">847</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">117</td>
<td class="gt_row gt_center" headers="% of Violations">23.400</td>
<td class="gt_row gt_center" headers="Replications_Needed">782</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">156</td>
<td class="gt_row gt_center" headers="% of Violations">31.200</td>
<td class="gt_row gt_center" headers="Replications_Needed">881</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">118</td>
<td class="gt_row gt_center" headers="% of Violations">23.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">784</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">136</td>
<td class="gt_row gt_center" headers="% of Violations">27.200</td>
<td class="gt_row gt_center" headers="Replications_Needed">829</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">99</td>
<td class="gt_row gt_center" headers="% of Violations">19.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">738</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">141</td>
<td class="gt_row gt_center" headers="% of Violations">28.200</td>
<td class="gt_row gt_center" headers="Replications_Needed">842</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">120</td>
<td class="gt_row gt_center" headers="% of Violations">24.000</td>
<td class="gt_row gt_center" headers="Replications_Needed">789</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">108</td>
<td class="gt_row gt_center" headers="% of Violations">21.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">760</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">102</td>
<td class="gt_row gt_center" headers="% of Violations">20.400</td>
<td class="gt_row gt_center" headers="Replications_Needed">745</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">159</td>
<td class="gt_row gt_center" headers="% of Violations">31.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">889</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">123</td>
<td class="gt_row gt_center" headers="% of Violations">24.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">797</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">169</td>
<td class="gt_row gt_center" headers="% of Violations">33.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">916</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">498</td>
<td class="gt_row gt_center" headers="Total Violations">117</td>
<td class="gt_row gt_center" headers="% of Violations">23.494</td>
<td class="gt_row gt_center" headers="Replications_Needed">782</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">145</td>
<td class="gt_row gt_center" headers="% of Violations">29.000</td>
<td class="gt_row gt_center" headers="Replications_Needed">853</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">497</td>
<td class="gt_row gt_center" headers="Total Violations">129</td>
<td class="gt_row gt_center" headers="% of Violations">25.956</td>
<td class="gt_row gt_center" headers="Replications_Needed">813</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>model2_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="xiqzzyhszs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xiqzzyhszs table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xiqzzyhszs thead, #xiqzzyhszs tbody, #xiqzzyhszs tfoot, #xiqzzyhszs tr, #xiqzzyhszs td, #xiqzzyhszs th {
  border-style: none;
}

#xiqzzyhszs p {
  margin: 0;
  padding: 0;
}

#xiqzzyhszs .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xiqzzyhszs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xiqzzyhszs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xiqzzyhszs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xiqzzyhszs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xiqzzyhszs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xiqzzyhszs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xiqzzyhszs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xiqzzyhszs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xiqzzyhszs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xiqzzyhszs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xiqzzyhszs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xiqzzyhszs .gt_spanner_row {
  border-bottom-style: hidden;
}

#xiqzzyhszs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xiqzzyhszs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xiqzzyhszs .gt_from_md > :first-child {
  margin-top: 0;
}

#xiqzzyhszs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xiqzzyhszs .gt_row {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xiqzzyhszs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xiqzzyhszs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xiqzzyhszs .gt_row_group_first td {
  border-top-width: 2px;
}

#xiqzzyhszs .gt_row_group_first th {
  border-top-width: 2px;
}

#xiqzzyhszs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xiqzzyhszs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xiqzzyhszs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xiqzzyhszs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xiqzzyhszs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xiqzzyhszs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xiqzzyhszs .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xiqzzyhszs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xiqzzyhszs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xiqzzyhszs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xiqzzyhszs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xiqzzyhszs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xiqzzyhszs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xiqzzyhszs .gt_left {
  text-align: left;
}

#xiqzzyhszs .gt_center {
  text-align: center;
}

#xiqzzyhszs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xiqzzyhszs .gt_font_normal {
  font-weight: normal;
}

#xiqzzyhszs .gt_font_bold {
  font-weight: bold;
}

#xiqzzyhszs .gt_font_italic {
  font-style: italic;
}

#xiqzzyhszs .gt_super {
  font-size: 65%;
}

#xiqzzyhszs .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xiqzzyhszs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xiqzzyhszs .gt_indent_1 {
  text-indent: 5px;
}

#xiqzzyhszs .gt_indent_2 {
  text-indent: 10px;
}

#xiqzzyhszs .gt_indent_3 {
  text-indent: 15px;
}

#xiqzzyhszs .gt_indent_4 {
  text-indent: 20px;
}

#xiqzzyhszs .gt_indent_5 {
  text-indent: 25px;
}

#xiqzzyhszs .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xiqzzyhszs div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="9" class="gt_heading gt_title gt_font_normal">Model 2: Monte Carlo Results</th>
</tr>
<tr class="odd gt_heading">
<th colspan="9" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Percentage of Cases with Label Switching and Replications Needed</th>
</tr>
<tr class="header gt_col_headings">
<th id="Transition-Probability" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Transition Probability</th>
<th id="TPs" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">TPs</th>
<th id="N_numeric" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">N_numeric</th>
<th id="Mixing-Proportion" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Mixing Proportion</th>
<th id="Mix" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Mix</th>
<th id="Total-Mplus-Runs" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total Mplus Runs</th>
<th id="Total-Violations" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total Violations</th>
<th id="a%-of-Violations" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">% of Violations</th>
<th id="Replications_Needed" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Replications_Needed</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">499</td>
<td class="gt_row gt_center" headers="Total Violations">30</td>
<td class="gt_row gt_center" headers="% of Violations">6.012</td>
<td class="gt_row gt_center" headers="Replications_Needed">582</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">76</td>
<td class="gt_row gt_center" headers="% of Violations">15.200</td>
<td class="gt_row gt_center" headers="Replications_Needed">684</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">499</td>
<td class="gt_row gt_center" headers="Total Violations">70</td>
<td class="gt_row gt_center" headers="% of Violations">14.028</td>
<td class="gt_row gt_center" headers="Replications_Needed">670</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">499</td>
<td class="gt_row gt_center" headers="Total Violations">66</td>
<td class="gt_row gt_center" headers="% of Violations">13.226</td>
<td class="gt_row gt_center" headers="Replications_Needed">661</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">499</td>
<td class="gt_row gt_center" headers="Total Violations">20</td>
<td class="gt_row gt_center" headers="% of Violations">4.008</td>
<td class="gt_row gt_center" headers="Replications_Needed">561</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">71</td>
<td class="gt_row gt_center" headers="% of Violations">14.200</td>
<td class="gt_row gt_center" headers="Replications_Needed">673</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">499</td>
<td class="gt_row gt_center" headers="Total Violations">59</td>
<td class="gt_row gt_center" headers="% of Violations">11.824</td>
<td class="gt_row gt_center" headers="Replications_Needed">646</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">499</td>
<td class="gt_row gt_center" headers="Total Violations">84</td>
<td class="gt_row gt_center" headers="% of Violations">16.834</td>
<td class="gt_row gt_center" headers="Replications_Needed">703</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">20</td>
<td class="gt_row gt_center" headers="% of Violations">4.000</td>
<td class="gt_row gt_center" headers="Replications_Needed">561</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">54</td>
<td class="gt_row gt_center" headers="% of Violations">10.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">634</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">69</td>
<td class="gt_row gt_center" headers="% of Violations">13.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">668</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">74</td>
<td class="gt_row gt_center" headers="% of Violations">14.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">679</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">34</td>
<td class="gt_row gt_center" headers="% of Violations">6.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">591</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">48</td>
<td class="gt_row gt_center" headers="% of Violations">9.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">621</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">61</td>
<td class="gt_row gt_center" headers="% of Violations">12.200</td>
<td class="gt_row gt_center" headers="Replications_Needed">650</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">54</td>
<td class="gt_row gt_center" headers="% of Violations">10.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">634</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model3_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tjpajtfxlp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tjpajtfxlp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tjpajtfxlp thead, #tjpajtfxlp tbody, #tjpajtfxlp tfoot, #tjpajtfxlp tr, #tjpajtfxlp td, #tjpajtfxlp th {
  border-style: none;
}

#tjpajtfxlp p {
  margin: 0;
  padding: 0;
}

#tjpajtfxlp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tjpajtfxlp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tjpajtfxlp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tjpajtfxlp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tjpajtfxlp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tjpajtfxlp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tjpajtfxlp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tjpajtfxlp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tjpajtfxlp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tjpajtfxlp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tjpajtfxlp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tjpajtfxlp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tjpajtfxlp .gt_spanner_row {
  border-bottom-style: hidden;
}

#tjpajtfxlp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tjpajtfxlp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tjpajtfxlp .gt_from_md > :first-child {
  margin-top: 0;
}

#tjpajtfxlp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tjpajtfxlp .gt_row {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tjpajtfxlp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tjpajtfxlp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tjpajtfxlp .gt_row_group_first td {
  border-top-width: 2px;
}

#tjpajtfxlp .gt_row_group_first th {
  border-top-width: 2px;
}

#tjpajtfxlp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjpajtfxlp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tjpajtfxlp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tjpajtfxlp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tjpajtfxlp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjpajtfxlp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tjpajtfxlp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tjpajtfxlp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tjpajtfxlp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tjpajtfxlp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tjpajtfxlp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjpajtfxlp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tjpajtfxlp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjpajtfxlp .gt_left {
  text-align: left;
}

#tjpajtfxlp .gt_center {
  text-align: center;
}

#tjpajtfxlp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tjpajtfxlp .gt_font_normal {
  font-weight: normal;
}

#tjpajtfxlp .gt_font_bold {
  font-weight: bold;
}

#tjpajtfxlp .gt_font_italic {
  font-style: italic;
}

#tjpajtfxlp .gt_super {
  font-size: 65%;
}

#tjpajtfxlp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tjpajtfxlp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tjpajtfxlp .gt_indent_1 {
  text-indent: 5px;
}

#tjpajtfxlp .gt_indent_2 {
  text-indent: 10px;
}

#tjpajtfxlp .gt_indent_3 {
  text-indent: 15px;
}

#tjpajtfxlp .gt_indent_4 {
  text-indent: 20px;
}

#tjpajtfxlp .gt_indent_5 {
  text-indent: 25px;
}

#tjpajtfxlp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tjpajtfxlp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="9" class="gt_heading gt_title gt_font_normal">Model 3: Monte Carlo Results</th>
</tr>
<tr class="odd gt_heading">
<th colspan="9" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Percentage of Cases with Label Switching and Replications Needed</th>
</tr>
<tr class="header gt_col_headings">
<th id="Transition-Probability" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Transition Probability</th>
<th id="TPs" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">TPs</th>
<th id="N_numeric" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">N_numeric</th>
<th id="Mixing-Proportion" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Mixing Proportion</th>
<th id="Mix" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Mix</th>
<th id="Total-Mplus-Runs" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total Mplus Runs</th>
<th id="Total-Violations" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Total Violations</th>
<th id="a%-of-Violations" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">% of Violations</th>
<th id="Replications_Needed" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Replications_Needed</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">498</td>
<td class="gt_row gt_center" headers="Total Violations">134</td>
<td class="gt_row gt_center" headers="% of Violations">26.908</td>
<td class="gt_row gt_center" headers="Replications_Needed">825</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">148</td>
<td class="gt_row gt_center" headers="% of Violations">29.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">860</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">163</td>
<td class="gt_row gt_center" headers="% of Violations">32.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">900</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">1000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">499</td>
<td class="gt_row gt_center" headers="Total Violations">187</td>
<td class="gt_row gt_center" headers="% of Violations">37.475</td>
<td class="gt_row gt_center" headers="Replications_Needed">965</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">96</td>
<td class="gt_row gt_center" headers="% of Violations">19.200</td>
<td class="gt_row gt_center" headers="Replications_Needed">731</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">184</td>
<td class="gt_row gt_center" headers="% of Violations">36.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">956</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">179</td>
<td class="gt_row gt_center" headers="% of Violations">35.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">943</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">2500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">188</td>
<td class="gt_row gt_center" headers="% of Violations">37.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">967</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">104</td>
<td class="gt_row gt_center" headers="% of Violations">20.800</td>
<td class="gt_row gt_center" headers="Replications_Needed">750</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">148</td>
<td class="gt_row gt_center" headers="% of Violations">29.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">860</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">168</td>
<td class="gt_row gt_center" headers="% of Violations">33.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">913</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">5000</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">202</td>
<td class="gt_row gt_center" headers="% of Violations">40.400</td>
<td class="gt_row gt_center" headers="Replications_Needed">1006</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">103</td>
<td class="gt_row gt_center" headers="% of Violations">20.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">748</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.200</td>
<td class="gt_row gt_center" headers="TPs">-1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">499</td>
<td class="gt_row gt_center" headers="Total Violations">115</td>
<td class="gt_row gt_center" headers="% of Violations">23.046</td>
<td class="gt_row gt_center" headers="Replications_Needed">777</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Even Proportions</td>
<td class="gt_row gt_center" headers="Mix">1</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">500</td>
<td class="gt_row gt_center" headers="Total Violations">173</td>
<td class="gt_row gt_center" headers="% of Violations">34.600</td>
<td class="gt_row gt_center" headers="Replications_Needed">926</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Transition Probability">.800</td>
<td class="gt_row gt_center" headers="TPs">1.385</td>
<td class="gt_row gt_center" headers="N_numeric">500</td>
<td class="gt_row gt_center" headers="Mixing Proportion">Uneven Proportions</td>
<td class="gt_row gt_center" headers="Mix">2</td>
<td class="gt_row gt_center" headers="Total Mplus Runs">499</td>
<td class="gt_row gt_center" headers="Total Violations">138</td>
<td class="gt_row gt_center" headers="% of Violations">27.655</td>
<td class="gt_row gt_center" headers="Replications_Needed">835</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="step-7-delete-cases-that-violate" class="level3">
<h3 class="anchored" data-anchor-id="step-7-delete-cases-that-violate"><strong>Step 7: Delete Cases that Violate</strong></h3>
<section id="objective-3" class="level4">
<h4 class="anchored" data-anchor-id="objective-3"><strong>Objective</strong></h4>
<p><em>Filter out cases with any violations, leaving only the clean data.</em></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Filter out cases with any violations (Any_Violation == 0)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> final_data_with_actuals[final_data_with_actuals<span class="sc">$</span>Any_Violation <span class="sc">==</span> <span class="dv">0</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="step-8-compute-monte-carlo-mc-values" class="level3">
<h3 class="anchored" data-anchor-id="step-8-compute-monte-carlo-mc-values"><strong>Step 8: Compute Monte Carlo (MC) Values</strong></h3>
<section id="objective-4" class="level4">
<h4 class="anchored" data-anchor-id="objective-4"><strong>Objective</strong></h4>
<p><em>Calculate Monte Carlo values for&nbsp;<code>TRANS11</code>, including population values, averages, standard errors, Mean Squared Error (MSE), coverage, and power.</em></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, convert Population back to numeric if it's a factor</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Population =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Population)))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the Monte Carlo values, including Mixing_proportion, Model_Type, N, </span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># population (transition probability), number of replications, and averages for TRANS11 and SE11</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FileName, Population, Mixing_proportion, Model, N) <span class="sc">%&gt;%</span>  <span class="co"># Group by FileName, Population, Mixing_proportion, Model_Type, and N</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">average =</span> <span class="fu">round</span>(<span class="fu">mean</span>(TRANS11, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">average_SE =</span> <span class="fu">round</span>(<span class="fu">mean</span>(SE_11, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_sd =</span> <span class="fu">round</span>(<span class="fu">sd</span>(TRANS11, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MSE calculation: mean squared error between TRANS11 and Population</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">MSE =</span> <span class="fu">round</span>(<span class="fu">mean</span>((TRANS11 <span class="sc">-</span> Population)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coverage calculation: check if Population lies within the confidence interval</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coverage =</span> <span class="fu">round</span>(<span class="fu">mean</span>((Population <span class="sc">&gt;=</span> (TRANS11 <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> SE_11)) <span class="sc">&amp;</span> (Population <span class="sc">&lt;=</span> (TRANS11 <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> SE_11)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Power calculation: proportion of cases where TRANS11 is significant</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Power =</span> <span class="fu">round</span>(<span class="fu">mean</span>(TRANS11 <span class="sc">/</span> SE_11 <span class="sc">&gt;</span> <span class="fl">1.96</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reps_Used counts the number of replications (rows) used for each FileName</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Reps_Used =</span> <span class="fu">n</span>()</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the values to 3 decimal points</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Avg_"</span>), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="step-9-calculate-dichotomous-variables-and-bias" class="level3">
<h3 class="anchored" data-anchor-id="step-9-calculate-dichotomous-variables-and-bias"><strong>Step 9: Calculate Dichotomous Variables and Bias</strong></h3>
<section id="objective-5" class="level4">
<h4 class="anchored" data-anchor-id="objective-5"><strong>Objective</strong></h4>
<p><em>Calculate dichotomous variables for Power and Coverage, compute Parameter and SE Bias, and prepare subsets for movers and stayers.</em></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Calculate dichotomous variable for Power (1 if Power &gt;= 0.8, else 0)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Power_Dic =</span> <span class="fu">ifelse</span>(Power <span class="sc">&gt;=</span> <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Calculate dichotomous variable for Coverage (0 if outside [0.91, 0.98], else 1)</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Coverage_Dic =</span> <span class="fu">ifelse</span>(Coverage <span class="sc">&gt;</span> <span class="fl">0.98</span> <span class="sc">|</span> Coverage <span class="sc">&lt;</span> <span class="fl">0.91</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Remove any groupings before further calculations</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Ensure numeric columns are correctly formatted</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">average =</span> <span class="fu">as.numeric</span>(average),</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Population =</span> <span class="fu">as.numeric</span>(Population),  <span class="co"># Ensure 'Population' is numeric</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">average_se =</span> <span class="fu">as.numeric</span>(average_SE),</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_sd =</span> <span class="fu">as.numeric</span>(population_sd)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Calculate Parameter Bias and SE Bias, rounding the results to 2 decimal places</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>mc_values <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Parameter_Bias =</span> (average <span class="sc">-</span> Population) <span class="sc">/</span> Population <span class="sc">*</span> <span class="dv">100</span>,  <span class="co"># Bias for the parameter</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_Bias =</span> (average_se <span class="sc">-</span> population_sd) <span class="sc">/</span> population_sd <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Bias for the standard error</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Parameter_Bias, SE_Bias), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">2</span>)))  <span class="co"># Round to 2 decimal places</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="step-10-subset-data-for-movers-and-stayers" class="level3">
<h3 class="anchored" data-anchor-id="step-10-subset-data-for-movers-and-stayers"><strong>Step 10: Subset Data for Movers and Stayers</strong></h3>
<section id="objective-6" class="level4">
<h4 class="anchored" data-anchor-id="objective-6"><strong>Objective</strong></h4>
<p><em>Subset the Monte Carlo values data for transitions with movers and stayers based on the population value.</em></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Subset data for transitions movers (population == 0.2)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>subset_mover <span class="ot">&lt;-</span> <span class="fu">subset</span>(mc_values, Population <span class="sc">==</span> <span class="fl">0.2</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Subset data for transitions stayers (population == 0.8)</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>subset_stayer <span class="ot">&lt;-</span> <span class="fu">subset</span>(mc_values, Population <span class="sc">==</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="step-11-combined-plot-for-mover-and-stayer" class="level3">
<h3 class="anchored" data-anchor-id="step-11-combined-plot-for-mover-and-stayer"><strong>Step 11: Combined Plot for Mover and Stayer</strong></h3>
<section id="objective-7" class="level4">
<h4 class="anchored" data-anchor-id="objective-7"><strong>Objective</strong></h4>
<p><em>Create streamlined plots for both mover and stayer subsets using a common theme and labels.</em></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define a custom theme (used for both plots)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>common_theme <span class="ot">&lt;-</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>),  <span class="co"># Major y-axis lines</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"black"</span>),  <span class="co"># Style for x-axis text</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.6</span>),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">10</span>),</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Define common labels function</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>common_labels <span class="ot">&lt;-</span> <span class="cf">function</span>(title) {</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sample Size"</span>,  </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Bias (%)"</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> title</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Create the plot function using the common theme and labels</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>create_bias_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title, ylim_range) {</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify which legends are present in the data</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span>, <span class="st">"Standard Error Bias"</span>)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(data<span class="sc">$</span>Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>)) present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(present_categories, <span class="st">"Coverage Failure"</span>)</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(data<span class="sc">$</span>Power_Dic <span class="sc">==</span> <span class="dv">0</span>)) present_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(present_categories, <span class="st">"Power Failure"</span>)</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define colors and shapes</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span> <span class="ot">=</span> <span class="st">"#4169E1"</span>, <span class="st">"Standard Error Bias"</span> <span class="ot">=</span> <span class="st">"#E14169"</span>, </span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Coverage Failure"</span> <span class="ot">=</span> <span class="st">"#4169E1"</span>, <span class="st">"Power Failure"</span> <span class="ot">=</span> <span class="st">"black"</span>)</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Parameter Bias"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"Standard Error Bias"</span> <span class="ot">=</span> <span class="dv">18</span>, </span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Coverage Failure"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Power Failure"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter the colors and shapes based on present categories</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>  filtered_colors <span class="ot">&lt;-</span> colors[present_categories]</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>  filtered_shapes <span class="ot">&lt;-</span> shapes[present_categories]</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(N))) <span class="sc">+</span>  </span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Parameter Bias"</span>, <span class="at">group =</span> Model), <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span>  </span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> SE_Bias, <span class="at">color =</span> <span class="st">"Standard Error Bias"</span>, <span class="at">group =</span> Model), <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span>  </span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Parameter Bias"</span>), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="fl">1.7</span>, <span class="at">fill =</span> <span class="st">"#4169E1"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> SE_Bias, <span class="at">color =</span> <span class="st">"Standard Error Bias"</span>), <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">fill =</span> <span class="st">"#E14169"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Coverage_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Coverage Failure"</span>), <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"#4169E1"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, Power_Dic <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">y =</span> Parameter_Bias, <span class="at">color =</span> <span class="st">"Power Failure"</span>), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> filtered_colors, </span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> present_categories, </span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> present_categories,</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> filtered_shapes</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span>  </span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">common_labels</span>(title) <span class="sc">+</span>  <span class="co"># Using the common labels function</span></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> ylim_range) <span class="sc">+</span>  </span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(Mixing_proportion <span class="sc">~</span> Model, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free_y"</span>) <span class="sc">+</span> </span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 500"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 1000"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 2500"</span>), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"N"</span>) <span class="sc">~</span> <span class="st">" = 5000"</span>))) <span class="sc">+</span>  </span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(ylim_range[<span class="dv">1</span>], ylim_range[<span class="dv">2</span>], <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span>  </span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>    common_theme <span class="sc">+</span>  <span class="co"># Apply the common theme</span></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"top"</span>,  <span class="co"># Move facet labels to the top</span></span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>),  <span class="co"># Rotate x-axis labels for readability</span></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">20</span>)  <span class="co"># Add margin to the right side</span></span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#4169E1"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  </span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#E14169"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>)</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for movers (population = 0.2)</span></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>plot_mover <span class="ot">&lt;-</span> <span class="fu">create_bias_plot</span>(subset_mover, <span class="st">"LTA Generated / LTA Analyzed with Mover Transition Probabilities"</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>))</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_mover)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Study_F_2T_LTA_LTA_files/figure-html/bias-plots-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for stayers (population = 0.8)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>plot_stayer <span class="ot">&lt;-</span> <span class="fu">create_bias_plot</span>(subset_stayer, <span class="st">"LTA Generated / LTA Analyzed with Stationary Transition Probabilities"</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_stayer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Study_F_2T_LTA_LTA_files/figure-html/bias-plots-2.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="step-12-prepare-data-for-heatmaps" class="level3">
<h3 class="anchored" data-anchor-id="step-12-prepare-data-for-heatmaps"><strong>Step 12: Prepare Data for Heatmaps</strong></h3>
<section id="objective-8" class="level4">
<h4 class="anchored" data-anchor-id="objective-8"><strong>Objective</strong></h4>
<p><em>Prepare data for heatmap creation by ensuring correct formatting for population values, and subsetting the data based on class proportions and sample sizes.</em></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Ensure N is treated as a factor with the correct levels in order </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># No need to create N_Label; N is already a factor with correct labels</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Order heatmap_data by population, Mixing_proportion, Model, and N</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Population' into a factor with proper levels</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> mc_values <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Population =</span> <span class="fu">factor</span>(Population, <span class="at">levels =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">".200"</span>, <span class="st">".800"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Population, Mixing_proportion, Model, N)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Create subsets for each combination of population and class proportions</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.2</span>_even_proportions <span class="ot">&lt;-</span> <span class="fu">subset</span>(heatmap_data, Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">&amp;</span> Mixing_proportion <span class="sc">==</span> <span class="st">"Even Proportions"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">select =</span> <span class="fu">c</span>(N, average, Coverage, Power, Parameter_Bias, SE_Bias))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.2</span>_uneven_proportions <span class="ot">&lt;-</span> <span class="fu">subset</span>(heatmap_data, Population <span class="sc">==</span> <span class="st">".200"</span> <span class="sc">&amp;</span> Mixing_proportion <span class="sc">==</span> <span class="st">"Uneven Proportions"</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">select =</span> <span class="fu">c</span>(N, average, Coverage, Power, Parameter_Bias, SE_Bias))</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.8</span>_even_proportions <span class="ot">&lt;-</span> <span class="fu">subset</span>(heatmap_data, Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">&amp;</span> Mixing_proportion <span class="sc">==</span> <span class="st">"Even Proportions"</span>,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">select =</span> <span class="fu">c</span>(N, average, Coverage, Power, Parameter_Bias, SE_Bias))</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.8</span>_uneven_proportions <span class="ot">&lt;-</span> <span class="fu">subset</span>(heatmap_data, Population <span class="sc">==</span> <span class="st">".800"</span> <span class="sc">&amp;</span> Mixing_proportion <span class="sc">==</span> <span class="st">"Uneven Proportions"</span>,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">select =</span> <span class="fu">c</span>(N, average, Coverage, Power, Parameter_Bias, SE_Bias))</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Store subsets in a list for easier access and management</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>subset_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset_0.2_even_proportions =</span> subset_0<span class="fl">.2</span>_even_proportions,</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset_0.2_uneven_proportions =</span> subset_0<span class="fl">.2</span>_uneven_proportions,</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset_0.8_even_proportions =</span> subset_0<span class="fl">.8</span>_even_proportions,</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset_0.8_uneven_proportions =</span> subset_0<span class="fl">.8</span>_uneven_proportions</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="step-13-heatmap-creation-and-rendering" class="level3">
<h3 class="anchored" data-anchor-id="step-13-heatmap-creation-and-rendering"><strong>Step 13: Heatmap Creation and Rendering</strong></h3>
<section id="objective-9" class="level4">
<h4 class="anchored" data-anchor-id="objective-9"><strong>Objective</strong></h4>
<p><em>Create heatmaps using the&nbsp;<code>gt</code>&nbsp;package and render each table separately for different subsets of the data.</em></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create the gt heatmap table</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>create_table <span class="ot">&lt;-</span> <span class="cf">function</span>(subset, transition_probability) {</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2: Create the gt object and set initial formatting</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  gt_table <span class="ot">&lt;-</span> subset <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opt_table_font</span>(<span class="at">stack =</span> <span class="st">"geometric-humanist"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"LTA Generated &amp; LTA Analyzed with Transition Probability of"</span>, transition_probability)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">N =</span> <span class="st">"Sample Size"</span>,  <span class="co"># This will now use the ordered N values</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">average =</span> <span class="st">"Estimated&lt;br&gt;Probability"</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">Coverage =</span> <span class="st">"Coverage"</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">Power =</span> <span class="st">"Power"</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter_Bias =</span> <span class="st">"Parameter&lt;br&gt;Bias"</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE_Bias =</span> <span class="st">"Standard Error&lt;br&gt;Bias"</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fn =</span> md</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Bias"</span>,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Parameter_Bias"</span>, <span class="st">"SE_Bias"</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="st">"Model 3"</span>, <span class="at">rows =</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="st">"Model 2"</span>, <span class="at">rows =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_row_group</span>(<span class="at">label =</span> <span class="st">"Model 1"</span>, <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">font =</span> <span class="st">"bold italic"</span>),  <span class="co"># Bold and italic styling for row subheaders</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_row_groups</span>()</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Parameter_Bias"</span>, <span class="st">"SE_Bias"</span>), <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="dv">4</span>, <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_options</span>(</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.hlines.color =</span> <span class="st">"white"</span>,</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_group.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_group.border.bottom.color =</span> <span class="st">"black"</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">columns =</span> <span class="fu">everything</span>())</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply color highlighting for violations in Parameter Bias</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span>(subset<span class="sc">$</span>Parameter_Bias <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">9.99</span> <span class="sc">&amp;</span> subset<span class="sc">$</span>Parameter_Bias <span class="sc">&lt;=</span> <span class="fl">9.99</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"Parameter_Bias"</span>,</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> .data<span class="sc">$</span>Parameter_Bias <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">9.99</span> <span class="sc">|</span> .data<span class="sc">$</span>Parameter_Bias <span class="sc">&gt;</span> <span class="fl">9.99</span>,  <span class="co"># Apply color only if outside the threshold</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#1f78b4"</span>, <span class="st">"#deebf7"</span>, <span class="st">"#1f78b4"</span>),  <span class="co"># Darker blue for larger deviations</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>)  <span class="co"># Adjust the domain to reflect the range of values</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Darker blue indicates larger deviations from zero *Parameter Bias* beyond the ±9.99 threshold."</span>),</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"Parameter_Bias"</span>)</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply color highlighting for violations in SE Bias</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span>(subset<span class="sc">$</span>SE_Bias <span class="sc">&gt;=</span> <span class="sc">-</span><span class="fl">4.99</span> <span class="sc">&amp;</span> subset<span class="sc">$</span>SE_Bias <span class="sc">&lt;=</span> <span class="fl">4.99</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="st">"SE_Bias"</span>,</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> .data<span class="sc">$</span>SE_Bias <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">4.99</span> <span class="sc">|</span> .data<span class="sc">$</span>SE_Bias <span class="sc">&gt;</span> <span class="fl">4.99</span>,  <span class="co"># Apply color only if outside the threshold</span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#e31a1c"</span>, <span class="st">"#fde0dd"</span>, <span class="st">"#e31a1c"</span>),  <span class="co"># Darker red for larger deviations</span></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>, <span class="dv">80</span>)  <span class="co"># Adjust the domain for the SE_Bias range</span></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Darker red indicates larger deviations from zero *Standard Error Bias* beyond the ±4.99 threshold."</span>),</span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"SE_Bias"</span>)</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(subset<span class="sc">$</span>Coverage <span class="sc">&lt;</span> <span class="fl">0.93</span> <span class="sc">|</span> subset<span class="sc">$</span>Coverage <span class="sc">&gt;</span> <span class="fl">0.979</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="st">"Coverage"</span>, <span class="at">rows =</span> subset<span class="sc">$</span>Coverage <span class="sc">&lt;</span> <span class="fl">0.93</span> <span class="sc">|</span> subset<span class="sc">$</span>Coverage <span class="sc">&gt;</span> <span class="fl">0.979</span>,</span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"numeric"</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#193006"</span>, <span class="st">"white"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(<span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Green indicates failure to achieve adequate *Coverage*."</span>), <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Coverage))</span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(subset<span class="sc">$</span>Power <span class="sc">&lt;</span> <span class="fl">0.8</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>    gt_table <span class="ot">&lt;-</span> gt_table <span class="sc">%&gt;%</span></span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="st">"Power"</span>, <span class="at">rows =</span> subset<span class="sc">$</span>Power <span class="sc">&lt;</span> <span class="fl">0.8</span>,</span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"numeric"</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#300049"</span>, <span class="st">"white"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(<span class="at">footnote =</span> <span class="fu">md</span>(<span class="st">"Purple indicates failure to achieve adequate *Power*."</span>), <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Power))</span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(gt_table)</span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="step-14-rendering-the-tables" class="level3">
<h3 class="anchored" data-anchor-id="step-14-rendering-the-tables"><strong>Step 14: Rendering the Tables</strong></h3>
<p><strong>Heatmap for&nbsp;<code>.200, Equal Proportions</code>:</strong></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>subset_02_table_even_proportions <span class="ot">&lt;-</span> <span class="fu">create_table</span>(subset_0<span class="fl">.2</span>_even_proportions, <span class="st">".200, Even Mixing Proportions"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>subset_02_table_even_proportions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="hyxubmmhxd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hyxubmmhxd table {
  font-family: Avenir, Montserrat, Corbel, 'URW Gothic', source-sans-pro, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hyxubmmhxd thead, #hyxubmmhxd tbody, #hyxubmmhxd tfoot, #hyxubmmhxd tr, #hyxubmmhxd td, #hyxubmmhxd th {
  border-style: none;
}

#hyxubmmhxd p {
  margin: 0;
  padding: 0;
}

#hyxubmmhxd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hyxubmmhxd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hyxubmmhxd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hyxubmmhxd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hyxubmmhxd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hyxubmmhxd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#hyxubmmhxd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hyxubmmhxd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hyxubmmhxd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hyxubmmhxd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hyxubmmhxd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hyxubmmhxd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hyxubmmhxd .gt_spanner_row {
  border-bottom-style: hidden;
}

#hyxubmmhxd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hyxubmmhxd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: middle;
}

#hyxubmmhxd .gt_from_md > :first-child {
  margin-top: 0;
}

#hyxubmmhxd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hyxubmmhxd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hyxubmmhxd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hyxubmmhxd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hyxubmmhxd .gt_row_group_first td {
  border-top-width: 2px;
}

#hyxubmmhxd .gt_row_group_first th {
  border-top-width: 2px;
}

#hyxubmmhxd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyxubmmhxd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hyxubmmhxd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hyxubmmhxd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hyxubmmhxd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyxubmmhxd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hyxubmmhxd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hyxubmmhxd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hyxubmmhxd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hyxubmmhxd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hyxubmmhxd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyxubmmhxd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hyxubmmhxd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyxubmmhxd .gt_left {
  text-align: left;
}

#hyxubmmhxd .gt_center {
  text-align: center;
}

#hyxubmmhxd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hyxubmmhxd .gt_font_normal {
  font-weight: normal;
}

#hyxubmmhxd .gt_font_bold {
  font-weight: bold;
}

#hyxubmmhxd .gt_font_italic {
  font-style: italic;
}

#hyxubmmhxd .gt_super {
  font-size: 65%;
}

#hyxubmmhxd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hyxubmmhxd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hyxubmmhxd .gt_indent_1 {
  text-indent: 5px;
}

#hyxubmmhxd .gt_indent_2 {
  text-indent: 10px;
}

#hyxubmmhxd .gt_indent_3 {
  text-indent: 15px;
}

#hyxubmmhxd .gt_indent_4 {
  text-indent: 20px;
}

#hyxubmmhxd .gt_indent_5 {
  text-indent: 25px;
}

#hyxubmmhxd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hyxubmmhxd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border">LTA Generated &amp; LTA Analyzed with Transition Probability of .200, Even Mixing Proportions</th>
</tr>
<tr class="odd gt_col_headings gt_spanner_row">
<th rowspan="2" id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Sample Size</th>
<th rowspan="2" id="average" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimated<br>Probability</th>
<th rowspan="2" id="Coverage" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Coverage<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th rowspan="2" id="Power" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Power<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
<th colspan="2" id="Bias" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Bias
</div></th>
</tr>
<tr class="header gt_col_headings">
<th id="Parameter_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Parameter<br>Bias<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
<th id="SE_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Standard Error<br>Bias<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="6" id="Model 1" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 1</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="Model 1  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 1  average">0.194</td>
<td class="gt_row gt_center" headers="Model 1  Coverage" style="background-color: #E9ECE7; color: #000000">0.915</td>
<td class="gt_row gt_center" headers="Model 1  Power" style="background-color: #9A7FA4; color: #FFFFFF">0.521</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">−3.00</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias" style="background-color: #FFCCC4; color: #000000">9.47</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 1  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 1  average">0.201</td>
<td class="gt_row gt_center" headers="Model 1  Coverage" style="background-color: #EBEDE9; color: #000000">0.922</td>
<td class="gt_row gt_center" headers="Model 1  Power">0.821</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">0.50</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias" style="background-color: #FFD4CD; color: #000000">5.97</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 1  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 1  average">0.199</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.959</td>
<td class="gt_row gt_center" headers="Model 1  Power">0.997</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">−0.50</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias" style="background-color: #FFCAC2; color: #000000">10.53</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 1  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 1  average">0.200</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.972</td>
<td class="gt_row gt_center" headers="Model 1  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias" style="background-color: #FFC8BF; color: #000000">11.54</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="Model 2" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 2</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_center" headers="Model 2  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 2  average">0.199</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.936</td>
<td class="gt_row gt_center" headers="Model 2  Power">0.994</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.50</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">−2.27</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 2  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 2  average">0.199</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.955</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.50</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias" style="background-color: #FFD1CA; color: #000000">7.14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 2  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 2  average">0.199</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.958</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.50</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias" style="background-color: #FED4CF; color: #000000">5.56</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 2  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 2  average">0.200</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.956</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">0.00</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="Model 3" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 3</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="Model 3  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 3  average">0.222</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.935</td>
<td class="gt_row gt_center" headers="Model 3  Power">0.869</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias" style="background-color: #B1CAE5; color: #000000">11.00</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias" style="background-color: #FFC3B9; color: #000000">13.85</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 3  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 3  average">0.210</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.953</td>
<td class="gt_row gt_center" headers="Model 3  Power">0.986</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">5.00</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias">4.26</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 3  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 3  average">0.205</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.955</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">2.50</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias" style="background-color: #FFD1CA; color: #000000">7.14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 3  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 3  average">0.204</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.962</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">2.00</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias" style="background-color: #FFCBC3; color: #000000">10.00</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Green indicates failure to achieve adequate <em>Coverage</em>.</td>
</tr>
<tr class="odd">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Purple indicates failure to achieve adequate <em>Power</em>.</td>
</tr>
<tr class="even">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> Darker blue indicates larger deviations from zero <em>Parameter Bias</em> beyond the ±9.99 threshold.</td>
</tr>
<tr class="odd">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span> Darker red indicates larger deviations from zero <em>Standard Error Bias</em> beyond the ±4.99 threshold.</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>subset_02_table_even_proportions <span class="sc">|&gt;</span> <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">55</span>)) <span class="sc">|&gt;</span> <span class="fu">gtsave</span>(<span class="fu">here</span>(<span class="st">"z2t_lta_rilta_tables"</span>, <span class="st">"2T_L_R_.200, Even Proportions.png"</span>), <span class="at">expand =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Heatmap for&nbsp;<code>.200, Unequal Proportions</code>:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap for .200, Unequal Proportions</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.2</span>_table_uneven_proportions <span class="ot">&lt;-</span> <span class="fu">create_table</span>(subset_0<span class="fl">.2</span>_uneven_proportions, <span class="st">".200, Uneven Mixing Proportions"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.2</span>_table_uneven_proportions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="byzfriaozi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#byzfriaozi table {
  font-family: Avenir, Montserrat, Corbel, 'URW Gothic', source-sans-pro, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#byzfriaozi thead, #byzfriaozi tbody, #byzfriaozi tfoot, #byzfriaozi tr, #byzfriaozi td, #byzfriaozi th {
  border-style: none;
}

#byzfriaozi p {
  margin: 0;
  padding: 0;
}

#byzfriaozi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#byzfriaozi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#byzfriaozi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#byzfriaozi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#byzfriaozi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#byzfriaozi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#byzfriaozi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#byzfriaozi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#byzfriaozi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#byzfriaozi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#byzfriaozi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#byzfriaozi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#byzfriaozi .gt_spanner_row {
  border-bottom-style: hidden;
}

#byzfriaozi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#byzfriaozi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: middle;
}

#byzfriaozi .gt_from_md > :first-child {
  margin-top: 0;
}

#byzfriaozi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#byzfriaozi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#byzfriaozi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#byzfriaozi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#byzfriaozi .gt_row_group_first td {
  border-top-width: 2px;
}

#byzfriaozi .gt_row_group_first th {
  border-top-width: 2px;
}

#byzfriaozi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#byzfriaozi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#byzfriaozi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#byzfriaozi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#byzfriaozi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#byzfriaozi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#byzfriaozi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#byzfriaozi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#byzfriaozi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#byzfriaozi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#byzfriaozi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#byzfriaozi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#byzfriaozi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#byzfriaozi .gt_left {
  text-align: left;
}

#byzfriaozi .gt_center {
  text-align: center;
}

#byzfriaozi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#byzfriaozi .gt_font_normal {
  font-weight: normal;
}

#byzfriaozi .gt_font_bold {
  font-weight: bold;
}

#byzfriaozi .gt_font_italic {
  font-style: italic;
}

#byzfriaozi .gt_super {
  font-size: 65%;
}

#byzfriaozi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#byzfriaozi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#byzfriaozi .gt_indent_1 {
  text-indent: 5px;
}

#byzfriaozi .gt_indent_2 {
  text-indent: 10px;
}

#byzfriaozi .gt_indent_3 {
  text-indent: 15px;
}

#byzfriaozi .gt_indent_4 {
  text-indent: 20px;
}

#byzfriaozi .gt_indent_5 {
  text-indent: 25px;
}

#byzfriaozi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#byzfriaozi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border">LTA Generated &amp; LTA Analyzed with Transition Probability of .200, Uneven Mixing Proportions</th>
</tr>
<tr class="odd gt_col_headings gt_spanner_row">
<th rowspan="2" id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Sample Size</th>
<th rowspan="2" id="average" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimated<br>Probability</th>
<th rowspan="2" id="Coverage" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Coverage<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th rowspan="2" id="Power" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Power</th>
<th colspan="2" id="Bias" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Bias
</div></th>
</tr>
<tr class="header gt_col_headings">
<th id="Parameter_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Parameter<br>Bias</th>
<th id="SE_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Standard Error<br>Bias<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="6" id="Model 1" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 1</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="Model 1  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 1  average">0.198</td>
<td class="gt_row gt_center" headers="Model 1  Coverage" style="background-color: #EBEDE9; color: #000000">0.921</td>
<td class="gt_row gt_center" headers="Model 1  Power">0.818</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">−1.00</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias" style="background-color: #FFC9C1; color: #000000">10.94</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 1  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 1  average">0.198</td>
<td class="gt_row gt_center" headers="Model 1  Coverage" style="background-color: #ECEEEA; color: #000000">0.927</td>
<td class="gt_row gt_center" headers="Model 1  Power">0.974</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">−1.00</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias">2.13</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 1  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 1  average">0.201</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.945</td>
<td class="gt_row gt_center" headers="Model 1  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">0.50</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 1  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 1  average">0.200</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.962</td>
<td class="gt_row gt_center" headers="Model 1  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias" style="background-color: #FED4CF; color: #000000">5.56</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="Model 2" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 2</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_center" headers="Model 2  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 2  average">0.198</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.958</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−1.00</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">3.33</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 2  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 2  average">0.198</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.953</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−1.00</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">4.76</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 2  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 2  average">0.199</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.960</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.50</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias" style="background-color: #FFD0C9; color: #000000">7.69</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 2  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 2  average">0.200</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.957</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">0.00</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="Model 3" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 3</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="Model 3  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 3  average">0.207</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.945</td>
<td class="gt_row gt_center" headers="Model 3  Power">0.992</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">3.50</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias">4.44</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 3  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 3  average">0.202</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.952</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">1.00</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias">3.23</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 3  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 3  average">0.200</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.965</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 3  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 3  average">0.200</td>
<td class="gt_row gt_center" headers="Model 3  Coverage" style="background-color: #ECEEEA; color: #000000">0.926</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias">0.00</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Green indicates failure to achieve adequate <em>Coverage</em>.</td>
</tr>
<tr class="odd">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Darker red indicates larger deviations from zero <em>Standard Error Bias</em> beyond the ±4.99 threshold.</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.2</span>_table_uneven_proportions <span class="sc">|&gt;</span> <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">55</span>)) <span class="sc">|&gt;</span> <span class="fu">gtsave</span>(<span class="fu">here</span>(<span class="st">"z2t_lta_rilta_tables"</span>,<span class="st">"2T_L_R_.200, Uneven Proportions.png"</span>), <span class="at">expand =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Heatmap for&nbsp;<code>.800, Equal Proportions</code>:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap for .800, Equal Proportions</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.8</span>_table_even_proportions <span class="ot">&lt;-</span> <span class="fu">create_table</span>(subset_0<span class="fl">.8</span>_even_proportions, <span class="st">".800, Even Mixing Proportions"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.8</span>_table_even_proportions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="yvcyuohgoa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yvcyuohgoa table {
  font-family: Avenir, Montserrat, Corbel, 'URW Gothic', source-sans-pro, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yvcyuohgoa thead, #yvcyuohgoa tbody, #yvcyuohgoa tfoot, #yvcyuohgoa tr, #yvcyuohgoa td, #yvcyuohgoa th {
  border-style: none;
}

#yvcyuohgoa p {
  margin: 0;
  padding: 0;
}

#yvcyuohgoa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yvcyuohgoa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yvcyuohgoa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yvcyuohgoa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yvcyuohgoa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yvcyuohgoa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#yvcyuohgoa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yvcyuohgoa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yvcyuohgoa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yvcyuohgoa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yvcyuohgoa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yvcyuohgoa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yvcyuohgoa .gt_spanner_row {
  border-bottom-style: hidden;
}

#yvcyuohgoa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yvcyuohgoa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: middle;
}

#yvcyuohgoa .gt_from_md > :first-child {
  margin-top: 0;
}

#yvcyuohgoa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yvcyuohgoa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yvcyuohgoa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yvcyuohgoa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yvcyuohgoa .gt_row_group_first td {
  border-top-width: 2px;
}

#yvcyuohgoa .gt_row_group_first th {
  border-top-width: 2px;
}

#yvcyuohgoa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvcyuohgoa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yvcyuohgoa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yvcyuohgoa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yvcyuohgoa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvcyuohgoa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yvcyuohgoa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yvcyuohgoa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yvcyuohgoa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yvcyuohgoa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yvcyuohgoa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvcyuohgoa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yvcyuohgoa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvcyuohgoa .gt_left {
  text-align: left;
}

#yvcyuohgoa .gt_center {
  text-align: center;
}

#yvcyuohgoa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yvcyuohgoa .gt_font_normal {
  font-weight: normal;
}

#yvcyuohgoa .gt_font_bold {
  font-weight: bold;
}

#yvcyuohgoa .gt_font_italic {
  font-style: italic;
}

#yvcyuohgoa .gt_super {
  font-size: 65%;
}

#yvcyuohgoa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yvcyuohgoa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yvcyuohgoa .gt_indent_1 {
  text-indent: 5px;
}

#yvcyuohgoa .gt_indent_2 {
  text-indent: 10px;
}

#yvcyuohgoa .gt_indent_3 {
  text-indent: 15px;
}

#yvcyuohgoa .gt_indent_4 {
  text-indent: 20px;
}

#yvcyuohgoa .gt_indent_5 {
  text-indent: 25px;
}

#yvcyuohgoa .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yvcyuohgoa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border">LTA Generated &amp; LTA Analyzed with Transition Probability of .800, Even Mixing Proportions</th>
</tr>
<tr class="odd gt_col_headings gt_spanner_row">
<th rowspan="2" id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Sample Size</th>
<th rowspan="2" id="average" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimated<br>Probability</th>
<th rowspan="2" id="Coverage" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Coverage</th>
<th rowspan="2" id="Power" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Power</th>
<th colspan="2" id="Bias" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Bias
</div></th>
</tr>
<tr class="header gt_col_headings">
<th id="Parameter_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Parameter<br>Bias</th>
<th id="SE_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Standard Error<br>Bias<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="6" id="Model 1" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 1</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="Model 1  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 1  average">0.781</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.941</td>
<td class="gt_row gt_center" headers="Model 1  Power">0.989</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">−2.38</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias" style="background-color: #FFC4BA; color: #000000">−13.73</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 1  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 1  average">0.794</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.965</td>
<td class="gt_row gt_center" headers="Model 1  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">−0.75</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias" style="background-color: #FFCCC5; color: #000000">9.43</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 1  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 1  average">0.799</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.942</td>
<td class="gt_row gt_center" headers="Model 1  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">−0.13</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 1  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 1  average">0.800</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.933</td>
<td class="gt_row gt_center" headers="Model 1  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias">0.00</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="Model 2" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 2</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_center" headers="Model 2  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 2  average">0.799</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.950</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.13</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 2  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 2  average">0.798</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.932</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.25</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">−3.13</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 2  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 2  average">0.799</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.952</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.13</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 2  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 2  average">0.800</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.956</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias" style="background-color: #FFD0C9; color: #000000">7.69</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="Model 3" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 3</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="Model 3  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 3  average">0.806</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.933</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">0.75</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias">1.85</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 3  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 3  average">0.800</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.964</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias" style="background-color: #FED5CF; color: #000000">5.26</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 3  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 3  average">0.799</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.969</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">−0.13</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias">4.17</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 3  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 3  average">0.800</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.976</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias" style="background-color: #FFD4CE; color: #000000">5.88</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Darker red indicates larger deviations from zero <em>Standard Error Bias</em> beyond the ±4.99 threshold.</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.8</span>_table_even_proportions <span class="sc">|&gt;</span> <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">55</span>)) <span class="sc">|&gt;</span> <span class="fu">gtsave</span>(<span class="fu">here</span>(<span class="st">"z2t_lta_rilta_tables"</span>, <span class="st">"2T_L_R_.800, Even Proportions.png"</span>), <span class="at">expand =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Heatmap for&nbsp;<code>.800, Unequal Proportions</code>:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap for .800, Unequal Proportions</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.8</span>_table_uneven_proportions <span class="ot">&lt;-</span> <span class="fu">create_table</span>(subset_0<span class="fl">.8</span>_uneven_proportions, <span class="st">".800, Uneven Mixing Proportions"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.8</span>_table_uneven_proportions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="zdypmhmcxp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zdypmhmcxp table {
  font-family: Avenir, Montserrat, Corbel, 'URW Gothic', source-sans-pro, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zdypmhmcxp thead, #zdypmhmcxp tbody, #zdypmhmcxp tfoot, #zdypmhmcxp tr, #zdypmhmcxp td, #zdypmhmcxp th {
  border-style: none;
}

#zdypmhmcxp p {
  margin: 0;
  padding: 0;
}

#zdypmhmcxp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zdypmhmcxp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zdypmhmcxp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zdypmhmcxp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zdypmhmcxp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zdypmhmcxp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#zdypmhmcxp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zdypmhmcxp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zdypmhmcxp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zdypmhmcxp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zdypmhmcxp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zdypmhmcxp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zdypmhmcxp .gt_spanner_row {
  border-bottom-style: hidden;
}

#zdypmhmcxp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zdypmhmcxp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: middle;
}

#zdypmhmcxp .gt_from_md > :first-child {
  margin-top: 0;
}

#zdypmhmcxp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zdypmhmcxp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zdypmhmcxp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zdypmhmcxp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zdypmhmcxp .gt_row_group_first td {
  border-top-width: 2px;
}

#zdypmhmcxp .gt_row_group_first th {
  border-top-width: 2px;
}

#zdypmhmcxp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdypmhmcxp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zdypmhmcxp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zdypmhmcxp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zdypmhmcxp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdypmhmcxp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zdypmhmcxp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zdypmhmcxp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zdypmhmcxp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zdypmhmcxp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zdypmhmcxp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdypmhmcxp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zdypmhmcxp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdypmhmcxp .gt_left {
  text-align: left;
}

#zdypmhmcxp .gt_center {
  text-align: center;
}

#zdypmhmcxp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zdypmhmcxp .gt_font_normal {
  font-weight: normal;
}

#zdypmhmcxp .gt_font_bold {
  font-weight: bold;
}

#zdypmhmcxp .gt_font_italic {
  font-style: italic;
}

#zdypmhmcxp .gt_super {
  font-size: 65%;
}

#zdypmhmcxp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zdypmhmcxp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zdypmhmcxp .gt_indent_1 {
  text-indent: 5px;
}

#zdypmhmcxp .gt_indent_2 {
  text-indent: 10px;
}

#zdypmhmcxp .gt_indent_3 {
  text-indent: 15px;
}

#zdypmhmcxp .gt_indent_4 {
  text-indent: 20px;
}

#zdypmhmcxp .gt_indent_5 {
  text-indent: 25px;
}

#zdypmhmcxp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zdypmhmcxp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border">LTA Generated &amp; LTA Analyzed with Transition Probability of .800, Uneven Mixing Proportions</th>
</tr>
<tr class="odd gt_col_headings gt_spanner_row">
<th rowspan="2" id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Sample Size</th>
<th rowspan="2" id="average" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimated<br>Probability</th>
<th rowspan="2" id="Coverage" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Coverage</th>
<th rowspan="2" id="Power" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Power</th>
<th colspan="2" id="Bias" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Bias
</div></th>
</tr>
<tr class="header gt_col_headings">
<th id="Parameter_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Parameter<br>Bias</th>
<th id="SE_Bias" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Standard Error<br>Bias<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="6" id="Model 1" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 1</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="Model 1  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 1  average">0.787</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.935</td>
<td class="gt_row gt_center" headers="Model 1  Power">0.986</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">−1.63</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias" style="background-color: #FC9481; color: #000000">−36.36</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 1  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 1  average">0.797</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.935</td>
<td class="gt_row gt_center" headers="Model 1  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">−0.38</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias">2.56</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 1  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 1  average">0.800</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.947</td>
<td class="gt_row gt_center" headers="Model 1  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 1  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 1  average">0.800</td>
<td class="gt_row gt_center" headers="Model 1  Coverage">0.955</td>
<td class="gt_row gt_center" headers="Model 1  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 1  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 1  SE_Bias">0.00</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="Model 2" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 2</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_center" headers="Model 2  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 2  average">0.798</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.942</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.25</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">3.23</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 2  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 2  average">0.799</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.945</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.13</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 2  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 2  average">0.799</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.947</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.13</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias" style="background-color: #FFD0C9; color: #000000">7.69</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 2  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 2  average">0.799</td>
<td class="gt_row gt_center" headers="Model 2  Coverage">0.932</td>
<td class="gt_row gt_center" headers="Model 2  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 2  Parameter_Bias">−0.13</td>
<td class="gt_row gt_center" headers="Model 2  SE_Bias">0.00</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="Model 3" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-family: 'bold italic'" scope="colgroup">Model 3</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="Model 3  N">N = 500</td>
<td class="gt_row gt_center" headers="Model 3  average">0.803</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.939</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">0.38</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias">2.78</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 3  N">N = 1000</td>
<td class="gt_row gt_center" headers="Model 3  average">0.801</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.962</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">0.13</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias">4.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Model 3  N">N = 2500</td>
<td class="gt_row gt_center" headers="Model 3  average">0.798</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.952</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">−0.25</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Model 3  N">N = 5000</td>
<td class="gt_row gt_center" headers="Model 3  average">0.800</td>
<td class="gt_row gt_center" headers="Model 3  Coverage">0.956</td>
<td class="gt_row gt_center" headers="Model 3  Power">1.000</td>
<td class="gt_row gt_center" headers="Model 3  Parameter_Bias">0.00</td>
<td class="gt_row gt_center" headers="Model 3  SE_Bias" style="background-color: #FFCDC5; color: #000000">9.09</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Darker red indicates larger deviations from zero <em>Standard Error Bias</em> beyond the ±4.99 threshold.</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>subset_0<span class="fl">.8</span>_table_uneven_proportions <span class="sc">|&gt;</span> <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">55</span>)) <span class="sc">|&gt;</span> <span class="fu">gtsave</span>(<span class="fu">here</span>(<span class="st">"z2t_lta_rilta_tables"</span>, <span class="st">"2T_L_R_.800, Uneven Proportions.png"</span>), <span class="at">expand =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>